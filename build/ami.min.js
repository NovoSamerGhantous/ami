!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("AMI",[],e):"object"==typeof exports?exports.AMI=e():t.AMI=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=127)}([function(t,e,i){"use strict";i.d(e,"a",function(){return d}),i.d(e,"b",function(){return pr}),i.d(e,"c",function(){return Ih}),i.d(e,"d",function(){return Fn}),i.d(e,"e",function(){return Xn}),i.d(e,"f",function(){return st}),i.d(e,"g",function(){return oi}),i.d(e,"h",function(){return Al}),i.d(e,"i",function(){return Is}),i.d(e,"j",function(){return f}),i.d(e,"k",function(){return nl}),i.d(e,"l",function(){return De}),i.d(e,"m",function(){return zn}),i.d(e,"n",function(){return Vs}),i.d(e,"o",function(){return Fs}),i.d(e,"p",function(){return Zs}),i.d(e,"q",function(){return r}),i.d(e,"r",function(){return Xi}),i.d(e,"s",function(){return dr}),i.d(e,"t",function(){return Ln}),i.d(e,"u",function(){return ct}),i.d(e,"v",function(){return vn}),i.d(e,"w",function(){return Hr}),i.d(e,"x",function(){return Fr}),i.d(e,"y",function(){return _i}),i.d(e,"z",function(){return Yi}),i.d(e,"A",function(){return yh}),i.d(e,"B",function(){return vr}),i.d(e,"C",function(){return Sl}),i.d(e,"D",function(){return ec}),i.d(e,"E",function(){return ec}),i.d(e,"F",function(){return ic}),i.d(e,"G",function(){return wh}),i.d(e,"H",function(){return ui}),i.d(e,"I",function(){return tt}),i.d(e,"J",function(){return mt}),i.d(e,"K",function(){return je}),i.d(e,"L",function(){return gi}),i.d(e,"M",function(){return di});
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const n="140",r={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o=0,a=1,s=2,l=1,c=2,h=3,u=0,d=1,f=2,p=1,m=0,_=1,g=2,y=3,b=4,v=5,w=100,x=101,A=102,S=103,M=104,E=200,T=201,k=202,C=203,I=204,P=205,R=206,B=207,L=208,D=209,O=210,F=0,G=1,N=2,z=3,U=4,H=5,V=6,W=7,j=0,Z=1,Y=2,X=0,J=1,Q=2,q=3,K=4,$=5,tt=300,et=301,it=302,nt=303,rt=304,ot=306,at=1e3,st=1001,lt=1002,ct=1003,ht=1004,ut=1005,dt=1006,ft=1007,pt=1008,mt=1009,_t=1010,gt=1011,yt=1012,bt=1013,vt=1014,wt=1015,xt=1016,At=1017,St=1018,Mt=1020,Et=1021,Tt=1022,kt=1023,Ct=1024,It=1025,Pt=1026,Rt=1027,Bt=1028,Lt=1029,Dt=1030,Ot=1031,Ft=1033,Gt=33776,Nt=33777,zt=33778,Ut=33779,Ht=35840,Vt=35841,Wt=35842,jt=35843,Zt=36196,Yt=37492,Xt=37496,Jt=37808,Qt=37809,qt=37810,Kt=37811,$t=37812,te=37813,ee=37814,ie=37815,ne=37816,re=37817,oe=37818,ae=37819,se=37820,le=37821,ce=36492,he=2200,ue=2201,de=2202,fe=2300,pe=2301,me=2302,_e=2400,ge=2401,ye=2402,be=2500,ve=2501,we=3e3,xe=3001,Ae=3200,Se=3201,Me=0,Ee=1,Te="srgb",ke="srgb-linear",Ce=7680,Ie=519,Pe=35044,Re=35048,Be="300 es",Le=1035;class De{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const i=this._listeners[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const i=e.slice(0);for(let e=0,n=i.length;e<n;e++)i[e].call(this,t);t.target=null}}}const Oe=[];for(let t=0;t<256;t++)Oe[t]=(t<16?"0":"")+t.toString(16);const Fe=Math.PI/180,Ge=180/Math.PI;function Ne(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Oe[255&t]+Oe[t>>8&255]+Oe[t>>16&255]+Oe[t>>24&255]+"-"+Oe[255&e]+Oe[e>>8&255]+"-"+Oe[e>>16&15|64]+Oe[e>>24&255]+"-"+Oe[63&i|128]+Oe[i>>8&255]+"-"+Oe[i>>16&255]+Oe[i>>24&255]+Oe[255&n]+Oe[n>>8&255]+Oe[n>>16&255]+Oe[n>>24&255]).toLowerCase()}function ze(t,e,i){return Math.max(e,Math.min(i,t))}function Ue(t,e){return(t%e+e)%e}function He(t,e,i){return(1-i)*t+i*e}function Ve(t){return 0==(t&t-1)&&0!==t}function We(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}class je{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*i-o*n+t.x,this.y=r*n+o*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}je.prototype.isVector2=!0;class Ze{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,n,r,o,a,s,l){const c=this.elements;return c[0]=t,c[1]=n,c[2]=a,c[3]=e,c[4]=r,c[5]=s,c[6]=i,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[3],s=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],f=i[8],p=n[0],m=n[3],_=n[6],g=n[1],y=n[4],b=n[7],v=n[2],w=n[5],x=n[8];return r[0]=o*p+a*g+s*v,r[3]=o*m+a*y+s*w,r[6]=o*_+a*b+s*x,r[1]=l*p+c*g+h*v,r[4]=l*m+c*y+h*w,r[7]=l*_+c*b+h*x,r[2]=u*p+d*g+f*v,r[5]=u*m+d*y+f*w,r[8]=u*_+d*b+f*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*o*c-e*a*l-i*r*c+i*a*s+n*r*l-n*o*s}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=c*o-a*l,u=a*s-c*r,d=l*r-o*s,f=e*h+i*u+n*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=h*p,t[1]=(n*l-c*i)*p,t[2]=(a*i-n*o)*p,t[3]=u*p,t[4]=(c*e-n*s)*p,t[5]=(n*r-a*e)*p,t[6]=d*p,t[7]=(i*s-l*e)*p,t[8]=(o*e-i*r)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,r,o,a){const s=Math.cos(r),l=Math.sin(r);return this.set(i*s,i*l,-i*(s*o+l*a)+o+t,-n*l,n*s,-n*(-l*o+s*a)+a+e,0,0,1),this}scale(t,e){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],o=n[3],a=n[6],s=n[1],l=n[4],c=n[7];return n[0]=e*r+i*s,n[3]=e*o+i*l,n[6]=e*a+i*c,n[1]=-i*r+e*s,n[4]=-i*o+e*l,n[7]=-i*a+e*c,this}translate(t,e){const i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<9;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function Ye(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}Ze.prototype.isMatrix3=!0;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Xe(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Je(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Qe(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const qe={[Te]:{[ke]:Je},[ke]:{[Te]:Qe}},Ke={legacyMode:!0,get workingColorSpace(){return ke},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(qe[e]&&void 0!==qe[e][i]){const n=qe[e][i];return t.r=n(t.r),t.g=n(t.g),t.b=n(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},$e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ti={r:0,g:0,b:0},ei={h:0,s:0,l:0},ii={h:0,s:0,l:0};function ni(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function ri(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class oi{constructor(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Te){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Ke.toWorkingColorSpace(this,e),this}setRGB(t,e,i,n=ke){return this.r=t,this.g=e,this.b=i,Ke.toWorkingColorSpace(this,n),this}setHSL(t,e,i,n=ke){if(t=Ue(t,1),e=ze(e,0,1),i=ze(i,0,1),0===e)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+e):i+e-i*e,r=2*i-n;this.r=ni(r,n,t+1/3),this.g=ni(r,n,t),this.b=ni(r,n,t-1/3)}return Ke.toWorkingColorSpace(this,n),this}setStyle(t,e=Te){function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=n[1],o=n[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,Ke.toWorkingColorSpace(this,e),i(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,Ke.toWorkingColorSpace(this,e),i(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const n=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,o=parseInt(t[3],10)/100;return i(t[4]),this.setHSL(n,r,o,e)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],i=t.length;if(3===i)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,Ke.toWorkingColorSpace(this,e),this;if(6===i)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,Ke.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=Te){const i=$e[t.toLowerCase()];return void 0!==i?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Je(t.r),this.g=Je(t.g),this.b=Je(t.b),this}copyLinearToSRGB(t){return this.r=Qe(t.r),this.g=Qe(t.g),this.b=Qe(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Te){return Ke.fromWorkingColorSpace(ri(this,ti),t),ze(255*ti.r,0,255)<<16^ze(255*ti.g,0,255)<<8^ze(255*ti.b,0,255)<<0}getHexString(t=Te){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=ke){Ke.fromWorkingColorSpace(ri(this,ti),e);const i=ti.r,n=ti.g,r=ti.b,o=Math.max(i,n,r),a=Math.min(i,n,r);let s,l;const c=(a+o)/2;if(a===o)s=0,l=0;else{const t=o-a;switch(l=c<=.5?t/(o+a):t/(2-o-a),o){case i:s=(n-r)/t+(n<r?6:0);break;case n:s=(r-i)/t+2;break;case r:s=(i-n)/t+4}s/=6}return t.h=s,t.s=l,t.l=c,t}getRGB(t,e=ke){return Ke.fromWorkingColorSpace(ri(this,ti),e),t.r=ti.r,t.g=ti.g,t.b=ti.b,t}getStyle(t=Te){return Ke.fromWorkingColorSpace(ri(this,ti),t),t!==Te?`color(${t} ${ti.r} ${ti.g} ${ti.b})`:`rgb(${255*ti.r|0},${255*ti.g|0},${255*ti.b|0})`}offsetHSL(t,e,i){return this.getHSL(ei),ei.h+=t,ei.s+=e,ei.l+=i,this.setHSL(ei.h,ei.s,ei.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(ei),t.getHSL(ii);const i=He(ei.h,ii.h,e),n=He(ei.s,ii.s,e),r=He(ei.l,ii.l,e);return this.setHSL(i,n,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let ai;oi.NAMES=$e,oi.prototype.isColor=!0,oi.prototype.r=1,oi.prototype.g=1,oi.prototype.b=1;class si{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===ai&&(ai=Xe("canvas")),ai.width=t.width,ai.height=t.height;const i=ai.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=ai}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Xe("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);const n=i.getImageData(0,0,t.width,t.height),r=n.data;for(let t=0;t<r.length;t++)r[t]=255*Je(r[t]/255);return i.putImageData(n,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Je(e[t]/255)):e[t]=Je(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class li{constructor(t=null){this.uuid=Ne(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(null!==n){let t;if(Array.isArray(n)){t=[];for(let e=0,i=n.length;e<i;e++)n[e].isDataTexture?t.push(ci(n[e].image)):t.push(ci(n[e]))}else t=ci(n);i.url=t}return e||(t.images[this.uuid]=i),i}}function ci(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?si.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}li.prototype.isSource=!0;let hi=0;class ui extends De{constructor(t=ui.DEFAULT_IMAGE,e=ui.DEFAULT_MAPPING,i=st,n=st,r=dt,o=pt,a=kt,s=mt,l=1,c=we){super(),Object.defineProperty(this,"id",{value:hi++}),this.uuid=Ne(),this.name="",this.source=new li(t),this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=o,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=s,this.offset=new je(0,0),this.repeat=new je(1,1),this.center=new je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ze,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==tt)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case at:t.x=t.x-Math.floor(t.x);break;case st:t.x=t.x<0?0:1;break;case lt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case at:t.y=t.y-Math.floor(t.y);break;case st:t.y=t.y<0?0:1;break;case lt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}ui.DEFAULT_IMAGE=null,ui.DEFAULT_MAPPING=tt,ui.prototype.isTexture=!0;class di{constructor(t=0,e=0,i=0,n=1){this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*e+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*e+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*e+o[7]*i+o[11]*n+o[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,r;const o=t.elements,a=o[0],s=o[4],l=o[8],c=o[1],h=o[5],u=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+f)<.1&&Math.abs(a+h+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const t=(a+1)/2,o=(h+1)/2,m=(p+1)/2,_=(s+c)/4,g=(l+d)/4,y=(u+f)/4;return t>o&&t>m?t<.01?(i=0,n=.707106781,r=.707106781):(n=_/(i=Math.sqrt(t)),r=g/i):o>m?o<.01?(i=.707106781,n=0,r=.707106781):(i=_/(n=Math.sqrt(o)),r=y/n):m<.01?(i=.707106781,n=.707106781,r=0):(i=g/(r=Math.sqrt(m)),n=y/r),this.set(i,n,r,e),this}let m=Math.sqrt((f-u)*(f-u)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(m)<.001&&(m=1),this.x=(f-u)/m,this.y=(l-d)/m,this.z=(c-s)/m,this.w=Math.acos((a+h+p-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}di.prototype.isVector4=!0;class fi extends De{constructor(t,e,i={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new di(0,0,t,e),this.scissorTest=!1,this.viewport=new di(0,0,t,e);const n={width:t,height:e,depth:1};this.texture=new ui(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:dt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(t,e,i=1){this.width===t&&this.height===e&&this.depth===i||(this.width=t,this.height=e,this.depth=i,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new li(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}fi.prototype.isWebGLRenderTarget=!0;class pi extends ui{constructor(t=null,e=1,i=1,n=1){super(null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=ct,this.minFilter=ct,this.wrapR=st,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}pi.prototype.isDataArrayTexture=!0;(class extends fi{constructor(t,e,i){super(t,e),this.depth=i,this.texture=new pi(null,t,e,i),this.texture.isRenderTargetTexture=!0}}).prototype.isWebGLArrayRenderTarget=!0;class mi extends ui{constructor(t=null,e=1,i=1,n=1){super(null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=ct,this.minFilter=ct,this.wrapR=st,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}mi.prototype.isData3DTexture=!0;(class extends fi{constructor(t,e,i){super(t,e),this.depth=i,this.texture=new mi(null,t,e,i),this.texture.isRenderTargetTexture=!0}}).prototype.isWebGL3DRenderTarget=!0;(class extends fi{constructor(t,e,i,n={}){super(t,e,n);const r=this.texture;this.texture=[];for(let t=0;t<i;t++)this.texture[t]=r.clone(),this.texture[t].isRenderTargetTexture=!0}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=t,this.texture[n].image.height=e,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,i=t.texture.length;e<i;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}}).prototype.isWebGLMultipleRenderTargets=!0;class _i{constructor(t=0,e=0,i=0,n=1){this._x=t,this._y=e,this._z=i,this._w=n}static slerp(t,e,i,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(t,e,n)}static slerpFlat(t,e,i,n,r,o,a){let s=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3];const u=r[o+0],d=r[o+1],f=r[o+2],p=r[o+3];if(0===a)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===a)return t[e+0]=u,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(h!==p||s!==u||l!==d||c!==f){let t=1-a;const e=s*u+l*d+c*f+h*p,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const r=Math.sqrt(n),o=Math.atan2(r,e*i);t=Math.sin(t*o)/r,a=Math.sin(a*o)/r}const r=a*i;if(s=s*t+u*r,l=l*t+d*r,c=c*t+f*r,h=h*t+p*r,t===1-a){const t=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=t,l*=t,c*=t,h*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,r,o){const a=i[n],s=i[n+1],l=i[n+2],c=i[n+3],h=r[o],u=r[o+1],d=r[o+2],f=r[o+3];return t[e]=a*f+c*h+s*d-l*u,t[e+1]=s*f+c*u+l*h-a*d,t[e+2]=l*f+c*d+a*u-s*h,t[e+3]=c*f-a*h-s*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=t._x,n=t._y,r=t._z,o=t._order,a=Math.cos,s=Math.sin,l=a(i/2),c=a(n/2),h=a(r/2),u=s(i/2),d=s(n/2),f=s(r/2);switch(o){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],r=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],h=e[10],u=i+a+h;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(c-s)*t,this._y=(r-l)*t,this._z=(o-n)*t}else if(i>a&&i>h){const t=2*Math.sqrt(1+i-a-h);this._w=(c-s)/t,this._x=.25*t,this._y=(n+o)/t,this._z=(r+l)/t}else if(a>h){const t=2*Math.sqrt(1+a-i-h);this._w=(r-l)/t,this._x=(n+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+h-i-a);this._w=(o-n)/t,this._x=(r+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(ze(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+o*a+n*l-r*s,this._y=n*c+o*s+r*a-i*l,this._z=r*c+o*l+i*s-n*a,this._w=o*c-i*a-n*s-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,r=this._z,o=this._w;let a=o*t._w+i*t._x+n*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=o*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(r),i*Math.cos(r),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}_i.prototype.isQuaternion=!0;class gi{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(bi.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(bi.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=t.elements,o=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*o,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,c=s*i+a*e-r*n,h=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+c*-a-h*-o,this.y=c*s+u*-o+h*-r-l*-a,this.z=h*s+u*-a+l*-o-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return yi.copy(this).projectOnVector(t),this.sub(yi)}reflect(t){return this.sub(yi.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(ze(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}gi.prototype.isVector3=!0;const yi=new gi,bi=new _i;class vi{constructor(t=new gi(1/0,1/0,1/0),e=new gi(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.length;s<l;s+=3){const l=t[s],c=t[s+1],h=t[s+2];l<e&&(e=l),c<i&&(i=c),h<n&&(n=h),l>r&&(r=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,i,n),this.max.set(r,o,a),this}setFromBufferAttribute(t){let e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.count;s<l;s++){const l=t.getX(s),c=t.getY(s),h=t.getZ(s);l<e&&(e=l),c<i&&(i=c),h<n&&(n=h),l>r&&(r=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,i,n),this.max.set(r,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=xi.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const i=t.geometry;if(void 0!==i)if(e&&void 0!=i.attributes&&void 0!==i.attributes.position){const e=i.attributes.position;for(let i=0,n=e.count;i<n;i++)xi.fromBufferAttribute(e,i).applyMatrix4(t.matrixWorld),this.expandByPoint(xi)}else null===i.boundingBox&&i.computeBoundingBox(),Ai.copy(i.boundingBox),Ai.applyMatrix4(t.matrixWorld),this.union(Ai);const n=t.children;for(let t=0,i=n.length;t<i;t++)this.expandByObject(n[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,xi),xi.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Ii),Pi.subVectors(this.max,Ii),Si.subVectors(t.a,Ii),Mi.subVectors(t.b,Ii),Ei.subVectors(t.c,Ii),Ti.subVectors(Mi,Si),ki.subVectors(Ei,Mi),Ci.subVectors(Si,Ei);let e=[0,-Ti.z,Ti.y,0,-ki.z,ki.y,0,-Ci.z,Ci.y,Ti.z,0,-Ti.x,ki.z,0,-ki.x,Ci.z,0,-Ci.x,-Ti.y,Ti.x,0,-ki.y,ki.x,0,-Ci.y,Ci.x,0];return!!Li(e,Si,Mi,Ei,Pi)&&(!!Li(e=[1,0,0,0,1,0,0,0,1],Si,Mi,Ei,Pi)&&(Ri.crossVectors(Ti,ki),Li(e=[Ri.x,Ri.y,Ri.z],Si,Mi,Ei,Pi)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return xi.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(xi).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(wi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),wi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),wi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),wi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),wi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),wi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),wi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),wi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(wi),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}vi.prototype.isBox3=!0;const wi=[new gi,new gi,new gi,new gi,new gi,new gi,new gi,new gi],xi=new gi,Ai=new vi,Si=new gi,Mi=new gi,Ei=new gi,Ti=new gi,ki=new gi,Ci=new gi,Ii=new gi,Pi=new gi,Ri=new gi,Bi=new gi;function Li(t,e,i,n,r){for(let o=0,a=t.length-3;o<=a;o+=3){Bi.fromArray(t,o);const a=r.x*Math.abs(Bi.x)+r.y*Math.abs(Bi.y)+r.z*Math.abs(Bi.z),s=e.dot(Bi),l=i.dot(Bi),c=n.dot(Bi);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}const Di=new vi,Oi=new gi,Fi=new gi,Gi=new gi;class Ni{constructor(t=new gi,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;void 0!==e?i.copy(e):Di.setFromPoints(t).getCenter(i);let n=0;for(let e=0,r=t.length;e<r;e++)n=Math.max(n,i.distanceToSquared(t[e]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Gi.subVectors(t,this.center);const e=Gi.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),i=.5*(t-this.radius);this.center.add(Gi.multiplyScalar(i/t)),this.radius+=i}return this}union(t){return!0===this.center.equals(t.center)?Fi.set(0,0,1).multiplyScalar(t.radius):Fi.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Oi.copy(t.center).add(Fi)),this.expandByPoint(Oi.copy(t.center).sub(Fi)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const zi=new gi,Ui=new gi,Hi=new gi,Vi=new gi,Wi=new gi,ji=new gi,Zi=new gi;class Yi{constructor(t=new gi,e=new gi(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,zi)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=zi.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(zi.copy(this.direction).multiplyScalar(e).add(this.origin),zi.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){Ui.copy(t).add(e).multiplyScalar(.5),Hi.copy(e).sub(t).normalize(),Vi.copy(this.origin).sub(Ui);const r=.5*t.distanceTo(e),o=-this.direction.dot(Hi),a=Vi.dot(this.direction),s=-Vi.dot(Hi),l=Vi.lengthSq(),c=Math.abs(1-o*o);let h,u,d,f;if(c>0)if(u=o*a-s,f=r*c,(h=o*s-a)>=0)if(u>=-f)if(u<=f){const t=1/c;d=(h*=t)*(h+o*(u*=t)+2*a)+u*(o*h+u+2*s)+l}else u=r,d=-(h=Math.max(0,-(o*u+a)))*h+u*(u+2*s)+l;else u=-r,d=-(h=Math.max(0,-(o*u+a)))*h+u*(u+2*s)+l;else u<=-f?d=-(h=Math.max(0,-(-o*r+a)))*h+(u=h>0?-r:Math.min(Math.max(-r,-s),r))*(u+2*s)+l:u<=f?(h=0,d=(u=Math.min(Math.max(-r,-s),r))*(u+2*s)+l):d=-(h=Math.max(0,-(o*r+a)))*h+(u=h>0?r:Math.min(Math.max(-r,-s),r))*(u+2*s)+l;else u=o>0?-r:r,d=-(h=Math.max(0,-(o*u+a)))*h+u*(u+2*s)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),n&&n.copy(Hi).multiplyScalar(u).add(Ui),d}intersectSphere(t,e){zi.subVectors(t.center,this.origin);const i=zi.dot(this.direction),n=zi.dot(zi)-i*i,r=t.radius*t.radius;if(n>r)return null;const o=Math.sqrt(r-n),a=i-o,s=i+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return null===i?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,o=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,o=(t.min.y-u.y)*c),i>o||r>n?null:((r>i||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),h>=0?(a=(t.min.z-u.z)*h,s=(t.max.z-u.z)*h):(a=(t.max.z-u.z)*h,s=(t.min.z-u.z)*h),i>s||a>n?null:((a>i||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,zi)}intersectTriangle(t,e,i,n,r){Wi.subVectors(e,t),ji.subVectors(i,t),Zi.crossVectors(Wi,ji);let o,a=this.direction.dot(Zi);if(a>0){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Vi.subVectors(this.origin,t);const s=o*this.direction.dot(ji.crossVectors(Vi,ji));if(s<0)return null;const l=o*this.direction.dot(Wi.cross(Vi));if(l<0)return null;if(s+l>a)return null;const c=-o*Vi.dot(Zi);return c<0?null:this.at(c/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Xi{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,n,r,o,a,s,l,c,h,u,d,f,p,m){const _=this.elements;return _[0]=t,_[4]=e,_[8]=i,_[12]=n,_[1]=r,_[5]=o,_[9]=a,_[13]=s,_[2]=l,_[6]=c,_[10]=h,_[14]=u,_[3]=d,_[7]=f,_[11]=p,_[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Xi).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/Ji.setFromMatrixColumn(t,0).length(),r=1/Ji.setFromMatrixColumn(t,1).length(),o=1/Ji.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*o,e[9]=i[9]*o,e[10]=i[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,i=t.x,n=t.y,r=t.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){const t=o*c,i=o*h,n=a*c,r=a*h;e[0]=s*c,e[4]=-s*h,e[8]=l,e[1]=i+n*l,e[5]=t-r*l,e[9]=-a*s,e[2]=r-t*l,e[6]=n+i*l,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,i=s*h,n=l*c,r=l*h;e[0]=t+r*a,e[4]=n*a-i,e[8]=o*l,e[1]=o*h,e[5]=o*c,e[9]=-a,e[2]=i*a-n,e[6]=r+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,i=s*h,n=l*c,r=l*h;e[0]=t-r*a,e[4]=-o*h,e[8]=n+i*a,e[1]=i+n*a,e[5]=o*c,e[9]=r-t*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,i=o*h,n=a*c,r=a*h;e[0]=s*c,e[4]=n*l-i,e[8]=t*l+r,e[1]=s*h,e[5]=r*l+t,e[9]=i*l-n,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,i=o*l,n=a*s,r=a*l;e[0]=s*c,e[4]=r-t*h,e[8]=n*h+i,e[1]=h,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=i*h+n,e[10]=t-r*h}else if("XZY"===t.order){const t=o*s,i=o*l,n=a*s,r=a*l;e[0]=s*c,e[4]=-h,e[8]=l*c,e[1]=t*h+r,e[5]=o*c,e[9]=i*h-n,e[2]=n*h-i,e[6]=a*c,e[10]=r*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(qi,t,Ki)}lookAt(t,e,i){const n=this.elements;return en.subVectors(t,e),0===en.lengthSq()&&(en.z=1),en.normalize(),$i.crossVectors(i,en),0===$i.lengthSq()&&(1===Math.abs(i.z)?en.x+=1e-4:en.z+=1e-4,en.normalize(),$i.crossVectors(i,en)),$i.normalize(),tn.crossVectors(en,$i),n[0]=$i.x,n[4]=tn.x,n[8]=en.x,n[1]=$i.y,n[5]=tn.y,n[9]=en.y,n[2]=$i.z,n[6]=tn.z,n[10]=en.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],_=i[14],g=i[3],y=i[7],b=i[11],v=i[15],w=n[0],x=n[4],A=n[8],S=n[12],M=n[1],E=n[5],T=n[9],k=n[13],C=n[2],I=n[6],P=n[10],R=n[14],B=n[3],L=n[7],D=n[11],O=n[15];return r[0]=o*w+a*M+s*C+l*B,r[4]=o*x+a*E+s*I+l*L,r[8]=o*A+a*T+s*P+l*D,r[12]=o*S+a*k+s*R+l*O,r[1]=c*w+h*M+u*C+d*B,r[5]=c*x+h*E+u*I+d*L,r[9]=c*A+h*T+u*P+d*D,r[13]=c*S+h*k+u*R+d*O,r[2]=f*w+p*M+m*C+_*B,r[6]=f*x+p*E+m*I+_*L,r[10]=f*A+p*T+m*P+_*D,r[14]=f*S+p*k+m*R+_*O,r[3]=g*w+y*M+b*C+v*B,r[7]=g*x+y*E+b*I+v*L,r[11]=g*A+y*T+b*P+v*D,r[15]=g*S+y*k+b*R+v*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*s*h-n*l*h-r*a*u+i*l*u+n*a*d-i*s*d)+t[7]*(+e*s*d-e*l*u+r*o*u-n*o*d+n*l*c-r*s*c)+t[11]*(+e*l*h-e*a*d-r*o*h+i*o*d+r*a*c-i*l*c)+t[15]*(-n*a*c-e*s*h+e*a*u+n*o*h-i*o*u+i*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],_=t[15],g=h*m*l-p*u*l+p*s*d-a*m*d-h*s*_+a*u*_,y=f*u*l-c*m*l-f*s*d+o*m*d+c*s*_-o*u*_,b=c*p*l-f*h*l+f*a*d-o*p*d-c*a*_+o*h*_,v=f*h*s-c*p*s-f*a*u+o*p*u+c*a*m-o*h*m,w=e*g+i*y+n*b+r*v;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/w;return t[0]=g*x,t[1]=(p*u*r-h*m*r-p*n*d+i*m*d+h*n*_-i*u*_)*x,t[2]=(a*m*r-p*s*r+p*n*l-i*m*l-a*n*_+i*s*_)*x,t[3]=(h*s*r-a*u*r-h*n*l+i*u*l+a*n*d-i*s*d)*x,t[4]=y*x,t[5]=(c*m*r-f*u*r+f*n*d-e*m*d-c*n*_+e*u*_)*x,t[6]=(f*s*r-o*m*r-f*n*l+e*m*l+o*n*_-e*s*_)*x,t[7]=(o*u*r-c*s*r+c*n*l-e*u*l-o*n*d+e*s*d)*x,t[8]=b*x,t[9]=(f*h*r-c*p*r-f*i*d+e*p*d+c*i*_-e*h*_)*x,t[10]=(o*p*r-f*a*r+f*i*l-e*p*l-o*i*_+e*a*_)*x,t[11]=(c*a*r-o*h*r-c*i*l+e*h*l+o*i*d-e*a*d)*x,t[12]=v*x,t[13]=(c*p*n-f*h*n+f*i*u-e*p*u-c*i*m+e*h*m)*x,t[14]=(f*a*n-o*p*n-f*i*s+e*p*s+o*i*m-e*a*m)*x,t[15]=(o*h*n-c*a*n+c*i*s-e*h*s-o*i*u+e*a*u)*x,this}scale(t){const e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,r,o){return this.set(1,i,r,0,t,1,o,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,l=r+r,c=o+o,h=a+a,u=r*l,d=r*c,f=r*h,p=o*c,m=o*h,_=a*h,g=s*l,y=s*c,b=s*h,v=i.x,w=i.y,x=i.z;return n[0]=(1-(p+_))*v,n[1]=(d+b)*v,n[2]=(f-y)*v,n[3]=0,n[4]=(d-b)*w,n[5]=(1-(u+_))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(f+y)*x,n[9]=(m-g)*x,n[10]=(1-(u+p))*x,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let r=Ji.set(n[0],n[1],n[2]).length();const o=Ji.set(n[4],n[5],n[6]).length(),a=Ji.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],Qi.copy(this);const s=1/r,l=1/o,c=1/a;return Qi.elements[0]*=s,Qi.elements[1]*=s,Qi.elements[2]*=s,Qi.elements[4]*=l,Qi.elements[5]*=l,Qi.elements[6]*=l,Qi.elements[8]*=c,Qi.elements[9]*=c,Qi.elements[10]*=c,e.setFromRotationMatrix(Qi),i.x=r,i.y=o,i.z=a,this}makePerspective(t,e,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,i,n,r,o){const a=this.elements,s=1/(e-t),l=1/(i-n),c=1/(o-r),h=(e+t)*s,u=(i+n)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}Xi.prototype.isMatrix4=!0;const Ji=new gi,Qi=new Xi,qi=new gi(0,0,0),Ki=new gi(1,1,1),$i=new gi,tn=new gi,en=new gi,nn=new Xi,rn=new _i;class on{constructor(t=0,e=0,i=0,n=on.DefaultOrder){this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){const n=t.elements,r=n[0],o=n[4],a=n[8],s=n[1],l=n[5],c=n[9],h=n[2],u=n[6],d=n[10];switch(e){case"XYZ":this._y=Math.asin(ze(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ze(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(ze(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-ze(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(ze(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-ze(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===i&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return nn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nn,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return rn.setFromEuler(this),this.setFromQuaternion(rn,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}on.prototype.isEuler=!0,on.DefaultOrder="XYZ",on.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class an{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let sn=0;const ln=new gi,cn=new _i,hn=new Xi,un=new gi,dn=new gi,fn=new gi,pn=new _i,mn=new gi(1,0,0),_n=new gi(0,1,0),gn=new gi(0,0,1),yn={type:"added"},bn={type:"removed"};class vn extends De{constructor(){super(),Object.defineProperty(this,"id",{value:sn++}),this.uuid=Ne(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vn.DefaultUp.clone();const t=new gi,e=new on,i=new _i,n=new gi(1,1,1);e._onChange(function(){i.setFromEuler(e,!1)}),i._onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Xi},normalMatrix:{value:new Ze}}),this.matrix=new Xi,this.matrixWorld=new Xi,this.matrixAutoUpdate=vn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new an,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return cn.setFromAxisAngle(t,e),this.quaternion.multiply(cn),this}rotateOnWorldAxis(t,e){return cn.setFromAxisAngle(t,e),this.quaternion.premultiply(cn),this}rotateX(t){return this.rotateOnAxis(mn,t)}rotateY(t){return this.rotateOnAxis(_n,t)}rotateZ(t){return this.rotateOnAxis(gn,t)}translateOnAxis(t,e){return ln.copy(t).applyQuaternion(this.quaternion),this.position.add(ln.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(mn,t)}translateY(t){return this.translateOnAxis(_n,t)}translateZ(t){return this.translateOnAxis(gn,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(hn.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?un.copy(t):un.set(t,e,i);const n=this.parent;this.updateWorldMatrix(!0,!1),dn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hn.lookAt(dn,un,this.up):hn.lookAt(un,dn,this.up),this.quaternion.setFromRotationMatrix(hn),n&&(hn.extractRotation(n.matrixWorld),cn.setFromRotationMatrix(hn),this.quaternion.premultiply(cn.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(yn)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(bn)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(bn)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),hn.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),hn.multiply(t.parent.matrixWorld)),t.applyMatrix4(hn),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dn,t,fn),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dn,pn,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)}updateWorldMatrix(t,e){const i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,i=t.length;e<i;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};function r(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const i=e.shapes;if(Array.isArray(i))for(let e=0,n=i.length;e<n;e++){const n=i[e];r(t.shapes,n)}else r(t.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let i=0,n=this.material.length;i<n;i++)e.push(r(t.materials,this.material[i]));n.material=e}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(let e=0;e<this.children.length;e++)n.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let e=0;e<this.animations.length;e++){const i=this.animations[e];n.animations.push(r(t.animations,i))}}if(e){const e=o(t.geometries),n=o(t.materials),r=o(t.textures),a=o(t.images),s=o(t.shapes),l=o(t.skeletons),c=o(t.animations),h=o(t.nodes);e.length>0&&(i.geometries=e),n.length>0&&(i.materials=n),r.length>0&&(i.textures=r),a.length>0&&(i.images=a),s.length>0&&(i.shapes=s),l.length>0&&(i.skeletons=l),c.length>0&&(i.animations=c),h.length>0&&(i.nodes=h)}return i.object=n,i;function o(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const i=t.children[e];this.add(i.clone())}return this}}vn.DefaultUp=new gi(0,1,0),vn.DefaultMatrixAutoUpdate=!0,vn.prototype.isObject3D=!0;const wn=new gi,xn=new gi,An=new gi,Sn=new gi,Mn=new gi,En=new gi,Tn=new gi,kn=new gi,Cn=new gi,In=new gi;class Pn{constructor(t=new gi,e=new gi,i=new gi){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),wn.subVectors(t,e),n.cross(wn);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(t,e,i,n,r){wn.subVectors(n,e),xn.subVectors(i,e),An.subVectors(t,e);const o=wn.dot(wn),a=wn.dot(xn),s=wn.dot(An),l=xn.dot(xn),c=xn.dot(An),h=o*l-a*a;if(0===h)return r.set(-2,-1,-1);const u=1/h,d=(l*s-a*c)*u,f=(o*c-a*s)*u;return r.set(1-d-f,f,d)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,Sn),Sn.x>=0&&Sn.y>=0&&Sn.x+Sn.y<=1}static getUV(t,e,i,n,r,o,a,s){return this.getBarycoord(t,e,i,n,Sn),s.set(0,0),s.addScaledVector(r,Sn.x),s.addScaledVector(o,Sn.y),s.addScaledVector(a,Sn.z),s}static isFrontFacing(t,e,i,n){return wn.subVectors(i,e),xn.subVectors(t,e),wn.cross(xn).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return wn.subVectors(this.c,this.b),xn.subVectors(this.a,this.b),.5*wn.cross(xn).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Pn.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Pn.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return Pn.getUV(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return Pn.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Pn.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const i=this.a,n=this.b,r=this.c;let o,a;Mn.subVectors(n,i),En.subVectors(r,i),kn.subVectors(t,i);const s=Mn.dot(kn),l=En.dot(kn);if(s<=0&&l<=0)return e.copy(i);Cn.subVectors(t,n);const c=Mn.dot(Cn),h=En.dot(Cn);if(c>=0&&h<=c)return e.copy(n);const u=s*h-c*l;if(u<=0&&s>=0&&c<=0)return o=s/(s-c),e.copy(i).addScaledVector(Mn,o);In.subVectors(t,r);const d=Mn.dot(In),f=En.dot(In);if(f>=0&&d<=f)return e.copy(r);const p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),e.copy(i).addScaledVector(En,a);const m=c*f-d*h;if(m<=0&&h-c>=0&&d-f>=0)return Tn.subVectors(r,n),a=(h-c)/(h-c+(d-f)),e.copy(n).addScaledVector(Tn,a);const _=1/(m+p+u);return o=p*_,a=u*_,e.copy(i).addScaledVector(Mn,o).addScaledVector(En,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let Rn=0;class Bn extends De{constructor(){super(),Object.defineProperty(this,"id",{value:Rn++}),this.uuid=Ne(),this.name="",this.type="Material",this.blending=_,this.side=u,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=I,this.blendDst=P,this.blendEquation=w,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ie,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ce,this.stencilZFail=Ce,this.stencilZPass=Ce,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const i=t[e];if(void 0===i){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===p;continue}const n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(i.blending=this.blending),this.side!==u&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){const e=n(t.textures),r=n(t.images);e.length>0&&(i.textures=e),r.length>0&&(i.images=r)}return i}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let i=null;if(null!==e){const t=e.length;i=new Array(t);for(let n=0;n!==t;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}Bn.prototype.isMaterial=!0,Bn.fromType=function(){return null};class Ln extends Bn{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new oi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}Ln.prototype.isMeshBasicMaterial=!0;const Dn=new gi,On=new je;class Fn{constructor(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.usage=Pe,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),r=new oi),e[i++]=r.r,e[i++]=r.g,e[i++]=r.b}return this}copyVector2sArray(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),r=new je),e[i++]=r.x,e[i++]=r.y}return this}copyVector3sArray(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),r=new gi),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z}return this}copyVector4sArray(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),r=new di),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z,e[i++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,i=this.count;e<i;e++)On.fromBufferAttribute(this,e),On.applyMatrix3(t),this.setXY(e,On.x,On.y);else if(3===this.itemSize)for(let e=0,i=this.count;e<i;e++)Dn.fromBufferAttribute(this,e),Dn.applyMatrix3(t),this.setXYZ(e,Dn.x,Dn.y,Dn.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)Dn.fromBufferAttribute(this,e),Dn.applyMatrix4(t),this.setXYZ(e,Dn.x,Dn.y,Dn.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Dn.fromBufferAttribute(this,e),Dn.applyNormalMatrix(t),this.setXYZ(e,Dn.x,Dn.y,Dn.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Dn.fromBufferAttribute(this,e),Dn.transformDirection(t),this.setXYZ(e,Dn.x,Dn.y,Dn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Pe&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}Fn.prototype.isBufferAttribute=!0;class Gn extends Fn{constructor(t,e,i){super(new Uint16Array(t),e,i)}}class Nn extends Fn{constructor(t,e,i){super(new Uint32Array(t),e,i)}}(class extends Fn{constructor(t,e,i){super(new Uint16Array(t),e,i)}}).prototype.isFloat16BufferAttribute=!0;class zn extends Fn{constructor(t,e,i){super(new Float32Array(t),e,i)}}let Un=0;const Hn=new Xi,Vn=new vn,Wn=new gi,jn=new vi,Zn=new vi,Yn=new gi;class Xn extends De{constructor(){super(),Object.defineProperty(this,"id",{value:Un++}),this.uuid=Ne(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Ye(t)?Nn:Gn)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const e=(new Ze).getNormalMatrix(t);i.applyNormalMatrix(e),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Hn.makeRotationFromQuaternion(t),this.applyMatrix4(Hn),this}rotateX(t){return Hn.makeRotationX(t),this.applyMatrix4(Hn),this}rotateY(t){return Hn.makeRotationY(t),this.applyMatrix4(Hn),this}rotateZ(t){return Hn.makeRotationZ(t),this.applyMatrix4(Hn),this}translate(t,e,i){return Hn.makeTranslation(t,e,i),this.applyMatrix4(Hn),this}scale(t,e,i){return Hn.makeScale(t,e,i),this.applyMatrix4(Hn),this}lookAt(t){return Vn.lookAt(t),Vn.updateMatrix(),this.applyMatrix4(Vn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wn).negate(),this.translate(Wn.x,Wn.y,Wn.z),this}setFromPoints(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new zn(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new vi);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new gi(-1/0,-1/0,-1/0),new gi(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];jn.setFromBufferAttribute(i),this.morphTargetsRelative?(Yn.addVectors(this.boundingBox.min,jn.min),this.boundingBox.expandByPoint(Yn),Yn.addVectors(this.boundingBox.max,jn.max),this.boundingBox.expandByPoint(Yn)):(this.boundingBox.expandByPoint(jn.min),this.boundingBox.expandByPoint(jn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ni);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new gi,1/0);if(t){const i=this.boundingSphere.center;if(jn.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];Zn.setFromBufferAttribute(i),this.morphTargetsRelative?(Yn.addVectors(jn.min,Zn.min),jn.expandByPoint(Yn),Yn.addVectors(jn.max,Zn.max),jn.expandByPoint(Yn)):(jn.expandByPoint(Zn.min),jn.expandByPoint(Zn.max))}jn.getCenter(i);let n=0;for(let e=0,r=t.count;e<r;e++)Yn.fromBufferAttribute(t,e),n=Math.max(n,i.distanceToSquared(Yn));if(e)for(let r=0,o=e.length;r<o;r++){const o=e[r],a=this.morphTargetsRelative;for(let e=0,r=o.count;e<r;e++)Yn.fromBufferAttribute(o,e),a&&(Wn.fromBufferAttribute(t,e),Yn.add(Wn)),n=Math.max(n,i.distanceToSquared(Yn))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.array,n=e.position.array,r=e.normal.array,o=e.uv.array,a=n.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Fn(new Float32Array(4*a),4));const s=this.getAttribute("tangent").array,l=[],c=[];for(let t=0;t<a;t++)l[t]=new gi,c[t]=new gi;const h=new gi,u=new gi,d=new gi,f=new je,p=new je,m=new je,_=new gi,g=new gi;function y(t,e,i){h.fromArray(n,3*t),u.fromArray(n,3*e),d.fromArray(n,3*i),f.fromArray(o,2*t),p.fromArray(o,2*e),m.fromArray(o,2*i),u.sub(h),d.sub(h),p.sub(f),m.sub(f);const r=1/(p.x*m.y-m.x*p.y);isFinite(r)&&(_.copy(u).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(r),g.copy(d).multiplyScalar(p.x).addScaledVector(u,-m.x).multiplyScalar(r),l[t].add(_),l[e].add(_),l[i].add(_),c[t].add(g),c[e].add(g),c[i].add(g))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let t=0,e=b.length;t<e;++t){const e=b[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)y(i[t+0],i[t+1],i[t+2])}const v=new gi,w=new gi,x=new gi,A=new gi;function S(t){x.fromArray(r,3*t),A.copy(x);const e=l[t];v.copy(e),v.sub(x.multiplyScalar(x.dot(e))).normalize(),w.crossVectors(A,e);const i=w.dot(c[t])<0?-1:1;s[4*t]=v.x,s[4*t+1]=v.y,s[4*t+2]=v.z,s[4*t+3]=i}for(let t=0,e=b.length;t<e;++t){const e=b[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)S(i[t+0]),S(i[t+1]),S(i[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let i=this.getAttribute("normal");if(void 0===i)i=new Fn(new Float32Array(3*e.count),3),this.setAttribute("normal",i);else for(let t=0,e=i.count;t<e;t++)i.setXYZ(t,0,0,0);const n=new gi,r=new gi,o=new gi,a=new gi,s=new gi,l=new gi,c=new gi,h=new gi;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),f=t.getX(u+1),p=t.getX(u+2);n.fromBufferAttribute(e,d),r.fromBufferAttribute(e,f),o.fromBufferAttribute(e,p),c.subVectors(o,r),h.subVectors(n,r),c.cross(h),a.fromBufferAttribute(i,d),s.fromBufferAttribute(i,f),l.fromBufferAttribute(i,p),a.add(c),s.add(c),l.add(c),i.setXYZ(d,a.x,a.y,a.z),i.setXYZ(f,s.x,s.y,s.z),i.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,a=e.count;t<a;t+=3)n.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,r),h.subVectors(n,r),c.cross(h),i.setXYZ(t+0,c.x,c.y,c.z),i.setXYZ(t+1,c.x,c.y,c.z),i.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const n in i){if(void 0===t.attributes[n])continue;const r=i[n].array,o=t.attributes[n],a=o.array,s=o.itemSize*e,l=Math.min(a.length,r.length-s);for(let t=0,e=s;t<l;t++,e++)r[e]=a[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Yn.fromBufferAttribute(t,e),Yn.normalize(),t.setXYZ(e,Yn.x,Yn.y,Yn.z)}toNonIndexed(){function t(t,e){const i=t.array,n=t.itemSize,r=t.normalized,o=new i.constructor(e.length*n);let a=0,s=0;for(let r=0,l=e.length;r<l;r++){a=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*n;for(let t=0;t<n;t++)o[s++]=i[a++]}return new Fn(o,n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Xn,i=this.index.array,n=this.attributes;for(const r in n){const o=t(n[r],i);e.setAttribute(r,o)}const r=this.morphAttributes;for(const n in r){const o=[],a=r[n];for(let e=0,n=a.length;e<n;e++){const n=t(a[e],i);o.push(n)}e.morphAttributes[n]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,i=o.length;t<i;t++){const i=o[t];e.addGroup(i.start,i.count,i.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const i=this.attributes;for(const e in i){const n=i[e];t.data.attributes[e]=n.toJSON(t.data)}const n={};let r=!1;for(const e in this.morphAttributes){const i=this.morphAttributes[e],o=[];for(let e=0,n=i.length;e<n;e++){const n=i[e];o.push(n.toJSON(t.data))}o.length>0&&(n[e]=o,r=!0)}r&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const i=t.index;null!==i&&this.setIndex(i.clone(e));const n=t.attributes;for(const t in n){const i=n[t];this.setAttribute(t,i.clone(e))}const r=t.morphAttributes;for(const t in r){const i=[],n=r[t];for(let t=0,r=n.length;t<r;t++)i.push(n[t].clone(e));this.morphAttributes[t]=i}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Xn.prototype.isBufferGeometry=!0;const Jn=new Xi,Qn=new Yi,qn=new Ni,Kn=new gi,$n=new gi,tr=new gi,er=new gi,ir=new gi,nr=new gi,rr=new gi,or=new gi,ar=new gi,sr=new je,lr=new je,cr=new je,hr=new gi,ur=new gi;class dr extends vn{constructor(t=new Xn,e=new Ln){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0===n)return;if(null===i.boundingSphere&&i.computeBoundingSphere(),qn.copy(i.boundingSphere),qn.applyMatrix4(r),!1===t.ray.intersectsSphere(qn))return;if(Jn.copy(r).invert(),Qn.copy(t.ray).applyMatrix4(Jn),null!==i.boundingBox&&!1===Qn.intersectsBox(i.boundingBox))return;let o;if(i.isBufferGeometry){const r=i.index,a=i.attributes.position,s=i.morphAttributes.position,l=i.morphTargetsRelative,c=i.attributes.uv,h=i.attributes.uv2,u=i.groups,d=i.drawRange;if(null!==r)if(Array.isArray(n))for(let i=0,f=u.length;i<f;i++){const f=u[i],p=n[f.materialIndex];for(let i=Math.max(f.start,d.start),n=Math.min(r.count,Math.min(f.start+f.count,d.start+d.count));i<n;i+=3){const n=r.getX(i),u=r.getX(i+1),d=r.getX(i+2);(o=fr(this,p,t,Qn,a,s,l,c,h,n,u,d))&&(o.faceIndex=Math.floor(i/3),o.face.materialIndex=f.materialIndex,e.push(o))}}else{for(let i=Math.max(0,d.start),u=Math.min(r.count,d.start+d.count);i<u;i+=3){const u=r.getX(i),d=r.getX(i+1),f=r.getX(i+2);(o=fr(this,n,t,Qn,a,s,l,c,h,u,d,f))&&(o.faceIndex=Math.floor(i/3),e.push(o))}}else if(void 0!==a)if(Array.isArray(n))for(let i=0,r=u.length;i<r;i++){const r=u[i],f=n[r.materialIndex];for(let i=Math.max(r.start,d.start),n=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));i<n;i+=3){(o=fr(this,f,t,Qn,a,s,l,c,h,i,i+1,i+2))&&(o.faceIndex=Math.floor(i/3),o.face.materialIndex=r.materialIndex,e.push(o))}}else{for(let i=Math.max(0,d.start),r=Math.min(a.count,d.start+d.count);i<r;i+=3){(o=fr(this,n,t,Qn,a,s,l,c,h,i,i+1,i+2))&&(o.faceIndex=Math.floor(i/3),e.push(o))}}}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function fr(t,e,i,n,r,o,a,s,l,c,h,u){Kn.fromBufferAttribute(r,c),$n.fromBufferAttribute(r,h),tr.fromBufferAttribute(r,u);const p=t.morphTargetInfluences;if(o&&p){rr.set(0,0,0),or.set(0,0,0),ar.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=p[t],i=o[t];0!==e&&(er.fromBufferAttribute(i,c),ir.fromBufferAttribute(i,h),nr.fromBufferAttribute(i,u),a?(rr.addScaledVector(er,e),or.addScaledVector(ir,e),ar.addScaledVector(nr,e)):(rr.addScaledVector(er.sub(Kn),e),or.addScaledVector(ir.sub($n),e),ar.addScaledVector(nr.sub(tr),e)))}Kn.add(rr),$n.add(or),tr.add(ar)}t.isSkinnedMesh&&(t.boneTransform(c,Kn),t.boneTransform(h,$n),t.boneTransform(u,tr));const m=function(t,e,i,n,r,o,a,s){let l;if(null===(l=e.side===d?n.intersectTriangle(a,o,r,!0,s):n.intersectTriangle(r,o,a,e.side!==f,s)))return null;ur.copy(s),ur.applyMatrix4(t.matrixWorld);const c=i.ray.origin.distanceTo(ur);return c<i.near||c>i.far?null:{distance:c,point:ur.clone(),object:t}}(t,e,i,n,Kn,$n,tr,hr);if(m){s&&(sr.fromBufferAttribute(s,c),lr.fromBufferAttribute(s,h),cr.fromBufferAttribute(s,u),m.uv=Pn.getUV(hr,Kn,$n,tr,sr,lr,cr,new je)),l&&(sr.fromBufferAttribute(l,c),lr.fromBufferAttribute(l,h),cr.fromBufferAttribute(l,u),m.uv2=Pn.getUV(hr,Kn,$n,tr,sr,lr,cr,new je));const t={a:c,b:h,c:u,normal:new gi,materialIndex:0};Pn.getNormal(Kn,$n,tr,t.normal),m.face=t}return m}dr.prototype.isMesh=!0;class pr extends Xn{constructor(t=1,e=1,i=1,n=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};const a=this;n=Math.floor(n),r=Math.floor(r);const s=[],l=[],c=[],h=[];let u=0,d=0;function f(t,e,i,n,r,o,f,p,m,_,g){const y=o/m,b=f/_,v=o/2,w=f/2,x=p/2,A=m+1,S=_+1;let M=0,E=0;const T=new gi;for(let o=0;o<S;o++){const a=o*b-w;for(let s=0;s<A;s++){const u=s*y-v;T[t]=u*n,T[e]=a*r,T[i]=x,l.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[i]=p>0?1:-1,c.push(T.x,T.y,T.z),h.push(s/m),h.push(1-o/_),M+=1}}for(let t=0;t<_;t++)for(let e=0;e<m;e++){const i=u+e+A*t,n=u+e+A*(t+1),r=u+(e+1)+A*(t+1),o=u+(e+1)+A*t;s.push(i,n,o),s.push(n,r,o),E+=6}a.addGroup(d,E,g),d+=E,u+=M}f("z","y","x",-1,-1,i,e,t,o=Math.floor(o),r,0),f("z","y","x",1,-1,i,e,-t,o,r,1),f("x","z","y",1,1,t,i,e,n,o,2),f("x","z","y",1,-1,t,i,-e,n,o,3),f("x","y","z",1,-1,t,e,i,n,r,4),f("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(s),this.setAttribute("position",new zn(l,3)),this.setAttribute("normal",new zn(c,3)),this.setAttribute("uv",new zn(h,2))}static fromJSON(t){return new pr(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function mr(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function _r(t){const e={};for(let i=0;i<t.length;i++){const n=mr(t[i]);for(const t in n)e[t]=n[t]}return e}const gr={clone:mr,merge:_r};var yr="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",br="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class vr extends Bn{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=yr,this.fragmentShader=br,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=mr(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const i={};for(const t in this.extensions)!0===this.extensions[t]&&(i[t]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}}vr.prototype.isShaderMaterial=!0;class wr extends vn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Xi,this.projectionMatrix=new Xi,this.projectionMatrixInverse=new Xi}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}wr.prototype.isCamera=!0;class xr extends wr{constructor(t=50,e=1,i=.1,n=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Ge*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Fe*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Ge*Math.atan(Math.tan(.5*Fe*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,n,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Fe*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,a=o.fullHeight;r+=o.offsetX*n/t,e-=o.offsetY*i/a,n*=o.width/t,i*=o.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}xr.prototype.isPerspectiveCamera=!0;const Ar=90,Sr=1;class Mr extends vn{constructor(t,e,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const n=new xr(Ar,Sr,t,e);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new gi(1,0,0)),this.add(n);const r=new xr(Ar,Sr,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new gi(-1,0,0)),this.add(r);const o=new xr(Ar,Sr,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new gi(0,1,0)),this.add(o);const a=new xr(Ar,Sr,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new gi(0,-1,0)),this.add(a);const s=new xr(Ar,Sr,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new gi(0,0,1)),this.add(s);const l=new xr(Ar,Sr,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new gi(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[n,r,o,a,s,l]=this.children,c=t.getRenderTarget(),h=t.toneMapping,u=t.xr.enabled;t.toneMapping=X,t.xr.enabled=!1;const d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,n),t.setRenderTarget(i,1),t.render(e,r),t.setRenderTarget(i,2),t.render(e,o),t.setRenderTarget(i,3),t.render(e,a),t.setRenderTarget(i,4),t.render(e,s),i.texture.generateMipmaps=d,t.setRenderTarget(i,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=h,t.xr.enabled=u,i.texture.needsPMREMUpdate=!0}}class Er extends ui{constructor(t,e,i,n,r,o,a,s,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:et,i,n,r,o,a,s,l,c),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}Er.prototype.isCubeTexture=!0;class Tr extends fi{constructor(t,e={}){super(t,t,e);const i={width:t,height:t,depth:1},n=[i,i,i,i,i,i];this.texture=new Er(n,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:dt}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new pr(5,5,5),r=new vr({name:"CubemapFromEquirect",uniforms:mr(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:d,blending:m});r.uniforms.tEquirect.value=e;const o=new dr(n,r),a=e.minFilter;return e.minFilter===pt&&(e.minFilter=dt),new Mr(1,10,this).update(t,o),e.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,i,n){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,i,n);t.setRenderTarget(r)}}Tr.prototype.isWebGLCubeRenderTarget=!0;const kr=new gi,Cr=new gi,Ir=new Ze;class Pr{constructor(t=new gi(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){const n=kr.subVectors(i,e).cross(Cr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const i=t.delta(kr),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:e.copy(i).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const i=e||Ir.getNormalMatrix(t),n=this.coplanarPoint(kr).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Pr.prototype.isPlane=!0;const Rr=new Ni,Br=new gi;class Lr{constructor(t=new Pr,e=new Pr,i=new Pr,n=new Pr,r=new Pr,o=new Pr){this.planes=[t,e,i,n,r,o]}set(t,e,i,n,r,o){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this}copy(t){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){const e=this.planes,i=t.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],f=i[10],p=i[11],m=i[12],_=i[13],g=i[14],y=i[15];return e[0].setComponents(a-n,h-s,p-u,y-m).normalize(),e[1].setComponents(a+n,h+s,p+u,y+m).normalize(),e[2].setComponents(a+r,h+l,p+d,y+_).normalize(),e[3].setComponents(a-r,h-l,p-d,y-_).normalize(),e[4].setComponents(a-o,h-c,p-f,y-g).normalize(),e[5].setComponents(a+o,h+c,p+f,y+g).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Rr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Rr)}intersectsSprite(t){return Rr.center.set(0,0,0),Rr.radius=.7071067811865476,Rr.applyMatrix4(t.matrixWorld),this.intersectsSphere(Rr)}intersectsSphere(t){const e=this.planes,i=t.center,n=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(i)<n)return!1}return!0}intersectsBox(t){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(Br.x=n.normal.x>0?t.max.x:t.min.x,Br.y=n.normal.y>0?t.max.y:t.min.y,Br.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(Br)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Dr(){let t=null,e=!1,i=null,n=null;function r(e,o){i(e,o),n=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==i&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(t){i=t},setContext:function(e){t=e}}}function Or(t,e){const i=e.isWebGL2,n=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),n.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const i=n.get(e);i&&(t.deleteBuffer(i.buffer),n.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=n.get(e);return void((!t||t.version<e.version)&&n.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=n.get(e);void 0===o?n.set(e,function(e,n){const r=e.array,o=e.usage,a=t.createBuffer();let s;if(t.bindBuffer(n,a),t.bufferData(n,r,o),e.onUploadCallback(),r instanceof Float32Array)s=5126;else if(r instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!i)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");s=5131}else s=5123;else if(r instanceof Int16Array)s=5122;else if(r instanceof Uint32Array)s=5125;else if(r instanceof Int32Array)s=5124;else if(r instanceof Int8Array)s=5120;else if(r instanceof Uint8Array)s=5121;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=5121}return{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):o.version<e.version&&(function(e,n,r){const o=n.array,a=n.updateRange;t.bindBuffer(r,e),-1===a.count?t.bufferSubData(r,0,o):(i?t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):t.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,e,r),o.version=e.version)}}}class Fr extends Xn{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};const r=t/2,o=e/2,a=Math.floor(i),s=Math.floor(n),l=a+1,c=s+1,h=t/a,u=e/s,d=[],f=[],p=[],m=[];for(let t=0;t<c;t++){const e=t*u-o;for(let i=0;i<l;i++){const n=i*h-r;f.push(n,-e,0),p.push(0,0,1),m.push(i/a),m.push(1-t/s)}}for(let t=0;t<s;t++)for(let e=0;e<a;e++){const i=e+l*t,n=e+l*(t+1),r=e+1+l*(t+1),o=e+1+l*t;d.push(i,n,o),d.push(n,r,o)}this.setIndex(d),this.setAttribute("position",new zn(f,3)),this.setAttribute("normal",new zn(p,3)),this.setAttribute("uv",new zn(m,2))}static fromJSON(t){return new Fr(t.width,t.height,t.widthSegments,t.heightSegments)}}const Gr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Nr={common:{diffuse:{value:new oi(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ze},uv2Transform:{value:new Ze},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new je(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new oi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new oi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ze}},sprite:{diffuse:{value:new oi(16777215)},opacity:{value:1},center:{value:new je(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ze}}},zr={basic:{uniforms:_r([Nr.common,Nr.specularmap,Nr.envmap,Nr.aomap,Nr.lightmap,Nr.fog]),vertexShader:Gr.meshbasic_vert,fragmentShader:Gr.meshbasic_frag},lambert:{uniforms:_r([Nr.common,Nr.specularmap,Nr.envmap,Nr.aomap,Nr.lightmap,Nr.emissivemap,Nr.fog,Nr.lights,{emissive:{value:new oi(0)}}]),vertexShader:Gr.meshlambert_vert,fragmentShader:Gr.meshlambert_frag},phong:{uniforms:_r([Nr.common,Nr.specularmap,Nr.envmap,Nr.aomap,Nr.lightmap,Nr.emissivemap,Nr.bumpmap,Nr.normalmap,Nr.displacementmap,Nr.fog,Nr.lights,{emissive:{value:new oi(0)},specular:{value:new oi(1118481)},shininess:{value:30}}]),vertexShader:Gr.meshphong_vert,fragmentShader:Gr.meshphong_frag},standard:{uniforms:_r([Nr.common,Nr.envmap,Nr.aomap,Nr.lightmap,Nr.emissivemap,Nr.bumpmap,Nr.normalmap,Nr.displacementmap,Nr.roughnessmap,Nr.metalnessmap,Nr.fog,Nr.lights,{emissive:{value:new oi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gr.meshphysical_vert,fragmentShader:Gr.meshphysical_frag},toon:{uniforms:_r([Nr.common,Nr.aomap,Nr.lightmap,Nr.emissivemap,Nr.bumpmap,Nr.normalmap,Nr.displacementmap,Nr.gradientmap,Nr.fog,Nr.lights,{emissive:{value:new oi(0)}}]),vertexShader:Gr.meshtoon_vert,fragmentShader:Gr.meshtoon_frag},matcap:{uniforms:_r([Nr.common,Nr.bumpmap,Nr.normalmap,Nr.displacementmap,Nr.fog,{matcap:{value:null}}]),vertexShader:Gr.meshmatcap_vert,fragmentShader:Gr.meshmatcap_frag},points:{uniforms:_r([Nr.points,Nr.fog]),vertexShader:Gr.points_vert,fragmentShader:Gr.points_frag},dashed:{uniforms:_r([Nr.common,Nr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gr.linedashed_vert,fragmentShader:Gr.linedashed_frag},depth:{uniforms:_r([Nr.common,Nr.displacementmap]),vertexShader:Gr.depth_vert,fragmentShader:Gr.depth_frag},normal:{uniforms:_r([Nr.common,Nr.bumpmap,Nr.normalmap,Nr.displacementmap,{opacity:{value:1}}]),vertexShader:Gr.meshnormal_vert,fragmentShader:Gr.meshnormal_frag},sprite:{uniforms:_r([Nr.sprite,Nr.fog]),vertexShader:Gr.sprite_vert,fragmentShader:Gr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ze},t2D:{value:null}},vertexShader:Gr.background_vert,fragmentShader:Gr.background_frag},cube:{uniforms:_r([Nr.envmap,{opacity:{value:1}}]),vertexShader:Gr.cube_vert,fragmentShader:Gr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gr.equirect_vert,fragmentShader:Gr.equirect_frag},distanceRGBA:{uniforms:_r([Nr.common,Nr.displacementmap,{referencePosition:{value:new gi},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gr.distanceRGBA_vert,fragmentShader:Gr.distanceRGBA_frag},shadow:{uniforms:_r([Nr.lights,Nr.fog,{color:{value:new oi(0)},opacity:{value:1}}]),vertexShader:Gr.shadow_vert,fragmentShader:Gr.shadow_frag}};function Ur(t,e,i,n){const r=t.getParameter(34921),o=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||null!==o,s={},l=f(null);let c=l,h=!1;function u(e){return n.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function d(e){return n.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function f(t){const e=[],i=[],n=[];for(let t=0;t<r;t++)e[t]=0,i[t]=0,n[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:i,attributeDivisors:n,object:t,attributes:{},index:null}}function p(){const t=c.newAttributes;for(let e=0,i=t.length;e<i;e++)t[e]=0}function m(t){_(t,0)}function _(i,r){const o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;if(o[i]=1,0===a[i]&&(t.enableVertexAttribArray(i),a[i]=1),s[i]!==r){(n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),s[i]=r}}function g(){const e=c.newAttributes,i=c.enabledAttributes;for(let n=0,r=i.length;n<r;n++)i[n]!==e[n]&&(t.disableVertexAttribArray(n),i[n]=0)}function y(e,i,r,o,a,s){!0!==n.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,i,r,o,a,s):t.vertexAttribIPointer(e,i,r,a,s)}function b(){v(),h=!0,c!==l&&u((c=l).object)}function v(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,b,v){let w=!1;if(a){const e=function(e,i,r){const a=!0===r.wireframe;let l=s[e.id];void 0===l&&(l={},s[e.id]=l);let c=l[i.id];void 0===c&&(c={},l[i.id]=c);let h=c[a];return void 0===h&&(h=f(n.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),c[a]=h),h}(b,d,l);c!==e&&u((c=e).object),(w=function(t,e,i,n){const r=c.attributes,o=e.attributes;let a=0;const s=i.getAttributes();for(const e in s){const i=s[e];if(i.location>=0){const i=r[e];let n=o[e];if(void 0===n&&("instanceMatrix"===e&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(n=t.instanceColor)),void 0===i)return!0;if(i.attribute!==n)return!0;if(n&&i.data!==n.data)return!0;a++}}return c.attributesNum!==a||c.index!==n}(r,b,d,v))&&function(t,e,i,n){const r={},o=e.attributes;let a=0;const s=i.getAttributes();for(const e in s){const i=s[e];if(i.location>=0){let i=o[e];void 0===i&&("instanceMatrix"===e&&t.instanceMatrix&&(i=t.instanceMatrix),"instanceColor"===e&&t.instanceColor&&(i=t.instanceColor));const n={};n.attribute=i,i&&i.data&&(n.data=i.data),r[e]=n,a++}}c.attributes=r,c.attributesNum=a,c.index=n}(r,b,d,v)}else{const t=!0===l.wireframe;c.geometry===b.id&&c.program===d.id&&c.wireframe===t||(c.geometry=b.id,c.program=d.id,c.wireframe=t,w=!0)}null!==v&&i.update(v,34963),(w||h)&&(h=!1,function(r,o,a,s){if(!1===n.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const l=s.attributes,c=a.getAttributes(),h=o.defaultAttributeValues;for(const e in c){const n=c[e];if(n.location>=0){let o=l[e];if(void 0===o&&("instanceMatrix"===e&&r.instanceMatrix&&(o=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(o=r.instanceColor)),void 0!==o){const e=o.normalized,a=o.itemSize,l=i.get(o);if(void 0===l)continue;const c=l.buffer,h=l.type,u=l.bytesPerElement;if(o.isInterleavedBufferAttribute){const i=o.data,l=i.stride,d=o.offset;if(i.isInstancedInterleavedBuffer){for(let t=0;t<n.locationSize;t++)_(n.location+t,i.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let t=0;t<n.locationSize;t++)m(n.location+t);t.bindBuffer(34962,c);for(let t=0;t<n.locationSize;t++)y(n.location+t,a/n.locationSize,h,e,l*u,(d+a/n.locationSize*t)*u)}else{if(o.isInstancedBufferAttribute){for(let t=0;t<n.locationSize;t++)_(n.location+t,o.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)}else for(let t=0;t<n.locationSize;t++)m(n.location+t);t.bindBuffer(34962,c);for(let t=0;t<n.locationSize;t++)y(n.location+t,a/n.locationSize,h,e,a*u,a/n.locationSize*t*u)}}else if(void 0!==h){const i=h[e];if(void 0!==i)switch(i.length){case 2:t.vertexAttrib2fv(n.location,i);break;case 3:t.vertexAttrib3fv(n.location,i);break;case 4:t.vertexAttrib4fv(n.location,i);break;default:t.vertexAttrib1fv(n.location,i)}}}}g()}(r,l,d,b),null!==v&&t.bindBuffer(34963,i.get(v).buffer))},reset:b,resetDefaultState:v,dispose:function(){b();for(const t in s){const e=s[t];for(const t in e){const i=e[t];for(const t in i)d(i[t].object),delete i[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const i=e[t];for(const t in i)d(i[t].object),delete i[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const i=s[e];if(void 0===i[t.id])continue;const n=i[t.id];for(const t in n)d(n[t].object),delete n[t];delete i[t.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:g}}zr.physical={uniforms:_r([zr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new je(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new oi(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new je},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new oi(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new oi(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Gr.meshphysical_vert,fragmentShader:Gr.meshphysical_frag};class Hr extends wr{constructor(t=-1,e=1,i=1,n=-1,r=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,i,n,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-t,o=i+t,a=n+e,s=n-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(r+=t*this.view.offsetX)+t*this.view.width,s=(a-=e*this.view.offsetY)-e*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}Hr.prototype.isOrthographicCamera=!0;const Vr=4,Wr=[.125,.215,.35,.446,.526,.582],jr=20,Zr=new Hr,Yr=new oi;let Xr=null;const Jr=(1+Math.sqrt(5))/2,Qr=1/Jr,qr=[new gi(1,1,1),new gi(-1,1,1),new gi(1,1,-1),new gi(-1,1,-1),new gi(0,Jr,Qr),new gi(0,Jr,-Qr),new gi(Qr,0,Jr),new gi(-Qr,0,Jr),new gi(Jr,Qr,0),new gi(-Jr,Qr,0)];class Kr{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,n=100){Xr=this._renderer.getRenderTarget(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,i,n,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=io(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=eo(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Xr),t.scissorTest=!1,to(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===et||t.mapping===it?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Xr=this._renderer.getRenderTarget();const i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:dt,minFilter:dt,generateMipmaps:!1,type:xt,format:kt,encoding:we,depthBuffer:!1},n=$r(t,e,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=$r(t,e,i);const{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],i=[],n=[];let r=t;const o=t-Vr+1+Wr.length;for(let a=0;a<o;a++){const o=Math.pow(2,r);i.push(o);let s=1/o;a>t-Vr?s=Wr[a-t+Vr-1]:0===a&&(s=0),n.push(s);const l=1/(o-2),c=-l,h=1+l,u=[c,c,h,c,h,h,c,c,h,h,c,h],d=6,f=6,p=3,m=2,_=1,g=new Float32Array(p*f*d),y=new Float32Array(m*f*d),b=new Float32Array(_*f*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,i=t>2?0:-1,n=[e,i,0,e+2/3,i,0,e+2/3,i+1,0,e,i,0,e+2/3,i+1,0,e,i+1,0];g.set(n,p*f*t),y.set(u,m*f*t);const r=[t,t,t,t,t,t];b.set(r,_*f*t)}const v=new Xn;v.setAttribute("position",new Fn(g,p)),v.setAttribute("uv",new Fn(y,m)),v.setAttribute("faceIndex",new Fn(b,_)),e.push(v),r>Vr&&r--}return{lodPlanes:e,sizeLods:i,sigmas:n}}(n)),this._blurMaterial=function(t,e,i){const n=new Float32Array(jr),r=new gi(0,1,0);return new vr({name:"SphericalGaussianBlur",defines:{n:jr,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:no(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}(n,t,e)}return n}_compileMaterial(t){const e=new dr(this._lodPlanes[0],t);this._renderer.compile(e,Zr)}_sceneToCubeUV(t,e,i,n){const r=new xr(90,1,e,i),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(Yr),s.toneMapping=X,s.autoClear=!1;const h=new Ln({name:"PMREM.Background",side:d,depthWrite:!1,depthTest:!1}),u=new dr(new pr,h);let f=!1;const p=t.background;p?p.isColor&&(h.color.copy(p),t.background=null,f=!0):(h.color.copy(Yr),f=!0);for(let e=0;e<6;e++){const i=e%3;0===i?(r.up.set(0,o[e],0),r.lookAt(a[e],0,0)):1===i?(r.up.set(0,0,o[e]),r.lookAt(0,a[e],0)):(r.up.set(0,o[e],0),r.lookAt(0,0,a[e]));const l=this._cubeSize;to(n,i*l,e>2?l:0,l,l),s.setRenderTarget(n),f&&s.render(u,r),s.render(t,r)}u.geometry.dispose(),u.material.dispose(),s.toneMapping=c,s.autoClear=l,t.background=p}_textureToCubeUV(t,e){const i=this._renderer,n=t.mapping===et||t.mapping===it;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=io()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=eo());const r=n?this._cubemapMaterial:this._equirectMaterial,o=new dr(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;to(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(o,Zr)}_applyPMREM(t){const e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let e=1;e<this._lodPlanes.length;e++){const i=Math.sqrt(this._sigmas[e]*this._sigmas[e]-this._sigmas[e-1]*this._sigmas[e-1]),n=qr[(e-1)%qr.length];this._blur(t,e-1,e,i,n)}e.autoClear=i}_blur(t,e,i,n,r){const o=this._pingPongRenderTarget;this._halfBlur(t,o,e,i,n,"latitudinal",r),this._halfBlur(o,t,i,i,n,"longitudinal",r)}_halfBlur(t,e,i,n,r,o,a){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new dr(this._lodPlanes[n],l),h=l.uniforms,u=this._sizeLods[i]-1,d=isFinite(r)?Math.PI/(2*u):2*Math.PI/(2*jr-1),f=r/d,p=isFinite(r)?1+Math.floor(3*f):jr;p>jr&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${jr}`);const m=[];let _=0;for(let t=0;t<jr;++t){const e=t/f,i=Math.exp(-e*e/2);m.push(i),0===t?_+=i:t<p&&(_+=2*i)}for(let t=0;t<m.length;t++)m[t]=m[t]/_;h.envMap.value=t.texture,h.samples.value=p,h.weights.value=m,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:g}=this;h.dTheta.value=d,h.mipInt.value=g-i;const y=this._sizeLods[n];to(e,3*y*(n>g-Vr?n-g+Vr:0),4*(this._cubeSize-y),3*y,2*y),s.setRenderTarget(e),s.render(c,Zr)}}function $r(t,e,i){const n=new fi(t,e,i);return n.texture.mapping=ot,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function to(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function eo(){return new vr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:no(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function io(){return new vr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:no(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:m,depthTest:!1,depthWrite:!1})}function no(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function ro(t){let e=new WeakMap,i=null;function n(t){const i=t.target;i.removeEventListener("dispose",n);const r=e.get(i);void 0!==r&&(e.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping,a=o===nt||o===rt,s=o===et||o===it;if(a||s){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let n=e.get(r);return null===i&&(i=new Kr(t)),n=a?i.fromEquirectangular(r,n):i.fromCubemap(r,n),e.set(r,n),n.texture}if(e.has(r))return e.get(r).texture;{const o=r.image;if(a&&o&&o.height>0||s&&o&&function(t){let e=0;for(let i=0;i<6;i++)void 0!==t[i]&&e++;return 6===e}(o)){null===i&&(i=new Kr(t));const o=a?i.fromEquirectangular(r):i.fromCubemap(r);return e.set(r,o),r.addEventListener("dispose",n),o.texture}return null}}}return r},dispose:function(){e=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function oo(t,e){return t[0]-e[0]}function ao(t,e){return Math.abs(e[1])-Math.abs(t[1])}function so(t,e){let i=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?i=127:n instanceof Int16Array?i=32767:n instanceof Int32Array?i=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),t.divideScalar(i)}const lo=new ui,co=new pi,ho=new mi,uo=new Er,fo=[],po=[],mo=new Float32Array(16),_o=new Float32Array(9),go=new Float32Array(4);function yo(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let o=fo[r];if(void 0===o&&(o=new Float32Array(r),fo[r]=o),0!==e){n.toArray(o,0);for(let n=1,r=0;n!==e;++n)r+=i,t[n].toArray(o,r)}return o}function bo(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function vo(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function wo(t,e){let i=po[e];void 0===i&&(i=new Int32Array(e),po[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function xo(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Ao(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(bo(i,e))return;t.uniform2fv(this.addr,e),vo(i,e)}}function So(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(bo(i,e))return;t.uniform3fv(this.addr,e),vo(i,e)}}function Mo(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(bo(i,e))return;t.uniform4fv(this.addr,e),vo(i,e)}}function Eo(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(bo(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),vo(i,e)}else{if(bo(i,n))return;go.set(n),t.uniformMatrix2fv(this.addr,!1,go),vo(i,n)}}function To(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(bo(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),vo(i,e)}else{if(bo(i,n))return;_o.set(n),t.uniformMatrix3fv(this.addr,!1,_o),vo(i,n)}}function ko(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(bo(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),vo(i,e)}else{if(bo(i,n))return;mo.set(n),t.uniformMatrix4fv(this.addr,!1,mo),vo(i,n)}}function Co(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Io(t,e){const i=this.cache;bo(i,e)||(t.uniform2iv(this.addr,e),vo(i,e))}function Po(t,e){const i=this.cache;bo(i,e)||(t.uniform3iv(this.addr,e),vo(i,e))}function Ro(t,e){const i=this.cache;bo(i,e)||(t.uniform4iv(this.addr,e),vo(i,e))}function Bo(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function Lo(t,e){const i=this.cache;bo(i,e)||(t.uniform2uiv(this.addr,e),vo(i,e))}function Do(t,e){const i=this.cache;bo(i,e)||(t.uniform3uiv(this.addr,e),vo(i,e))}function Oo(t,e){const i=this.cache;bo(i,e)||(t.uniform4uiv(this.addr,e),vo(i,e))}function Fo(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(e||lo,r)}function Go(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||ho,r)}function No(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(e||uo,r)}function zo(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||co,r)}function Uo(t,e){t.uniform1fv(this.addr,e)}function Ho(t,e){const i=yo(e,this.size,2);t.uniform2fv(this.addr,i)}function Vo(t,e){const i=yo(e,this.size,3);t.uniform3fv(this.addr,i)}function Wo(t,e){const i=yo(e,this.size,4);t.uniform4fv(this.addr,i)}function jo(t,e){const i=yo(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function Zo(t,e){const i=yo(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function Yo(t,e){const i=yo(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function Xo(t,e){t.uniform1iv(this.addr,e)}function Jo(t,e){t.uniform2iv(this.addr,e)}function Qo(t,e){t.uniform3iv(this.addr,e)}function qo(t,e){t.uniform4iv(this.addr,e)}function Ko(t,e){t.uniform1uiv(this.addr,e)}function $o(t,e){t.uniform2uiv(this.addr,e)}function ta(t,e){t.uniform3uiv(this.addr,e)}function ea(t,e){t.uniform4uiv(this.addr,e)}function ia(t,e,i){const n=e.length,r=wo(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.setTexture2D(e[t]||lo,r[t])}function na(t,e,i){const n=e.length,r=wo(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.setTexture3D(e[t]||ho,r[t])}function ra(t,e,i){const n=e.length,r=wo(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.setTextureCube(e[t]||uo,r[t])}function oa(t,e,i){const n=e.length,r=wo(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.setTexture2DArray(e[t]||co,r[t])}function aa(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return xo;case 35664:return Ao;case 35665:return So;case 35666:return Mo;case 35674:return Eo;case 35675:return To;case 35676:return ko;case 5124:case 35670:return Co;case 35667:case 35671:return Io;case 35668:case 35672:return Po;case 35669:case 35673:return Ro;case 5125:return Bo;case 36294:return Lo;case 36295:return Do;case 36296:return Oo;case 35678:case 36198:case 36298:case 36306:case 35682:return Fo;case 35679:case 36299:case 36307:return Go;case 35680:case 36300:case 36308:case 36293:return No;case 36289:case 36303:case 36311:case 36292:return zo}}(e.type)}function sa(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Uo;case 35664:return Ho;case 35665:return Vo;case 35666:return Wo;case 35674:return jo;case 35675:return Zo;case 35676:return Yo;case 5124:case 35670:return Xo;case 35667:case 35671:return Jo;case 35668:case 35672:return Qo;case 35669:case 35673:return qo;case 5125:return Ko;case 36294:return $o;case 36295:return ta;case 36296:return ea;case 35678:case 36198:case 36298:case 36306:case 35682:return ia;case 35679:case 36299:case 36307:return na;case 35680:case 36300:case 36308:case 36293:return ra;case 36289:case 36303:case 36311:case 36292:return oa}}(e.type)}function la(t){this.id=t,this.seq=[],this.map={}}la.prototype.setValue=function(t,e,i){const n=this.seq;for(let r=0,o=n.length;r!==o;++r){const o=n[r];o.setValue(t,e[o.id],i)}};const ca=/(\w+)(\])?(\[|\.)?/g;function ha(t,e){t.seq.push(e),t.map[e.id]=e}function ua(t,e,i){const n=t.name,r=n.length;for(ca.lastIndex=0;;){const o=ca.exec(n),a=ca.lastIndex;let s=o[1];const l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===r){ha(i,void 0===c?new aa(s,t,e):new sa(s,t,e));break}{let t=i.map[s];void 0===t&&ha(i,t=new la(s)),i=t}}}function da(t,e){this.seq=[],this.map={};const i=t.getProgramParameter(e,35718);for(let n=0;n<i;++n){const i=t.getActiveUniform(e,n);ua(i,t.getUniformLocation(e,i.name),this)}}function fa(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}da.prototype.setValue=function(t,e,i,n){const r=this.map[e];void 0!==r&&r.setValue(t,i,n)},da.prototype.setOptional=function(t,e,i){const n=e[i];void 0!==n&&this.setValue(t,i,n)},da.upload=function(t,e,i,n){for(let r=0,o=e.length;r!==o;++r){const o=e[r],a=i[o.id];!1!==a.needsUpdate&&o.setValue(t,a.value,n)}},da.seqWithValue=function(t,e){const i=[];for(let n=0,r=t.length;n!==r;++n){const r=t[n];r.id in e&&i.push(r)}return i};let pa=0;function ma(t,e,i){const n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(n&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const n=parseInt(o[0]);return i.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const i=t.split("\n"),n=[],r=Math.max(e-6,0),o=Math.min(e+6,i.length);for(let t=r;t<o;t++)n.push(t+1+": "+i[t]);return n.join("\n")}(t.getShaderSource(e),n)}return r}function _a(t,e){const i=function(t){switch(t){case we:return["Linear","( value )"];case xe:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function ga(t){return""!==t}function ya(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ba(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const va=/^[ \t]*#include +<([\w\d./]+)>/gm;function wa(t){return t.replace(va,xa)}function xa(t,e){const i=Gr[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return wa(i)}const Aa=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Sa=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ma(t){return t.replace(Sa,Ta).replace(Aa,Ea)}function Ea(t,e,i,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ta(t,e,i,n)}function Ta(t,e,i,n){let r="";for(let t=parseInt(e);t<parseInt(i);t++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function ka(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ca(t,e,i,n){const r=t.getContext(),o=i.defines;let a=i.vertexShader,s=i.fragmentShader;const u=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===l?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===c?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===h&&(e="SHADOWMAP_TYPE_VSM"),e}(i),d=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case et:case it:e="ENVMAP_TYPE_CUBE";break;case ot:e="ENVMAP_TYPE_CUBE_UV"}return e}(i),f=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case it:e="ENVMAP_MODE_REFRACTION"}return e}(i),p=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case j:e="ENVMAP_BLENDING_MULTIPLY";break;case Z:e="ENVMAP_BLENDING_MIX";break;case Y:e="ENVMAP_BLENDING_ADD"}return e}(i),m=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const i=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:n,maxMip:i}}(i),_=i.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ga).join("\n")}(i),g=function(t){const e=[];for(const i in t){const n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(o),y=r.createProgram();let b,v,w=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?((b=[g].filter(ga).join("\n")).length>0&&(b+="\n"),(v=[_,g].filter(ga).join("\n")).length>0&&(v+="\n")):(b=[ka(i),"#define SHADER_NAME "+i.shaderName,g,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+f:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+u:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ga).join("\n"),v=[_,ka(i),"#define SHADER_NAME "+i.shaderName,g,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+d:"",i.envMap?"#define "+f:"",i.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+u:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==X?"#define TONE_MAPPING":"",i.toneMapping!==X?Gr.tonemapping_pars_fragment:"",i.toneMapping!==X?function(t,e){let i;switch(e){case J:i="Linear";break;case Q:i="Reinhard";break;case q:i="OptimizedCineon";break;case K:i="ACESFilmic";break;case $:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Gr.encodings_pars_fragment,_a("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(ga).join("\n")),a=ba(a=ya(a=wa(a),i),i),s=ba(s=ya(s=wa(s),i),i),a=Ma(a),s=Ma(s),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(w="#version 300 es\n",b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,v=["#define varying in",i.glslVersion===Be?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===Be?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const x=w+v+s,A=fa(r,35633,w+b+a),S=fa(r,35632,x);if(r.attachShader(y,A),r.attachShader(y,S),void 0!==i.index0AttributeName?r.bindAttribLocation(y,0,i.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(y).trim(),e=r.getShaderInfoLog(A).trim(),i=r.getShaderInfoLog(S).trim();let n=!0,o=!0;if(!1===r.getProgramParameter(y,35714)){n=!1;const e=ma(r,A,"vertex"),i=ma(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+i)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==i||(o=!1);o&&(this.diagnostics={runnable:n,programLog:t,vertexShader:{log:e,prefix:b},fragmentShader:{log:i,prefix:v}})}let M,E;return r.deleteShader(A),r.deleteShader(S),this.getUniforms=function(){return void 0===M&&(M=new da(r,y)),M},this.getAttributes=function(){return void 0===E&&(E=function(t,e){const i={},n=t.getProgramParameter(e,35721);for(let r=0;r<n;r++){const n=t.getActiveAttrib(e,r),o=n.name;let a=1;35674===n.type&&(a=2),35675===n.type&&(a=3),35676===n.type&&(a=4),i[o]={type:n.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}(r,y)),E},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.name=i.shaderName,this.id=pa++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=A,this.fragmentShader=S,this}let Ia=0;class Pa{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,i=t.fragmentShader,n=this._getShaderStage(e),r=this._getShaderStage(i),o=this._getShaderCacheForMaterial(t);return!1===o.has(n)&&(o.add(n),n.usedTimes++),!1===o.has(r)&&(o.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const t of e)t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const i=new Ra(t);e.set(t,i)}return e.get(t)}}class Ra{constructor(t){this.id=Ia++,this.code=t,this.usedTimes=0}}function Ba(t,e,i,n,r,o,a){const s=new an,l=new Pa,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(o,s,c,y,b){const v=y.fog,w=b.geometry,x=o.isMeshStandardMaterial?y.environment:null,A=(o.isMeshStandardMaterial?i:e).get(o.envMap||x),S=A&&A.mapping===ot?A.image.height:null,M=g[o.type];null!==o.precision&&(m=r.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead.");const E=w.morphAttributes.position||w.morphAttributes.normal||w.morphAttributes.color,T=void 0!==E?E.length:0;let k,C,I,P,R=0;if(void 0!==w.morphAttributes.position&&(R=1),void 0!==w.morphAttributes.normal&&(R=2),void 0!==w.morphAttributes.color&&(R=3),M){const t=zr[M];k=t.vertexShader,C=t.fragmentShader}else k=o.vertexShader,C=o.fragmentShader,l.update(o),I=l.getVertexShaderID(o),P=l.getFragmentShaderID(o);const B=t.getRenderTarget(),L=o.alphaTest>0,D=o.clearcoat>0;return{isWebGL2:h,shaderID:M,shaderName:o.type,vertexShader:k,fragmentShader:C,defines:o.defines,customVertexShaderID:I,customFragmentShaderID:P,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:m,instancing:!0===b.isInstancedMesh,instancingColor:!0===b.isInstancedMesh&&null!==b.instanceColor,supportsVertexTextures:p,outputEncoding:null===B?t.outputEncoding:!0===B.isXRRenderTarget?B.texture.encoding:we,map:!!o.map,matcap:!!o.matcap,envMap:!!A,envMapMode:A&&A.mapping,envMapCubeUVHeight:S,lightMap:!!o.lightMap,aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:o.normalMapType===Ee,tangentSpaceNormalMap:o.normalMapType===Me,decodeVideoTexture:!!o.map&&!0===o.map.isVideoTexture&&o.map.encoding===xe,clearcoat:D,clearcoatMap:D&&!!o.clearcoatMap,clearcoatRoughnessMap:D&&!!o.clearcoatRoughnessMap,clearcoatNormalMap:D&&!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,specularIntensityMap:!!o.specularIntensityMap,specularColorMap:!!o.specularColorMap,opaque:!1===o.transparent&&o.blending===_,alphaMap:!!o.alphaMap,alphaTest:L,gradientMap:!!o.gradientMap,sheen:o.sheen>0,sheenColorMap:!!o.sheenColorMap,sheenRoughnessMap:!!o.sheenRoughnessMap,transmission:o.transmission>0,transmissionMap:!!o.transmissionMap,thicknessMap:!!o.thicknessMap,combine:o.combine,vertexTangents:!!o.normalMap&&!!w.attributes.tangent,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!w.attributes.color&&4===w.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheenColorMap||o.sheenRoughnessMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmission>0||o.transmissionMap||o.thicknessMap||o.specularIntensityMap||o.specularColorMap||o.sheen>0||o.sheenColorMap||o.sheenRoughnessMap||!o.displacementMap),fog:!!v,useFog:!0===o.fog,fogExp2:v&&v.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===b.isSkinnedMesh,morphTargets:void 0!==w.morphAttributes.position,morphNormals:void 0!==w.morphAttributes.normal,morphColors:void 0!==w.morphAttributes.color,morphTargetsCount:T,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:o.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:o.toneMapped?t.toneMapping:X,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===f,flipSided:o.side===d,useDepthPacking:!!o.depthPacking,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(e){const i=[];if(e.shaderID?i.push(e.shaderID):(i.push(e.customVertexShaderID),i.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)i.push(t),i.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(i,e),function(t,e){s.disableAll(),e.isWebGL2&&s.enable(0),e.supportsVertexTextures&&s.enable(1),e.instancing&&s.enable(2),e.instancingColor&&s.enable(3),e.map&&s.enable(4),e.matcap&&s.enable(5),e.envMap&&s.enable(6),e.lightMap&&s.enable(7),e.aoMap&&s.enable(8),e.emissiveMap&&s.enable(9),e.bumpMap&&s.enable(10),e.normalMap&&s.enable(11),e.objectSpaceNormalMap&&s.enable(12),e.tangentSpaceNormalMap&&s.enable(13),e.clearcoat&&s.enable(14),e.clearcoatMap&&s.enable(15),e.clearcoatRoughnessMap&&s.enable(16),e.clearcoatNormalMap&&s.enable(17),e.displacementMap&&s.enable(18),e.specularMap&&s.enable(19),e.roughnessMap&&s.enable(20),e.metalnessMap&&s.enable(21),e.gradientMap&&s.enable(22),e.alphaMap&&s.enable(23),e.alphaTest&&s.enable(24),e.vertexColors&&s.enable(25),e.vertexAlphas&&s.enable(26),e.vertexUvs&&s.enable(27),e.vertexTangents&&s.enable(28),e.uvsVertexOnly&&s.enable(29),e.fog&&s.enable(30),t.push(s.mask),s.disableAll(),e.useFog&&s.enable(0),e.flatShading&&s.enable(1),e.logarithmicDepthBuffer&&s.enable(2),e.skinning&&s.enable(3),e.morphTargets&&s.enable(4),e.morphNormals&&s.enable(5),e.morphColors&&s.enable(6),e.premultipliedAlpha&&s.enable(7),e.shadowMapEnabled&&s.enable(8),e.physicallyCorrectLights&&s.enable(9),e.doubleSided&&s.enable(10),e.flipSided&&s.enable(11),e.useDepthPacking&&s.enable(12),e.dithering&&s.enable(13),e.specularIntensityMap&&s.enable(14),e.specularColorMap&&s.enable(15),e.transmission&&s.enable(16),e.transmissionMap&&s.enable(17),e.thicknessMap&&s.enable(18),e.sheen&&s.enable(19),e.sheenColorMap&&s.enable(20),e.sheenRoughnessMap&&s.enable(21),e.decodeVideoTexture&&s.enable(22),e.opaque&&s.enable(23),t.push(s.mask)}(i,e),i.push(t.outputEncoding)),i.push(e.customProgramCacheKey),i.join()},getUniforms:function(t){const e=g[t.type];let i;if(e){const t=zr[e];i=gr.clone(t.uniforms)}else i=t.uniforms;return i},acquireProgram:function(e,i){let n;for(let t=0,e=c.length;t<e;t++){const e=c[t];if(e.cacheKey===i){++(n=e).usedTimes;break}}return void 0===n&&(n=new Ca(t,i,e,o),c.push(n)),n},releaseProgram:function(t){if(0==--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:c,dispose:function(){l.dispose()}}}function La(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Da(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Oa(){const t=[];let e=0;const i=[],n=[],r=[];function o(i,n,r,o,a,s){let l=t[e];return void 0===l?(l={id:i.id,object:i,geometry:n,material:r,groupOrder:o,renderOrder:i.renderOrder,z:a,group:s},t[e]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=r,l.groupOrder=o,l.renderOrder=i.renderOrder,l.z=a,l.group=s),e++,l}return{opaque:i,transmissive:n,transparent:r,init:function(){e=0,i.length=0,n.length=0,r.length=0},push:function(t,e,a,s,l,c){const h=o(t,e,a,s,l,c);a.transmission>0?n.push(h):!0===a.transparent?r.push(h):i.push(h)},unshift:function(t,e,a,s,l,c){const h=o(t,e,a,s,l,c);a.transmission>0?n.unshift(h):!0===a.transparent?r.unshift(h):i.unshift(h)},finish:function(){for(let i=e,n=t.length;i<n;i++){const e=t[i];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){i.length>1&&i.sort(t||La),n.length>1&&n.sort(e||Da),r.length>1&&r.sort(e||Da)}}}let Fa=0;function Ga(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Na(t,e){const i=new function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new gi,color:new oi};break;case"SpotLight":i={position:new gi,direction:new gi,color:new oi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new gi,color:new oi,distance:0,decay:0};break;case"HemisphereLight":i={direction:new gi,skyColor:new oi,groundColor:new oi};break;case"RectAreaLight":i={color:new oi,position:new gi,halfWidth:new gi,halfHeight:new gi}}return t[e.id]=i,i}}},n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new je};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new je,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=i,i}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new gi);const o=new gi,a=new Xi,s=new Xi;return{setup:function(o,a){let s=0,l=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0;o.sort(Ga);const y=!0!==a?Math.PI:1;for(let t=0,e=o.length;t<e;t++){const e=o[t],a=e.color,b=e.intensity,v=e.distance,w=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=a.r*b*y,l+=a.g*b*y,c+=a.b*b*y;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],b);else if(e.isDirectionalLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,r.directionalShadow[h]=i,r.directionalShadowMap[h]=w,r.directionalShadowMatrix[h]=e.shadow.matrix,m++}r.directional[h]=t,h++}else if(e.isSpotLight){const t=i.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(b*y),t.distance=v,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,r.spotShadow[d]=i,r.spotShadowMap[d]=w,r.spotShadowMatrix[d]=e.shadow.matrix,g++}r.spot[d]=t,d++}else if(e.isRectAreaLight){const t=i.get(e);t.color.copy(a).multiplyScalar(b),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[f]=t,f++}else if(e.isPointLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,i.shadowCameraNear=t.camera.near,i.shadowCameraFar=t.camera.far,r.pointShadow[u]=i,r.pointShadowMap[u]=w,r.pointShadowMatrix[u]=e.shadow.matrix,_++}r.point[u]=t,u++}else if(e.isHemisphereLight){const t=i.get(e);t.skyColor.copy(e.color).multiplyScalar(b*y),t.groundColor.copy(e.groundColor).multiplyScalar(b*y),r.hemi[p]=t,p++}}f>0&&(e.isWebGL2?(r.rectAreaLTC1=Nr.LTC_FLOAT_1,r.rectAreaLTC2=Nr.LTC_FLOAT_2):!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Nr.LTC_FLOAT_1,r.rectAreaLTC2=Nr.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Nr.LTC_HALF_1,r.rectAreaLTC2=Nr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=s,r.ambient[1]=l,r.ambient[2]=c;const b=r.hash;b.directionalLength===h&&b.pointLength===u&&b.spotLength===d&&b.rectAreaLength===f&&b.hemiLength===p&&b.numDirectionalShadows===m&&b.numPointShadows===_&&b.numSpotShadows===g||(r.directional.length=h,r.spot.length=d,r.rectArea.length=f,r.point.length=u,r.hemi.length=p,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=_,r.pointShadowMap.length=_,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=_,r.spotShadowMatrix.length=g,b.directionalLength=h,b.pointLength=u,b.spotLength=d,b.rectAreaLength=f,b.hemiLength=p,b.numDirectionalShadows=m,b.numPointShadows=_,b.numSpotShadows=g,r.version=Fa++)},setupView:function(t,e){let i=0,n=0,l=0,c=0,h=0;const u=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[i];t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(u),i++}else if(d.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(u),l++}else if(d.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),s.identity(),a.copy(d.matrixWorld),a.premultiply(u),s.extractRotation(a),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),c++}else if(d.isPointLight){const t=r.point[n];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),n++}else if(d.isHemisphereLight){const t=r.hemi[h];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(u),h++}}},state:r}}function za(t,e){const i=new Na(t,e),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:function(t){i.setup(n,t)},setupLightsView:function(t){i.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){r.push(t)}}}class Ua extends Bn{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=Ae,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Ua.prototype.isMeshDepthMaterial=!0;class Ha extends Bn{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new gi,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}Ha.prototype.isMeshDistanceMaterial=!0;const Va="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Wa="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function ja(t,e,i){let n=new Lr;const r=new je,o=new je,a=new di,s=new Ua({depthPacking:Se}),c=new Ha,p={},_=i.maxTextureSize,g={0:d,1:u,2:f},y=new vr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new je},radius:{value:4}},vertexShader:Va,fragmentShader:Wa}),b=y.clone();b.defines.HORIZONTAL_PASS=1;const v=new Xn;v.setAttribute("position",new Fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const w=new dr(v,y),x=this;function A(i,n){const r=e.update(w);y.defines.VSM_SAMPLES!==i.blurSamples&&(y.defines.VSM_SAMPLES=i.blurSamples,b.defines.VSM_SAMPLES=i.blurSamples,y.needsUpdate=!0,b.needsUpdate=!0),y.uniforms.shadow_pass.value=i.map.texture,y.uniforms.resolution.value=i.mapSize,y.uniforms.radius.value=i.radius,t.setRenderTarget(i.mapPass),t.clear(),t.renderBufferDirect(n,null,r,y,w,null),b.uniforms.shadow_pass.value=i.mapPass.texture,b.uniforms.resolution.value=i.mapSize,b.uniforms.radius.value=i.radius,t.setRenderTarget(i.map),t.clear(),t.renderBufferDirect(n,null,r,b,w,null)}function S(e,i,n,r,o,a){let l=null;const u=!0===n.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(l=void 0!==u?u:!0===n.isPointLight?c:s,t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0){const t=l.uuid,e=i.uuid;let n=p[t];void 0===n&&(n={},p[t]=n);let r=n[e];void 0===r&&(r=l.clone(),n[e]=r),l=r}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=a===h?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:g[i.side],l.alphaMap=i.alphaMap,l.alphaTest=i.alphaTest,l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.displacementMap=i.displacementMap,l.displacementScale=i.displacementScale,l.displacementBias=i.displacementBias,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===n.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(n.matrixWorld),l.nearDistance=r,l.farDistance=o),l}function M(i,r,o,a,s){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&s===h)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);const n=e.update(i),r=i.material;if(Array.isArray(r)){const e=n.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],h=r[c.materialIndex];if(h&&h.visible){const e=S(i,h,a,o.near,o.far,s);t.renderBufferDirect(o,null,n,e,i,c)}}}else if(r.visible){const e=S(i,r,a,o.near,o.far,s);t.renderBufferDirect(o,null,n,e,i,null)}}const l=i.children;for(let t=0,e=l.length;t<e;t++)M(l[t],r,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=l,this.render=function(e,i,s){if(!1===x.enabled)return;if(!1===x.autoUpdate&&!1===x.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(m),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=e.length;l<c;l++){const c=e[l],u=c.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;r.copy(u.mapSize);const f=u.getFrameExtents();if(r.multiply(f),o.copy(u.mapSize),(r.x>_||r.y>_)&&(r.x>_&&(o.x=Math.floor(_/f.x),r.x=o.x*f.x,u.mapSize.x=o.x),r.y>_&&(o.y=Math.floor(_/f.y),r.y=o.y*f.y,u.mapSize.y=o.y)),null!==u.map||u.isPointLightShadow||this.type!==h||(u.map=new fi(r.x,r.y),u.map.texture.name=c.name+".shadowMap",u.mapPass=new fi(r.x,r.y),u.camera.updateProjectionMatrix()),null===u.map){const t={minFilter:ct,magFilter:ct,format:kt};u.map=new fi(r.x,r.y,t),u.map.texture.name=c.name+".shadowMap",u.camera.updateProjectionMatrix()}t.setRenderTarget(u.map),t.clear();const p=u.getViewportCount();for(let t=0;t<p;t++){const e=u.getViewport(t);a.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),d.viewport(a),u.updateMatrices(c,t),n=u.getFrustum(),M(i,s,u.camera,c,this.type)}u.isPointLightShadow||this.type!==h||A(u,s),u.needsUpdate=!1}x.needsUpdate=!1,t.setRenderTarget(l,c,u)}}function Za(t,e,i,n,r,o,a){const s=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const _=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function y(t,e){return g?new OffscreenCanvas(t,e):Xe("canvas")}function b(t,e,i,n){let r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=e?We:Math.floor,o=n(r*t.width),a=n(r*t.height);void 0===m&&(m=y(o,a));const s=i?y(o,a):m;return s.width=o,s.height=a,s.getContext("2d").drawImage(t,0,0,o,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+a+")."),s}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function v(t){return Ve(t.width)&&Ve(t.height)}function w(t,e){return t.generateMipmaps&&e&&t.minFilter!==ct&&t.minFilter!==dt}function x(e){t.generateMipmap(e)}function A(i,n,r,o,a=!1){if(!1===s)return n;if(null!==i){if(void 0!==t[i])return t[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let l=n;return 6403===n&&(5126===r&&(l=33326),5131===r&&(l=33325),5121===r&&(l=33321)),33319===n&&(5126===r&&(l=33328),5131===r&&(l=33327),5121===r&&(l=33323)),6408===n&&(5126===r&&(l=34836),5131===r&&(l=34842),5121===r&&(l=o===xe&&!1===a?35907:32856),32819===r&&(l=32854),32820===r&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||e.get("EXT_color_buffer_float"),l}function S(t,e,i){return!0===w(t,i)||t.isFramebufferTexture&&t.minFilter!==ct&&t.minFilter!==dt?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function M(t){return t===ct||t===ht||t===ut?9728:9729}function E(t){const e=t.target;e.removeEventListener("dispose",E),function(t){const e=n.get(t);if(void 0===e.__webglInit)return;const i=t.source,r=_.get(i);if(r){const n=r[e.__cacheKey];n.usedTimes--,0===n.usedTimes&&k(t),0===Object.keys(r).length&&_.delete(i)}n.remove(t)}(e),e.isVideoTexture&&p.delete(e)}function T(e){const i=e.target;i.removeEventListener("dispose",T),function(e){const i=e.texture,r=n.get(e),o=n.get(i);void 0!==o.__webglTexture&&(t.deleteTexture(o.__webglTexture),a.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,r=i.length;e<r;e++){const r=n.get(i[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),a.memory.textures--),n.remove(i[e])}n.remove(i),n.remove(e)}(i)}function k(e){const i=n.get(e);t.deleteTexture(i.__webglTexture);const r=e.source;delete _.get(r)[i.__cacheKey],a.memory.textures--}let C=0;function I(t,e){const r=n.get(t);if(t.isVideoTexture&&function(t){const e=a.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&r.__version!==t.version){const i=t.image;if(null===i)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==i.complete)return void D(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+e),i.bindTexture(3553,r.__webglTexture)}const P={[at]:10497,[st]:33071,[lt]:33648},R={[ct]:9728,[ht]:9984,[ut]:9986,[dt]:9729,[ft]:9985,[pt]:9987};function B(i,o,a){if(a?(t.texParameteri(i,10242,P[o.wrapS]),t.texParameteri(i,10243,P[o.wrapT]),32879!==i&&35866!==i||t.texParameteri(i,32882,P[o.wrapR]),t.texParameteri(i,10240,R[o.magFilter]),t.texParameteri(i,10241,R[o.minFilter])):(t.texParameteri(i,10242,33071),t.texParameteri(i,10243,33071),32879!==i&&35866!==i||t.texParameteri(i,32882,33071),o.wrapS===st&&o.wrapT===st||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(i,10240,M(o.magFilter)),t.texParameteri(i,10241,M(o.minFilter)),o.minFilter!==ct&&o.minFilter!==dt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(o.type===wt&&!1===e.has("OES_texture_float_linear"))return;if(!1===s&&o.type===xt&&!1===e.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(t.texParameterf(i,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function L(e,i){let n=!1;void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",E));const r=i.source;let o=_.get(r);void 0===o&&(o={},_.set(r,o));const s=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}(i);if(s!==e.__cacheKey){void 0===o[s]&&(o[s]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,n=!0),o[s].usedTimes++;const r=o[e.__cacheKey];void 0!==r&&(o[e.__cacheKey].usedTimes--,0===r.usedTimes&&k(i)),e.__cacheKey=s,e.__webglTexture=o[s].texture}return n}function D(e,n,r){let a=3553;n.isDataArrayTexture&&(a=35866),n.isData3DTexture&&(a=32879);const l=L(e,n),c=n.source;if(i.activeTexture(33984+r),i.bindTexture(a,e.__webglTexture),c.version!==c.__currentVersion||!0===l){t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment),t.pixelStorei(37443,0);const r=function(t){return!s&&(t.wrapS!==st||t.wrapT!==st||t.minFilter!==ct&&t.minFilter!==dt)}(n)&&!1===v(n.image);let u=b(n.image,r,!1,h);const d=v(u=U(n,u))||s,f=o.convert(n.format,n.encoding);let p,m=o.convert(n.type),_=A(n.internalFormat,f,m,n.encoding,n.isVideoTexture);B(a,n,d);const g=n.mipmaps,y=s&&!0!==n.isVideoTexture,M=void 0===e.__version||!0===l,E=S(n,u,d);if(n.isDepthTexture)_=6402,s?_=n.type===wt?36012:n.type===vt?33190:n.type===Mt?35056:33189:n.type===wt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===Pt&&6402===_&&n.type!==yt&&n.type!==vt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=yt,m=o.convert(n.type)),n.format===Rt&&6402===_&&(_=34041,n.type!==Mt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Mt,m=o.convert(n.type))),M&&(y?i.texStorage2D(3553,1,_,u.width,u.height):i.texImage2D(3553,0,_,u.width,u.height,0,f,m,null));else if(n.isDataTexture)if(g.length>0&&d){y&&M&&i.texStorage2D(3553,E,_,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],y?i.texSubImage2D(3553,t,0,0,p.width,p.height,f,m,p.data):i.texImage2D(3553,t,_,p.width,p.height,0,f,m,p.data);n.generateMipmaps=!1}else y?(M&&i.texStorage2D(3553,E,_,u.width,u.height),i.texSubImage2D(3553,0,0,0,u.width,u.height,f,m,u.data)):i.texImage2D(3553,0,_,u.width,u.height,0,f,m,u.data);else if(n.isCompressedTexture){y&&M&&i.texStorage2D(3553,E,_,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],n.format!==kt?null!==f?y?i.compressedTexSubImage2D(3553,t,0,0,p.width,p.height,f,p.data):i.compressedTexImage2D(3553,t,_,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):y?i.texSubImage2D(3553,t,0,0,p.width,p.height,f,m,p.data):i.texImage2D(3553,t,_,p.width,p.height,0,f,m,p.data)}else if(n.isDataArrayTexture)y?(M&&i.texStorage3D(35866,E,_,u.width,u.height,u.depth),i.texSubImage3D(35866,0,0,0,0,u.width,u.height,u.depth,f,m,u.data)):i.texImage3D(35866,0,_,u.width,u.height,u.depth,0,f,m,u.data);else if(n.isData3DTexture)y?(M&&i.texStorage3D(32879,E,_,u.width,u.height,u.depth),i.texSubImage3D(32879,0,0,0,0,u.width,u.height,u.depth,f,m,u.data)):i.texImage3D(32879,0,_,u.width,u.height,u.depth,0,f,m,u.data);else if(n.isFramebufferTexture){if(M)if(y)i.texStorage2D(3553,E,_,u.width,u.height);else{let t=u.width,e=u.height;for(let n=0;n<E;n++)i.texImage2D(3553,n,_,t,e,0,f,m,null),t>>=1,e>>=1}}else if(g.length>0&&d){y&&M&&i.texStorage2D(3553,E,_,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],y?i.texSubImage2D(3553,t,0,0,f,m,p):i.texImage2D(3553,t,_,f,m,p);n.generateMipmaps=!1}else y?(M&&i.texStorage2D(3553,E,_,u.width,u.height),i.texSubImage2D(3553,0,0,0,f,m,u)):i.texImage2D(3553,0,_,f,m,u);w(n,d)&&x(a),c.__currentVersion=c.version,n.onUpdate&&n.onUpdate(n)}e.__version=n.version}function O(e,r,a,s,l){const c=o.convert(a.format,a.encoding),h=o.convert(a.type),u=A(a.internalFormat,c,h,a.encoding);n.get(r).__hasExternalTextures||(32879===l||35866===l?i.texImage3D(l,0,u,r.width,r.height,r.depth,0,c,h,null):i.texImage2D(l,0,u,r.width,r.height,0,c,h,null)),i.bindFramebuffer(36160,e),z(r)?d.framebufferTexture2DMultisampleEXT(36160,s,l,n.get(a).__webglTexture,0,N(r)):t.framebufferTexture2D(36160,s,l,n.get(a).__webglTexture,0),i.bindFramebuffer(36160,null)}function F(e,i,n){if(t.bindRenderbuffer(36161,e),i.depthBuffer&&!i.stencilBuffer){let r=33189;if(n||z(i)){const e=i.depthTexture;e&&e.isDepthTexture&&(e.type===wt?r=36012:e.type===vt&&(r=33190));const n=N(i);z(i)?d.renderbufferStorageMultisampleEXT(36161,n,r,i.width,i.height):t.renderbufferStorageMultisample(36161,n,r,i.width,i.height)}else t.renderbufferStorage(36161,r,i.width,i.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(i.depthBuffer&&i.stencilBuffer){const r=N(i);n&&!1===z(i)?t.renderbufferStorageMultisample(36161,r,35056,i.width,i.height):z(i)?d.renderbufferStorageMultisampleEXT(36161,r,35056,i.width,i.height):t.renderbufferStorage(36161,34041,i.width,i.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===i.isWebGLMultipleRenderTargets?i.texture[0]:i.texture,r=o.convert(e.format,e.encoding),a=o.convert(e.type),s=A(e.internalFormat,r,a,e.encoding),l=N(i);n&&!1===z(i)?t.renderbufferStorageMultisample(36161,l,s,i.width,i.height):z(i)?d.renderbufferStorageMultisampleEXT(36161,l,s,i.width,i.height):t.renderbufferStorage(36161,s,i.width,i.height)}t.bindRenderbuffer(36161,null)}function G(e){const r=n.get(e),o=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),I(r.depthTexture,0);const o=n.get(r.depthTexture).__webglTexture,a=N(r);if(r.depthTexture.format===Pt)z(r)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,a):t.framebufferTexture2D(36160,36096,3553,o,0);else{if(r.depthTexture.format!==Rt)throw new Error("Unknown depthTexture format");z(r)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,a):t.framebufferTexture2D(36160,33306,3553,o,0)}}(r.__webglFramebuffer,e)}else if(o){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)i.bindFramebuffer(36160,r.__webglFramebuffer[n]),r.__webglDepthbuffer[n]=t.createRenderbuffer(),F(r.__webglDepthbuffer[n],e,!1)}else i.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),F(r.__webglDepthbuffer,e,!1);i.bindFramebuffer(36160,null)}function N(t){return Math.min(u,t.samples)}function z(t){const i=n.get(t);return s&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function U(t,i){const n=t.encoding,r=t.format,o=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===Le?i:(n!==we&&(n===xe?!1===s?!0===e.has("EXT_sRGB")&&r===kt?(t.format=Le,t.minFilter=dt,t.generateMipmaps=!1):i=si.sRGBToLinear(i):r===kt&&o===mt||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",n)),i)}this.allocateTextureUnit=function(){const t=C;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),C+=1,t},this.resetTextureUnits=function(){C=0},this.setTexture2D=I,this.setTexture2DArray=function(t,e){const r=n.get(t);t.version>0&&r.__version!==t.version?D(r,t,e):(i.activeTexture(33984+e),i.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=n.get(t);t.version>0&&r.__version!==t.version?D(r,t,e):(i.activeTexture(33984+e),i.bindTexture(32879,r.__webglTexture))},this.setTextureCube=function(e,r){const a=n.get(e);e.version>0&&a.__version!==e.version?function(e,n,r){if(6!==n.image.length)return;const a=L(e,n),l=n.source;if(i.activeTexture(33984+r),i.bindTexture(34067,e.__webglTexture),l.version!==l.__currentVersion||!0===a){t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment),t.pixelStorei(37443,0);const r=n.isCompressedTexture||n.image[0].isCompressedTexture,a=n.image[0]&&n.image[0].isDataTexture,h=[];for(let t=0;t<6;t++)h[t]=r||a?a?n.image[t].image:n.image[t]:b(n.image[t],!1,!0,c),h[t]=U(n,h[t]);const u=h[0],d=v(u)||s,f=o.convert(n.format,n.encoding),p=o.convert(n.type),m=A(n.internalFormat,f,p,n.encoding),_=s&&!0!==n.isVideoTexture,g=void 0===e.__version;let y,M=S(n,u,d);if(B(34067,n,d),r){_&&g&&i.texStorage2D(34067,M,m,u.width,u.height);for(let t=0;t<6;t++){y=h[t].mipmaps;for(let e=0;e<y.length;e++){const r=y[e];n.format!==kt?null!==f?_?i.compressedTexSubImage2D(34069+t,e,0,0,r.width,r.height,f,r.data):i.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_?i.texSubImage2D(34069+t,e,0,0,r.width,r.height,f,p,r.data):i.texImage2D(34069+t,e,m,r.width,r.height,0,f,p,r.data)}}}else{y=n.mipmaps,_&&g&&(y.length>0&&M++,i.texStorage2D(34067,M,m,h[0].width,h[0].height));for(let t=0;t<6;t++)if(a){_?i.texSubImage2D(34069+t,0,0,0,h[t].width,h[t].height,f,p,h[t].data):i.texImage2D(34069+t,0,m,h[t].width,h[t].height,0,f,p,h[t].data);for(let e=0;e<y.length;e++){const n=y[e],r=n.image[t].image;_?i.texSubImage2D(34069+t,e+1,0,0,r.width,r.height,f,p,r.data):i.texImage2D(34069+t,e+1,m,r.width,r.height,0,f,p,r.data)}}else{_?i.texSubImage2D(34069+t,0,0,0,f,p,h[t]):i.texImage2D(34069+t,0,m,f,p,h[t]);for(let e=0;e<y.length;e++){const n=y[e];_?i.texSubImage2D(34069+t,e+1,0,0,f,p,n.image[t]):i.texImage2D(34069+t,e+1,m,f,p,n.image[t])}}}w(n,d)&&x(34067),l.__currentVersion=l.version,n.onUpdate&&n.onUpdate(n)}e.__version=n.version}(a,e,r):(i.activeTexture(33984+r),i.bindTexture(34067,a.__webglTexture))},this.rebindTextures=function(t,e,i){const r=n.get(t);void 0!==e&&O(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==i&&G(t)},this.setupRenderTarget=function(e){const l=e.texture,c=n.get(e),h=n.get(l);e.addEventListener("dispose",T),!0!==e.isWebGLMultipleRenderTargets&&(void 0===h.__webglTexture&&(h.__webglTexture=t.createTexture()),h.__version=l.version,a.memory.textures++);const u=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,f=v(e)||s;if(u){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers){const i=e.texture;for(let e=0,r=i.length;e<r;e++){const r=n.get(i[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(s&&e.samples>0&&!1===z(e)){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const n=o.convert(l.format,l.encoding),r=o.convert(l.type),a=A(l.internalFormat,n,r,l.encoding),s=N(e);t.renderbufferStorageMultisample(36161,s,a,e.width,e.height),i.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),F(c.__webglDepthRenderbuffer,e,!0)),i.bindFramebuffer(36160,null)}if(u){i.bindTexture(34067,h.__webglTexture),B(34067,l,f);for(let t=0;t<6;t++)O(c.__webglFramebuffer[t],e,l,36064,34069+t);w(l,f)&&x(34067),i.unbindTexture()}else if(d){const t=e.texture;for(let r=0,o=t.length;r<o;r++){const o=t[r],a=n.get(o);i.bindTexture(3553,a.__webglTexture),B(3553,o,f),O(c.__webglFramebuffer,e,o,36064+r,3553),w(o,f)&&x(3553)}i.unbindTexture()}else{let t=3553;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(s?t=e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(t,h.__webglTexture),B(t,l,f),O(c.__webglFramebuffer,e,l,36064,t),w(l,f)&&x(t),i.unbindTexture()}e.depthBuffer&&G(e)},this.updateRenderTargetMipmap=function(t){const e=v(t)||s,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let o=0,a=r.length;o<a;o++){const a=r[o];if(w(a,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=n.get(a).__webglTexture;i.bindTexture(e,r),x(e),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(s&&e.samples>0&&!1===z(e)){const r=e.width,o=e.height;let a=16384;const s=[36064],l=e.stencilBuffer?33306:36096;e.depthBuffer&&s.push(l);const c=n.get(e),h=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;!1===h&&(e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024)),i.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,c.__webglFramebuffer),!0===h&&(t.invalidateFramebuffer(36008,[l]),t.invalidateFramebuffer(36009,[l])),t.blitFramebuffer(0,0,r,o,0,0,r,o,a,9728),f&&t.invalidateFramebuffer(36008,s),i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=G,this.setupFrameBufferTexture=O,this.useMultisampledRTT=z}class Ya extends xr{constructor(t=[]){super(),this.cameras=t}}Ya.prototype.isArrayCamera=!0;class Xa extends vn{constructor(){super(),this.type="Group"}}Xa.prototype.isGroup=!0;const Ja={type:"move"};class Qa{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Xa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Xa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new gi,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new gi),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Xa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new gi,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new gi),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,i){let n=null,r=null,o=null;const a=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==a&&null!==(n=e.getPose(t.targetRaySpace,i))&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Ja)),l&&t.hand){o=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,i);if(void 0===l.joints[n.jointName]){const t=new Xa;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[n.jointName]=t,l.add(t)}const r=l.joints[n.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const n=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=n.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&a>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&null!==(r=e.getPose(t.gripSpace,i))&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1);return null!==a&&(a.visible=null!==n),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==o),this}}class qa extends ui{constructor(t,e,i,n,r,o,a,s,l,c){if((c=void 0!==c?c:Pt)!==Pt&&c!==Rt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===Pt&&(i=yt),void 0===i&&c===Rt&&(i=Mt),super(null,n,r,o,a,s,c,i,l),this.image={width:t,height:e},this.magFilter=void 0!==a?a:ct,this.minFilter=void 0!==s?s:ct,this.flipY=!1,this.generateMipmaps=!1}}qa.prototype.isDepthTexture=!0;class Ka extends De{constructor(t,e){super();const i=this;let n=null,r=1,o=null,a="local-floor",s=null,l=null,c=null,h=null,u=null,d=null;const f=e.getContextAttributes();let p=null,m=null;const _=[],g=new Map,y=new xr;y.layers.enable(1),y.viewport=new di;const b=new xr;b.layers.enable(2),b.viewport=new di;const v=[y,b],w=new Ya;w.layers.enable(1),w.layers.enable(2);let x=null,A=null;function S(t){const e=g.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function M(){g.forEach(function(t,e){t.disconnect(e)}),g.clear(),x=null,A=null,t.setRenderTarget(p),u=null,h=null,c=null,n=null,m=null,P.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function E(t){const e=n.inputSources;for(let t=0;t<e.length;t++){const i="right"===e[t].handedness?1:0;g.set(e[t],_[i])}for(let e=0;e<t.removed.length;e++){const i=t.removed[e],n=g.get(i);n&&(n.dispatchEvent({type:"disconnected",data:i}),g.delete(i))}for(let e=0;e<t.added.length;e++){const i=t.added[e],n=g.get(i);n&&n.dispatchEvent({type:"connected",data:i})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=_[t];return void 0===e&&(e=new Qa,_[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=_[t];return void 0===e&&(e=new Qa,_[t]=e),e.getGripSpace()},this.getHand=function(t){let e=_[t];return void 0===e&&(e=new Qa,_[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s||o},this.setReferenceSpace=function(t){s=t},this.getBaseLayer=function(){return null!==h?h:u},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return n},this.setSession=async function(s){if(null!==(n=s)){if(p=t.getRenderTarget(),n.addEventListener("select",S),n.addEventListener("selectstart",S),n.addEventListener("selectend",S),n.addEventListener("squeeze",S),n.addEventListener("squeezestart",S),n.addEventListener("squeezeend",S),n.addEventListener("end",M),n.addEventListener("inputsourceschange",E),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===n.renderState.layers||!1===t.capabilities.isWebGL2){const i={antialias:void 0!==n.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};u=new XRWebGLLayer(n,e,i),n.updateRenderState({baseLayer:u}),m=new fi(u.framebufferWidth,u.framebufferHeight,{format:kt,type:mt,encoding:t.outputEncoding})}else{let i=null,o=null,a=null;f.depth&&(a=f.stencil?35056:33190,i=f.stencil?Rt:Pt,o=f.stencil?Mt:yt);const s={colorFormat:t.outputEncoding===xe?35907:32856,depthFormat:a,scaleFactor:r};c=new XRWebGLBinding(n,e),h=c.createProjectionLayer(s),n.updateRenderState({layers:[h]}),m=new fi(h.textureWidth,h.textureHeight,{format:kt,type:mt,depthTexture:new qa(h.textureWidth,h.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:f.stencil,encoding:t.outputEncoding,samples:f.antialias?4:0}),t.properties.get(m).__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),o=await n.requestReferenceSpace(a),P.setContext(n),P.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};const T=new gi,k=new gi;function C(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===n)return;w.near=b.near=y.near=t.near,w.far=b.far=y.far=t.far,x===w.near&&A===w.far||(n.updateRenderState({depthNear:w.near,depthFar:w.far}),x=w.near,A=w.far);const e=t.parent,i=w.cameras;C(w,e);for(let t=0;t<i.length;t++)C(i[t],e);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),t.position.copy(w.position),t.quaternion.copy(w.quaternion),t.scale.copy(w.scale),t.matrix.copy(w.matrix),t.matrixWorld.copy(w.matrixWorld);const r=t.children;for(let t=0,e=r.length;t<e;t++)r[t].updateMatrixWorld(!0);2===i.length?function(t,e,i){T.setFromMatrixPosition(e.matrixWorld),k.setFromMatrixPosition(i.matrixWorld);const n=T.distanceTo(k),r=e.projectionMatrix.elements,o=i.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(o[8]+1)/o[0],d=a*h,f=a*u,p=n/(-h+u),m=p*-h;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const _=a+p,g=s+p,y=d-m,b=f+(n-m),v=l*s/g*_,w=c*s/g*_;t.projectionMatrix.makePerspective(y,b,v,w,_,g)}(w,y,b):w.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==u?u.fixedFoveation:void 0},this.setFoveation=function(t){null!==h&&(h.fixedFoveation=t),null!==u&&void 0!==u.fixedFoveation&&(u.fixedFoveation=t)};let I=null;const P=new Dr;P.setAnimationLoop(function(e,i){if(l=i.getViewerPose(s||o),d=i,null!==l){const e=l.views;null!==u&&(t.setRenderTargetFramebuffer(m,u.framebuffer),t.setRenderTarget(m));let i=!1;e.length!==w.cameras.length&&(w.cameras.length=0,i=!0);for(let n=0;n<e.length;n++){const r=e[n];let o=null;if(null!==u)o=u.getViewport(r);else{const e=c.getViewSubImage(h,r);o=e.viewport,0===n&&(t.setRenderTargetTextures(m,e.colorTexture,h.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(m))}const a=v[n];a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===n&&w.matrix.copy(a.matrix),!0===i&&w.cameras.push(a)}}const r=n.inputSources;for(let t=0;t<_.length;t++){const e=r[t],n=g.get(e);void 0!==n&&n.update(e,i,s||o)}I&&I(e,i),d=null}),this.setAnimationLoop=function(t){I=t},this.dispose=function(){}}}function $a(t,e){function i(i,n){i.opacity.value=n.opacity,n.color&&i.diffuse.value.copy(n.color),n.emissive&&i.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(i.map.value=n.map),n.alphaMap&&(i.alphaMap.value=n.alphaMap),n.bumpMap&&(i.bumpMap.value=n.bumpMap,i.bumpScale.value=n.bumpScale,n.side===d&&(i.bumpScale.value*=-1)),n.displacementMap&&(i.displacementMap.value=n.displacementMap,i.displacementScale.value=n.displacementScale,i.displacementBias.value=n.displacementBias),n.emissiveMap&&(i.emissiveMap.value=n.emissiveMap),n.normalMap&&(i.normalMap.value=n.normalMap,i.normalScale.value.copy(n.normalScale),n.side===d&&i.normalScale.value.negate()),n.specularMap&&(i.specularMap.value=n.specularMap),n.alphaTest>0&&(i.alphaTest.value=n.alphaTest);const r=e.get(n).envMap;if(r&&(i.envMap.value=r,i.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,i.reflectivity.value=n.reflectivity,i.ior.value=n.ior,i.refractionRatio.value=n.refractionRatio),n.lightMap){i.lightMap.value=n.lightMap;const e=!0!==t.physicallyCorrectLights?Math.PI:1;i.lightMapIntensity.value=n.lightMapIntensity*e}let o,a;n.aoMap&&(i.aoMap.value=n.aoMap,i.aoMapIntensity.value=n.aoMapIntensity),n.map?o=n.map:n.specularMap?o=n.specularMap:n.displacementMap?o=n.displacementMap:n.normalMap?o=n.normalMap:n.bumpMap?o=n.bumpMap:n.roughnessMap?o=n.roughnessMap:n.metalnessMap?o=n.metalnessMap:n.alphaMap?o=n.alphaMap:n.emissiveMap?o=n.emissiveMap:n.clearcoatMap?o=n.clearcoatMap:n.clearcoatNormalMap?o=n.clearcoatNormalMap:n.clearcoatRoughnessMap?o=n.clearcoatRoughnessMap:n.specularIntensityMap?o=n.specularIntensityMap:n.specularColorMap?o=n.specularColorMap:n.transmissionMap?o=n.transmissionMap:n.thicknessMap?o=n.thicknessMap:n.sheenColorMap?o=n.sheenColorMap:n.sheenRoughnessMap&&(o=n.sheenRoughnessMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),i.uvTransform.value.copy(o.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),i.uv2Transform.value.copy(a.matrix))}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,n,r,o,a){n.isMeshBasicMaterial?i(t,n):n.isMeshLambertMaterial?i(t,n):n.isMeshToonMaterial?(i(t,n),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,n)):n.isMeshPhongMaterial?(i(t,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,n)):n.isMeshStandardMaterial?(i(t,n),function(t,i){t.roughness.value=i.roughness,t.metalness.value=i.metalness,i.roughnessMap&&(t.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(t.metalnessMap.value=i.metalnessMap),e.get(i).envMap&&(t.envMapIntensity.value=i.envMapIntensity)}(t,n),n.isMeshPhysicalMaterial&&function(t,e,i){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===d&&t.clearcoatNormalScale.value.negate())),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,n,a)):n.isMeshMatcapMaterial?(i(t,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,n)):n.isMeshDepthMaterial?i(t,n):n.isMeshDistanceMaterial?(i(t,n),function(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,n)):n.isMeshNormalMaterial?i(t,n):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,n)):n.isPointsMaterial?function(t,e,i,n){let r;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*i,t.scale.value=.5*n,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,n,r,o):n.isSpriteMaterial?function(t,e){let i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,n):n.isShadowMaterial?(t.color.value.copy(n.color),t.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function ts(t={}){const e=void 0!==t.canvas?t.canvas:function(){const t=Xe("canvas");return t.style.display="block",t}(),i=void 0!==t.context?t.context:null,r=void 0===t.depth||t.depth,l=void 0===t.stencil||t.stencil,c=void 0!==t.antialias&&t.antialias,h=void 0===t.premultipliedAlpha||t.premultipliedAlpha,p=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,j=void 0!==t.powerPreference?t.powerPreference:"default",Z=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let Y;Y=null!==i?i.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let J=null,Q=null;const q=[],K=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=we,this.physicallyCorrectLights=!1,this.toneMapping=X,this.toneMappingExposure=1;const $=this;let tt=!1,at=0,st=0,lt=null,ct=-1,ht=null;const ut=new di,dt=new di;let ft=null,he=e.width,ue=e.height,de=1,fe=null,pe=null;const me=new di(0,0,he,ue),_e=new di(0,0,he,ue);let ge=!1;const ye=new Lr;let be=!1,ve=!1,Ae=null;const Se=new Xi,Me=new je,Ee=new gi,Te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ke(){return null===lt?de:1}let Ce,Ie,Pe,Re,Be,De,Oe,Fe,Ge,Ne,ze,Ue,He,Ve,Je,Qe,qe,Ke,$e,ti,ei,ii,ni,ri=i;function ai(t,i){for(let n=0;n<t.length;n++){const r=t[n],o=e.getContext(r,i);if(null!==o)return o}return null}try{const t={alpha:!0,depth:r,stencil:l,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:j,failIfMajorPerformanceCaveat:Z};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${n}`),e.addEventListener("webglcontextlost",ci,!1),e.addEventListener("webglcontextrestored",hi,!1),null===ri){const e=["webgl2","webgl","experimental-webgl"];if(!0===$.isWebGL1Renderer&&e.shift(),null===(ri=ai(e,t)))throw ai(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ri.getShaderPrecisionFormat&&(ri.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function si(){Ce=new function(t){const e={};function i(i){if(void 0!==e[i])return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return{has:function(t){return null!==i(t)},init:function(t){t.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(t){const e=i(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}(ri),Ie=new function(t,e,i){let n;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==i.precision?i.precision:"highp";const s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const l=o||e.has("WEBGL_draw_buffers"),c=!0===i.logarithmicDepthBuffer,h=t.getParameter(34930),u=t.getParameter(35660),d=t.getParameter(3379),f=t.getParameter(34076),p=t.getParameter(34921),m=t.getParameter(36347),_=t.getParameter(36348),g=t.getParameter(36349),y=u>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const i=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:u,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:_,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?t.getParameter(36183):0}}(ri,Ce,t),Ce.init(Ie),ii=new function(t,e,i){const n=i.isWebGL2;return{convert:function(i,r=null){let o;if(i===mt)return 5121;if(i===At)return 32819;if(i===St)return 32820;if(i===_t)return 5120;if(i===gt)return 5122;if(i===yt)return 5123;if(i===bt)return 5124;if(i===vt)return 5125;if(i===wt)return 5126;if(i===xt)return n?5131:null!==(o=e.get("OES_texture_half_float"))?o.HALF_FLOAT_OES:null;if(i===Et)return 6406;if(i===kt)return 6408;if(i===Ct)return 6409;if(i===It)return 6410;if(i===Pt)return 6402;if(i===Rt)return 34041;if(i===Bt)return 6403;if(i===Tt)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(i===Le)return null!==(o=e.get("EXT_sRGB"))?o.SRGB_ALPHA_EXT:null;if(i===Lt)return 36244;if(i===Dt)return 33319;if(i===Ot)return 33320;if(i===Ft)return 36249;if(i===Gt||i===Nt||i===zt||i===Ut)if(r===xe){if(null===(o=e.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(i===Gt)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Nt)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===zt)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Ut)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(o=e.get("WEBGL_compressed_texture_s3tc")))return null;if(i===Gt)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Nt)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===zt)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Ut)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(i===Ht||i===Vt||i===Wt||i===jt){if(null===(o=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(i===Ht)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Vt)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Wt)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===jt)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===Zt)return null!==(o=e.get("WEBGL_compressed_texture_etc1"))?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===Yt||i===Xt){if(null===(o=e.get("WEBGL_compressed_texture_etc")))return null;if(i===Yt)return r===xe?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===Xt)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(i===Jt||i===Qt||i===qt||i===Kt||i===$t||i===te||i===ee||i===ie||i===ne||i===re||i===oe||i===ae||i===se||i===le){if(null===(o=e.get("WEBGL_compressed_texture_astc")))return null;if(i===Jt)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Qt)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===qt)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Kt)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===$t)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===te)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===ee)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===ie)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===ne)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===re)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===oe)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===ae)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===se)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===le)return r===xe?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===ce){if(null===(o=e.get("EXT_texture_compression_bptc")))return null;if(i===ce)return r===xe?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}return i===Mt?n?34042:null!==(o=e.get("WEBGL_depth_texture"))?o.UNSIGNED_INT_24_8_WEBGL:null:void 0!==t[i]?t[i]:null}}}(ri,Ce,Ie),Pe=new function(t,e,i){const n=i.isWebGL2,r=new function(){let e=!1;const i=new di;let n=null;const r=new di(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,o,a,s){!0===s&&(e*=a,n*=a,o*=a),i.set(e,n,o,a),!1===r.equals(i)&&(t.clearColor(e,n,o,a),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}},l=new function(){let e=!1,i=null,n=null,r=null;return{setTest:function(t){t?bt(2929):vt(2929)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case F:t.depthFunc(512);break;case G:t.depthFunc(519);break;case N:t.depthFunc(513);break;case z:t.depthFunc(515);break;case U:t.depthFunc(514);break;case H:t.depthFunc(518);break;case V:t.depthFunc(516);break;case W:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}},c=new function(){let e=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(t){e||(t?bt(2960):vt(2960))},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,a){n===e&&r===i&&o===a||(t.stencilFunc(e,i,a),n=e,r=i,o=a)},setOp:function(e,i,n){a===e&&s===i&&l===n||(t.stencilOp(e,i,n),a=e,s=i,l=n)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,i=null,n=null,r=null,o=null,a=null,s=null,l=null,c=null}}};let h={},u={},p=new WeakMap,j=[],Z=null,Y=!1,X=null,J=null,Q=null,q=null,K=null,$=null,tt=null,et=!1,it=null,nt=null,rt=null,ot=null,at=null;const st=t.getParameter(35661);let lt=!1,ct=0;const ht=t.getParameter(7938);-1!==ht.indexOf("WebGL")?(ct=parseFloat(/^WebGL (\d)/.exec(ht)[1]),lt=ct>=1):-1!==ht.indexOf("OpenGL ES")&&(ct=parseFloat(/^OpenGL ES (\d)/.exec(ht)[1]),lt=ct>=2);let ut=null,dt={};const ft=t.getParameter(3088),pt=t.getParameter(2978),mt=(new di).fromArray(ft),_t=(new di).fromArray(pt);function gt(e,i,n){const r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<n;e++)t.texImage2D(i+e,0,6408,1,1,0,6408,5121,r);return o}const yt={};function bt(e){!0!==h[e]&&(t.enable(e),h[e]=!0)}function vt(e){!1!==h[e]&&(t.disable(e),h[e]=!1)}yt[3553]=gt(3553,3553,1),yt[34067]=gt(34067,34069,6),r.setClear(0,0,0,1),l.setClear(1),c.setClear(0),bt(2929),l.setFunc(z),St(!1),Mt(a),bt(2884),At(m);const wt={[w]:32774,[x]:32778,[A]:32779};if(n)wt[S]=32775,wt[M]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(wt[S]=t.MIN_EXT,wt[M]=t.MAX_EXT)}const xt={[E]:0,[T]:1,[k]:768,[I]:770,[O]:776,[L]:774,[R]:772,[C]:769,[P]:771,[D]:775,[B]:773};function At(e,i,n,r,o,a,s,l){if(e!==m){if(!1===Y&&(bt(3042),Y=!0),e===v)o=o||i,a=a||n,s=s||r,i===J&&o===K||(t.blendEquationSeparate(wt[i],wt[o]),J=i,K=o),n===Q&&r===q&&a===$&&s===tt||(t.blendFuncSeparate(xt[n],xt[r],xt[a],xt[s]),Q=n,q=r,$=a,tt=s),X=e,et=null;else if(e!==X||l!==et){if(J===w&&K===w||(t.blendEquation(32774),J=w,K=w),l)switch(e){case _:t.blendFuncSeparate(1,771,1,771);break;case g:t.blendFunc(1,1);break;case y:t.blendFuncSeparate(0,769,0,1);break;case b:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case _:t.blendFuncSeparate(770,771,1,771);break;case g:t.blendFunc(770,1);break;case y:t.blendFuncSeparate(0,769,0,1);break;case b:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}Q=null,q=null,$=null,tt=null,X=e,et=l}}else!0===Y&&(vt(3042),Y=!1)}function St(e){it!==e&&(e?t.frontFace(2304):t.frontFace(2305),it=e)}function Mt(e){e!==o?(bt(2884),e!==nt&&(e===a?t.cullFace(1029):e===s?t.cullFace(1028):t.cullFace(1032))):vt(2884),nt=e}function Et(e,i,n){e?(bt(32823),ot===i&&at===n||(t.polygonOffset(i,n),ot=i,at=n)):vt(32823)}function Tt(e){void 0===e&&(e=33984+st-1),ut!==e&&(t.activeTexture(e),ut=e)}return{buffers:{color:r,depth:l,stencil:c},enable:bt,disable:vt,bindFramebuffer:function(e,i){return u[e]!==i&&(t.bindFramebuffer(e,i),u[e]=i,n&&(36009===e&&(u[36160]=i),36160===e&&(u[36009]=i)),!0)},drawBuffers:function(n,r){let o=j,a=!1;if(n)if(void 0===(o=p.get(r))&&(o=[],p.set(r,o)),n.isWebGLMultipleRenderTargets){const t=n.texture;if(o.length!==t.length||36064!==o[0]){for(let e=0,i=t.length;e<i;e++)o[e]=36064+e;o.length=t.length,a=!0}}else 36064!==o[0]&&(o[0]=36064,a=!0);else 1029!==o[0]&&(o[0]=1029,a=!0);a&&(i.isWebGL2?t.drawBuffers(o):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(o))},useProgram:function(e){return Z!==e&&(t.useProgram(e),Z=e,!0)},setBlending:At,setMaterial:function(t,e){t.side===f?vt(2884):bt(2884);let i=t.side===d;e&&(i=!i),St(i),t.blending===_&&!1===t.transparent?At(m):At(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),l.setFunc(t.depthFunc),l.setTest(t.depthTest),l.setMask(t.depthWrite),r.setMask(t.colorWrite);const n=t.stencilWrite;c.setTest(n),n&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Et(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?bt(32926):vt(32926)},setFlipSided:St,setCullFace:Mt,setLineWidth:function(e){e!==rt&&(lt&&t.lineWidth(e),rt=e)},setPolygonOffset:Et,setScissorTest:function(t){t?bt(3089):vt(3089)},activeTexture:Tt,bindTexture:function(e,i){null===ut&&Tt();let n=dt[ut];void 0===n&&(n={type:void 0,texture:void 0},dt[ut]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||yt[e]),n.type=e,n.texture=i)},unbindTexture:function(){const e=dt[ut];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===mt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),mt.copy(e))},viewport:function(e){!1===_t.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),_t.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===n&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},ut=null,dt={},u={},p=new WeakMap,j=[],Z=null,Y=!1,X=null,J=null,Q=null,q=null,K=null,$=null,tt=null,et=!1,it=null,nt=null,rt=null,ot=null,at=null,mt.set(0,0,t.canvas.width,t.canvas.height),_t.set(0,0,t.canvas.width,t.canvas.height),r.reset(),l.reset(),c.reset()}}}(ri,Ce,Ie),Re=new function(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,i,n){switch(e.calls++,i){case 4:e.triangles+=n*(t/3);break;case 1:e.lines+=n*(t/2);break;case 3:e.lines+=n*(t-1);break;case 2:e.lines+=n*t;break;case 0:e.points+=n*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}(ri),Be=new function(){let t=new WeakMap;return{get:function(e){let i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i},remove:function(e){t.delete(e)},update:function(e,i,n){t.get(e)[i]=n},dispose:function(){t=new WeakMap}}},De=new Za(ri,Ce,Pe,Be,Ie,ii,Re),Oe=new function(t){let e=new WeakMap;function i(t,e){return e===nt?t.mapping=et:e===rt&&(t.mapping=it),t}function n(t){const i=t.target;i.removeEventListener("dispose",n);const r=e.get(i);void 0!==r&&(e.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const o=r.mapping;if(o===nt||o===rt){if(e.has(r))return i(e.get(r).texture,r.mapping);{const o=r.image;if(o&&o.height>0){const a=new Tr(o.height/2);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",n),i(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}($),Fe=new ro($),Ge=new Or(ri,Ie),ni=new Ur(ri,Ce,Ge,Ie),Ne=new function(t,e,i,n){const r={},o=new WeakMap;function a(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const t in s.attributes)e.remove(s.attributes[t]);s.removeEventListener("dispose",a),delete r[s.id];const l=o.get(s);l&&(e.remove(l),o.delete(s)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,i.memory.geometries--}function s(t){const i=[],n=t.index,r=t.attributes.position;let a=0;if(null!==n){const t=n.array;a=n.version;for(let e=0,n=t.length;e<n;e+=3){const n=t[e+0],r=t[e+1],o=t[e+2];i.push(n,r,r,o,o,n)}}else{const t=r.array;a=r.version;for(let e=0,n=t.length/3-1;e<n;e+=3){const t=e+0,n=e+1,r=e+2;i.push(t,n,n,r,r,t)}}const s=new(Ye(i)?Nn:Gn)(i,1);s.version=a;const l=o.get(t);l&&e.remove(l),o.set(t,s)}return{get:function(t,e){return!0===r[e.id]?e:(e.addEventListener("dispose",a),r[e.id]=!0,i.memory.geometries++,e)},update:function(t){const i=t.attributes;for(const t in i)e.update(i[t],34962);const n=t.morphAttributes;for(const t in n){const i=n[t];for(let t=0,n=i.length;t<n;t++)e.update(i[t],34962)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const i=t.index;null!==i&&e.version<i.version&&s(t)}else s(t);return o.get(t)}}}(ri,Ge,Re,ni),ze=new function(t,e,i,n){let r=new WeakMap;function o(t){const e=t.target;e.removeEventListener("dispose",o),i.remove(e.instanceMatrix),null!==e.instanceColor&&i.remove(e.instanceColor)}return{update:function(t){const a=n.render.frame,s=t.geometry,l=e.get(t,s);return r.get(l)!==a&&(e.update(l),r.set(l,a)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",o)&&t.addEventListener("dispose",o),i.update(t.instanceMatrix,34962),null!==t.instanceColor&&i.update(t.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}(ri,Ne,Ge,Re),$e=new function(t,e,i){const n={},r=new Float32Array(8),o=new WeakMap,a=new di,s=[];for(let t=0;t<8;t++)s[t]=[t,0];return{update:function(l,c,h,u){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const n=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,r=void 0!==n?n.length:0;let s=o.get(c);if(void 0===s||s.count!==r){void 0!==s&&s.texture.dispose();const t=void 0!==c.morphAttributes.position,i=void 0!==c.morphAttributes.normal,n=void 0!==c.morphAttributes.color,l=c.morphAttributes.position||[],h=c.morphAttributes.normal||[],u=c.morphAttributes.color||[];let d=0;!0===t&&(d=1),!0===i&&(d=2),!0===n&&(d=3);let f=c.attributes.position.count*d,p=1;f>e.maxTextureSize&&(p=Math.ceil(f/e.maxTextureSize),f=e.maxTextureSize);const m=new Float32Array(f*p*4*r),_=new pi(m,f,p,r);_.type=wt,_.needsUpdate=!0;const g=4*d;for(let e=0;e<r;e++){const r=l[e],o=h[e],s=u[e],c=f*p*4*e;for(let e=0;e<r.count;e++){const l=e*g;!0===t&&(a.fromBufferAttribute(r,e),!0===r.normalized&&so(a,r),m[c+l+0]=a.x,m[c+l+1]=a.y,m[c+l+2]=a.z,m[c+l+3]=0),!0===i&&(a.fromBufferAttribute(o,e),!0===o.normalized&&so(a,o),m[c+l+4]=a.x,m[c+l+5]=a.y,m[c+l+6]=a.z,m[c+l+7]=0),!0===n&&(a.fromBufferAttribute(s,e),!0===s.normalized&&so(a,s),m[c+l+8]=a.x,m[c+l+9]=a.y,m[c+l+10]=a.z,m[c+l+11]=4===s.itemSize?a.w:1)}}s={count:r,texture:_,size:new je(f,p)},o.set(c,s),c.addEventListener("dispose",function t(){_.dispose(),o.delete(c),c.removeEventListener("dispose",t)})}let l=0;for(let t=0;t<d.length;t++)l+=d[t];const h=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(t,"morphTargetBaseInfluence",h),u.getUniforms().setValue(t,"morphTargetInfluences",d),u.getUniforms().setValue(t,"morphTargetsTexture",s.texture,i),u.getUniforms().setValue(t,"morphTargetsTextureSize",s.size)}else{const e=void 0===d?0:d.length;let i=n[c.id];if(void 0===i||i.length!==e){i=[];for(let t=0;t<e;t++)i[t]=[t,0];n[c.id]=i}for(let t=0;t<e;t++){const e=i[t];e[0]=t,e[1]=d[t]}i.sort(ao);for(let t=0;t<8;t++)t<e&&i[t][1]?(s[t][0]=i[t][0],s[t][1]=i[t][1]):(s[t][0]=Number.MAX_SAFE_INTEGER,s[t][1]=0);s.sort(oo);const o=c.morphAttributes.position,a=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=s[t],i=e[0],n=e[1];i!==Number.MAX_SAFE_INTEGER&&n?(o&&c.getAttribute("morphTarget"+t)!==o[i]&&c.setAttribute("morphTarget"+t,o[i]),a&&c.getAttribute("morphNormal"+t)!==a[i]&&c.setAttribute("morphNormal"+t,a[i]),r[t]=n,l+=n):(o&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),a&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),r[t]=0)}const h=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(t,"morphTargetBaseInfluence",h),u.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}(ri,Ie,De),Qe=new function(t){const e=this;let i=null,n=0,r=!1,o=!1;const a=new Pr,s=new Ze,l={value:null,needsUpdate:!1};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function h(t,i,n,r){const o=null!==t?t.length:0;let c=null;if(0!==o){if(c=l.value,!0!==r||null===c){const e=n+4*o,r=i.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,i=n;e!==o;++e,i+=4)a.copy(t[e]).applyMatrix4(r,s),a.normal.toArray(c,i),c[i+3]=a.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){const a=0!==t.length||e||0!==n||r;return r=e,i=h(t,o,0),n=t.length,a},this.beginShadows=function(){o=!0,h(null)},this.endShadows=function(){o=!1,c()},this.setState=function(e,a,s){const u=e.clippingPlanes,d=e.clipIntersection,f=e.clipShadows,p=t.get(e);if(!r||null===u||0===u.length||o&&!f)o?h(null):c();else{const t=o?0:n,e=4*t;let r=p.clippingState||null;l.value=r,r=h(u,a,e,s);for(let t=0;t!==e;++t)r[t]=i[t];p.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}(Be),Ue=new Ba($,Oe,Fe,Ce,Ie,ni,Qe),He=new $a($,Be),Ve=new function(){let t=new WeakMap;return{get:function(e,i){let n;return!1===t.has(e)?(n=new Oa,t.set(e,[n])):i>=t.get(e).length?(n=new Oa,t.get(e).push(n)):n=t.get(e)[i],n},dispose:function(){t=new WeakMap}}},Je=new function(t,e){let i=new WeakMap;return{get:function(n,r=0){let o;return!1===i.has(n)?(o=new za(t,e),i.set(n,[o])):r>=i.get(n).length?(o=new za(t,e),i.get(n).push(o)):o=i.get(n)[r],o},dispose:function(){i=new WeakMap}}}(Ce,Ie),Ke=new function(t,e,i,n,r,o){const a=new oi(0);let s,l,c=!0===r?0:1,h=null,f=0,p=null;function m(t,e){i.buffers.color.setClear(t.r,t.g,t.b,e,o)}return{getClearColor:function(){return a},setClearColor:function(t,e=1){a.set(t),m(a,c=e)},getClearAlpha:function(){return c},setClearAlpha:function(t){m(a,c=t)},render:function(i,r){let o=!1,_=!0===r.isScene?r.background:null;_&&_.isTexture&&(_=e.get(_));const g=t.xr,y=g.getSession&&g.getSession();y&&"additive"===y.environmentBlendMode&&(_=null),null===_?m(a,c):_&&_.isColor&&(m(_,1),o=!0),(t.autoClear||o)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===ot)?(void 0===l&&((l=new dr(new pr(1,1,1),new vr({name:"BackgroundCubeMaterial",uniforms:mr(zr.cube.uniforms),vertexShader:zr.cube.vertexShader,fragmentShader:zr.cube.fragmentShader,side:d,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(l)),l.material.uniforms.envMap.value=_,l.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,h===_&&f===_.version&&p===t.toneMapping||(l.material.needsUpdate=!0,h=_,f=_.version,p=t.toneMapping),l.layers.enableAll(),i.unshift(l,l.geometry,l.material,0,0,null)):_&&_.isTexture&&(void 0===s&&((s=new dr(new Fr(2,2),new vr({name:"BackgroundMaterial",uniforms:mr(zr.background.uniforms),vertexShader:zr.background.vertexShader,fragmentShader:zr.background.fragmentShader,side:u,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=_,!0===_.matrixAutoUpdate&&_.updateMatrix(),s.material.uniforms.uvTransform.value.copy(_.matrix),h===_&&f===_.version&&p===t.toneMapping||(s.material.needsUpdate=!0,h=_,f=_.version,p=t.toneMapping),s.layers.enableAll(),i.unshift(s,s.geometry,s.material,0,0,null))}}}($,Oe,Pe,ze,Y,h),qe=new ja($,ze,Ie),ti=new function(t,e,i,n){const r=n.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,n){t.drawArrays(o,e,n),i.update(n,o,1)},this.renderInstances=function(n,a,s){if(0===s)return;let l,c;if(r)l=t,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,n,a,s),i.update(a,o,s)}}(ri,Ce,Re,Ie),ei=new function(t,e,i,n){const r=n.isWebGL2;let o,a,s;this.setMode=function(t){o=t},this.setIndex=function(t){a=t.type,s=t.bytesPerElement},this.render=function(e,n){t.drawElements(o,n,a,e*s),i.update(n,o,1)},this.renderInstances=function(n,l,c){if(0===c)return;let h,u;if(r)h=t,u="drawElementsInstanced";else if(u="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](o,l,a,n*s,c),i.update(l,o,c)}}(ri,Ce,Re,Ie),Re.programs=Ue.programs,$.capabilities=Ie,$.extensions=Ce,$.properties=Be,$.renderLists=Ve,$.shadowMap=qe,$.state=Pe,$.info=Re}si();const li=new Ka($,ri);function ci(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),tt=!0}function hi(){console.log("THREE.WebGLRenderer: Context Restored."),tt=!1;const t=Re.autoReset,e=qe.enabled,i=qe.autoUpdate,n=qe.needsUpdate,r=qe.type;si(),Re.autoReset=t,qe.enabled=e,qe.autoUpdate=i,qe.needsUpdate=n,qe.type=r}function ui(t){const e=t.target;e.removeEventListener("dispose",ui),function(t){(function(t){const e=Be.get(t).programs;void 0!==e&&(e.forEach(function(t){Ue.releaseProgram(t)}),t.isShaderMaterial&&Ue.releaseShaderCache(t))})(t),Be.remove(t)}(e)}this.xr=li,this.getContext=function(){return ri},this.getContextAttributes=function(){return ri.getContextAttributes()},this.forceContextLoss=function(){const t=Ce.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=Ce.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return de},this.setPixelRatio=function(t){void 0!==t&&(de=t,this.setSize(he,ue,!1))},this.getSize=function(t){return t.set(he,ue)},this.setSize=function(t,i,n){li.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(he=t,ue=i,e.width=Math.floor(t*de),e.height=Math.floor(i*de),!1!==n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(t){return t.set(he*de,ue*de).floor()},this.setDrawingBufferSize=function(t,i,n){he=t,ue=i,de=n,e.width=Math.floor(t*n),e.height=Math.floor(i*n),this.setViewport(0,0,t,i)},this.getCurrentViewport=function(t){return t.copy(ut)},this.getViewport=function(t){return t.copy(me)},this.setViewport=function(t,e,i,n){t.isVector4?me.set(t.x,t.y,t.z,t.w):me.set(t,e,i,n),Pe.viewport(ut.copy(me).multiplyScalar(de).floor())},this.getScissor=function(t){return t.copy(_e)},this.setScissor=function(t,e,i,n){t.isVector4?_e.set(t.x,t.y,t.z,t.w):_e.set(t,e,i,n),Pe.scissor(dt.copy(_e).multiplyScalar(de).floor())},this.getScissorTest=function(){return ge},this.setScissorTest=function(t){Pe.setScissorTest(ge=t)},this.setOpaqueSort=function(t){fe=t},this.setTransparentSort=function(t){pe=t},this.getClearColor=function(t){return t.copy(Ke.getClearColor())},this.setClearColor=function(){Ke.setClearColor.apply(Ke,arguments)},this.getClearAlpha=function(){return Ke.getClearAlpha()},this.setClearAlpha=function(){Ke.setClearAlpha.apply(Ke,arguments)},this.clear=function(t=!0,e=!0,i=!0){let n=0;t&&(n|=16384),e&&(n|=256),i&&(n|=1024),ri.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ci,!1),e.removeEventListener("webglcontextrestored",hi,!1),Ve.dispose(),Je.dispose(),Be.dispose(),Oe.dispose(),Fe.dispose(),ze.dispose(),ni.dispose(),Ue.dispose(),li.dispose(),li.removeEventListener("sessionstart",_i),li.removeEventListener("sessionend",yi),Ae&&(Ae.dispose(),Ae=null),bi.stop()},this.renderBufferDirect=function(t,e,i,n,r,o){null===e&&(e=Te);const a=r.isMesh&&r.matrixWorld.determinant()<0,s=function(t,e,i,n,r){!0!==e.isScene&&(e=Te);De.resetTextureUnits();const o=e.fog,a=n.isMeshStandardMaterial?e.environment:null,s=null===lt?$.outputEncoding:!0===lt.isXRRenderTarget?lt.texture.encoding:we,l=(n.isMeshStandardMaterial?Fe:Oe).get(n.envMap||a),c=!0===n.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,h=!!n.normalMap&&!!i.attributes.tangent,u=!!i.morphAttributes.position,d=!!i.morphAttributes.normal,f=!!i.morphAttributes.color,p=n.toneMapped?$.toneMapping:X,m=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,_=void 0!==m?m.length:0,g=Be.get(n),y=Q.state.lights;if(!0===be&&(!0===ve||t!==ht)){const e=t===ht&&n.id===ct;Qe.setState(n,t,e)}let b=!1;n.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version?b=!0:g.outputEncoding!==s?b=!0:r.isInstancedMesh&&!1===g.instancing?b=!0:r.isInstancedMesh||!0!==g.instancing?r.isSkinnedMesh&&!1===g.skinning?b=!0:r.isSkinnedMesh||!0!==g.skinning?g.envMap!==l?b=!0:!0===n.fog&&g.fog!==o?b=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===Qe.numPlanes&&g.numIntersection===Qe.numIntersection?g.vertexAlphas!==c?b=!0:g.vertexTangents!==h?b=!0:g.morphTargets!==u?b=!0:g.morphNormals!==d?b=!0:g.morphColors!==f?b=!0:g.toneMapping!==p?b=!0:!0===Ie.isWebGL2&&g.morphTargetsCount!==_&&(b=!0):b=!0:b=!0:b=!0:(b=!0,g.__version=n.version);let v=g.currentProgram;!0===b&&(v=Ai(n,e,r));let w=!1,x=!1,A=!1;const S=v.getUniforms(),M=g.uniforms;Pe.useProgram(v.program)&&(w=!0,x=!0,A=!0);n.id!==ct&&(ct=n.id,x=!0);if(w||ht!==t){if(S.setValue(ri,"projectionMatrix",t.projectionMatrix),Ie.logarithmicDepthBuffer&&S.setValue(ri,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),ht!==t&&(ht=t,x=!0,A=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=S.map.cameraPosition;void 0!==e&&e.setValue(ri,Ee.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&S.setValue(ri,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||r.isSkinnedMesh)&&S.setValue(ri,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){S.setOptional(ri,r,"bindMatrix"),S.setOptional(ri,r,"bindMatrixInverse");const t=r.skeleton;t&&(Ie.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),S.setValue(ri,"boneTexture",t.boneTexture,De),S.setValue(ri,"boneTextureSize",t.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const E=i.morphAttributes;(void 0!==E.position||void 0!==E.normal||void 0!==E.color&&!0===Ie.isWebGL2)&&$e.update(r,i,n,v);(x||g.receiveShadow!==r.receiveShadow)&&(g.receiveShadow=r.receiveShadow,S.setValue(ri,"receiveShadow",r.receiveShadow));x&&(S.setValue(ri,"toneMappingExposure",$.toneMappingExposure),g.needsLights&&function(t,e){t.ambientLightColor.needsUpdate=e,t.lightProbe.needsUpdate=e,t.directionalLights.needsUpdate=e,t.directionalLightShadows.needsUpdate=e,t.pointLights.needsUpdate=e,t.pointLightShadows.needsUpdate=e,t.spotLights.needsUpdate=e,t.spotLightShadows.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}(M,A),o&&!0===n.fog&&He.refreshFogUniforms(M,o),He.refreshMaterialUniforms(M,n,de,ue,Ae),da.upload(ri,g.uniformsList,M,De));n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(da.upload(ri,g.uniformsList,M,De),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&S.setValue(ri,"center",r.center);return S.setValue(ri,"modelViewMatrix",r.modelViewMatrix),S.setValue(ri,"normalMatrix",r.normalMatrix),S.setValue(ri,"modelMatrix",r.matrixWorld),v}(t,e,i,n,r);Pe.setMaterial(n,a);let l=i.index;const c=i.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let h,u=1;!0===n.wireframe&&(l=Ne.getWireframeAttribute(i),u=2),ni.setup(r,n,s,i,l);let d=ti;null!==l&&(h=Ge.get(l),(d=ei).setIndex(h));const f=null!==l?l.count:c.count,p=i.drawRange.start*u,m=i.drawRange.count*u,_=null!==o?o.start*u:0,g=null!==o?o.count*u:1/0,y=Math.max(p,_),b=Math.min(f,p+m,_+g)-1,v=Math.max(0,b-y+1);if(0!==v){if(r.isMesh)!0===n.wireframe?(Pe.setLineWidth(n.wireframeLinewidth*ke()),d.setMode(1)):d.setMode(4);else if(r.isLine){let t=n.linewidth;void 0===t&&(t=1),Pe.setLineWidth(t*ke()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(y,v,r.count);else if(i.isInstancedBufferGeometry){const t=Math.min(i.instanceCount,i._maxInstanceCount);d.renderInstances(y,v,t)}else d.render(y,v)}},this.compile=function(t,e){(Q=Je.get(t)).init(),K.push(Q),t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(Q.pushLight(t),t.castShadow&&Q.pushShadow(t))}),Q.setupLights($.physicallyCorrectLights),t.traverse(function(e){const i=e.material;if(i)if(Array.isArray(i))for(let n=0;n<i.length;n++){Ai(i[n],t,e)}else Ai(i,t,e)}),K.pop(),Q=null};let mi=null;function _i(){bi.stop()}function yi(){bi.start()}const bi=new Dr;function vi(t,e,i,n){const r=t.opaque,o=t.transmissive,a=t.transparent;Q.setupLightsView(i),o.length>0&&function(t,e,i){const n=Ie.isWebGL2;null===Ae&&(Ae=new fi(1,1,{generateMipmaps:!0,type:Ce.has("EXT_color_buffer_half_float")?xt:mt,minFilter:pt,samples:n&&!0===c?4:0}));$.getDrawingBufferSize(Me),n?Ae.setSize(Me.x,Me.y):Ae.setSize(We(Me.x),We(Me.y));const r=$.getRenderTarget();$.setRenderTarget(Ae),$.clear();const o=$.toneMapping;$.toneMapping=X,wi(t,e,i),$.toneMapping=o,De.updateMultisampleRenderTarget(Ae),De.updateRenderTargetMipmap(Ae),$.setRenderTarget(r)}(r,e,i),n&&Pe.viewport(ut.copy(n)),r.length>0&&wi(r,e,i),o.length>0&&wi(o,e,i),a.length>0&&wi(a,e,i),Pe.buffers.depth.setTest(!0),Pe.buffers.depth.setMask(!0),Pe.buffers.color.setMask(!0),Pe.setPolygonOffset(!1)}function wi(t,e,i){const n=!0===e.isScene?e.overrideMaterial:null;for(let r=0,o=t.length;r<o;r++){const o=t[r],a=o.object,s=o.geometry,l=null===n?o.material:n,c=o.group;a.layers.test(i.layers)&&xi(a,e,i,s,l,c)}}function xi(t,e,i,n,r,o){t.onBeforeRender($,e,i,n,r,o),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender($,e,i,n,t,o),!0===r.transparent&&r.side===f?(r.side=d,r.needsUpdate=!0,$.renderBufferDirect(i,e,n,r,t,o),r.side=u,r.needsUpdate=!0,$.renderBufferDirect(i,e,n,r,t,o),r.side=f):$.renderBufferDirect(i,e,n,r,t,o),t.onAfterRender($,e,i,n,r,o)}function Ai(t,e,i){!0!==e.isScene&&(e=Te);const n=Be.get(t),r=Q.state.lights,o=Q.state.shadowsArray,a=r.state.version,s=Ue.getParameters(t,r.state,o,e,i),l=Ue.getProgramCacheKey(s);let c=n.programs;n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=(t.isMeshStandardMaterial?Fe:Oe).get(t.envMap||n.environment),void 0===c&&(t.addEventListener("dispose",ui),c=new Map,n.programs=c);let h=c.get(l);if(void 0!==h){if(n.currentProgram===h&&n.lightsStateVersion===a)return Si(t,s),h}else s.uniforms=Ue.getUniforms(t),t.onBuild(i,s,$),t.onBeforeCompile(s,$),h=Ue.acquireProgram(s,l),c.set(l,h),n.uniforms=s.uniforms;const u=n.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=Qe.uniform),Si(t,s),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=a,n.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotShadowMatrix.value=r.state.spotShadowMatrix,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);const d=h.getUniforms(),f=da.seqWithValue(d.seq,u);return n.currentProgram=h,n.uniformsList=f,h}function Si(t,e){const i=Be.get(t);i.outputEncoding=e.outputEncoding,i.instancing=e.instancing,i.skinning=e.skinning,i.morphTargets=e.morphTargets,i.morphNormals=e.morphNormals,i.morphColors=e.morphColors,i.morphTargetsCount=e.morphTargetsCount,i.numClippingPlanes=e.numClippingPlanes,i.numIntersection=e.numClipIntersection,i.vertexAlphas=e.vertexAlphas,i.vertexTangents=e.vertexTangents,i.toneMapping=e.toneMapping}bi.setAnimationLoop(function(t){mi&&mi(t)}),"undefined"!=typeof self&&bi.setContext(self),this.setAnimationLoop=function(t){mi=t,li.setAnimationLoop(t),null===t?bi.stop():bi.start()},li.addEventListener("sessionstart",_i),li.addEventListener("sessionend",yi),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===tt)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===li.enabled&&!0===li.isPresenting&&(!0===li.cameraAutoUpdate&&li.updateCamera(e),e=li.getCamera()),!0===t.isScene&&t.onBeforeRender($,t,e,lt),(Q=Je.get(t,K.length)).init(),K.push(Q),Se.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ye.setFromProjectionMatrix(Se),ve=this.localClippingEnabled,be=Qe.init(this.clippingPlanes,ve,e),(J=Ve.get(t,q.length)).init(),q.push(J),function t(e,i,n,r){if(!1===e.visible)return;const o=e.layers.test(i.layers);if(o)if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(i);else if(e.isLight)Q.pushLight(e),e.castShadow&&Q.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||ye.intersectsSprite(e)){r&&Ee.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Se);const t=ze.update(e),i=e.material;i.visible&&J.push(e,t,i,n,Ee.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Re.render.frame&&(e.skeleton.update(),e.skeleton.frame=Re.render.frame),!e.frustumCulled||ye.intersectsObject(e))){r&&Ee.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Se);const t=ze.update(e),i=e.material;if(Array.isArray(i)){const r=t.groups;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i[a.materialIndex];s&&s.visible&&J.push(e,t,s,n,Ee.z,a)}}else i.visible&&J.push(e,t,i,n,Ee.z,null)}const a=e.children;for(let e=0,o=a.length;e<o;e++)t(a[e],i,n,r)}(t,e,0,$.sortObjects),J.finish(),!0===$.sortObjects&&J.sort(fe,pe),!0===be&&Qe.beginShadows();const i=Q.state.shadowsArray;if(qe.render(i,t,e),!0===be&&Qe.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ke.render(J,t),Q.setupLights($.physicallyCorrectLights),e.isArrayCamera){const i=e.cameras;for(let e=0,n=i.length;e<n;e++){const n=i[e];vi(J,t,n,n.viewport)}}else vi(J,t,e);null!==lt&&(De.updateMultisampleRenderTarget(lt),De.updateRenderTargetMipmap(lt)),!0===t.isScene&&t.onAfterRender($,t,e),ni.resetDefaultState(),ct=-1,ht=null,K.pop(),Q=K.length>0?K[K.length-1]:null,q.pop(),J=q.length>0?q[q.length-1]:null},this.getActiveCubeFace=function(){return at},this.getActiveMipmapLevel=function(){return st},this.getRenderTarget=function(){return lt},this.setRenderTargetTextures=function(t,e,i){Be.get(t.texture).__webglTexture=e,Be.get(t.depthTexture).__webglTexture=i;const n=Be.get(t);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===i,n.__autoAllocateDepthBuffer||!0===Ce.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const i=Be.get(t);i.__webglFramebuffer=e,i.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,i=0){lt=t,at=e,st=i;let n=!0;if(t){const e=Be.get(t);void 0!==e.__useDefaultFramebuffer?(Pe.bindFramebuffer(36160,null),n=!1):void 0===e.__webglFramebuffer?De.setupRenderTarget(t):e.__hasExternalTextures&&De.rebindTextures(t,Be.get(t.texture).__webglTexture,Be.get(t.depthTexture).__webglTexture)}let r=null,o=!1,a=!1;if(t){const i=t.texture;(i.isData3DTexture||i.isDataArrayTexture)&&(a=!0);const n=Be.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=n[e],o=!0):r=Ie.isWebGL2&&t.samples>0&&!1===De.useMultisampledRTT(t)?Be.get(t).__webglMultisampledFramebuffer:n,ut.copy(t.viewport),dt.copy(t.scissor),ft=t.scissorTest}else ut.copy(me).multiplyScalar(de).floor(),dt.copy(_e).multiplyScalar(de).floor(),ft=ge;if(Pe.bindFramebuffer(36160,r)&&Ie.drawBuffers&&n&&Pe.drawBuffers(t,r),Pe.viewport(ut),Pe.scissor(dt),Pe.setScissorTest(ft),o){const n=Be.get(t.texture);ri.framebufferTexture2D(36160,36064,34069+e,n.__webglTexture,i)}else if(a){const n=Be.get(t.texture),r=e||0;ri.framebufferTextureLayer(36160,36064,n.__webglTexture,i||0,r)}ct=-1},this.readRenderTargetPixels=function(t,e,i,n,r,o,a){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=Be.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){Pe.bindFramebuffer(36160,s);try{const a=t.texture,s=a.format,l=a.type;if(s!==kt&&ii.convert(s)!==ri.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===xt&&(Ce.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&Ce.has("EXT_color_buffer_float"));if(!(l===mt||ii.convert(l)===ri.getParameter(35738)||l===wt&&(Ie.isWebGL2||Ce.has("OES_texture_float")||Ce.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&ri.readPixels(e,i,n,r,ii.convert(s),ii.convert(l),o)}finally{const t=null!==lt?Be.get(lt).__webglFramebuffer:null;Pe.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,i=0){if(!0!==e.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const n=Math.pow(2,-i),r=Math.floor(e.image.width*n),o=Math.floor(e.image.height*n);De.setTexture2D(e,0),ri.copyTexSubImage2D(3553,i,0,0,t.x,t.y,r,o),Pe.unbindTexture()},this.copyTextureToTexture=function(t,e,i,n=0){const r=e.image.width,o=e.image.height,a=ii.convert(i.format),s=ii.convert(i.type);De.setTexture2D(i,0),ri.pixelStorei(37440,i.flipY),ri.pixelStorei(37441,i.premultiplyAlpha),ri.pixelStorei(3317,i.unpackAlignment),e.isDataTexture?ri.texSubImage2D(3553,n,t.x,t.y,r,o,a,s,e.image.data):e.isCompressedTexture?ri.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):ri.texSubImage2D(3553,n,t.x,t.y,a,s,e.image),0===n&&i.generateMipmaps&&ri.generateMipmap(3553),Pe.unbindTexture()},this.copyTextureToTexture3D=function(t,e,i,n,r=0){if($.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const o=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,s=t.max.z-t.min.z+1,l=ii.convert(n.format),c=ii.convert(n.type);let h;if(n.isData3DTexture)De.setTexture3D(n,0),h=32879;else{if(!n.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");De.setTexture2DArray(n,0),h=35866}ri.pixelStorei(37440,n.flipY),ri.pixelStorei(37441,n.premultiplyAlpha),ri.pixelStorei(3317,n.unpackAlignment);const u=ri.getParameter(3314),d=ri.getParameter(32878),f=ri.getParameter(3316),p=ri.getParameter(3315),m=ri.getParameter(32877),_=i.isCompressedTexture?i.mipmaps[0]:i.image;ri.pixelStorei(3314,_.width),ri.pixelStorei(32878,_.height),ri.pixelStorei(3316,t.min.x),ri.pixelStorei(3315,t.min.y),ri.pixelStorei(32877,t.min.z),i.isDataTexture||i.isData3DTexture?ri.texSubImage3D(h,r,e.x,e.y,e.z,o,a,s,l,c,_.data):i.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ri.compressedTexSubImage3D(h,r,e.x,e.y,e.z,o,a,s,l,_.data)):ri.texSubImage3D(h,r,e.x,e.y,e.z,o,a,s,l,c,_),ri.pixelStorei(3314,u),ri.pixelStorei(32878,d),ri.pixelStorei(3316,f),ri.pixelStorei(3315,p),ri.pixelStorei(32877,m),0===r&&n.generateMipmaps&&ri.generateMipmap(h),Pe.unbindTexture()},this.initTexture=function(t){De.setTexture2D(t,0),Pe.unbindTexture()},this.resetState=function(){at=0,st=0,lt=null,Pe.reset(),ni.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ts.prototype.isWebGLRenderer=!0;(class extends ts{}).prototype.isWebGL1Renderer=!0;class es{constructor(t,e=25e-5){this.name="",this.color=new oi(t),this.density=e}clone(){return new es(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}es.prototype.isFogExp2=!0;class is{constructor(t,e=1,i=1e3){this.name="",this.color=new oi(t),this.near=e,this.far=i}clone(){return new is(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}is.prototype.isFog=!0;class ns extends vn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}ns.prototype.isScene=!0;class rs{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Pe,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ne()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,i){t*=this.stride,i*=e.stride;for(let n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ne()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ne()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}rs.prototype.isInterleavedBuffer=!0;const os=new gi;class as{constructor(t,e,i,n=!1){this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,i=this.data.count;e<i;e++)os.fromBufferAttribute(this,e),os.applyMatrix4(t),this.setXYZ(e,os.x,os.y,os.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)os.fromBufferAttribute(this,e),os.applyNormalMatrix(t),this.setXYZ(e,os.x,os.y,os.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)os.fromBufferAttribute(this,e),os.transformDirection(t),this.setXYZ(e,os.x,os.y,os.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this}setXYZ(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this}setXYZW(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return new Fn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new as(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}as.prototype.isInterleavedBufferAttribute=!0;class ss extends Bn{constructor(t){super(),this.type="SpriteMaterial",this.color=new oi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let ls;ss.prototype.isSpriteMaterial=!0;const cs=new gi,hs=new gi,us=new gi,ds=new je,fs=new je,ps=new Xi,ms=new gi,_s=new gi,gs=new gi,ys=new je,bs=new je,vs=new je;class ws extends vn{constructor(t){if(super(),this.type="Sprite",void 0===ls){ls=new Xn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new rs(t,5);ls.setIndex([0,1,2,0,2,3]),ls.setAttribute("position",new as(e,3,0,!1)),ls.setAttribute("uv",new as(e,2,3,!1))}this.geometry=ls,this.material=void 0!==t?t:new ss,this.center=new je(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hs.setFromMatrixScale(this.matrixWorld),ps.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),us.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&hs.multiplyScalar(-us.z);const i=this.material.rotation;let n,r;0!==i&&(r=Math.cos(i),n=Math.sin(i));const o=this.center;xs(ms.set(-.5,-.5,0),us,o,hs,n,r),xs(_s.set(.5,-.5,0),us,o,hs,n,r),xs(gs.set(.5,.5,0),us,o,hs,n,r),ys.set(0,0),bs.set(1,0),vs.set(1,1);let a=t.ray.intersectTriangle(ms,_s,gs,!1,cs);if(null===a&&(xs(_s.set(-.5,.5,0),us,o,hs,n,r),bs.set(0,1),null===(a=t.ray.intersectTriangle(ms,gs,_s,!1,cs))))return;const s=t.ray.origin.distanceTo(cs);s<t.near||s>t.far||e.push({distance:s,point:cs.clone(),uv:Pn.getUV(cs,ms,_s,gs,ys,bs,vs,new je),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function xs(t,e,i,n,r,o){ds.subVectors(t,i).addScalar(.5).multiply(n),void 0!==r?(fs.x=o*ds.x-r*ds.y,fs.y=r*ds.x+o*ds.y):fs.copy(ds),t.copy(e),t.x+=fs.x,t.y+=fs.y,t.applyMatrix4(ps)}ws.prototype.isSprite=!0;const As=new gi,Ss=new di,Ms=new di,Es=new gi,Ts=new Xi;class ks extends dr{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Xi,this.bindMatrixInverse=new Xi}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new di,e=this.geometry.attributes.skinWeight;for(let i=0,n=e.count;i<n;i++){t.fromBufferAttribute(e,i);const n=1/t.manhattanLength();n!==1/0?t.multiplyScalar(n):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const i=this.skeleton,n=this.geometry;Ss.fromBufferAttribute(n.attributes.skinIndex,t),Ms.fromBufferAttribute(n.attributes.skinWeight,t),As.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const n=Ms.getComponent(t);if(0!==n){const r=Ss.getComponent(t);Ts.multiplyMatrices(i.bones[r].matrixWorld,i.boneInverses[r]),e.addScaledVector(Es.copy(As).applyMatrix4(Ts),n)}}return e.applyMatrix4(this.bindMatrixInverse)}}ks.prototype.isSkinnedMesh=!0;class Cs extends vn{constructor(){super(),this.type="Bone"}}Cs.prototype.isBone=!0;class Is extends ui{constructor(t=null,e=1,i=1,n,r,o,a,s,l=ct,c=ct,h,u){super(null,o,a,s,l,c,n,r,h,u),this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Is.prototype.isDataTexture=!0;class Ps extends Fn{constructor(t,e,i,n=1){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,i),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}Ps.prototype.isInstancedBufferAttribute=!0;const Rs=new Xi,Bs=new Xi,Ls=[],Ds=new dr;class Os extends dr{constructor(t,e,i){super(t,e),this.instanceMatrix=new Ps(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const i=this.matrixWorld,n=this.count;if(Ds.geometry=this.geometry,Ds.material=this.material,void 0!==Ds.material)for(let r=0;r<n;r++){this.getMatrixAt(r,Rs),Bs.multiplyMatrices(i,Rs),Ds.matrixWorld=Bs,Ds.raycast(t,Ls);for(let t=0,i=Ls.length;t<i;t++){const i=Ls[t];i.instanceId=r,i.object=this,e.push(i)}Ls.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Ps(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Os.prototype.isInstancedMesh=!0;class Fs extends Bn{constructor(t){super(),this.type="LineBasicMaterial",this.color=new oi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}Fs.prototype.isLineBasicMaterial=!0;const Gs=new gi,Ns=new gi,zs=new Xi,Us=new Yi,Hs=new Ni;class Vs extends vn{constructor(t=new Xn,e=new Fs){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,i=[0];for(let t=1,n=e.count;t<n;t++)Gs.fromBufferAttribute(e,t-1),Ns.fromBufferAttribute(e,t),i[t]=i[t-1],i[t]+=Gs.distanceTo(Ns);t.setAttribute("lineDistance",new zn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const i=this.geometry,n=this.matrixWorld,r=t.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Hs.copy(i.boundingSphere),Hs.applyMatrix4(n),Hs.radius+=r,!1===t.ray.intersectsSphere(Hs))return;zs.copy(n).invert(),Us.copy(t.ray).applyMatrix4(zs);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=new gi,c=new gi,h=new gi,u=new gi,d=this.isLineSegments?2:1;if(i.isBufferGeometry){const n=i.index,r=i.attributes.position;if(null!==n){for(let i=Math.max(0,o.start),a=Math.min(n.count,o.start+o.count)-1;i<a;i+=d){const o=n.getX(i),a=n.getX(i+1);if(l.fromBufferAttribute(r,o),c.fromBufferAttribute(r,a),Us.distanceSqToSegment(l,c,u,h)>s)continue;u.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(u);d<t.near||d>t.far||e.push({distance:d,point:h.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else{for(let i=Math.max(0,o.start),n=Math.min(r.count,o.start+o.count)-1;i<n;i+=d){if(l.fromBufferAttribute(r,i),c.fromBufferAttribute(r,i+1),Us.distanceSqToSegment(l,c,u,h)>s)continue;u.applyMatrix4(this.matrixWorld);const n=t.ray.origin.distanceTo(u);n<t.near||n>t.far||e.push({distance:n,point:h.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Vs.prototype.isLine=!0;const Ws=new gi,js=new gi;class Zs extends Vs{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,i=[];for(let t=0,n=e.count;t<n;t+=2)Ws.fromBufferAttribute(e,t),js.fromBufferAttribute(e,t+1),i[t]=0===t?0:i[t-1],i[t+1]=i[t]+Ws.distanceTo(js);t.setAttribute("lineDistance",new zn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Zs.prototype.isLineSegments=!0;class Ys extends Vs{constructor(t,e){super(t,e),this.type="LineLoop"}}Ys.prototype.isLineLoop=!0;class Xs extends Bn{constructor(t){super(),this.type="PointsMaterial",this.color=new oi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}Xs.prototype.isPointsMaterial=!0;const Js=new Xi,Qs=new Yi,qs=new Ni,Ks=new gi;class $s extends vn{constructor(t=new Xn,e=new Xs){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const i=this.geometry,n=this.matrixWorld,r=t.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),qs.copy(i.boundingSphere),qs.applyMatrix4(n),qs.radius+=r,!1===t.ray.intersectsSphere(qs))return;Js.copy(n).invert(),Qs.copy(t.ray).applyMatrix4(Js);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(i.isBufferGeometry){const r=i.index,a=i.attributes.position;if(null!==r){for(let i=Math.max(0,o.start),l=Math.min(r.count,o.start+o.count);i<l;i++){const o=r.getX(i);Ks.fromBufferAttribute(a,o),tl(Ks,o,s,n,t,e,this)}}else{for(let i=Math.max(0,o.start),r=Math.min(a.count,o.start+o.count);i<r;i++)Ks.fromBufferAttribute(a,i),tl(Ks,i,s,n,t,e,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function tl(t,e,i,n,r,o,a){const s=Qs.distanceSqToPoint(t);if(s<i){const i=new gi;Qs.closestPointToPoint(t,i),i.applyMatrix4(n);const l=r.ray.origin.distanceTo(i);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:i,index:e,face:null,object:a})}}$s.prototype.isPoints=!0;(class extends ui{constructor(t,e,i,n,r,o,a,s,l){super(t,e,i,n,r,o,a,s,l),this.minFilter=void 0!==o?o:dt,this.magFilter=void 0!==r?r:dt,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}).prototype.isVideoTexture=!0;(class extends ui{constructor(t,e,i){super({width:t,height:e}),this.format=i,this.magFilter=ct,this.minFilter=ct,this.generateMipmaps=!1,this.needsUpdate=!0}}).prototype.isFramebufferTexture=!0;class el extends ui{constructor(t,e,i,n,r,o,a,s,l,c,h,u){super(null,o,a,s,l,c,n,r,h,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}el.prototype.isCompressedTexture=!0;(class extends ui{constructor(t,e,i,n,r,o,a,s,l){super(t,e,i,n,r,o,a,s,l),this.needsUpdate=!0}}).prototype.isCanvasTexture=!0;class il{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let i,n=this.getPoint(0),r=0;e.push(0);for(let o=1;o<=t;o++)r+=(i=this.getPoint(o/t)).distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const i=this.getLengths();let n=0;const r=i.length;let o;o=e||t*i[r-1];let a,s=0,l=r-1;for(;s<=l;)if((a=i[n=Math.floor(s+(l-s)/2)]-o)<0)s=n+1;else{if(!(a>0)){l=n;break}l=n-1}if(i[n=l]===o)return n/(r-1);const c=i[n];return(n+(o-c)/(i[n+1]-c))/(r-1)}getTangent(t,e){let i=t-1e-4,n=t+1e-4;i<0&&(i=0),n>1&&(n=1);const r=this.getPoint(i),o=this.getPoint(n),a=e||(r.isVector2?new je:new gi);return a.copy(o).sub(r).normalize(),a}getTangentAt(t,e){const i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e){const i=new gi,n=[],r=[],o=[],a=new gi,s=new Xi;for(let e=0;e<=t;e++){const i=e/t;n[e]=this.getTangentAt(i,new gi)}r[0]=new gi,o[0]=new gi;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),h=Math.abs(n[0].y),u=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),u<=l&&i.set(0,0,1),a.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],a),o[0].crossVectors(n[0],r[0]);for(let e=1;e<=t;e++){if(r[e]=r[e-1].clone(),o[e]=o[e-1].clone(),a.crossVectors(n[e-1],n[e]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(ze(n[e-1].dot(n[e]),-1,1));r[e].applyMatrix4(s.makeRotationAxis(a,t))}o[e].crossVectors(n[e],r[e])}if(!0===e){let e=Math.acos(ze(r[0].dot(r[t]),-1,1));e/=t,n[0].dot(a.crossVectors(r[0],r[t]))>0&&(e=-e);for(let i=1;i<=t;i++)r[i].applyMatrix4(s.makeRotationAxis(n[i],e*i)),o[i].crossVectors(n[i],r[i])}return{tangents:n,normals:r,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class nl extends il{constructor(t=0,e=0,i=1,n=1,r=0,o=2*Math.PI,a=!1,s=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s}getPoint(t,e){const i=e||new je,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=o?0:n),!0!==this.aClockwise||o||(r===n?r=-n:r-=n);const a=this.aStartAngle+t*r;let s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),i=s-this.aX,n=l-this.aY;s=i*t-n*e+this.aX,l=i*e+n*t+this.aY}return i.set(s,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}nl.prototype.isEllipseCurve=!0;class rl extends nl{constructor(t,e,i,n,r,o){super(t,e,i,i,n,r,o),this.type="ArcCurve"}}function ol(){let t=0,e=0,i=0,n=0;function r(r,o,a,s){t=r,e=a,i=-3*r+3*o-2*a-s,n=2*r-2*o+a+s}return{initCatmullRom:function(t,e,i,n,o){r(e,i,o*(i-t),o*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,o,a,s){let l=(e-t)/o-(i-t)/(o+a)+(i-e)/a,c=(i-e)/a-(n-e)/(a+s)+(n-i)/s;r(e,i,l*=a,c*=a)},calc:function(r){const o=r*r;return t+e*r+i*o+n*(o*r)}}}rl.prototype.isArcCurve=!0;const al=new gi,sl=new ol,ll=new ol,cl=new ol;class hl extends il{constructor(t=[],e=!1,i="centripetal",n=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}getPoint(t,e=new gi){const i=e,n=this.points,r=n.length,o=(r-(this.closed?0:1))*t;let a,s,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?a=n[(l-1)%r]:(al.subVectors(n[0],n[1]).add(n[0]),a=al);const h=n[l%r],u=n[(l+1)%r];if(this.closed||l+2<r?s=n[(l+2)%r]:(al.subVectors(n[r-1],n[r-2]).add(n[r-1]),s=al),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(s),t);i<1e-4&&(i=1),e<1e-4&&(e=i),n<1e-4&&(n=i),sl.initNonuniformCatmullRom(a.x,h.x,u.x,s.x,e,i,n),ll.initNonuniformCatmullRom(a.y,h.y,u.y,s.y,e,i,n),cl.initNonuniformCatmullRom(a.z,h.z,u.z,s.z,e,i,n)}else"catmullrom"===this.curveType&&(sl.initCatmullRom(a.x,h.x,u.x,s.x,this.tension),ll.initCatmullRom(a.y,h.y,u.y,s.y,this.tension),cl.initCatmullRom(a.z,h.z,u.z,s.z,this.tension));return i.set(sl.calc(c),ll.calc(c),cl.calc(c)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new gi).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function ul(t,e,i,n,r){const o=.5*(n-e),a=.5*(r-i),s=t*t;return(2*i-2*n+o+a)*(t*s)+(-3*i+3*n-2*o-a)*s+o*t+i}function dl(t,e,i,n){return function(t,e){const i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)}function fl(t,e,i,n,r){return function(t,e){const i=1-t;return i*i*i*e}(t,e)+function(t,e){const i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,r)}hl.prototype.isCatmullRomCurve3=!0;class pl extends il{constructor(t=new je,e=new je,i=new je,n=new je){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new je){const i=e,n=this.v0,r=this.v1,o=this.v2,a=this.v3;return i.set(fl(t,n.x,r.x,o.x,a.x),fl(t,n.y,r.y,o.y,a.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}pl.prototype.isCubicBezierCurve=!0;class ml extends il{constructor(t=new gi,e=new gi,i=new gi,n=new gi){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new gi){const i=e,n=this.v0,r=this.v1,o=this.v2,a=this.v3;return i.set(fl(t,n.x,r.x,o.x,a.x),fl(t,n.y,r.y,o.y,a.y),fl(t,n.z,r.z,o.z,a.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}ml.prototype.isCubicBezierCurve3=!0;class _l extends il{constructor(t=new je,e=new je){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new je){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const i=e||new je;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}_l.prototype.isLineCurve=!0;class gl extends il{constructor(t=new je,e=new je,i=new je){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new je){const i=e,n=this.v0,r=this.v1,o=this.v2;return i.set(dl(t,n.x,r.x,o.x),dl(t,n.y,r.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}gl.prototype.isQuadraticBezierCurve=!0;class yl extends il{constructor(t=new gi,e=new gi,i=new gi){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new gi){const i=e,n=this.v0,r=this.v1,o=this.v2;return i.set(dl(t,n.x,r.x,o.x),dl(t,n.y,r.y,o.y),dl(t,n.z,r.z,o.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}yl.prototype.isQuadraticBezierCurve3=!0;class bl extends il{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new je){const i=e,n=this.points,r=(n.length-1)*t,o=Math.floor(r),a=r-o,s=n[0===o?o:o-1],l=n[o],c=n[o>n.length-2?n.length-1:o+1],h=n[o>n.length-3?n.length-1:o+2];return i.set(ul(a,s.x,l.x,c.x,h.x),ul(a,s.y,l.y,c.y,h.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new je).fromArray(i))}return this}}bl.prototype.isSplineCurve=!0;var vl=Object.freeze({__proto__:null,ArcCurve:rl,CatmullRomCurve3:hl,CubicBezierCurve:pl,CubicBezierCurve3:ml,EllipseCurve:nl,LineCurve:_l,LineCurve3:class extends il{constructor(t=new gi,e=new gi){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new gi){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:gl,QuadraticBezierCurve3:yl,SplineCurve:bl});class wl extends il{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new _l(e,t))}getPoint(t,e){const i=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=i){const t=n[r]-i,o=this.curves[r],a=o.getLength(),s=0===a?0:1-t/a;return o.getPointAt(s,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let i;for(let n=0,r=this.curves;n<r.length;n++){const o=r[n],a=o.isEllipseCurve?2*t:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a);for(let t=0;t<s.length;t++){const n=s[t];i&&i.equals(n)||(e.push(n),i=n)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push((new vl[i.type]).fromJSON(i))}return this}}class xl extends wl{constructor(t){super(),this.type="Path",this.currentPoint=new je,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const i=new _l(this.currentPoint.clone(),new je(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,n){const r=new gl(this.currentPoint.clone(),new je(t,e),new je(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(t,e,i,n,r,o){const a=new pl(this.currentPoint.clone(),new je(t,e),new je(i,n),new je(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),i=new bl(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,n,r,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+a,e+s,i,n,r,o),this}absarc(t,e,i,n,r,o){return this.absellipse(t,e,i,i,n,r,o),this}ellipse(t,e,i,n,r,o,a,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,i,n,r,o,a,s),this}absellipse(t,e,i,n,r,o,a,s){const l=new nl(t,e,i,n,r,o,a,s);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Al extends Xn{constructor(t=1,e=1,i=1,n=8,r=1,o=!1,a=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};const l=this;n=Math.floor(n),r=Math.floor(r);const c=[],h=[],u=[],d=[];let f=0;const p=[],m=i/2;let _=0;function g(i){const r=f,o=new je,p=new gi;let g=0;const y=!0===i?t:e,b=!0===i?1:-1;for(let t=1;t<=n;t++)h.push(0,m*b,0),u.push(0,b,0),d.push(.5,.5),f++;const v=f;for(let t=0;t<=n;t++){const e=t/n*s+a,i=Math.cos(e),r=Math.sin(e);p.x=y*r,p.y=m*b,p.z=y*i,h.push(p.x,p.y,p.z),u.push(0,b,0),o.x=.5*i+.5,o.y=.5*r*b+.5,d.push(o.x,o.y),f++}for(let t=0;t<n;t++){const e=r+t,n=v+t;!0===i?c.push(n,n+1,e):c.push(n+1,n,e),g+=3}l.addGroup(_,g,!0===i?1:2),_+=g}!function(){const o=new gi,g=new gi;let y=0;const b=(e-t)/i;for(let l=0;l<=r;l++){const c=[],_=l/r,y=_*(e-t)+t;for(let t=0;t<=n;t++){const e=t/n,r=e*s+a,l=Math.sin(r),p=Math.cos(r);g.x=y*l,g.y=-_*i+m,g.z=y*p,h.push(g.x,g.y,g.z),o.set(l,b,p).normalize(),u.push(o.x,o.y,o.z),d.push(e,1-_),c.push(f++)}p.push(c)}for(let t=0;t<n;t++)for(let e=0;e<r;e++){const i=p[e][t],n=p[e+1][t],r=p[e+1][t+1],o=p[e][t+1];c.push(i,n,o),c.push(n,r,o),y+=6}l.addGroup(_,y,0),_+=y}(),!1===o&&(t>0&&g(!0),e>0&&g(!1)),this.setIndex(c),this.setAttribute("position",new zn(h,3)),this.setAttribute("normal",new zn(u,3)),this.setAttribute("uv",new zn(d,2))}static fromJSON(t){return new Al(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}new gi,new gi,new gi,new Pn;class Sl extends xl{constructor(t){super(t),this.uuid=Ne(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push((new xl).fromJSON(i))}return this}}const Ml={triangulate:function(t,e,i=2){const n=e&&e.length,r=n?e[0]*i:t.length;let o=El(t,0,r,i,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c,h,u,d,f;if(n&&(o=function(t,e,i,n){const r=[];let o,a,s,l,c;for(o=0,a=e.length;o<a;o++)s=e[o]*n,l=o<a-1?e[o+1]*n:t.length,(c=El(t,s,l,n,!1))===c.next&&(c.steiner=!0),r.push(Fl(c));for(r.sort(Bl),o=0;o<r.length;o++)Ll(r[o],i),i=Tl(i,i.next);return i}(t,e,o,i)),t.length>80*i){s=c=t[0],l=h=t[1];for(let e=i;e<r;e+=i)u=t[e],d=t[e+1],u<s&&(s=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=0!==(f=Math.max(c-s,h-l))?1/f:0}return kl(o,a,i,s,l,f),a}};function El(t,e,i,n,r){let o,a;if(r===function(t,e,i,n){let r=0;for(let o=e,a=i-n;o<i;o+=n)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}(t,e,i,n)>0)for(o=e;o<i;o+=n)a=Yl(o,t[o],t[o+1],a);else for(o=i-n;o>=e;o-=n)a=Yl(o,t[o],t[o+1],a);return a&&Ul(a,a.next)&&(Xl(a),a=a.next),a}function Tl(t,e){if(!t)return t;e||(e=t);let i,n=t;do{if(i=!1,n.steiner||!Ul(n,n.next)&&0!==zl(n.prev,n,n.next))n=n.next;else{if(Xl(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function kl(t,e,i,n,r,o,a){if(!t)return;!a&&o&&function(t,e,i,n){let r=t;do{null===r.z&&(r.z=Ol(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,i,n,r,o,a,s,l,c=1;do{for(i=t,t=null,o=null,a=0;i;){for(a++,n=i,s=0,e=0;e<c&&(s++,n=n.nextZ);e++);for(l=c;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,c*=2}while(a>1)}(r)}(t,n,r,o);let s,l,c=t;for(;t.prev!==t.next;)if(s=t.prev,l=t.next,o?Il(t,n,r,o):Cl(t))e.push(s.i/i),e.push(t.i/i),e.push(l.i/i),Xl(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?kl(t=Pl(Tl(t),e,i),e,i,n,r,o,2):2===a&&Rl(t,e,i,n,r,o):kl(Tl(t),e,i,n,r,o,1);break}}function Cl(t){const e=t.prev,i=t,n=t.next;if(zl(e,i,n)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(Gl(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&zl(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Il(t,e,i,n){const r=t.prev,o=t,a=t.next;if(zl(r,o,a)>=0)return!1;const s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,u=Ol(s,l,e,i,n),d=Ol(c,h,e,i,n);let f=t.prevZ,p=t.nextZ;for(;f&&f.z>=u&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&Gl(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&zl(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&Gl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&zl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=u;){if(f!==t.prev&&f!==t.next&&Gl(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&zl(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&Gl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&zl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Pl(t,e,i){let n=t;do{const r=n.prev,o=n.next.next;!Ul(r,o)&&Hl(r,n,n.next,o)&&jl(r,o)&&jl(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),Xl(n),Xl(n.next),n=t=o),n=n.next}while(n!==t);return Tl(n)}function Rl(t,e,i,n,r,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&Nl(a,t)){let s=Zl(a,t);return a=Tl(a,a.next),s=Tl(s,s.next),kl(a,e,i,n,r,o),void kl(s,e,i,n,r,o)}t=t.next}a=a.next}while(a!==t)}function Bl(t,e){return t.x-e.x}function Ll(t,e){if(e=function(t,e){let i=e;const n=t.x,r=t.y;let o,a=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){const t=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=n&&t>a){if(a=t,t===n){if(r===i.y)return i;if(r===i.next.y)return i.next}o=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!o)return null;if(n===a)return o;const s=o,l=o.x,c=o.y;let h,u=1/0;i=o;do{n>=i.x&&i.x>=l&&n!==i.x&&Gl(r<c?n:a,r,l,c,r<c?a:n,r,i.x,i.y)&&(h=Math.abs(r-i.y)/(n-i.x),jl(i,t)&&(h<u||h===u&&(i.x>o.x||i.x===o.x&&Dl(o,i)))&&(o=i,u=h)),i=i.next}while(i!==s);return o}(t,e)){const i=Zl(e,t);Tl(e,e.next),Tl(i,i.next)}}function Dl(t,e){return zl(t.prev,t,e.prev)<0&&zl(e.next,t,t.next)<0}function Ol(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Fl(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Gl(t,e,i,n,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(i-a)*(e-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function Nl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Hl(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(jl(t,e)&&jl(e,t)&&function(t,e){let i=t,n=!1;const r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(zl(t.prev,t,e.prev)||zl(t,e.prev,e))||Ul(t,e)&&zl(t.prev,t,t.next)>0&&zl(e.prev,e,e.next)>0)}function zl(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Ul(t,e){return t.x===e.x&&t.y===e.y}function Hl(t,e,i,n){const r=Wl(zl(t,e,i)),o=Wl(zl(t,e,n)),a=Wl(zl(i,n,t)),s=Wl(zl(i,n,e));return r!==o&&a!==s||(!(0!==r||!Vl(t,i,e))||(!(0!==o||!Vl(t,n,e))||(!(0!==a||!Vl(i,t,n))||!(0!==s||!Vl(i,e,n)))))}function Vl(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Wl(t){return t>0?1:t<0?-1:0}function jl(t,e){return zl(t.prev,t,t.next)<0?zl(t,e,t.next)>=0&&zl(t,t.prev,e)>=0:zl(t,e,t.prev)<0||zl(t,t.next,e)<0}function Zl(t,e){const i=new Jl(t.i,t.x,t.y),n=new Jl(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function Yl(t,e,i,n){const r=new Jl(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Xl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Jl(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ql{static area(t){const e=t.length;let i=0;for(let n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i}static isClockWise(t){return Ql.area(t)<0}static triangulateShape(t,e){const i=[],n=[],r=[];ql(t),Kl(i,t);let o=t.length;e.forEach(ql);for(let t=0;t<e.length;t++)n.push(o),o+=e[t].length,Kl(i,e[t]);const a=Ml.triangulate(i,n);for(let t=0;t<a.length;t+=3)r.push(a.slice(t,t+3));return r}}function ql(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Kl(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class $l extends Xn{constructor(t=new Sl([new je(.5,.5),new je(-.5,.5),new je(-.5,-.5),new je(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e};const i=this,n=[],r=[];for(let e=0,i=(t=Array.isArray(t)?t:[t]).length;e<i;e++){o(t[e])}function o(t){const o=[],a=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,h=void 0!==e.bevelThickness?e.bevelThickness:.2,u=void 0!==e.bevelSize?e.bevelSize:h-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3;const p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:tc;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let _,g,y,b,v,w=!1;p&&(_=p.getSpacedPoints(s),w=!0,c=!1,g=p.computeFrenetFrames(s,!1),y=new gi,b=new gi,v=new gi),c||(f=0,h=0,u=0,d=0);const x=t.extractPoints(a);let A=x.shape;const S=x.holes;if(!Ql.isClockWise(A)){A=A.reverse();for(let t=0,e=S.length;t<e;t++){const e=S[t];Ql.isClockWise(e)&&(S[t]=e.reverse())}}const M=Ql.triangulateShape(A,S),E=A;for(let t=0,e=S.length;t<e;t++){const e=S[t];A=A.concat(e)}function T(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}const k=A.length,C=M.length;function I(t,e,i){let n,r,o;const a=t.x-e.x,s=t.y-e.y,l=i.x-t.x,c=i.y-t.y,h=a*a+s*s,u=a*c-s*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(h),d=Math.sqrt(l*l+c*c),f=e.x-s/u,p=e.y+a/u,m=((i.x-c/d-f)*c-(i.y+l/d-p)*l)/(a*c-s*l),_=(n=f+a*m-t.x)*n+(r=p+s*m-t.y)*r;if(_<=2)return new je(n,r);o=Math.sqrt(_/2)}else{let t=!1;a>Number.EPSILON?l>Number.EPSILON&&(t=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(c)&&(t=!0),t?(n=-s,r=a,o=Math.sqrt(h)):(n=a,r=s,o=Math.sqrt(h/2))}return new je(n/o,r/o)}const P=[];for(let t=0,e=E.length,i=e-1,n=t+1;t<e;t++,i++,n++)i===e&&(i=0),n===e&&(n=0),P[t]=I(E[t],E[i],E[n]);const R=[];let B,L=P.concat();for(let t=0,e=S.length;t<e;t++){const e=S[t];B=[];for(let t=0,i=e.length,n=i-1,r=t+1;t<i;t++,n++,r++)n===i&&(n=0),r===i&&(r=0),B[t]=I(e[t],e[n],e[r]);R.push(B),L=L.concat(B)}for(let t=0;t<f;t++){const e=t/f,i=h*Math.cos(e*Math.PI/2),n=u*Math.sin(e*Math.PI/2)+d;for(let t=0,e=E.length;t<e;t++){const e=T(E[t],P[t],n);F(e.x,e.y,-i)}for(let t=0,e=S.length;t<e;t++){const e=S[t];B=R[t];for(let t=0,r=e.length;t<r;t++){const r=T(e[t],B[t],n);F(r.x,r.y,-i)}}}const D=u+d;for(let t=0;t<k;t++){const e=c?T(A[t],L[t],D):A[t];w?(b.copy(g.normals[0]).multiplyScalar(e.x),y.copy(g.binormals[0]).multiplyScalar(e.y),v.copy(_[0]).add(b).add(y),F(v.x,v.y,v.z)):F(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<k;e++){const i=c?T(A[e],L[e],D):A[e];w?(b.copy(g.normals[t]).multiplyScalar(i.x),y.copy(g.binormals[t]).multiplyScalar(i.y),v.copy(_[t]).add(b).add(y),F(v.x,v.y,v.z)):F(i.x,i.y,l/s*t)}for(let t=f-1;t>=0;t--){const e=t/f,i=h*Math.cos(e*Math.PI/2),n=u*Math.sin(e*Math.PI/2)+d;for(let t=0,e=E.length;t<e;t++){const e=T(E[t],P[t],n);F(e.x,e.y,l+i)}for(let t=0,e=S.length;t<e;t++){const e=S[t];B=R[t];for(let t=0,r=e.length;t<r;t++){const r=T(e[t],B[t],n);w?F(r.x,r.y+_[s-1].y,_[s-1].x+i):F(r.x,r.y,l+i)}}}function O(t,e){let i=t.length;for(;--i>=0;){const n=i;let r=i-1;r<0&&(r=t.length-1);for(let t=0,i=s+2*f;t<i;t++){const i=k*t,o=k*(t+1);N(e+n+i,e+r+i,e+r+o,e+n+o)}}}function F(t,e,i){o.push(t),o.push(e),o.push(i)}function G(t,e,r){z(t),z(e),z(r);const o=n.length/3,a=m.generateTopUV(i,n,o-3,o-2,o-1);U(a[0]),U(a[1]),U(a[2])}function N(t,e,r,o){z(t),z(e),z(o),z(e),z(r),z(o);const a=n.length/3,s=m.generateSideWallUV(i,n,a-6,a-3,a-2,a-1);U(s[0]),U(s[1]),U(s[3]),U(s[1]),U(s[2]),U(s[3])}function z(t){n.push(o[3*t+0]),n.push(o[3*t+1]),n.push(o[3*t+2])}function U(t){r.push(t.x),r.push(t.y)}!function(){const t=n.length/3;if(c){let t=0,e=k*t;for(let t=0;t<C;t++){const i=M[t];G(i[2]+e,i[1]+e,i[0]+e)}e=k*(t=s+2*f);for(let t=0;t<C;t++){const i=M[t];G(i[0]+e,i[1]+e,i[2]+e)}}else{for(let t=0;t<C;t++){const e=M[t];G(e[2],e[1],e[0])}for(let t=0;t<C;t++){const e=M[t];G(e[0]+k*s,e[1]+k*s,e[2]+k*s)}}i.addGroup(t,n.length/3-t,0)}(),function(){const t=n.length/3;let e=0;O(E,e),e+=E.length;for(let t=0,i=S.length;t<i;t++){const i=S[t];O(i,e),e+=i.length}i.addGroup(t,n.length/3-t,1)}()}this.setAttribute("position",new zn(n,3)),this.setAttribute("uv",new zn(r,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,i){if(i.shapes=[],Array.isArray(t))for(let e=0,n=t.length;e<n;e++){const n=t[e];i.shapes.push(n.uuid)}else i.shapes.push(t.uuid);void 0!==e.extrudePath&&(i.options.extrudePath=e.extrudePath.toJSON());return i}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const i=[];for(let n=0,r=t.shapes.length;n<r;n++){const r=e[t.shapes[n]];i.push(r)}const n=t.options.extrudePath;return void 0!==n&&(t.options.extrudePath=(new vl[n.type]).fromJSON(n)),new $l(i,t.options)}}const tc={generateTopUV:function(t,e,i,n,r){const o=e[3*i],a=e[3*i+1],s=e[3*n],l=e[3*n+1],c=e[3*r],h=e[3*r+1];return[new je(o,a),new je(s,l),new je(c,h)]},generateSideWallUV:function(t,e,i,n,r,o){const a=e[3*i],s=e[3*i+1],l=e[3*i+2],c=e[3*n],h=e[3*n+1],u=e[3*n+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*o],_=e[3*o+1],g=e[3*o+2];return Math.abs(s-h)<Math.abs(a-c)?[new je(a,1-l),new je(c,1-u),new je(d,1-p),new je(m,1-g)]:[new je(s,1-l),new je(h,1-u),new je(f,1-p),new je(_,1-g)]}};class ec extends Xn{constructor(t=new Sl([new je(0,.5),new je(-.5,-.5),new je(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const i=[],n=[],r=[],o=[];let a=0,s=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(a,s,e),a+=s,s=0;function l(t){const a=n.length/3,l=t.extractPoints(e);let c=l.shape;const h=l.holes;!1===Ql.isClockWise(c)&&(c=c.reverse());for(let t=0,e=h.length;t<e;t++){const e=h[t];!0===Ql.isClockWise(e)&&(h[t]=e.reverse())}const u=Ql.triangulateShape(c,h);for(let t=0,e=h.length;t<e;t++){const e=h[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];n.push(e.x,e.y,0),r.push(0,0,1),o.push(e.x,e.y)}for(let t=0,e=u.length;t<e;t++){const e=u[t],n=e[0]+a,r=e[1]+a,o=e[2]+a;i.push(n,r,o),s+=3}}this.setIndex(i),this.setAttribute("position",new zn(n,3)),this.setAttribute("normal",new zn(r,3)),this.setAttribute("uv",new zn(o,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){const n=t[i];e.shapes.push(n.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const i=[];for(let n=0,r=t.shapes.length;n<r;n++){const r=e[t.shapes[n]];i.push(r)}return new ec(i,t.curveSegments)}}class ic extends Xn{constructor(t=1,e=32,i=16,n=0,r=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));const s=Math.min(o+a,Math.PI);let l=0;const c=[],h=new gi,u=new gi,d=[],f=[],p=[],m=[];for(let d=0;d<=i;d++){const _=[],g=d/i;let y=0;0==d&&0==o?y=.5/e:d==i&&s==Math.PI&&(y=-.5/e);for(let i=0;i<=e;i++){const s=i/e;h.x=-t*Math.cos(n+s*r)*Math.sin(o+g*a),h.y=t*Math.cos(o+g*a),h.z=t*Math.sin(n+s*r)*Math.sin(o+g*a),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),m.push(s+y,1-g),_.push(l++)}c.push(_)}for(let t=0;t<i;t++)for(let n=0;n<e;n++){const e=c[t][n+1],r=c[t][n],a=c[t+1][n],l=c[t+1][n+1];(0!==t||o>0)&&d.push(e,r,l),(t!==i-1||s<Math.PI)&&d.push(r,a,l)}this.setIndex(d),this.setAttribute("position",new zn(f,3)),this.setAttribute("normal",new zn(p,3)),this.setAttribute("uv",new zn(m,2))}static fromJSON(t){return new ic(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class nc extends Bn{constructor(t){super(),this.type="ShadowMaterial",this.color=new oi(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}nc.prototype.isShadowMaterial=!0;class rc extends vr{constructor(t){super(t),this.type="RawShaderMaterial"}}rc.prototype.isRawShaderMaterial=!0;class oc extends Bn{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new oi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}oc.prototype.isMeshStandardMaterial=!0;class ac extends oc{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new je(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ze(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new oi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new oi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new oi(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}ac.prototype.isMeshPhysicalMaterial=!0;class sc extends Bn{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new oi(16777215),this.specular=new oi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}sc.prototype.isMeshPhongMaterial=!0;class lc extends Bn{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new oi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}lc.prototype.isMeshToonMaterial=!0;class cc extends Bn{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}cc.prototype.isMeshNormalMaterial=!0;class hc extends Bn{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new oi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=j,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}hc.prototype.isMeshLambertMaterial=!0;class uc extends Bn{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new oi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}uc.prototype.isMeshMatcapMaterial=!0;class dc extends Fs{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}dc.prototype.isLineDashedMaterial=!0;const fc={ShadowMaterial:nc,SpriteMaterial:ss,RawShaderMaterial:rc,ShaderMaterial:vr,PointsMaterial:Xs,MeshPhysicalMaterial:ac,MeshStandardMaterial:oc,MeshPhongMaterial:sc,MeshToonMaterial:lc,MeshNormalMaterial:cc,MeshLambertMaterial:hc,MeshDepthMaterial:Ua,MeshDistanceMaterial:Ha,MeshBasicMaterial:Ln,MeshMatcapMaterial:uc,LineDashedMaterial:dc,LineBasicMaterial:Fs,Material:Bn};Bn.fromType=function(t){return new fc[t]};const pc={arraySlice:function(t,e,i){return pc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,i=new Array(e);for(let t=0;t!==e;++t)i[t]=t;return i.sort(function(e,i){return t[e]-t[i]}),i},sortedArray:function(t,e,i){const n=t.length,r=new t.constructor(n);for(let o=0,a=0;a!==n;++o){const n=i[o]*e;for(let i=0;i!==e;++i)r[a++]=t[n+i]}return r},flattenJSON:function(t,e,i,n){let r=1,o=t[0];for(;void 0!==o&&void 0===o[n];)o=t[r++];if(void 0===o)return;let a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(e.push(o.time),i.push.apply(i,a)),o=t[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(e.push(o.time),a.toArray(i,i.length)),o=t[r++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(e.push(o.time),i.push(a)),o=t[r++]}while(void 0!==o)},subclip:function(t,e,i,n,r=30){const o=t.clone();o.name=e;const a=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],s=e.getValueSize(),l=[],c=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*r;if(!(o<i||o>=n)){l.push(e.times[t]);for(let i=0;i<s;++i)c.push(e.values[t*s+i])}}0!==l.length&&(e.times=pc.convertArray(l,e.times.constructor),e.values=pc.convertArray(c,e.values.constructor),a.push(e))}o.tracks=a;let s=1/0;for(let t=0;t<o.tracks.length;++t)s>o.tracks[t].times[0]&&(s=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,i=t,n=30){n<=0&&(n=30);const r=i.tracks.length,o=e/n;for(let e=0;e<r;++e){const n=i.tracks[e],r=n.ValueTypeName;if("bool"===r||"string"===r)continue;const a=t.tracks.find(function(t){return t.name===n.name&&t.ValueTypeName===r});if(void 0===a)continue;let s=0;const l=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);const u=n.times.length-1;let d;if(o<=n.times[0]){const t=s,e=l-s;d=pc.arraySlice(n.values,t,e)}else if(o>=n.times[u]){const t=u*l+s,e=t+l-s;d=pc.arraySlice(n.values,t,e)}else{const t=n.createInterpolant(),e=s,i=l-s;t.evaluate(o),d=pc.arraySlice(t.resultBuffer,e,i)}if("quaternion"===r){(new _i).fromArray(d).normalize().conjugate().toArray(d)}const f=a.times.length;for(let t=0;t<f;++t){const e=t*h+c;if("quaternion"===r)_i.multiplyQuaternionsFlat(a.values,e,d,0,a.values,e);else{const t=h-2*c;for(let i=0;i<t;++i)a.values[e+i]-=d[i]}}}return t.blendMode=ve,t}};class mc{constructor(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{let o;i:{n:if(!(t<n)){for(let o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,t<(n=e[++i]))break e}o=e.length;break i}if(t>=r)break t;{const a=e[1];t<a&&(i=2,r=a);for(let o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,t>=(r=e[--i-1]))break e}o=i,i=0}}for(;i<o;){const n=i+o>>>1;t<e[n]?o=n:i=n+1}if(n=e[i],void 0===(r=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n;for(let t=0;t!==n;++t)e[t]=i[r+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}mc.prototype.beforeStart_=mc.prototype.copySampleValue_,mc.prototype.afterEnd_=mc.prototype.copySampleValue_;class _c extends mc{constructor(t,e,i,n){super(t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_e,endingEnd:_e}}intervalChanged_(t,e,i){const n=this.parameterPositions;let r=t-2,o=t+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case ge:r=t,a=2*e-i;break;case ye:a=e+n[r=n.length-2]-n[r+1];break;default:r=t,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case ge:o=t,s=2*i-e;break;case ye:o=1,s=i+n[1]-n[0];break;default:o=t-1,s=e}const l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-i),this._offsetPrev=r*c,this._offsetNext=o*c}interpolate_(t,e,i,n){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,f=(i-e)/(n-e),p=f*f,m=p*f,_=-u*m+2*u*p-u*f,g=(1+u)*m+(-1.5-2*u)*p+(-.5+u)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let t=0;t!==a;++t)r[t]=_*o[c+t]+g*o[l+t]+y*o[s+t]+b*o[h+t];return r}}class gc extends mc{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(i-e)/(n-e),h=1-c;for(let t=0;t!==a;++t)r[t]=o[l+t]*h+o[s+t]*c;return r}}class yc extends mc{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t){return this.copySampleValue_(t-1)}}class bc{constructor(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=pc.convertArray(e,this.TimeBufferType),this.values=pc.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:pc.convertArray(t.times,Array),values:pc.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(i.interpolation=e)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new yc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new gc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new _c(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case fe:e=this.InterpolantFactoryMethodDiscrete;break;case pe:e=this.InterpolantFactoryMethodLinear;break;case me:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return fe;case this.InterpolantFactoryMethodLinear:return pe;case this.InterpolantFactoryMethodSmooth:return me}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this}trim(t,e){const i=this.times,n=i.length;let r=0,o=n-1;for(;r!==n&&i[r]<t;)++r;for(;-1!==o&&i[o]>e;)--o;if(++o,0!==r||o!==n){r>=o&&(r=(o=Math.max(o,1))-1);const t=this.getValueSize();this.times=pc.arraySlice(i,r,o),this.values=pc.arraySlice(this.values,r*t,o*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let e=0;e!==r;e++){const n=i[e];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,n),t=!1;break}if(null!==o&&o>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,n,o),t=!1;break}o=n}if(void 0!==n&&pc.isTypedArray(n))for(let e=0,i=n.length;e!==i;++e){const i=n[e];if(isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,i),t=!1;break}}return t}optimize(){const t=pc.arraySlice(this.times),e=pc.arraySlice(this.values),i=this.getValueSize(),n=this.getInterpolation()===me,r=t.length-1;let o=1;for(let a=1;a<r;++a){let r=!1;const s=t[a];if(s!==t[a+1]&&(1!==a||s!==t[0]))if(n)r=!0;else{const t=a*i,n=t-i,o=t+i;for(let a=0;a!==i;++a){const i=e[t+a];if(i!==e[n+a]||i!==e[o+a]){r=!0;break}}}if(r){if(a!==o){t[o]=t[a];const n=a*i,r=o*i;for(let t=0;t!==i;++t)e[r+t]=e[n+t]}++o}}if(r>0){t[o]=t[r];for(let t=r*i,n=o*i,a=0;a!==i;++a)e[n+a]=e[t+a];++o}return o!==t.length?(this.times=pc.arraySlice(t,0,o),this.values=pc.arraySlice(e,0,o*i)):(this.times=t,this.values=e),this}clone(){const t=pc.arraySlice(this.times,0),e=pc.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}bc.prototype.TimeBufferType=Float32Array,bc.prototype.ValueBufferType=Float32Array,bc.prototype.DefaultInterpolation=pe;class vc extends bc{}vc.prototype.ValueTypeName="bool",vc.prototype.ValueBufferType=Array,vc.prototype.DefaultInterpolation=fe,vc.prototype.InterpolantFactoryMethodLinear=void 0,vc.prototype.InterpolantFactoryMethodSmooth=void 0;class wc extends bc{}wc.prototype.ValueTypeName="color";class xc extends bc{}xc.prototype.ValueTypeName="number";class Ac extends mc{constructor(t,e,i,n){super(t,e,i,n)}interpolate_(t,e,i,n){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(i-e)/(n-e);let l=t*a;for(let t=l+a;l!==t;l+=4)_i.slerpFlat(r,0,o,l-a,o,l,s);return r}}class Sc extends bc{InterpolantFactoryMethodLinear(t){return new Ac(this.times,this.values,this.getValueSize(),t)}}Sc.prototype.ValueTypeName="quaternion",Sc.prototype.DefaultInterpolation=pe,Sc.prototype.InterpolantFactoryMethodSmooth=void 0;class Mc extends bc{}Mc.prototype.ValueTypeName="string",Mc.prototype.ValueBufferType=Array,Mc.prototype.DefaultInterpolation=fe,Mc.prototype.InterpolantFactoryMethodLinear=void 0,Mc.prototype.InterpolantFactoryMethodSmooth=void 0;class Ec extends bc{}Ec.prototype.ValueTypeName="vector";class Tc{constructor(t,e=-1,i,n=be){this.name=t,this.tracks=i,this.duration=e,this.blendMode=n,this.uuid=Ne(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],i=t.tracks,n=1/(t.fps||1);for(let t=0,r=i.length;t!==r;++t)e.push(kc(i[t]).scale(n));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,n=i.length;t!==n;++t)e.push(bc.toJSON(i[t]));return n}static CreateFromMorphTargetSequence(t,e,i,n){const r=e.length,o=[];for(let t=0;t<r;t++){let a=[],s=[];a.push((t+r-1)%r,t,(t+1)%r),s.push(0,1,0);const l=pc.getKeyframeOrder(a);a=pc.sortedArray(a,1,l),s=pc.sortedArray(s,1,l),n||0!==a[0]||(a.push(r),s.push(s[0])),o.push(new xc(".morphTargetInfluences["+e[t].name+"]",a,s).scale(1/i))}return new this(t,-1,o)}static findByName(t,e){let i=t;if(!Array.isArray(t)){const e=t;i=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<i.length;t++)if(i[t].name===e)return i[t];return null}static CreateClipsFromMorphTargetSequences(t,e,i){const n={},r=/^([\w-]*?)([\d]+)$/;for(let e=0,i=t.length;e<i;e++){const i=t[e],o=i.name.match(r);if(o&&o.length>1){const t=o[1];let e=n[t];e||(n[t]=e=[]),e.push(i)}}const o=[];for(const t in n)o.push(this.CreateFromMorphTargetSequence(t,n[t],e,i));return o}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(t,e,i,n,r){if(0!==i.length){const o=[],a=[];pc.flattenJSON(i,o,a,n),0!==o.length&&r.push(new t(e,o,a))}},n=[],r=t.name||"default",o=t.fps||30,a=t.blendMode;let s=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const r=l[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let i=0;i<r[e].morphTargets.length;i++)t[r[e].morphTargets[i]]=-1;for(const i in t){const t=[],o=[];for(let n=0;n!==r[e].morphTargets.length;++n){const n=r[e];t.push(n.time),o.push(n.morphTarget===i?1:0)}n.push(new xc(".morphTargetInfluence["+i+"]",t,o))}s=t.length*o}else{const o=".bones["+e[t].name+"]";i(Ec,o+".position",r,"pos",n),i(Sc,o+".quaternion",r,"rot",n),i(Ec,o+".scale",r,"scl",n)}}return 0===n.length?null:new this(r,s,n,a)}resetDuration(){let t=0;for(let e=0,i=this.tracks.length;e!==i;++e){const i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function kc(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xc;case"vector":case"vector2":case"vector3":case"vector4":return Ec;case"color":return wc;case"quaternion":return Sc;case"bool":case"boolean":return vc;case"string":return Mc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],i=[];pc.flattenJSON(t.keys,e,i,"value"),t.times=e,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Cc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Ic{constructor(t,e,i){const n=this;let r=!1,o=0,a=0,s=void 0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===r&&void 0!==n.onStart&&n.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,i=l.length;e<i;e+=2){const i=l[e],n=l[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return n}return null}}}const Pc=new Ic;class Rc{constructor(t){this.manager=void 0!==t?t:Pc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const i=this;return new Promise(function(n,r){i.load(t,n,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Bc={};class Lc extends Rc{constructor(t){super(t)}load(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=Cc.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(void 0!==Bc[t])return void Bc[t].push({onLoad:e,onProgress:i,onError:n});Bc[t]=[],Bc[t].push({onLoad:e,onProgress:i,onError:n});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,s=this.responseType;fetch(o).then(e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const i=Bc[t],n=e.body.getReader(),r=e.headers.get("Content-Length"),o=r?parseInt(r):0,a=0!==o;let s=0;const l=new ReadableStream({start(t){!function e(){n.read().then(({done:n,value:r})=>{if(n)t.close();else{s+=r.byteLength;const n=new ProgressEvent("progress",{lengthComputable:a,loaded:s,total:o});for(let t=0,e=i.length;t<e;t++){const e=i[t];e.onProgress&&e.onProgress(n)}t.enqueue(r),e()}})}()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)}).then(t=>{switch(s){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then(t=>{return(new DOMParser).parseFromString(t,a)});case"json":return t.json();default:if(void 0===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),i=e&&e[1]?e[1].toLowerCase():void 0,n=new TextDecoder(i);return t.arrayBuffer().then(t=>n.decode(t))}}}).then(e=>{Cc.add(t,e);const i=Bc[t];delete Bc[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onLoad&&n.onLoad(e)}}).catch(e=>{const i=Bc[t];if(void 0===i)throw this.manager.itemError(t),e;delete Bc[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Dc extends Rc{constructor(t){super(t)}load(t,e,i,n){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=Cc.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;const a=Xe("img");function s(){c(),Cc.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){c(),n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}class Oc extends vn{constructor(t,e=1){super(),this.type="Light",this.color=new oi(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}Oc.prototype.isLight=!0;class Fc extends Oc{constructor(t,e,i){super(t,i),this.type="HemisphereLight",this.position.copy(vn.DefaultUp),this.updateMatrix(),this.groundColor=new oi(e)}copy(t){return Oc.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}Fc.prototype.isHemisphereLight=!0;const Gc=new Xi,Nc=new gi,zc=new gi;class Uc{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new je(512,512),this.map=null,this.mapPass=null,this.matrix=new Xi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Lr,this._frameExtents=new je(1,1),this._viewportCount=1,this._viewports=[new di(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,i=this.matrix;Nc.setFromMatrixPosition(t.matrixWorld),e.position.copy(Nc),zc.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(zc),e.updateMatrixWorld(),Gc.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Gc),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(e.projectionMatrix),i.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Hc extends Uc{constructor(){super(new xr(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,i=2*Ge*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}Hc.prototype.isSpotLightShadow=!0;class Vc extends Oc{constructor(t,e,i=0,n=Math.PI/3,r=0,o=1){super(t,e),this.type="SpotLight",this.position.copy(vn.DefaultUp),this.updateMatrix(),this.target=new vn,this.distance=i,this.angle=n,this.penumbra=r,this.decay=o,this.shadow=new Hc}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Vc.prototype.isSpotLight=!0;const Wc=new Xi,jc=new gi,Zc=new gi;class Yc extends Uc{constructor(){super(new xr(90,1,.5,500)),this._frameExtents=new je(4,2),this._viewportCount=6,this._viewports=[new di(2,1,1,1),new di(0,1,1,1),new di(3,1,1,1),new di(1,1,1,1),new di(3,0,1,1),new di(1,0,1,1)],this._cubeDirections=[new gi(1,0,0),new gi(-1,0,0),new gi(0,0,1),new gi(0,0,-1),new gi(0,1,0),new gi(0,-1,0)],this._cubeUps=[new gi(0,1,0),new gi(0,1,0),new gi(0,1,0),new gi(0,1,0),new gi(0,0,1),new gi(0,0,-1)]}updateMatrices(t,e=0){const i=this.camera,n=this.matrix,r=t.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),jc.setFromMatrixPosition(t.matrixWorld),i.position.copy(jc),Zc.copy(i.position),Zc.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(Zc),i.updateMatrixWorld(),n.makeTranslation(-jc.x,-jc.y,-jc.z),Wc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Wc)}}Yc.prototype.isPointLightShadow=!0;class Xc extends Oc{constructor(t,e,i=0,n=1){super(t,e),this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new Yc}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Xc.prototype.isPointLight=!0;class Jc extends Uc{constructor(){super(new Hr(-5,5,5,-5,.5,500))}}Jc.prototype.isDirectionalLightShadow=!0;class Qc extends Oc{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(vn.DefaultUp),this.updateMatrix(),this.target=new vn,this.shadow=new Jc}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Qc.prototype.isDirectionalLight=!0;class qc extends Oc{constructor(t,e){super(t,e),this.type="AmbientLight"}}qc.prototype.isAmbientLight=!0;class Kc extends Oc{constructor(t,e,i=10,n=10){super(t,e),this.type="RectAreaLight",this.width=i,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}Kc.prototype.isRectAreaLight=!0;class $c{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new gi)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const i=t.x,n=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*n),e.addScaledVector(o[2],.488603*r),e.addScaledVector(o[3],.488603*i),e.addScaledVector(o[4],i*n*1.092548),e.addScaledVector(o[5],n*r*1.092548),e.addScaledVector(o[6],.315392*(3*r*r-1)),e.addScaledVector(o[7],i*r*1.092548),e.addScaledVector(o[8],.546274*(i*i-n*n)),e}getIrradianceAt(t,e){const i=t.x,n=t.y,r=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*n),e.addScaledVector(o[2],1.023328*r),e.addScaledVector(o[3],1.023328*i),e.addScaledVector(o[4],.858086*i*n),e.addScaledVector(o[5],.858086*n*r),e.addScaledVector(o[6],.743125*r*r-.247708),e.addScaledVector(o[7],.858086*i*r),e.addScaledVector(o[8],.429043*(i*i-n*n)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(t.coefficients[i],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].fromArray(t,e+3*n);return this}toArray(t=[],e=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].toArray(t,e+3*n);return t}static getBasisAt(t,e){const i=t.x,n=t.y,r=t.z;e[0]=.282095,e[1]=.488603*n,e[2]=.488603*r,e[3]=.488603*i,e[4]=1.092548*i*n,e[5]=1.092548*n*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*i*r,e[8]=.546274*(i*i-n*n)}}$c.prototype.isSphericalHarmonics3=!0;class th extends Oc{constructor(t=new $c,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}th.prototype.isLightProbe=!0;class eh{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:e+t)}}class ih extends Xn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}ih.prototype.isInstancedBufferGeometry=!0;let nh;(class extends Rc{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=Cc.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(i){Cc.add(t,i),e&&e(i),r.manager.itemEnd(t)}).catch(function(e){n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}),r.manager.itemStart(t)}}).prototype.isImageBitmapLoader=!0;const rh={getContext:function(){return void 0===nh&&(nh=new(window.AudioContext||window.webkitAudioContext)),nh},setContext:function(t){nh=t}};(class extends th{constructor(t,e,i=1){super(void 0,i);const n=(new oi).set(t),r=(new oi).set(e),o=new gi(n.r,n.g,n.b),a=new gi(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0;(class extends th{constructor(t,e=1){super(void 0,e);const i=(new oi).set(t);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}).prototype.isAmbientLightProbe=!0;class oh extends vn{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}class ah{constructor(t,e,i){let n,r,o;switch(this.binding=t,this.valueSize=i,e){case"quaternion":n=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:n=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const i=this.buffer,n=this.valueSize,r=t*n+n;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==n;++t)i[r+t]=i[t];o=e}else{const t=e/(o+=e);this._mixBufferRegion(i,r,0,t,n)}this.cumulativeWeight=o}accumulateAdditive(t){const e=this.buffer,i=this.valueSize,n=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(i,n,t,1-r,e)}o>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(i[t]!==i[t+e]){a.setValue(i,n);break}}saveOriginalState(){const t=this.binding,e=this.buffer,i=this.valueSize,n=i*this._origIndex;t.getValue(e,n);for(let t=i,r=n;t!==r;++t)e[t]=e[n+t%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]}_select(t,e,i,n,r){if(n>=.5)for(let n=0;n!==r;++n)t[e+n]=t[i+n]}_slerp(t,e,i,n){_i.slerpFlat(t,e,t,e,t,i,n)}_slerpAdditive(t,e,i,n,r){const o=this._workIndex*r;_i.multiplyQuaternionsFlat(t,o,t,e,t,i),_i.slerpFlat(t,e,t,e,t,o,n)}_lerp(t,e,i,n,r){const o=1-n;for(let a=0;a!==r;++a){const r=e+a;t[r]=t[r]*o+t[i+a]*n}}_lerpAdditive(t,e,i,n,r){for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]+t[i+o]*n}}}const sh=new RegExp("[\\[\\]\\.:\\/]","g"),lh="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",ch=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),hh=/(WCOD+)?/.source.replace("WCOD",lh),uh=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),dh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),fh=new RegExp("^"+ch+hh+uh+dh+"$"),ph=["material","materials","bones"];class mh{constructor(t,e,i){this.path=e,this.parsedPath=i||mh.parseTrackName(e),this.node=mh.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new mh.Composite(t,e,i):new mh(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(sh,"")}static parseTrackName(t){const e=fh.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=i.nodeName.substring(n+1);-1!==ph.indexOf(t)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=t)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){const i=function(t){for(let n=0;n<t.length;n++){const r=t[n];if(r.name===e||r.uuid===e)return r;const o=i(r.children);if(o)return o}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,i=e.objectName,n=e.propertyName;let r=e.propertyIndex;if(t||(t=mh.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(i){let n=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==n){if(void 0===t[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[n]}}const o=t[n];if(void 0===o){const i=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+n+" but it wasn't found.",t)}let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}mh.Composite=class{constructor(t,e,i){const n=i||mh.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)}setValue(t,e){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},mh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},mh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},mh.prototype.GetterByBindingType=[mh.prototype._getValue_direct,mh.prototype._getValue_array,mh.prototype._getValue_arrayElement,mh.prototype._getValue_toArray],mh.prototype.SetterByBindingTypeAndVersioning=[[mh.prototype._setValue_direct,mh.prototype._setValue_direct_setNeedsUpdate,mh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mh.prototype._setValue_array,mh.prototype._setValue_array_setNeedsUpdate,mh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mh.prototype._setValue_arrayElement,mh.prototype._setValue_arrayElement_setNeedsUpdate,mh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mh.prototype._setValue_fromArray,mh.prototype._setValue_fromArray_setNeedsUpdate,mh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];(class{constructor(){this.uuid=Ne(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,i=this._paths,n=this._parsedPaths,r=this._bindings,o=r.length;let a=void 0,s=t.length,l=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const h=arguments[c],u=h.uuid;let d=e[u];if(void 0===d){d=s++,e[u]=d,t.push(h);for(let t=0,e=o;t!==e;++t)r[t].push(new mh(h,i[t],n[t]))}else if(d<l){a=t[d];const s=--l,c=t[s];e[c.uuid]=d,t[d]=c,e[u]=s,t[s]=h;for(let t=0,e=o;t!==e;++t){const e=r[t],o=e[s];let a=e[d];e[d]=o,void 0===a&&(a=new mh(h,i[t],n[t])),e[s]=a}}else t[d]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,l=e[s];if(void 0!==l&&l>=r){const o=r++,c=t[o];e[c.uuid]=l,t[l]=c,e[s]=o,t[o]=a;for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[o],r=e[l];e[l]=n,e[o]=r}}}this.nCachedObjects_=r}uncache(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_,o=t.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,l=e[s];if(void 0!==l)if(delete e[s],l<r){const a=--r,s=t[a],c=--o,h=t[c];e[s.uuid]=l,t[l]=s,e[h.uuid]=a,t[a]=h,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[a],r=e[c];e[l]=n,e[a]=r,e.pop()}}else{const r=--o,a=t[r];r>0&&(e[a.uuid]=l),t[l]=a,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t];e[l]=e[r],e.pop()}}}this.nCachedObjects_=r}subscribe_(t,e){const i=this._bindingsIndicesByPath;let n=i[t];const r=this._bindings;if(void 0!==n)return r[n];const o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=new Array(l);n=r.length,i[t]=n,o.push(t),a.push(e),r.push(h);for(let i=c,n=s.length;i!==n;++i){const n=s[i];h[i]=new mh(n,t,e)}return h}unsubscribe_(t){const e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){const n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=i,o[i]=s,o.pop(),r[i]=r[a],r.pop(),n[i]=n[a],n.pop()}}}).prototype.isAnimationObjectGroup=!0;class _h{constructor(t,e,i=null,n=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=n;const r=e.tracks,o=r.length,a=new Array(o),s={endingStart:_e,endingEnd:_e};for(let t=0;t!==o;++t){const e=r[t].createInterpolant(null);a[t]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ue,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){const i=this._clip.duration,n=t._clip.duration,r=n/i,o=i/n;t.warp(1,r,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){const n=this._mixer,r=n.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+i,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,n){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const n=(t-r)*i;if(n<0||0===i)return;this._startTime=null,e=i*n}e*=this._updateTimeScale(t);const o=this._updateTime(e),a=this._updateWeight(t);if(a>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case ve:for(let i=0,n=t.length;i!==n;++i)t[i].evaluate(o),e[i].accumulateAdditive(a);break;case be:default:for(let i=0,r=t.length;i!==r;++i)t[i].evaluate(o),e[i].accumulate(n,a)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const i=this._weightInterpolant;if(null!==i){const n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const i=this._timeScaleInterpolant;if(null!==i){e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,i=this.loop;let n=this.time+t,r=this._loopCount;const o=i===de;if(0===t)return-1===r?n:o&&1==(1&r)?e-n:n;if(i===he){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=e)n=e;else{if(!(n<0)){this.time=n;break t}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),n>=e||n<0){const i=Math.floor(n/e);n-=e*i,r+=Math.abs(i);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=n;if(o&&1==(1&r))return e-n}return n}_setEndings(t,e,i){const n=this._interpolantSettings;i?(n.endingStart=ge,n.endingEnd=ge):(n.endingStart=t?this.zeroSlopeAtStart?ge:_e:ye,n.endingEnd=e?this.zeroSlopeAtEnd?ge:_e:ye)}_scheduleFading(t,e,i){const n=this._mixer,r=n.time;let o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=i,this}}(class extends De{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,o=t._propertyBindings,a=t._interpolants,s=i.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let t=0;t!==r;++t){const r=n[t],l=r.name;let h=c[l];if(void 0!==h)++h.referenceCount,o[t]=h;else{if(void 0!==(h=o[t])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,l));continue}const n=e&&e._propertyBindings[t].binding.parsedPath;++(h=new ah(mh.create(i,l,n),r.ValueTypeName,r.getValueSize())).referenceCount,this._addInactiveBinding(h,s,l),o[t]=h}a[t].resultBuffer=h.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,i){const n=this._actions,r=this._actionsByClip;let o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=n.length,n.push(t),o.actionByRoot[i]=t}_removeInactiveAction(t){const e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==--i.referenceCount&&this._removeInactiveBinding(i)}}_lendAction(t){const e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackAction(t){const e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_addInactiveBinding(t,e,i){const n=this._bindingsByRootAndName,r=this._bindings;let o=n[e];void 0===o&&(o={},n[e]=o),o[i]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,a=o[n],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[r],0===Object.keys(a).length&&delete o[n]}_lendBinding(t){const e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_takeBackBinding(t){const e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let i=t[e];return void 0===i&&((i=new gc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=i),i}_takeBackControlInterpolant(t){const e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r}clipAction(t,e,i){const n=e||this._root,r=n.uuid;let o="string"==typeof t?Tc.findByName(n,t):t;const a=null!==o?o.uuid:t,s=this._actionsByClip[a];let l=null;if(void 0===i&&(i=null!==o?o.blendMode:be),void 0!==s){const t=s.actionByRoot[r];if(void 0!==t&&t.blendMode===i)return t;l=s.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new _h(this,o,e,i);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(t,e){const i=e||this._root,n=i.uuid,r="string"==typeof t?Tc.findByName(i,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1;for(let a=0;a!==i;++a)e[a]._update(n,t,r,o);const a=this._bindings,s=this._nActiveBindings;for(let t=0;t!==s;++t)a[t].apply(o);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){const t=r.knownActions;for(let i=0,n=t.length;i!==n;++i){const n=t[i];this._deactivateAction(n);const r=n._cacheIndex,o=e[e.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,o._cacheIndex=r,e[r]=o,e.pop(),this._removeInactiveBindingsForAction(n)}delete n[i]}}uncacheRoot(t){const e=t.uuid,i=this._actionsByClip;for(const t in i){const n=i[t].actionByRoot[e];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}const n=this._bindingsByRootAndName[e];if(void 0!==n)for(const t in n){const e=n[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class gh{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new gh(void 0===this.value.clone?this.value:this.value.clone())}}(class extends rs{constructor(t,e,i=1){super(t,e),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;(class{constructor(t,e,i,n,r){this.buffer=t,this.type=e,this.itemSize=i,this.elementSize=n,this.count=r,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}).prototype.isGLBufferAttribute=!0;class yh{constructor(t,e,i=0,n=1/0){this.ray=new Yi(t,e),this.near=i,this.far=n,this.camera=null,this.layers=new an,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,i=[]){return vh(t,this,i,e),i.sort(bh),i}intersectObjects(t,e=!0,i=[]){for(let n=0,r=t.length;n<r;n++)vh(t[n],this,i,e);return i.sort(bh),i}}function bh(t,e){return t.distance-e.distance}function vh(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),!0===n){const n=t.children;for(let t=0,r=n.length;t<r;t++)vh(n[t],e,i,!0)}}class wh{constructor(t=1,e=0,i=0){return this.radius=t,this.phi=e,this.theta=i,this}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(ze(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const xh=new je;class Ah{constructor(t=new je(1/0,1/0),e=new je(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=xh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return xh.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}Ah.prototype.isBox2=!0;const Sh=new gi,Mh=new gi;const Eh=new gi,Th=new Xi,kh=new Xi;const Ch=new vi;class Ih extends Zs{constructor(t,e=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new Xn;r.setIndex(new Fn(i,1)),r.setAttribute("position",new Fn(n,3)),super(r,new Fs({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Ch.setFromObject(this.object),Ch.isEmpty())return;const e=Ch.min,i=Ch.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=e.x,r[4]=i.y,r[5]=i.z,r[6]=e.x,r[7]=e.y,r[8]=i.z,r[9]=i.x,r[10]=e.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=e.z,r[15]=e.x,r[16]=i.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=i.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t){return Zs.prototype.copy.call(this,t),this.object=t.object,this}}const Ph=new ArrayBuffer(4),Rh=(new Float32Array(Ph),new Uint32Array(Ph),new Uint32Array(512)),Bh=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(Rh[t]=0,Rh[256|t]=32768,Bh[t]=24,Bh[256|t]=24):e<-14?(Rh[t]=1024>>-e-14,Rh[256|t]=1024>>-e-14|32768,Bh[t]=-e-1,Bh[256|t]=-e-1):e<=15?(Rh[t]=e+15<<10,Rh[256|t]=e+15<<10|32768,Bh[t]=13,Bh[256|t]=13):e<128?(Rh[t]=31744,Rh[256|t]=64512,Bh[t]=24,Bh[256|t]=24):(Rh[t]=31744,Rh[256|t]=64512,Bh[t]=13,Bh[256|t]=13)}const Lh=new Uint32Array(2048),Dh=new Uint32Array(64),Oh=new Uint32Array(64);for(let t=1;t<1024;++t){let e=t<<13,i=0;for(;0==(8388608&e);)e<<=1,i-=8388608;e&=-8388609,i+=947912704,Lh[t]=e|i}for(let t=1024;t<2048;++t)Lh[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)Dh[t]=t<<23;Dh[31]=1199570944,Dh[32]=2147483648;for(let t=33;t<63;++t)Dh[t]=2147483648+(t-32<<23);Dh[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(Oh[t]=1024);il.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(il.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},xl.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)};(class extends Zs{constructor(t=10,e=10,i=4473924,n=8947848){i=new oi(i),n=new oi(n);const r=e/2,o=t/e,a=t/2,s=[],l=[];for(let t=0,c=0,h=-a;t<=e;t++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);const e=t===r?i:n;e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3}const c=new Xn;c.setAttribute("position",new zn(s,3)),c.setAttribute("color",new zn(l,3)),super(c,new Fs({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}).prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Zs{constructor(t){const e=function t(e){const i=[];!0===e.isBone&&i.push(e);for(let n=0;n<e.children.length;n++)i.push.apply(i,t(e.children[n]));return i}(t),i=new Xn,n=[],r=[],o=new oi(0,0,1),a=new oi(0,1,0);for(let t=0;t<e.length;t++){const i=e[t];i.parent&&i.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}i.setAttribute("position",new zn(n,3)),i.setAttribute("color",new zn(r,3)),super(i,new Fs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,i=this.geometry,n=i.getAttribute("position");kh.copy(this.root.matrixWorld).invert();for(let t=0,i=0;t<e.length;t++){const r=e[t];r.parent&&r.parent.isBone&&(Th.multiplyMatrices(kh,r.matrixWorld),Eh.setFromMatrixPosition(Th),n.setXYZ(i,Eh.x,Eh.y,Eh.z),Th.multiplyMatrices(kh,r.parent.matrixWorld),Eh.setFromMatrixPosition(Th),n.setXYZ(i+1,Eh.x,Eh.y,Eh.z),i+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Rc.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),eh.extractUrlBase(t)},Rc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Ah.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},Ah.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ah.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Ah.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},vi.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},vi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},vi.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},vi.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},vi.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},on.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Ni.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Lr.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},class{constructor(t=new gi,e=new gi){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Sh.subVectors(t,this.start),Mh.subVectors(this.end,this.start);const i=Mh.dot(Mh);let n=Mh.dot(Sh)/i;return e&&(n=ze(n,0,1)),n}closestPointToPoint(t,e,i){const n=this.closestPointToPointParameter(t,e);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Ze.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Ze.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Ze.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ze.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Ze.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ze.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Xi.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},Xi.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Xi.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new gi).setFromMatrixColumn(this,3)},Xi.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},Xi.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Xi.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Xi.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Xi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Xi.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},Xi.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Xi.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Xi.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Xi.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Xi.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Xi.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Xi.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Xi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Xi.prototype.makeFrustum=function(t,e,i,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,o)},Xi.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Pr.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},_i.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},_i.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Yi.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Yi.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},Yi.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Pn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Pn.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},Pn.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},Pn.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},Pn.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},Pn.barycoordFromPoint=function(t,e,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Pn.getBarycoord(t,e,i,n,r)},Pn.normal=function(t,e,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Pn.getNormal(t,e,i,n)},Sl.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Sl.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new $l(this,t)},Sl.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ec(this,t)},je.prototype.fromAttribute=function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},je.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},je.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},gi.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},gi.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},gi.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},gi.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},gi.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},gi.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},gi.prototype.fromAttribute=function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},gi.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},gi.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},di.prototype.fromAttribute=function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},di.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},vn.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},vn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},vn.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},vn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},vn.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(vn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),dr.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(dr.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ks.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},xr.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Oc.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Fn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Re},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Re)}}}),Fn.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Re:Pe),this},Fn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Fn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Xn.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},Xn.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Fn(arguments[1],arguments[2])))},Xn.prototype.addDrawCall=function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},Xn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Xn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Xn.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},Xn.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Xn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),rs.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Re:Pe),this},rs.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},$l.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},$l.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},$l.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},ns.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},gh.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Bn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new oi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===p}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(vr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),ts.prototype.clearTarget=function(t,e,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,i,n)},ts.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},ts.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ts.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ts.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ts.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ts.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ts.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ts.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ts.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ts.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ts.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ts.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ts.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ts.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},ts.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ts.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ts.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ts.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ts.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ts.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ts.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ts.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ts.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ts.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ts.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?xe:we}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(ja.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(fi.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),oh.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new class extends Rc{constructor(t){super(t)}load(t,e,i,n){const r=this,o=new Lc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,function(i){try{const o=i.slice(0);rh.getContext().decodeAudioData(o,function(t){e(t)})}catch(e){n?n(e):console.error(e),r.manager.itemError(t)}},i,n)}}).load(t,function(t){e.setBuffer(t)}),this},class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let i=0;i<e.length;i++)t+=e[i];return t/e.length}}.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Mr.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},Mr.prototype.clear=function(t,e,i,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,i,n)},si.crossOrigin=void 0,si.loadTexture=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new class extends Rc{constructor(t){super(t)}load(t,e,i,n){const r=new ui,o=new Dc(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)},i,n),r}};r.setCrossOrigin(this.crossOrigin);const o=r.load(t,i,void 0,n);return e&&(o.mapping=e),o},si.loadTextureCube=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new class extends Rc{constructor(t){super(t)}load(t,e,i,n){const r=new Er,o=new Dc(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(i){o.load(t[i],function(t){r.images[i]=t,6==++a&&(r.needsUpdate=!0,e&&e(r))},void 0,n)}for(let e=0;e<t.length;++e)s(e);return r}};r.setCrossOrigin(this.crossOrigin);const o=r.load(t,i,void 0,n);return e&&(o.mapping=e),o},si.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},si.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n)},function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i(44),r=i(111);class o{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(s.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(s.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=t.elements,o=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*o,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,r=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*n-a*i,c=s*i+a*e-r*n,h=s*n+r*i-o*e,u=-r*e-o*i-a*n;return this.x=l*s+u*-r+c*-a-h*-o,this.y=c*s+u*-o+h*-r-l*-a,this.z=h*s+u*-a+l*-o-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return a.copy(this).projectOnVector(t),this.sub(a)}reflect(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(n.a(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(e),this.y=i*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}o.prototype.isVector3=!0;const a=new o,s=new r.a},function(t,e,i){"use strict";var n=i(5),r=i(112),o=i(113),a=i(116),s=i(6),l=i(1),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.bbox=function(t,e){return n.a.vector3(t)&&n.a.vector3(e)?e.x>=0&&e.y>=0&&e.z>=0?{min:t.clone().sub(e),max:t.clone().add(e)}:(console.log("halfDimensions must be >= 0."),console.log(e),!1):(console.log("Invalid center or plane halfDimensions."),!1)},t.minMax=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[65535,-32768],i=t.length,n=0;n<i;n++){var r=t[n];e[0]=Math.min(e[0],r),e[1]=Math.max(e[1],r)}return e},t.isElement=function(t){try{return t instanceof HTMLElement}catch(e){return"object"===(void 0===t?"undefined":c(t))&&1===t.nodeType&&"object"===c(t.style)&&"object"===c(t.ownerDocument)}},t.isString=function(t){return"string"==typeof t||t instanceof String},t.parseUrl=function(t){var e=new URL(t,"http://fix.me"),i={filename:e.searchParams.get("filename"),extension:"",pathname:e.pathname,query:e.search};i.filename||(i.filename=i.pathname.split("/").pop());var n=i.filename.split(".");i.extension=n.length>1?n.pop():"dicom";return(!isNaN(i.extension)||-1!==["asp","aspx","go","gs","hs","jsp","js","php","pl","py","rb","htm","html"].indexOf(i.extension)||i.query&&i.query.includes("contentType=application%2Fdicom"))&&(i.extension="dicom"),i},t.ijk2LPS=function(t,e,i,n,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new s.a,a=new s.a;return a.set(t.x*n.y,e.x*n.x,i.x*n.z,r.x,t.y*n.y,e.y*n.x,i.y*n.z,r.y,t.z*n.y,e.z*n.x,i.z*n.z,r.z,0,0,0,1),a.premultiply(o),a},t.aabb2LPS=function(t,e,i,n){var r=new s.a;return r.set(t.x,e.x,i.x,n.x,t.y,e.y,i.y,n.y,t.z,e.z,i.z,n.z,0,0,0,1),r},t.worldToData=function(t,e){var i=(new l.a).copy(e).applyMatrix4(t);return i.addScalar(.5).floor(),i},t.value=function(t,e){console.warn("value is deprecated, please use getPixelData instead"),this.getPixelData(t,e)},t.getPixelData=function(t,e){return e.z>=0&&e.z<t._frame.length?t._frame[e.z].getPixelData(e.x,e.y):null},t.setPixelData=function(t,e,i){if(!(e.z>=0&&e.z<t._frame.length))return null;t._frame[e.z].setPixelData(e.x,e.y,i)},t.rescaleSlopeIntercept=function(t,e,i){return t*e+i},t.centerOfMass=function(t){for(var e=new l.a(0,0,0),i=0;i<t.length;i++)e.x+=t[i].x,e.y+=t[i].y,e.z+=t[i].z;return e.divideScalar(t.length),e},t.orderIntersections=function(t,e){for(var i=this.centerOfMass(t),n=new l.a(t[0].x-i.x,t[0].y-i.y,t[0].z-i.z).normalize(),r=new l.a(0,0,0).crossVectors(n,e).normalize(),o=[],a=0;a<t.length;a++){var s=new l.a(t[a].x,t[a].y,t[a].z);s.direction=new l.a(t[a].x-i.x,t[a].y-i.y,t[a].z-i.z).normalize();var c=n.dot(s.direction),h=r.dot(s.direction);s.xy={x:c,y:h};var u=Math.atan2(h,c)*(180/Math.PI);s.angle=u,o.push(s)}o.sort(function(t,e){return t.angle-e.angle});for(var d=[o[0]],f=1;f<o.length;f++)Math.abs(o[f-1].angle-o[f].angle)>1e-4&&d.push(o[f]);return d},t.getRoI=function(e,i,n){e.geometry.computeBoundingBox();var a=(new r.a).setFromObject(e),s=a.min.clone().project(i),l=a.max.clone().project(i),c=i.controls.domElement.offsetWidth,h=i.controls.domElement.offsetHeight,u=new o.a,d=[];s.x=Math.round((s.x+1)*c/2),s.y=Math.round((1-s.y)*h/2),l.x=Math.round((l.x+1)*c/2),l.y=Math.round((1-l.y)*h/2);var f=[Math.min(s.x,l.x),Math.max(s.x,l.x)];s.x=f[0],l.x=f[1];var p=[Math.min(s.y,l.y),Math.max(s.y,l.y)];s.y=p[0],l.y=p[1];for(var m=[],_=null,g=s.x;g<=l.x;g++)for(var y=s.y;y<=l.y;y++)u.setFromCamera({x:g/c*2-1,y:-y/h*2+1},i),0!==(m=u.intersectObject(e)).length&&null!==(_=t.getPixelData(n,t.worldToData(n.lps2IJK,m[0].point)))&&1===n.numberOfChannels&&d.push(t.rescaleSlopeIntercept(_,n.rescaleSlope,n.rescaleIntercept));if(0===d.length)return null;var b=d.reduce(function(t,e){return t+e})/d.length;return{min:d.reduce(function(t,e){return t<e?t:e}),max:d.reduce(function(t,e){return t>e?t:e}),mean:b,sd:Math.sqrt(d.reduce(function(t,e){return t+Math.pow(e-b,2)},0)/d.length)}},t.getGeometryArea=function(t){if(t.faces.length<1)return 0;var e=0,i=t.vertices;return t.faces.forEach(function(t){e+=new a.a(i[t.a],i[t.b],i[t.c]).getArea()}),e},t.stringToNumber=function(t){var e=Number(t);if(e!=e){var i=(t.match(/\./g)||[]).length;if(1===(t.match(/\,/g)||[]).length&&i<2){var n=0===i?".":"",r=t.replace(/,/g,n);e=Number(r)}e!=e&&(console.error("String could not be converted to number ("+t+'). Setting value to "1.0".'),e=1)}return e},t}();e.a=h},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(4),r=i(9),o=i(0),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r));return a._widgetType="Handle",!0===r.hideHandleMesh&&(a.visible=!1),a._plane={position:new o.L,direction:new o.L},a._offset=new o.L,a._raycaster=new o.A,a._active=!1,a._hovered=!1,a._tracking=!1,a._mouse=new o.K,a._initialized=!1,a._material=null,a._geometry=null,a._mesh=null,a._meshHovered=!1,a._dom=null,a._domHovered=!1,a._screenPosition=a.worldToScreen(a._worldPosition),a.create(),a.initOffsets(),a.onResize=a.onResize.bind(a),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){addEventListener("resize",this.onResize),this._dom.addEventListener("mouseenter",this.onHover),this._dom.addEventListener("mouseleave",this.onHover),this._container.addEventListener("wheel",this.onMove)},e.prototype.removeEventListeners=function(){removeEventListener("resize",this.onResize),this._dom.removeEventListener("mouseenter",this.onHover),this._dom.removeEventListener("mouseleave",this.onHover),this._container.removeEventListener("wheel",this.onMove)},e.prototype.onResize=function(){this.initOffsets()},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._meshHovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){var t=this._raycaster.intersectObject(this._mesh);this._meshHovered=t.length>0},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){var e=this.getMouseOffsets(t,this._container);if(this._mouse.set(e.x,e.y),this._raycaster.setFromCamera(this._mouse,this._camera),this._raycaster.ray.position=this._raycaster.ray.origin,this._hovered){if(this._active=!0,this._controls.enabled=!1,this._targetMesh){var i=this._raycaster.intersectObject(this._targetMesh);i.length>0&&this._offset.copy(i[0].point).sub(this._worldPosition)}else{this._plane.position.copy(this._worldPosition),this._plane.direction.copy(this._camera.getWorldDirection());var n=r.a.rayPlane(this._raycaster.ray,this._plane);null!==n&&this._offset.copy(n).sub(this._plane.position)}this.update()}},e.prototype.onMove=function(t,e){var i=this.getMouseOffsets(t,this._container);if(this._mouse.set(i.x,i.y),this._raycaster.setFromCamera(this._mouse,this._camera),this._raycaster.ray.position=this._raycaster.ray.origin,this._active||e)if(this._dragged=!0,null!==this._targetMesh){var n=this._raycaster.intersectObject(this._targetMesh);n.length>0&&this._worldPosition.copy(n[0].point.sub(this._offset))}else{0===this._plane.direction.length()&&(this._plane.position.copy(this._worldPosition),this._plane.direction.copy(this._camera.getWorldDirection()));var o=r.a.rayPlane(this._raycaster.ray,this._plane);null!==o&&this._worldPosition.copy(o.sub(this._offset))}else this.onHover(null);this.update()},e.prototype.onEnd=function(){!0!==this._tracking&&(!this._dragged&&this._active&&this._initialized&&(this._selected=!this._selected),this._initialized=!0,this._active=!1,this._dragged=!1,this._controls.enabled=!0,this.update())},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new o.F(1,16,16),this._material=new o.t({wireframe:!0,wireframeLinewidth:2}),this.updateMeshColor(),this._mesh=new o.s(this._geometry,this._material),this._mesh.position.copy(this._worldPosition),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._dom=document.createElement("div"),this._dom.className="widgets-handle",this._dom.style.transform="translate3D(\n      "+this._screenPosition.x+"px,\n      "+(this._screenPosition.y-this._container.offsetHeight)+"px, 0)",this.updateDOMColor(),this._container.appendChild(this._dom)},e.prototype.update=function(){this.updateColor(),this._screenPosition=this.worldToScreen(this._worldPosition),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOMColor(),this.updateDOMPosition()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._mesh&&this._mesh.position.copy(this._worldPosition)},e.prototype.updateDOMPosition=function(){this._dom&&(this._dom.style.transform="translate3D("+this._screenPosition.x+"px,\n        "+(this._screenPosition.y-this._container.offsetHeight)+"px, 0)")},e.prototype.updateDOMColor=function(){this._dom.style.borderColor=this._color},e.prototype.showMesh=function(){!0!==this._params.hideMesh&&!0!==this._params.hideHandleMesh&&(this.visible=!0)},e.prototype.free=function(){this.removeEventListeners(),this._container.removeChild(this._dom),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.hideDOM=function(){this._dom.style.display="none"},e.prototype.showDOM=function(){this._dom.style.display=""},a(e,[{key:"screenPosition",get:function(){return this._screenPosition},set:function(t){this._screenPosition=t}},{key:"active",get:function(){return this._active},set:function(t){this._active=t,this._controls.enabled=!this._active,this.update()}},{key:"tracking",get:function(){return this._tracking},set:function(t){this._tracking=t,this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(43),r=i(7),o=i(2),a=i(0);class s extends a.v{constructor(t,e,i){if(super(),this._widgetType="Base",this._params=i,!0===i.hideMesh&&(this.visible=!1),null===document.getElementById("ami-widgets")){const t=document.createElement("style");t.id="ami-widgets",t.innerHTML=n.a.code,document.head.appendChild(t)}this._enabled=!0,this._selected=!1,this._hovered=!0,this._active=!0,this._colors={default:r.a.blue,active:r.a.yellow,hover:r.a.red,select:r.a.green,text:r.a.white,error:r.a.lightRed},this._color=this._colors.default,this._dragged=!1,this._displayed=!0,this._targetMesh=t,this._controls=e,this._camera=e.object,this._container=e.domElement,this._worldPosition=new a.L,i.worldPosition?this._worldPosition.copy(i.worldPosition):null!==this._targetMesh&&this._worldPosition.copy(this._targetMesh.position)}initOffsets(){const t=this._container.getBoundingClientRect(),e=document.body,i=document.documentElement,n=scrollY||i.scrollTop||e.scrollTop,r=scrollX||i.scrollLeft||e.scrollLeft,o=i.clientTop||e.clientTop||0,a=i.clientLeft||e.clientLeft||0;this._offsets={top:Math.round(t.top+n-o),left:Math.round(t.left+r-a)}}getMouseOffsets(t,e){return{x:(t.clientX-this._offsets.left)/e.offsetWidth*2-1,y:-(t.clientY-this._offsets.top)/e.offsetHeight*2+1,screenX:t.clientX-this._offsets.left,screenY:t.clientY-this._offsets.top}}getArea(t){let e=0,i=t.length-1;for(let n=0;n<t.length;n++)e+=(t[i].x+t[n].x)*(t[i].y-t[n].y),i=n;return Math.abs(e/2)}getRegionByXY(t,e){let i=null;return t.some((t,n)=>{if(e.x>=t.x0&&e.x<=t.x1&&e.y>=t.y0&&e.y<=t.y1)return i=n,!0}),i}getPointInRegion(t,e){return t?new a.K((e.x-t.x0-(t.axisX||0))*t.deltaX,(e.y-t.y0-(t.axisY||0))*t.deltaY):null}getUsPoint(t,e){return this.getPointInRegion(t[this.getRegionByXY(t,e)],e)}getUsDistance(t,e){const i=this._params.ultrasoundRegions||[];if(i.length<1)return null;const n=this.getRegionByXY(i,t),r=this.getRegionByXY(i,e);return null===n||null===r||n!==r||"cm"!==i[n].unitsX||"cm"!==i[n].unitsY?null:this.getPointInRegion(i[n],t).distanceTo(this.getPointInRegion(i[n],e))}getDistanceData(t,e,i){let n=null,r=null;if(i)n=t.distanceTo(e)*i;else if(this._params.ultrasoundRegions&&this._params.lps2IJK){const i=this.getUsDistance(o.a.worldToData(this._params.lps2IJK,t),o.a.worldToData(this._params.lps2IJK,e));null!==i?(n=10*i,r="mm"):(n=t.distanceTo(e),r=this._params.pixelSpacing?"mm":"units")}else n=t.distanceTo(e);return{distance:n,units:r}}getLineData(t,e){const i=e.clone().sub(t),n=e.clone().add(t).multiplyScalar(.5),r=i.length(),o=i.angleTo(new a.L(1,0,0));return{line:i,length:r,transformX:n.x-r/2,transformY:n.y-this._container.offsetHeight,transformAngle:t.y<e.y?o:-o,center:n}}getRectData(t,e){const i=e.clone().sub(t),n=i.clone().projectOnVector(new a.L(0,1,0)),r=t.clone().min(e);return{width:i.clone().projectOnVector(new a.L(1,0,0)).length(),height:n.length(),transformX:r.x,transformY:r.y-this._container.offsetHeight,paddingVector:n.clone().normalize()}}adjustLabelTransform(t,e,i){let n=Math.round(e.x-(i?0:t.offsetWidth/2)),r=Math.round(e.y-(i?0:t.offsetHeight/2))-this._container.offsetHeight;return n<0?n=n>-t.offsetWidth?0:n+t.offsetWidth:n>this._container.offsetWidth-t.offsetWidth&&(n=n<this._container.offsetWidth?this._container.offsetWidth-t.offsetWidth:n-t.offsetWidth),r<-this._container.offsetHeight?r=r>-this._container.offsetHeight-t.offsetHeight?-this._container.offsetHeight:r+t.offsetHeight:r>-t.offsetHeight&&(r=r<0?-t.offsetHeight:r-t.offsetHeight),new a.K(n,r)}worldToScreen(t){const e=t.clone();return e.project(this._camera),e.x=Math.round((e.x+1)*this._container.offsetWidth/2),e.y=Math.round((1-e.y)*this._container.offsetHeight/2),e.z=0,e}update(){console.log("update() should be overloaded!")}updateColor(){this._active?this._color=this._colors.active:this._hovered?this._color=this._colors.hover:this._selected?this._color=this._colors.select:this._color=this._colors.default}setDefaultColor(t){this._colors.default=t,this._handles&&this._handles.forEach(e=>e._colors.default=t),this.update()}show(){this.showDOM(),this.showMesh(),this.update(),this._displayed=!0}hide(){this.hideDOM(),this.hideMesh(),this._displayed=!1}hideDOM(){console.log("hideDOM() should be overloaded!")}showDOM(){console.log("showDOM() should be overloaded!")}hideMesh(){this.visible=!1}showMesh(){!0!==this._params.hideMesh&&(this.visible=!0)}free(){this._camera=null,this._container=null,this._controls=null,this._params=null,this._targetMesh=null}get widgetType(){return this._widgetType}get targetMesh(){return this._targetMesh}set targetMesh(t){this._targetMesh=t,this.update()}get worldPosition(){return this._worldPosition}set worldPosition(t){this._worldPosition.copy(t),this.update()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this.update()}get selected(){return this._selected}set selected(t){this._selected=t,this.update()}get hovered(){return this._hovered}set hovered(t){this._hovered=t,this.update()}get dragged(){return this._dragged}set dragged(t){this._dragged=t,this.update()}get displayed(){return this._displayed}set displayed(t){this._displayed=t,this.update()}get active(){return this._active}set active(t){this._active=t,this.update()}get color(){return this._color}set color(t){this._color=t,this.update()}}},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.matrix4=function(t){return!(null===t||void 0===t||!t.hasOwnProperty("elements")||16!==t.elements.length||"function"!=typeof t.identity||"function"!=typeof t.copy||"function"!=typeof t.determinant)},t.vector3=function(t){return!(!(null!==t&&void 0!==t&&t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("z"))||t.hasOwnProperty("w"))},t.box=function(t){return!!(null!==t&&void 0!==t&&t.hasOwnProperty("center")&&this.vector3(t.center)&&t.hasOwnProperty("halfDimensions")&&this.vector3(t.halfDimensions)&&t.halfDimensions.x>=0&&t.halfDimensions.y>=0&&t.halfDimensions.z>=0)},t.ray=function(t){return!!(null!==t&&void 0!==t&&t.hasOwnProperty("position")&&this.vector3(t.position)&&t.hasOwnProperty("direction")&&this.vector3(t.direction))},t}();e.a=n},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(1);class r{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,n,r,o,a,s,l,c,h,u,d,f,p,m){const _=this.elements;return _[0]=t,_[4]=e,_[8]=i,_[12]=n,_[1]=r,_[5]=o,_[9]=a,_[13]=s,_[2]=l,_[6]=c,_[10]=h,_[14]=u,_[3]=d,_[7]=f,_[11]=p,_[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new r).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/o.setFromMatrixColumn(t,0).length(),r=1/o.setFromMatrixColumn(t,1).length(),a=1/o.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,i=t.x,n=t.y,r=t.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){const t=o*c,i=o*h,n=a*c,r=a*h;e[0]=s*c,e[4]=-s*h,e[8]=l,e[1]=i+n*l,e[5]=t-r*l,e[9]=-a*s,e[2]=r-t*l,e[6]=n+i*l,e[10]=o*s}else if("YXZ"===t.order){const t=s*c,i=s*h,n=l*c,r=l*h;e[0]=t+r*a,e[4]=n*a-i,e[8]=o*l,e[1]=o*h,e[5]=o*c,e[9]=-a,e[2]=i*a-n,e[6]=r+t*a,e[10]=o*s}else if("ZXY"===t.order){const t=s*c,i=s*h,n=l*c,r=l*h;e[0]=t-r*a,e[4]=-o*h,e[8]=n+i*a,e[1]=i+n*a,e[5]=o*c,e[9]=r-t*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){const t=o*c,i=o*h,n=a*c,r=a*h;e[0]=s*c,e[4]=n*l-i,e[8]=t*l+r,e[1]=s*h,e[5]=r*l+t,e[9]=i*l-n,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){const t=o*s,i=o*l,n=a*s,r=a*l;e[0]=s*c,e[4]=r-t*h,e[8]=n*h+i,e[1]=h,e[5]=o*c,e[9]=-a*c,e[2]=-l*c,e[6]=i*h+n,e[10]=t-r*h}else if("XZY"===t.order){const t=o*s,i=o*l,n=a*s,r=a*l;e[0]=s*c,e[4]=-h,e[8]=l*c,e[1]=t*h+r,e[5]=o*c,e[9]=i*h-n,e[2]=n*h-i,e[6]=a*c,e[10]=r*h+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(s,t,l)}lookAt(t,e,i){const n=this.elements;return u.subVectors(t,e),0===u.lengthSq()&&(u.z=1),u.normalize(),c.crossVectors(i,u),0===c.lengthSq()&&(1===Math.abs(i.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),c.crossVectors(i,u)),c.normalize(),h.crossVectors(u,c),n[0]=c.x,n[4]=h.x,n[8]=u.x,n[1]=c.y,n[5]=h.y,n[9]=u.y,n[2]=c.z,n[6]=h.z,n[10]=u.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,o=i[0],a=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],_=i[14],g=i[3],y=i[7],b=i[11],v=i[15],w=n[0],x=n[4],A=n[8],S=n[12],M=n[1],E=n[5],T=n[9],k=n[13],C=n[2],I=n[6],P=n[10],R=n[14],B=n[3],L=n[7],D=n[11],O=n[15];return r[0]=o*w+a*M+s*C+l*B,r[4]=o*x+a*E+s*I+l*L,r[8]=o*A+a*T+s*P+l*D,r[12]=o*S+a*k+s*R+l*O,r[1]=c*w+h*M+u*C+d*B,r[5]=c*x+h*E+u*I+d*L,r[9]=c*A+h*T+u*P+d*D,r[13]=c*S+h*k+u*R+d*O,r[2]=f*w+p*M+m*C+_*B,r[6]=f*x+p*E+m*I+_*L,r[10]=f*A+p*T+m*P+_*D,r[14]=f*S+p*k+m*R+_*O,r[3]=g*w+y*M+b*C+v*B,r[7]=g*x+y*E+b*I+v*L,r[11]=g*A+y*T+b*P+v*D,r[15]=g*S+y*k+b*R+v*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],o=t[1],a=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*s*h-n*l*h-r*a*u+i*l*u+n*a*d-i*s*d)+t[7]*(+e*s*d-e*l*u+r*o*u-n*o*d+n*l*c-r*s*c)+t[11]*(+e*l*h-e*a*d-r*o*h+i*o*d+r*a*c-i*l*c)+t[15]*(-n*a*c-e*s*h+e*a*u+n*o*h-i*o*u+i*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],a=t[5],s=t[6],l=t[7],c=t[8],h=t[9],u=t[10],d=t[11],f=t[12],p=t[13],m=t[14],_=t[15],g=h*m*l-p*u*l+p*s*d-a*m*d-h*s*_+a*u*_,y=f*u*l-c*m*l-f*s*d+o*m*d+c*s*_-o*u*_,b=c*p*l-f*h*l+f*a*d-o*p*d-c*a*_+o*h*_,v=f*h*s-c*p*s-f*a*u+o*p*u+c*a*m-o*h*m,w=e*g+i*y+n*b+r*v;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/w;return t[0]=g*x,t[1]=(p*u*r-h*m*r-p*n*d+i*m*d+h*n*_-i*u*_)*x,t[2]=(a*m*r-p*s*r+p*n*l-i*m*l-a*n*_+i*s*_)*x,t[3]=(h*s*r-a*u*r-h*n*l+i*u*l+a*n*d-i*s*d)*x,t[4]=y*x,t[5]=(c*m*r-f*u*r+f*n*d-e*m*d-c*n*_+e*u*_)*x,t[6]=(f*s*r-o*m*r-f*n*l+e*m*l+o*n*_-e*s*_)*x,t[7]=(o*u*r-c*s*r+c*n*l-e*u*l-o*n*d+e*s*d)*x,t[8]=b*x,t[9]=(f*h*r-c*p*r-f*i*d+e*p*d+c*i*_-e*h*_)*x,t[10]=(o*p*r-f*a*r+f*i*l-e*p*l-o*i*_+e*a*_)*x,t[11]=(c*a*r-o*h*r-c*i*l+e*h*l+o*i*d-e*a*d)*x,t[12]=v*x,t[13]=(c*p*n-f*h*n+f*i*u-e*p*u-c*i*m+e*h*m)*x,t[14]=(f*a*n-o*p*n-f*i*s+e*p*s+o*i*m-e*a*m)*x,t[15]=(o*h*n-c*a*n+c*i*s-e*h*s-o*i*u+e*a*u)*x,this}scale(t){const e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),r=1-i,o=t.x,a=t.y,s=t.z,l=r*o,c=r*a;return this.set(l*o+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*o,0,l*s-n*a,c*s+n*o,r*s*s+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,r,o){return this.set(1,i,r,0,t,1,o,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,l=r+r,c=o+o,h=a+a,u=r*l,d=r*c,f=r*h,p=o*c,m=o*h,_=a*h,g=s*l,y=s*c,b=s*h,v=i.x,w=i.y,x=i.z;return n[0]=(1-(p+_))*v,n[1]=(d+b)*v,n[2]=(f-y)*v,n[3]=0,n[4]=(d-b)*w,n[5]=(1-(u+_))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(f+y)*x,n[9]=(m-g)*x,n[10]=(1-(u+p))*x,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let r=o.set(n[0],n[1],n[2]).length();const s=o.set(n[4],n[5],n[6]).length(),l=o.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],a.copy(this);const c=1/r,h=1/s,u=1/l;return a.elements[0]*=c,a.elements[1]*=c,a.elements[2]*=c,a.elements[4]*=h,a.elements[5]*=h,a.elements[6]*=h,a.elements[8]*=u,a.elements[9]*=u,a.elements[10]*=u,e.setFromRotationMatrix(a),i.x=r,i.y=s,i.z=l,this}makePerspective(t,e,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*r/(e-t),l=2*r/(i-n),c=(e+t)/(e-t),h=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,i,n,r,o){const a=this.elements,s=1/(e-t),l=1/(i-n),c=1/(o-r),h=(e+t)*s,u=(i+n)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}r.prototype.isMatrix4=!0;const o=new n.a,a=new r,s=new n.a(0,0,0),l=new n.a(1,1,1),c=new n.a,h=new n.a,u=new n.a},function(t,e,i){"use strict";var n;i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r}),function(t){t.blue="#00B0FF",t.yellow="#FFEB3B",t.red="#F50057",t.green="#76FF03",t.white="#FFF",t.lightRed="#F77"}(n||(n={}));class r{static cielab2XYZ(t,e,i){let n=(t+16)/116,r=e/500+n,o=n-i/200;return n=Math.pow(n,3)>.008856?Math.pow(n,3):(n-16/116)/7.787,[95.047*(r=Math.pow(r,3)>.008856?Math.pow(r,3):(r-16/116)/7.787),100*n,108.883*(o=Math.pow(o,3)>.008856?Math.pow(o,3):(o-16/116)/7.787)]}static xyz2RGB(t,e,i){let n=3.2406*(t/=100)+-1.5372*(e/=100)+-.4986*(i/=100),r=-.9689*t+1.8758*e+.0415*i,o=.0557*t+-.204*e+1.057*i;return n>.0031308?n=1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r>.0031308?r=1.055*Math.pow(r,1/2.4)-.055:r*=12.92,o>.0031308?o=1.055*Math.pow(o,1/2.4)-.055:o*=12.92,[n*=255,r*=255,o*=255]}static cielab2RGB(t=50,e=0,i=0){if(!(t>=0&&t<=100))return null;const[n,r,o]=this.cielab2XYZ(t,e,i);return this.xyz2RGB(n,r,o)}}},function(t,e,i){"use strict";var n=i(10),r=i(118),o=i(117);var a=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.name="interpolationIdentity",i._currentVoxel="currentVoxel",i._dataValue="dataValue",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.api=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._base,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._currentVoxel,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._dataValue;return this._base=t,this.compute(e,i)},e.prototype.compute=function(t,e){return this.computeDefinition(),this._base._functions[this._name]=this._definition,this._name+"("+t+", "+e+");"},e.prototype.computeDefinition=function(){this._definition="\nvoid "+this._name+"(in vec3 currentVoxel, out vec4 dataValue){\n  // lower bound\n  vec3 rcurrentVoxel = vec3(floor(currentVoxel.x + 0.5 ), floor(currentVoxel.y + 0.5 ), floor(currentVoxel.z + 0.5 ));\n  ivec3 voxel = ivec3(int(rcurrentVoxel.x), int(rcurrentVoxel.y), int(rcurrentVoxel.z));\n\n  vec4 tmp = vec4(0., 0., 0., 0.);\n  int offset = 0;\n\n  "+o.a.api(this._base,"voxel","tmp","offset")+"\n  "+r.a.api(this._base,"tmp","offset","dataValue")+"\n}\n    "},e}(n.a);e.a=new a},function(t,e,i){"use strict";var n=i(2),r=i(5),o=i(6),a=i(1);var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.aabbPlane=function(t,e){var i=[];if(!this.validateAabb(t)||!this.validatePlane(e))return console.log("Invalid aabb or plane provided."),!1;var r=new o.a;r.getInverse(t.toAABB);var s=e.direction.clone().applyMatrix4(t.toAABB),l=new a.a(0,0,0).applyMatrix4(t.toAABB),c=this.posdir(e.position.clone().applyMatrix4(t.toAABB),new a.a(s.x-l.x,s.y-l.y,s.z-l.z).normalize()),h=n.a.bbox(t.center,t.halfDimensions),u=new a.a(new a.a(1,0,0),new a.a(0,1,0),new a.a(0,0,1)),d=this.posdir(new a.a(t.center.x-t.halfDimensions.x,t.center.y-t.halfDimensions.y,t.center.z-t.halfDimensions.z),u.x);this.rayPlaneInBBox(d,c,h,i),d.direction=u.y,this.rayPlaneInBBox(d,c,h,i),d.direction=u.z,this.rayPlaneInBBox(d,c,h,i);var f=this.posdir(new a.a(t.center.x+t.halfDimensions.x,t.center.y+t.halfDimensions.y,t.center.z+t.halfDimensions.z),u.x);this.rayPlaneInBBox(f,c,h,i),f.direction=u.y,this.rayPlaneInBBox(f,c,h,i),f.direction=u.z,this.rayPlaneInBBox(f,c,h,i);var p=this.posdir(new a.a(t.center.x+t.halfDimensions.x,t.center.y-t.halfDimensions.y,t.center.z-t.halfDimensions.z),u.y);this.rayPlaneInBBox(p,c,h,i),p.direction=u.z,this.rayPlaneInBBox(p,c,h,i);var m=this.posdir(new a.a(t.center.x-t.halfDimensions.x,t.center.y+t.halfDimensions.y,t.center.z-t.halfDimensions.z),u.x);this.rayPlaneInBBox(m,c,h,i),m.direction=u.z,this.rayPlaneInBBox(m,c,h,i);var _=this.posdir(new a.a(t.center.x-t.halfDimensions.x,t.center.y-t.halfDimensions.y,t.center.z+t.halfDimensions.z),u.x);return this.rayPlaneInBBox(_,c,h,i),_.direction=u.y,this.rayPlaneInBBox(_,c,h,i),i.map(function(t){return t.applyMatrix4(r)}),i},t.rayPlane=function(t,e){if(0!==t.direction.dot(e.direction)){var i=(e.direction.x*(e.position.x-t.position.x)+e.direction.y*(e.position.y-t.position.y)+e.direction.z*(e.position.z-t.position.z))/(e.direction.x*t.direction.x+e.direction.y*t.direction.y+e.direction.z*t.direction.z);return new a.a(t.position.x+i*t.direction.x,t.position.y+i*t.direction.y,t.position.z+i*t.direction.z)}return null},t.rayBox=function(t,e){var i=[],r=n.a.bbox(e.center,e.halfDimensions),o=this.posdir(new a.a(r.min.x,e.center.y,e.center.z),new a.a(-1,0,0));return this.rayPlaneInBBox(t,o,r,i),o=this.posdir(new a.a(r.max.x,e.center.y,e.center.z),new a.a(1,0,0)),this.rayPlaneInBBox(t,o,r,i),o=this.posdir(new a.a(e.center.x,r.min.y,e.center.z),new a.a(0,-1,0)),this.rayPlaneInBBox(t,o,r,i),o=this.posdir(new a.a(e.center.x,r.max.y,e.center.z),new a.a(0,1,0)),this.rayPlaneInBBox(t,o,r,i),o=this.posdir(new a.a(e.center.x,e.center.y,r.min.z),new a.a(0,0,-1)),this.rayPlaneInBBox(t,o,r,i),o=this.posdir(new a.a(e.center.x,e.center.y,r.max.z),new a.a(0,0,1)),this.rayPlaneInBBox(t,o,r,i),i},t.rayPlaneInBBox=function(t,e,i,n){var r=this.rayPlane(t,e);r&&this.inBBox(r,i)&&(n.find(this.findIntersection(r))||n.push(r))},t.findIntersection=function(t){return function(e,i,n){return t.x===e.x&&t.y===e.y&&t.z===e.z}},t.inBBox=function(t,e){return!!(t&&t.x>=e.min.x-1e-4&&t.y>=e.min.y-1e-4&&t.z>=e.min.z-1e-4&&t.x<=e.max.x+1e-4&&t.y<=e.max.y+1e-4&&t.z<=e.max.z+1e-4)},t.posdir=function(t,e){return{position:t,direction:e}},t.validatePlane=function(t){return null===t?(console.log("Invalid plane."),console.log(t),!1):r.a.vector3(t.position)?!!r.a.vector3(t.direction)||(console.log("Invalid plane.direction."),console.log(t.direction),!1):(console.log("Invalid plane.position."),console.log(t.position),!1)},t.validateAabb=function(t){return null===t?(console.log("Invalid aabb."),console.log(t),!1):r.a.matrix4(t.toAABB)?r.a.vector3(t.center)?!!(r.a.vector3(t.halfDimensions)&&t.halfDimensions.x>=0&&t.halfDimensions.y>=0&&t.halfDimensions.z>=0)||(console.log("Invalid aabb.halfDimensions."),console.log(t.halfDimensions),!1):(console.log("Invalid aabb.center."),console.log(t.center),!1):(console.log("Invalid aabb.toAABB: "),console.log(t.toAABB),!1)},t}();e.a=s},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name="shadersBase",this._base={_functions:{},_uniforms:{}},this._definition=""}return n(t,[{key:"name",get:function(){return this._name},set:function(t){this._name=t}}]),t}();e.a=r},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._rightHanded=!0}return t.prototype.pixelRepresentation=function(){return 0},t.prototype.pixelPaddingValue=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},t.prototype.modality=function(){return"unknown"},t.prototype.segmentationType=function(){return"unknown"},t.prototype.segmentationSegments=function(){return[]},t.prototype.referencedSegmentNumber=function(t){return-1},t.prototype.rightHanded=function(){return this._rightHanded},t.prototype.spacingBetweenSlices=function(){return null},t.prototype.numberOfChannels=function(){return 1},t.prototype.sliceThickness=function(){return null},t.prototype.dimensionIndexValues=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},t.prototype.instanceNumber=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},t.prototype.windowCenter=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},t.prototype.windowWidth=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},t.prototype.rescaleSlope=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 1},t.prototype.rescaleIntercept=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0},t.prototype.ultrasoundRegions=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[]},t.prototype.frameTime=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},t.prototype._decompressUncompressed=function(){},t.prototype._swap16=function(t){return(255&t)<<8|t>>8&255},t.prototype._swap32=function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255},t.prototype.invert=function(){return!1},t.prototype.transferSyntaxUID=function(){return"no value provided"},t.prototype.studyDate=function(){return"no value provided"},t.prototype.studyDescription=function(){return"no value provided"},t.prototype.seriesDate=function(){return"no value provided"},t.prototype.seriesDescription=function(){return"no value provided"},t.prototype.rawHeader=function(){return"no value provided"},t.prototype.patientID=function(){return"no value provided"},t.prototype.patientName=function(){return"no value provided"},t.prototype.patientAge=function(){return"no value provided"},t.prototype.patientBirthdate=function(){return"no value provided"},t.prototype.patientSex=function(){return"no value provided"},t.prototype.minMaxPixelData=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],i=t.length,n=0;n<i;n++){var r=t[n];e[0]=Math.min(e[0],r),e[1]=Math.max(e[1],r)}return e},t}();e.a=n},function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){var e,i,n,r,o,a;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(a=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)o=t[e],a.set(o,r),r+=o.length;return a}},o={arraySet:function(t,e,i,n,r){for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(n)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.DataStream=n.lossless.DataStream||function(t,e,i){this.buffer=new DataView(t,e,i),this.index=0},n.lossless.DataStream.prototype.get16=function(){var t=this.buffer.getUint16(this.index,!1);return this.index+=2,t},n.lossless.DataStream.prototype.get8=function(){var t=this.buffer.getUint8(this.index);return this.index+=1,t},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.DataStream)},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=-1}return t.prototype.mergeModels=function(t,e){if(!this._validateModelArray(t)||!this._validateModelArray(e))return console.log("invalid inputs provided."),!1;for(var i=0,n=e.length;i<n;i++)for(var r=0,o=t.length;r<o&&!t[r].merge(e[i]);r++)r===t.length-1&&t.push(e[i]);return!0},t.prototype.merge=function(t){return!!this.validate(t)&&this._id===t._id},t.prototype.validate=function(t){return!(!t||null===t||"function"!=typeof t.merge)},t.prototype._validateModelArray=function(t){if(null===t||Array!==t.constructor)return console.log("invalid model array provided."),!1;for(var e=0;e<t.length;e++)if(!t[e]||null===t[e]||"function"!=typeof t[e].validate||!t[e].validate(t[e]))return!1;return!0},t}();e.a=n},function(t,e,i){"use strict";i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r});const n=1022,r=1023},function(t,e,i){"use strict";var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._uniforms=e,this._functions={},this._main=""}return t.prototype.functions=function(){""===this._main&&this.main();var t="";for(var e in this._functions)t+=this._functions[e]+"\n";return t},t.prototype.uniforms=function(){var t="";for(var e in this._uniforms){var i=this._uniforms[e];t+="uniform "+i.typeGLSL+" "+e,i&&i.length&&(t+="["+i.length+"]"),t+=";\n"}return t},t.prototype.main=function(){this._main="\n\nfloat luma (vec3 rgb) {\n  return (rgb.r + rgb.g + rgb.b)/3.0;\n}\n\nconst float T = 0.04;\nconst float M = 1.0;\nconst float L = 0.002;\n\nvoid main(void) {\n\n  vec2 texCoord = vec2(((vProjectedCoords.x / vProjectedCoords.w) + 1.0 ) / 2.0,\n                ((vProjectedCoords.y / vProjectedCoords.w) + 1.0 ) / 2.0 );\n\n  float borderWidth = uWidth; // in px\n  float step_u = borderWidth * 1.0 / uCanvasWidth;\n  float step_v = borderWidth * 1.0 / uCanvasHeight;\n  vec4 centerPixel = texture2D(uTextureFilled, texCoord);\n\n  vec4 rightPixel  = texture2D(uTextureFilled, texCoord + vec2(step_u, 0.0));\n  vec4 bottomPixel = texture2D(uTextureFilled, texCoord + vec2(0.0, step_v));\n\n  // now manually compute the derivatives\n  float _dFdX = length(rightPixel - centerPixel) / step_u;\n  float _dFdY = length(bottomPixel - centerPixel) / step_v;\n\n  // gl_FragColor.r = _dFdX;\n  // gl_FragColor.g = _dFdY;\n  gl_FragColor.r = max(max(centerPixel.r, rightPixel.r), bottomPixel.r);\n  gl_FragColor.g = max(max(centerPixel.g, rightPixel.g), bottomPixel.g);\n  gl_FragColor.b = max(max(centerPixel.b, rightPixel.b), bottomPixel.b);\n  float maxDerivative = max(_dFdX, _dFdY);\n  float clampedDerivative = clamp(maxDerivative, 0., 1.);\n  gl_FragColor.a = uOpacity * clampedDerivative;\n\n  return;\n  // float h = 1./uCanvasHeight;\n  // float w = 1./uCanvasWidth;\n  // vec4 n[9];\n  // n[0] = texture2D(uTextureFilled, vProjectedTextCoords + vec2( -w, -h));\n  // n[1] = texture2D(uTextureFilled, vProjectedTextCoords + vec2(0.0, -h));\n  // n[2] = texture2D(uTextureFilled, vProjectedTextCoords + vec2(  w, -h));\n  // n[3] = texture2D(uTextureFilled, vProjectedTextCoords + vec2( -w, 0.0));\n  // n[4] = texture2D(uTextureFilled, vProjectedTextCoords);\n  // n[5] = texture2D(uTextureFilled, texCoord + vec2(  w, 0.0));\n  // n[6] = texture2D(uTextureFilled, texCoord + vec2( -w, h));\n  // n[7] = texture2D(uTextureFilled, texCoord + vec2(0.0, h));\n  // n[8] = texture2D(uTextureFilled, texCoord + vec2(  w, h));\n  // vec4 sobel_horizEdge = n[2] + (2.0*n[5]) + n[8] - (n[0] + (2.0*n[3]) + n[6]);\n  // vec4 sobel_vertEdge  = n[0] + (2.0*n[1]) + n[2] - (n[6] + (2.0*n[7]) + n[8]);\n  // vec3 sobel = sqrt((sobel_horizEdge.rgb * sobel_horizEdge.rgb) + (sobel_vertEdge.rgb * sobel_vertEdge.rgb));\n  // gl_FragColor = vec4( sobel, max(max(sobel.r, sobel.g), sobel.b) );\n\n  // return;\n}\n   "},t.prototype.compute=function(){return"\n// uniforms\n"+this.uniforms()+"\n\n// varying (should fetch it from vertex directly)\nvarying vec4      vProjectedCoords;\n\n// tailored functions\n"+this.functions()+"\n\n// main loop\n"+this._main+"\n      "},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.compute=function(){return"\nvarying vec4 vProjectedCoords;\n\n//\n// main\n//\nvoid main() {\n\n  vec4 vPos = modelMatrix * vec4(position, 1.0 );\n  mat4 vProjectionViewMatrix = projectionMatrix * viewMatrix;\n  vProjectedCoords =  projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n\n}\n        "},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._uniforms=e,this._functions={},this._main=""}return t.prototype.functions=function(){""===this._main&&this.main();var t="";for(var e in this._functions)t+=this._functions[e]+"\n";return t},t.prototype.uniforms=function(){var t="";for(var e in this._uniforms){var i=this._uniforms[e];t+="uniform "+i.typeGLSL+" "+e,i&&i.length&&(t+="["+i.length+"]"),t+=";\n"}return t},t.prototype.main=function(){this._main="\nvoid intersectionProjection(\n  in vec4 plane,\n  in vec4 slice,\n  out vec3 intersectionProjection){\n\n      vec3 intersectionDirection = normalize(cross(plane.xyz, slice.xyz));\n      vec3 intersectionPoint = \n        cross(intersectionDirection,slice.xyz) * plane.w +\n        cross(plane.xyz, intersectionDirection) * slice.w;\n\n      intersectionProjection =\n        intersectionPoint.xyz +\n        (dot(vPos.xyz - intersectionPoint, intersectionDirection)\n          * intersectionDirection);\n\n}\n\nvoid main(void) {\n      vec4 c1 = vec4(0., 0., 0., 0.);\n      vec4 c2 = vec4(0., 0., 0., 0.);\n      vec4 c3 = vec4(0., 0., 0., 0.);\n\n      // localizer #1\n      // must be normalized!\n      if(length(uPlane1.xyz) > 0.5) {\n        vec3 projection1 = vec3(1.);\n        intersectionProjection(\n          uPlane1,\n          uSlice,\n          projection1\n        );\n\n        vec4 projInter1 = (vProjectionViewMatrix * vec4(projection1, 1.));\n        vec3 ndc1 = projInter1.xyz / projInter1.w;\n        vec2 screenSpace1 = (ndc1.xy * .5 + .5) * vec2(uCanvasWidth, uCanvasHeight);\n\n        float d1 = distance(gl_FragCoord.xy, screenSpace1.xy);\n        c1 = vec4(uPlaneColor1, 1. - smoothstep(.5, .7, d1));\n      }\n\n      // localizer #2\n      if(length(uPlane2.xyz) > 0.5) {\n        vec3 projection2 = vec3(1.);\n        intersectionProjection(\n          uPlane2,\n          uSlice,\n          projection2\n        );\n\n        vec4 projInter2 = (vProjectionViewMatrix * vec4(projection2, 1.));\n        vec3 ndc2 = projInter2.xyz / projInter2.w;\n        vec2 screenSpace2 = (ndc2.xy * .5 + .5) * vec2(uCanvasWidth, uCanvasHeight);\n\n        float d2 = distance(gl_FragCoord.xy, screenSpace2.xy);\n        c2 = vec4(uPlaneColor2, 1. - smoothstep(.5, .7, d2));\n      }\n\n      // localizer #3\n      if(length(uPlane3.xyz) > 0.5) {\n        vec3 projection3 = vec3(1.);\n        intersectionProjection(\n          uPlane3,\n          uSlice,\n          projection3\n        );\n\n        vec4 projInter3 = (vProjectionViewMatrix * vec4(projection3, 1.));\n        vec3 ndc3 = projInter3.xyz / projInter3.w;\n        vec2 screenSpace3 = (ndc3.xy * .5 + .5) * vec2(uCanvasWidth, uCanvasHeight);\n\n        float d3 = distance(gl_FragCoord.xy, screenSpace3.xy);\n        c3 = vec4(uPlaneColor3, 1. - smoothstep(.5, .7, d3));\n      }\n\n      // float uBorderDashLength = 10.0;\n      // float uBorderWidth = 2.0;\n      // float valueX = mod(gl_FragCoord.x, 2. * uBorderDashLength);\n      // float valueY = mod(gl_FragCoord.y, 2. * uBorderDashLength);\n      // if( valueX < uBorderDashLength || valueY < uBorderDashLength ){\n        vec3 colorMix = c1.xyz*c1.w + c2.xyz*c2.w + c3.xyz*c3.w;\n        gl_FragColor = vec4(colorMix, max(max(c1.w, c2.w),c3.w)*0.5);\n        return;\n      // }\n      \n      // gl_FragColor = vec4(0., 0., 0., 0.);\n      // return;\n}\n   "},t.prototype.compute=function(){return"\n// uniforms\n"+this.uniforms()+"\n\n// varying (should fetch it from vertex directly)\nvarying vec4 vPos;\nvarying mat4 vProjectionViewMatrix;\n\n// tailored functions\n"+this.functions()+"\n\n// main loop\n"+this._main+"\n      "},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.compute=function(){return"\nvarying vec4 vPos;\nvarying mat4 vProjectionViewMatrix;\n\n//\n// main\n//\nvoid main() {\n\n  vPos = modelMatrix * vec4(position, 1.0 );\n  vProjectionViewMatrix = projectionMatrix * viewMatrix;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n\n}\n        "},t}();e.a=n},function(t,e,i){"use strict";var n=i(6);var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.uniforms=function(){return{uTextureSize:{type:"i",value:0,typeGLSL:"int"},uTextureContainer:{type:"tv",value:[],typeGLSL:"sampler2D",length:7},uDataDimensions:{type:"iv",value:[0,0,0],typeGLSL:"ivec3"},uWorldToData:{type:"m4",value:new n.a,typeGLSL:"mat4"},uWindowCenterWidth:{type:"fv1",value:[0,0],typeGLSL:"float",length:2},uRescaleSlopeIntercept:{type:"fv1",value:[0,0],typeGLSL:"float",length:2},uNumberOfChannels:{type:"i",value:1,typeGLSL:"int"},uBitsAllocated:{type:"i",value:8,typeGLSL:"int"},uInvert:{type:"i",value:0,typeGLSL:"int"},uLut:{type:"i",value:0,typeGLSL:"int"},uTextureLUT:{type:"t",value:[],typeGLSL:"sampler2D"},uPixelType:{type:"i",value:0,typeGLSL:"int"},uPackedPerPixel:{type:"i",value:1,typeGLSL:"int"},uInterpolation:{type:"i",value:1,typeGLSL:"int"},uWorldBBox:{type:"fv1",value:[0,0,0,0,0,0],typeGLSL:"float",length:6},uSteps:{type:"i",value:256,typeGLSL:"int"},uAlphaCorrection:{type:"f",value:.5,typeGLSL:"float"},uFrequence:{type:"f",value:0,typeGLSL:"float"},uAmplitude:{type:"f",value:0,typeGLSL:"float"},uShading:{type:"i",value:1,typeGLSL:"int"},uAmbient:{type:"f",value:.1,typeGLSL:"float"},uAmbientColor:{type:"v3",value:[1,1,0],typeGLSL:"vec3"},uSampleColorToAmbient:{type:"i",value:1,typeGLSL:"int"},uSpecular:{type:"f",value:1,typeGLSL:"float"},uSpecularColor:{type:"v3",value:[1,1,1],typeGLSL:"vec3"},uDiffuse:{type:"f",value:.3,typeGLSL:"float"},uDiffuseColor:{type:"v3",value:[1,1,0],typeGLSL:"vec3"},uSampleColorToDiffuse:{type:"i",value:1,typeGLSL:"int"},uShininess:{type:"f",value:5,typeGLSL:"float"},uLightPosition:{type:"v3",value:[0,0,0],typeGLSL:"vec3"},uLightPositionInCamera:{type:"i",value:1,typeGLSL:"int"},uIntensity:{type:"v3",value:[.8,.8,.8],typeGLSL:"vec3"},uAlgorithm:{type:"i",value:0,typeGLSL:"int"}}},t}();e.a=r},function(t,e,i){"use strict";var n=i(8),r=i(119);e.a=function(t,e,i,o){switch(t._uniforms.uInterpolation.value){case 0:return n.a.api(t,e,i);case 1:return r.a.api(t,e,i,o);default:return n.a.api(t,e,i)}}},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.Utils=n.lossless.Utils||{},n.lossless.Utils.createArray=function(t){var e=new Array(t||0),i=t;if(arguments.length>1)for(var r=Array.prototype.slice.call(arguments,1);i--;)e[t-1-i]=n.lossless.Utils.createArray.apply(this,r);return e},n.lossless.Utils.makeCRCTable=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e},n.lossless.Utils.crc32=function(t){for(var e=n.lossless.Utils.crcTable||(n.lossless.Utils.crcTable=n.lossless.Utils.makeCRCTable()),i=-1,r=0;r<t.byteLength;r++)i=i>>>8^e[255&(i^t.getUint8(r))];return(-1^i)>>>0},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.Utils)},function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i(0),r=i(9),o=i(2);var a=function(t){function e(i,a,s,l){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new n.r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var h={halfDimensions:i,center:a,toAABB:c},u={position:s,direction:l},d=r.a.aabbPlane(h,u);if(d.length<3)throw console.log("WARNING: Less than 3 intersections between AABB and Plane."),console.log("AABB"),console.log(h),console.log("Plane"),console.log(u),console.log("exiting..."),new Error("geometries.slice has less than 3 intersections, can not create a valid geometry.");var f=o.a.orderIntersections(d,l),p=new n.C;p.moveTo(f[0].xy.x,f[0].xy.y);var m=new Float32Array(3*f.length);m.set(f[0].toArray(),0);for(var _=1;_<f.length;_++)m.set(f[_].toArray(),3*_),p.lineTo(f[_].xy.x,f[_].xy.y);p.lineTo(f[0].xy.x,f[0].xy.y);var g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,p));return g.type="SliceBufferGeometry",g.setAttribute("position",new n.m(m,3)),g.vertices=f,g}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.D)},function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i(0),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._helpersSlice=i,n._visible=!0,n._color=16711680,n._material=null,n._geometry=null,n._mesh=null,n._create(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){if(this._material||(this._material=new n.o({color:this._color,linewidth:1})),this._helpersSlice.geometry.vertices){this._geometry=new n.e;var t=this._helpersSlice.geometry.vertices.length,e=new Float32Array(3*(t+1));e.set(this._helpersSlice.geometry.attributes.position.array,0),e.set(this._helpersSlice.geometry.vertices[0].toArray(),3*t),this._geometry.setAttribute("position",new n.m(e,3)),this._mesh=new n.n(this._geometry,this._material),"IJK"===this._helpersSlice.aabbSpace&&this._mesh.applyMatrix4(this._helpersSlice.stack.ijk2LPS),this._mesh.visible=this._visible,this.add(this._mesh)}},e.prototype._update=function(){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh=null),this._create()},e.prototype.dispose=function(){this._mesh.material.dispose(),this._mesh.material=null,this._geometry.dispose(),this._geometry=null,this._material.dispose(),this._material=null},r(e,[{key:"helpersSlice",set:function(t){this._helpersSlice=t,this._update()},get:function(){return this._helpersSlice}},{key:"visible",set:function(t){this._visible=t,this._mesh&&(this._mesh.visible=this._visible)},get:function(){return this._visible}},{key:"color",set:function(t){this._color=t,this._material&&this._material.color.set(this._color)},get:function(){return this._color}}]),e}(n.v)},function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i(0),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._stack=i,n._visible=!0,n._color=16777215,n._material=null,n._geometry=null,n._mesh=null,n._meshStack=null,n._create(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){var t=this._stack.dimensionsIJK,e=this._stack.halfDimensionsIJK,i=new n.L(-.5,-.5,-.5),r=new n.b(t.x,t.y,t.z);r.applyMatrix4((new n.r).makeTranslation(e.x+i.x,e.y+i.y,e.z+i.z)),this._geometry=r,this._material=new n.t({wireframe:!0});var o=new n.s(this._geometry,null);o.applyMatrix4(this._stack.ijk2LPS),o.visible=this._visible,this._meshStack=o,this._mesh=new n.c(this._meshStack,this._color),this._material=this._mesh.material,this.add(this._mesh)},e.prototype._update=function(){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null),this._create()},e.prototype.dispose=function(){this._mesh.material.dispose(),this._mesh.material=null,this._geometry.dispose(),this._geometry=null,this._material.dispose(),this._material=null},r(e,[{key:"visible",set:function(t){this._visible=t,this._mesh&&(this._mesh.visible=this._visible)},get:function(){return this._visible}},{key:"color",set:function(t){this._color=t,this._material&&this._material.color.set(this._color)},get:function(){return this._color}}]),e}(n.v)},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.uniforms=function(){return{uCanvasWidth:{type:"f",value:0,typeGLSL:"float"},uCanvasHeight:{type:"f",value:0,typeGLSL:"float"},uWidth:{type:"f",value:1,typeGLSL:"float"},uOpacity:{type:"f",value:1,typeGLSL:"float"},uTextureFilled:{type:"t",value:[],typeGLSL:"sampler2D"}}},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.uniforms=function(){return{uCanvasWidth:{type:"f",value:0,typeGLSL:"float"},uCanvasHeight:{type:"f",value:0,typeGLSL:"float"},uSlice:{type:"v4",value:[0,0,0,0],typeGLSL:"vec4"},uPlane1:{type:"v4",value:[0,0,0,0],typeGLSL:"vec4"},uPlaneColor1:{type:"v3",value:[1,1,0],typeGLSL:"vec3"},uPlane2:{type:"v4",value:[0,0,0,0],typeGLSL:"vec4"},uPlaneColor2:{type:"v3",value:[1,1,0],typeGLSL:"vec3"},uPlane3:{type:"v4",value:[0,0,0,0],typeGLSL:"vec4"},uPlaneColor3:{type:"v3",value:[1,1,0],typeGLSL:"vec3"}}},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._container=e,this._modes={load:{name:"load",color:"#FFF56F"},parse:{name:"parse",color:"#2196F3"}},this.requestAnimationFrameID=null,this._mode=null,this._value=null,this._total=null,this._totalFiles=null,this.init()}return t.prototype.free=function(){var t=this._container.getElementsByClassName("progress container");t.length>0&&t[0].parentNode.removeChild(t[0]),t=null,cancelAnimationFrame(this.requestAnimationFrameID)},t.prototype.init=function(){var t=this._domContainer();for(var e in this._modes)if(this._modes.hasOwnProperty(e)){var i=this._domBar(this._modes[e]);t.appendChild(i),i=null}this._container.appendChild(t),t=null,this.updateUI()},t.prototype.update=function(t,e,i){arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._mode=i,this._value=t,0===e?(this._total=t,this._value=Math.random()*t):this._total=e},t.prototype.updateUI=function(){var t=this;if(this.requestAnimationFrameID=requestAnimationFrame(function(){t.updateUI()}),!(this._modes.hasOwnProperty(this._mode)&&this._modes[this._mode].hasOwnProperty("name")&&this._modes[this._mode].hasOwnProperty("color")))return!1;var e=Math.round(this._value/this._total*100),i=this._modes[this._mode].color,n=this._container.getElementsByClassName("progress "+this._modes[this._mode].name);n.length>0&&(n[0].style.borderColor=i,n[0].style.width=e+"%"),n=null},t.prototype._domContainer=function(){var t=document.createElement("div");return t.classList.add("progress"),t.classList.add("container"),t.style.width="100%",t.style.height="8px",t.style.position="absolute",t.style.backgroundColor="rgba(158, 158, 158, 0.5)",t.style.top="0",t.style.zIndex="1",t},t.prototype._domBar=function(t){if(!t.hasOwnProperty("name")||!t.hasOwnProperty("color"))return console.log("Invalid mode provided."),console.log(t),!1;var e=document.createElement("div");return e.classList.add(t.name),e.classList.add("progress"),e.style.border="2px solid "+t.color,e.style.width="0%",e},n(t,[{key:"totalFiles",set:function(t){this._totalFiles=t},get:function(){return this._totalFiles}}]),t}();e.a=r},function(t,e,i){"use strict";i.d(e,"a",function(){return h});var n=i(23),r=i(32),o=i(31),a=i(30),s=i(45),l=i(0),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var h=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new l.L(0,0,0),c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new l.L(0,0,1),h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"IJK";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return u._stack=i,u._invert=u._stack.invert,u._lut="none",u._lutTexture=null,u._intensityAuto=!0,u._interpolation=1,u._index=n,u._windowWidth=null,u._windowCenter=null,u._opacity=1,u._rescaleSlope=null,u._rescaleIntercept=null,u._spacing=1,u._thickness=0,u._thicknessMethod=0,u._lowerThreshold=null,u._upperThreshold=null,u._canvasWidth=0,u._canvasHeight=0,u._borderColor=null,u._planePosition=s,u._planeDirection=c,u._aaBBspace=h,u._material=null,u._textures=[],u._shadersFragment=a.a,u._shadersVertex=o.a,u._uniforms=r.a.uniforms(),u._geometry=null,u._mesh=null,u._visible=!0,u._init(),u._create(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._init=function(){if(this._stack&&this._stack._prepared&&this._stack._packed)if("IJK"===this._aaBBspace)this._halfDimensions=this._stack.halfDimensionsIJK,this._center=new l.L(this._stack.halfDimensionsIJK.x-.5,this._stack.halfDimensionsIJK.y-.5,this._stack.halfDimensionsIJK.z-.5),this._toAABB=new l.r;else{var t=this._stack.AABBox();this._halfDimensions=t.clone().multiplyScalar(.5),this._center=this._stack.centerAABBox(),this._toAABB=this._stack.lps2AABB}},e.prototype._create=function(){if(this._stack&&this._stack.prepared&&this._stack.packed){try{var t=Object(n.a)();this._geometry=new t(this._halfDimensions,this._center,this._planePosition,this._planeDirection,this._toAABB)}catch(t){return console.log(t),void console.log("invalid slice geometry - exiting...")}this._geometry.vertices&&(this._material||(this._uniforms.uTextureSize.value=this._stack.textureSize,this._uniforms.uDataDimensions.value=[this._stack.dimensionsIJK.x,this._stack.dimensionsIJK.y,this._stack.dimensionsIJK.z],this._uniforms.uWorldToData.value=this._stack.lps2IJK,this._uniforms.uNumberOfChannels.value=this._stack.numberOfChannels,this._uniforms.uPixelType.value=this._stack.pixelType,this._uniforms.uBitsAllocated.value=this._stack.bitsAllocated,this._uniforms.uPackedPerPixel.value=this._stack.packedPerPixel,this._uniforms.uSpacing.value=this._spacing,this._uniforms.uThickness.value=this._thickness,this._uniforms.uThicknessMethod.value=this._thicknessMethod,this._prepareTexture(),this._uniforms.uTextureContainer.value=this._textures,this._stack.textureUnits>8&&(this._uniforms.uTextureContainer.length=14),this._createMaterial({side:l.j})),this.updateIntensitySettings(),this.updateIntensitySettingsUniforms(),this._mesh=new l.s(this._geometry,this._material),"IJK"===this._aaBBspace&&this._mesh.applyMatrix4(this._stack.ijk2LPS),this._mesh.visible=this._visible,this.add(this._mesh))}},e.prototype.updateIntensitySettings=function(){this._intensityAuto?(this.updateIntensitySetting("windowCenter"),this.updateIntensitySetting("windowWidth"),this.updateIntensitySetting("rescaleSlope"),this.updateIntensitySetting("rescaleIntercept")):(null===this._windowCenter&&(this._windowCenter=this._stack.windowCenter),null===this._windowWidth&&(this._windowWidth=this._stack.windowWidth),null===this._rescaleSlope&&(this._rescaleSlope=this._stack.rescaleSlope),null===this._rescaleIntercept&&(this._rescaleIntercept=this._stack.rescaleIntercept)),null===this._upperThreshold&&(this._upperThreshold=this._stack._minMax[1]),null===this._lowerThreshold&&(this._lowerThreshold=this._stack._minMax[0])},e.prototype.updateIntensitySettingsUniforms=function(){var t=0;this._stack._minMax[0]<0&&(t-=this._stack._minMax[0]),this._uniforms.uRescaleSlopeIntercept.value=[this._rescaleSlope,this._rescaleIntercept],this._uniforms.uWindowCenterWidth.value=[t+this._windowCenter,this._windowWidth],this._uniforms.uOpacity.value=this._opacity,this._uniforms.uLowerUpperThreshold.value=[t+this._lowerThreshold,t+this._upperThreshold],this._uniforms.uInvert.value=!0===this._invert?1:0,this._uniforms.uInterpolation.value=this._interpolation,"none"===this._lut?this._uniforms.uLut.value=0:(this._uniforms.uLut.value=1,this._uniforms.uTextureLUT.value=this._lutTexture)},e.prototype.updateIntensitySetting=function(t){this._stack.frame[this._index]&&this._stack.frame[this._index][t]?this["_"+t]=this._stack.frame[this._index][t]:this["_"+t]=this._stack[t]},e.prototype._update=function(){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh=null),this._create()},e.prototype.dispose=function(){for(var t=0;t<this._textures.length;t++)this._textures[t].dispose(),this._textures[t]=null;this._textures=null,this._shadersFragment=null,this._shadersVertex=null,this._uniforms=null,this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null},e.prototype.cartesianEquation=function(){if(!this._geometry||!this._geometry.vertices||this._geometry.vertices.length<3)return new l.M;var t=this._geometry.vertices,e=this._stack.ijk2LPS,i=new l.L(t[0].x,t[0].y,t[0].z).applyMatrix4(e),n=new l.L(t[1].x,t[1].y,t[1].z).applyMatrix4(e),r=new l.L(t[2].x,t[2].y,t[2].z).applyMatrix4(e),o=new l.L,a=new l.L,s=o.subVectors(r,n).cross(a.subVectors(i,n)).normalize();return new l.M(s.x,s.y,s.z,-s.dot(i))},c(e,[{key:"stack",get:function(){return this._stack},set:function(t){this._stack=t}},{key:"spacing",get:function(){return this._spacing},set:function(t){this._spacing=t,this._uniforms.uSpacing.value=this._spacing}},{key:"thickness",get:function(){return this._thickness},set:function(t){this._thickness=t,this._uniforms.uThickness.value=this._thickness}},{key:"thicknessMethod",get:function(){return this._thicknessMethod},set:function(t){this._thicknessMethod=t,this._uniforms.uThicknessMethod.value=this._thicknessMethod}},{key:"windowWidth",get:function(){return this._windowWidth},set:function(t){this._windowWidth=t,this.updateIntensitySettingsUniforms()}},{key:"windowCenter",get:function(){return this._windowCenter},set:function(t){this._windowCenter=t,this.updateIntensitySettingsUniforms()}},{key:"opacity",get:function(){return this._opacity},set:function(t){this._opacity=t,this.updateIntensitySettingsUniforms()}},{key:"upperThreshold",get:function(){return this._upperThreshold},set:function(t){this._upperThreshold=t,this.updateIntensitySettingsUniforms()}},{key:"lowerThreshold",get:function(){return this._lowerThreshold},set:function(t){this._lowerThreshold=t,this.updateIntensitySettingsUniforms()}},{key:"rescaleSlope",get:function(){return this._rescaleSlope},set:function(t){this._rescaleSlope=t,this.updateIntensitySettingsUniforms()}},{key:"rescaleIntercept",get:function(){return this._rescaleIntercept},set:function(t){this._rescaleIntercept=t,this.updateIntensitySettingsUniforms()}},{key:"invert",get:function(){return this._invert},set:function(t){this._invert=t,this.updateIntensitySettingsUniforms()}},{key:"lut",get:function(){return this._lut},set:function(t){this._lut=t}},{key:"lutTexture",get:function(){return this._lutTexture},set:function(t){this._lutTexture=t,this.updateIntensitySettingsUniforms()}},{key:"intensityAuto",get:function(){return this._intensityAuto},set:function(t){this._intensityAuto=t,this.updateIntensitySettings(),this.updateIntensitySettingsUniforms()}},{key:"interpolation",get:function(){return this._interpolation},set:function(t){this._interpolation=t,this.updateIntensitySettingsUniforms(),this._updateMaterial()}},{key:"index",get:function(){return this._index},set:function(t){this._index=t,this._update()}},{key:"planePosition",set:function(t){this._planePosition=t,this._update()},get:function(){return this._planePosition}},{key:"planeDirection",set:function(t){this._planeDirection=t,this._update()},get:function(){return this._planeDirection}},{key:"halfDimensions",set:function(t){this._halfDimensions=t},get:function(){return this._halfDimensions}},{key:"center",set:function(t){this._center=t},get:function(){return this._center}},{key:"aabbSpace",set:function(t){this._aaBBspace=t,this._init()},get:function(){return this._aaBBspace}},{key:"mesh",set:function(t){this._mesh=t},get:function(){return this._mesh}},{key:"geometry",set:function(t){this._geometry=t},get:function(){return this._geometry}},{key:"canvasWidth",set:function(t){this._canvasWidth=t,this._uniforms.uCanvasWidth.value=this._canvasWidth},get:function(){return this._canvasWidth}},{key:"canvasHeight",set:function(t){this._canvasHeight=t,this._uniforms.uCanvasHeight.value=this._canvasHeight},get:function(){return this._canvasHeight}},{key:"borderColor",set:function(t){this._borderColor=t,this._uniforms.uBorderColor.value=new l.g(t)},get:function(){return this._borderColor}}]),e}(s.a)},function(t,e,i){"use strict";var n=i(21);var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._uniforms=e,this._functions={},this._main=""}return t.prototype.functions=function(){""===this._main&&this.main();var t="";for(var e in this._functions)t+=this._functions[e]+"\n";return t},t.prototype.uniforms=function(){var t="";for(var e in this._uniforms){var i=this._uniforms[e];t+="uniform "+i.typeGLSL+" "+e,i&&i.length&&(t+="["+i.length+"]"),t+=";\n"}return t},t.prototype.main=function(){this._main="\nvoid main(void) {\n\n  // draw border if slice is cropped\n  // float uBorderDashLength = 10.;\n\n  if( uCanvasWidth > 0. &&\n      ((gl_FragCoord.x > uBorderMargin && (gl_FragCoord.x - uBorderMargin) < uBorderWidth) ||\n       (gl_FragCoord.x < (uCanvasWidth - uBorderMargin) && (gl_FragCoord.x + uBorderMargin) > (uCanvasWidth - uBorderWidth) ))){\n    float valueY = mod(gl_FragCoord.y, 2. * uBorderDashLength);\n    if( valueY < uBorderDashLength && gl_FragCoord.y > uBorderMargin && gl_FragCoord.y < (uCanvasHeight - uBorderMargin) ){\n      gl_FragColor = vec4(uBorderColor, 1.);\n      return;\n    }\n  }\n\n  if( uCanvasHeight > 0. &&\n      ((gl_FragCoord.y > uBorderMargin && (gl_FragCoord.y - uBorderMargin) < uBorderWidth) ||\n       (gl_FragCoord.y < (uCanvasHeight - uBorderMargin) && (gl_FragCoord.y + uBorderMargin) > (uCanvasHeight - uBorderWidth) ))){\n    float valueX = mod(gl_FragCoord.x, 2. * uBorderDashLength);\n    if( valueX < uBorderDashLength && gl_FragCoord.x > uBorderMargin && gl_FragCoord.x < (uCanvasWidth - uBorderMargin) ){\n      gl_FragColor = vec4(uBorderColor, 1.);\n      return;\n    }\n  }\n\n  // get texture coordinates of current pixel\n  vec4 dataValue = vec4(0.);\n  vec3 gradient = vec3(1.); // gradient calculations will be skipped if it is equal to vec3(1.) \n  float steps = floor(uThickness / uSpacing + 0.5);\n\n  if (steps > 1.) {\n    vec3 origin = vPos - uThickness * 0.5 * vNormal;\n    vec4 dataValueAcc = vec4(0.);\n    for (float step = 0.; step < 128.; step++) {\n      if (step >= steps) {\n        break;\n      }\n\n      vec4 dataCoordinates = uWorldToData * vec4(origin + step * uSpacing * vNormal, 1.);\n      vec3 currentVoxel = dataCoordinates.xyz;\n      "+Object(n.a)(this,"currentVoxel","dataValueAcc","gradient")+";\n\n      if (step == 0.) {\n        dataValue.r = dataValueAcc.r;\n        continue;\n      }\n\n      if (uThicknessMethod == 0) {\n        dataValue.r = max(dataValueAcc.r, dataValue.r);\n      }\n      if (uThicknessMethod == 1) {\n        dataValue.r += dataValueAcc.r;\n      }\n      if (uThicknessMethod == 2) {\n        dataValue.r = min(dataValueAcc.r, dataValue.r);\n      }\n    }\n\n    if (uThicknessMethod == 1) {\n      dataValue.r /= steps;\n    }\n  } else {\n    vec4 dataCoordinates = uWorldToData * vec4(vPos, 1.);\n    vec3 currentVoxel = dataCoordinates.xyz;\n    "+Object(n.a)(this,"currentVoxel","dataValue","gradient")+"\n  }\n\n  if(uNumberOfChannels == 1){\n    // rescale/slope\n    float realIntensity = dataValue.r * uRescaleSlopeIntercept[0] + uRescaleSlopeIntercept[1];\n  \n    // threshold\n    if (realIntensity < uLowerUpperThreshold[0] || realIntensity > uLowerUpperThreshold[1]) {\n      discard;\n    }\n  \n    // normalize\n    float windowMin = uWindowCenterWidth[0] - uWindowCenterWidth[1] * 0.5;\n    float normalizedIntensity =\n      ( realIntensity - windowMin ) / uWindowCenterWidth[1];\n    dataValue.r = dataValue.g = dataValue.b = normalizedIntensity;\n    dataValue.a = 1.;\n\n    // apply LUT\n    if(uLut == 1){\n      // should opacity be grabbed there?\n      dataValue = texture2D( uTextureLUT, vec2( normalizedIntensity , 1.0) );\n    }\n  \n    // apply segmentation\n    if(uLutSegmentation == 1){\n      // should opacity be grabbed there?\n      //\n      float textureWidth = 256.;\n      float textureHeight = 128.;\n      float min = 0.;\n      // start at 0!\n      int adjustedIntensity = int(floor(realIntensity + 0.5));\n  \n      // Get row and column in the texture\n      int colIndex = int(mod(float(adjustedIntensity), textureWidth));\n      int rowIndex = int(floor(float(adjustedIntensity)/textureWidth));\n  \n      float texWidth = 1./textureWidth;\n      float texHeight = 1./textureHeight;\n    \n      // Map row and column to uv\n      vec2 uv = vec2(0,0);\n      uv.x = 0.5 * texWidth + (texWidth * float(colIndex));\n      uv.y = 1. - (0.5 * texHeight + float(rowIndex) * texHeight);\n  \n      dataValue = texture2D( uTextureLUTSegmentation, uv );\n    }\n  }\n\n  if(uInvert == 1){\n    dataValue.xyz = vec3(1.) - dataValue.xyz;\n  }\n\n  dataValue.a = dataValue.a*uOpacity;\n\n  gl_FragColor = dataValue;\n}\n   "},t.prototype.compute=function(){return"\n// uniforms\n"+this.uniforms()+"\n\n// varying (should fetch it from vertex directly)\nvarying vec3 vPos;\nvarying vec3 vNormal;\n\n// tailored functions\n"+this.functions()+"\n\n// main loop\n"+this._main+"\n      "},t}();e.a=r},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.compute=function(){return"\nvarying vec3 vPos;\nvarying vec3 vNormal;\n\nvoid main() {\n  vNormal = normal;\n  vPos = (modelMatrix * vec4(position, 1.0 )).xyz;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n\n}\n        "},t}();e.a=n},function(t,e,i){"use strict";var n=i(6);var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.uniforms=function(){return{uTextureSize:{type:"i",value:0,typeGLSL:"int"},uTextureContainer:{type:"tv",value:[],typeGLSL:"sampler2D",length:7},uDataDimensions:{type:"iv",value:[0,0,0],typeGLSL:"ivec3"},uWorldToData:{type:"m4",value:new n.a,typeGLSL:"mat4"},uWindowCenterWidth:{type:"fv1",value:[0,0],typeGLSL:"float",length:2},uLowerUpperThreshold:{type:"fv1",value:[0,0],typeGLSL:"float",length:2},uRescaleSlopeIntercept:{type:"fv1",value:[0,0],typeGLSL:"float",length:2},uNumberOfChannels:{type:"i",value:1,typeGLSL:"int"},uBitsAllocated:{type:"i",value:8,typeGLSL:"int"},uInvert:{type:"i",value:0,typeGLSL:"int"},uLut:{type:"i",value:0,typeGLSL:"int"},uTextureLUT:{type:"t",value:[],typeGLSL:"sampler2D"},uLutSegmentation:{type:"i",value:0,typeGLSL:"int"},uTextureLUTSegmentation:{type:"t",value:[],typeGLSL:"sampler2D"},uPixelType:{type:"i",value:0,typeGLSL:"int"},uPackedPerPixel:{type:"i",value:1,typeGLSL:"int"},uInterpolation:{type:"i",value:1,typeGLSL:"int"},uCanvasWidth:{type:"f",value:0,typeGLSL:"float"},uCanvasHeight:{type:"f",value:0,typeGLSL:"float"},uBorderColor:{type:"v3",value:[1,0,.5],typeGLSL:"vec3"},uBorderWidth:{type:"f",value:2,typeGLSL:"float"},uBorderMargin:{type:"f",value:2,typeGLSL:"float"},uBorderDashLength:{type:"f",value:10,typeGLSL:"float"},uOpacity:{type:"f",value:1,typeGLSL:"float"},uSpacing:{type:"f",value:0,typeGLSL:"float"},uThickness:{type:"f",value:0,typeGLSL:"float"},uThicknessMethod:{type:"i",value:0,typeGLSL:"int"}}},t}();e.a=r},function(t,e,i){"use strict";var n=i(21),r=i(120);var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._uniforms=e,this._functions={},this._main=""}return t.prototype.functions=function(){""===this._main&&this.main();var t="";for(var e in this._functions)t+=this._functions[e]+"\n";return t},t.prototype.uniforms=function(){var t="";for(var e in this._uniforms){var i=this._uniforms[e];t+="uniform "+i.typeGLSL+" "+e,i&&i.length&&(t+="["+i.length+"]"),t+=";\n"}return t},t.prototype.main=function(){this._main="\nvoid getIntensity(in vec3 dataCoordinates, out float intensity, out vec3 gradient){\n\n  vec4 dataValue = vec4(0., 0., 0., 0.);\n  "+Object(n.a)(this,"dataCoordinates","dataValue","gradient")+"\n\n  intensity = dataValue.r;\n\n  // rescale/slope\n  intensity = intensity*uRescaleSlopeIntercept[0] + uRescaleSlopeIntercept[1];\n  // window level\n  float windowMin = uWindowCenterWidth[0] - uWindowCenterWidth[1] * 0.5;\n  intensity = ( intensity - windowMin ) / uWindowCenterWidth[1];\n}\n\nmat4 inverse(mat4 m) {\n  float\n    a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n    a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n    a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n    a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n    b00 = a00 * a11 - a01 * a10,\n    b01 = a00 * a12 - a02 * a10,\n    b02 = a00 * a13 - a03 * a10,\n    b03 = a01 * a12 - a02 * a11,\n    b04 = a01 * a13 - a03 * a11,\n    b05 = a02 * a13 - a03 * a12,\n    b06 = a20 * a31 - a21 * a30,\n    b07 = a20 * a32 - a22 * a30,\n    b08 = a20 * a33 - a23 * a30,\n    b09 = a21 * a32 - a22 * a31,\n    b10 = a21 * a33 - a23 * a31,\n    b11 = a22 * a33 - a23 * a32,\n\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n    a11 * b11 - a12 * b10 + a13 * b09,\n    a02 * b10 - a01 * b11 - a03 * b09,\n    a31 * b05 - a32 * b04 + a33 * b03,\n    a22 * b04 - a21 * b05 - a23 * b03,\n    a12 * b08 - a10 * b11 - a13 * b07,\n    a00 * b11 - a02 * b08 + a03 * b07,\n    a32 * b02 - a30 * b05 - a33 * b01,\n    a20 * b05 - a22 * b02 + a23 * b01,\n    a10 * b10 - a11 * b08 + a13 * b06,\n    a01 * b08 - a00 * b10 - a03 * b06,\n    a30 * b04 - a31 * b02 + a33 * b00,\n    a21 * b02 - a20 * b04 - a23 * b00,\n    a11 * b07 - a10 * b09 - a12 * b06,\n    a00 * b09 - a01 * b07 + a02 * b06,\n    a31 * b01 - a30 * b03 - a32 * b00,\n    a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n/**\n * Adapted from original sources\n * \n * Original code: \n * http://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/\n * https://www.shadertoy.com/view/lt33z7\n * \n * The vec3 returned is the RGB color of the light's contribution.\n *\n * k_a: Ambient color\n * k_d: Diffuse color\n * k_s: Specular color\n * alpha: Shininess coefficient\n * p: position of point being lit\n * eye: the position of the camera\n * lightPos: the position of the light\n * lightIntensity: color/intensity of the light\n *\n * See https://en.wikipedia.org/wiki/Phong_reflection_model#Description\n */\nvec3 phongShading(vec3 k_a, vec3 k_d, vec3 k_s, float shininess, vec3 p, vec3 eye,\n  vec3 lightPos, vec3 lightIntensity, vec3 normal) {\n  vec3 N = normal;\n  vec3 L = lightPos - p;\n  if (length(L) > 0.) {\n    L = L / length(L);\n  }\n  vec3 V = eye - p;\n  if (length(V) > 0.) {\n    V = V / length(V);\n  }\n  vec3 R = reflect(-L, N);\n  if (length(R) > 0.) {\n    R = R / length(R);\n  }\n\n  // https://en.wikipedia.org/wiki/Blinn%E2%80%93Phong_shading_model\n  vec3 h = L + V;\n  vec3 H = h;\n  if (length(h) > 0.) {\n    H = H / length(h);\n  }\n\n  float dotLN = dot(L, N);\n  float dotRV = dot(R, V);\n\n  if (dotLN < 0.) {\n    // Light not visible from this point on the surface\n    return k_a;\n  } \n\n  if (dotRV < 0.) {\n    // Light reflection in opposite direction as viewer, apply only diffuse\n    // component\n    return k_a + lightIntensity * (k_d * dotLN);\n  }\n\n  float specAngle = max(dot(H, normal), 0.0);\n  float specular = pow(dotRV, shininess); //pow(specAngle, shininess); // \n  return k_a + lightIntensity * (k_d * dotLN  + k_s * specular);\n}\n\nfloat PI = 3.14159265358979323846264 * 00000.1; // PI\n\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv) {\n  const highp float a = 12.9898;\n  const highp float b = 78.233;\n  const highp float c = 43758.5453;\n  highp float dt = dot(uv.xy, vec2(a, b)), sn = mod(dt, PI);\n  return fract(sin(sn) * c);\n}\n\nvoid main(void) {\n  const int maxSteps = 1024;\n\n  // the ray\n  vec3 rayOrigin = cameraPosition;\n  vec3 rayDirection = normalize(vPos.xyz - rayOrigin);\n\n  vec3 lightOrigin = uLightPositionInCamera == 1 ? cameraPosition : uLightPosition;\n\n  // the Axe-Aligned B-Box\n  vec3 AABBMin = vec3(uWorldBBox[0], uWorldBBox[2], uWorldBBox[4]);\n  vec3 AABBMax = vec3(uWorldBBox[1], uWorldBBox[3], uWorldBBox[5]);\n\n  // Intersection ray/bbox\n  float tNear, tFar;\n  bool intersect = false;\n  "+r.a.api(this,"rayOrigin","rayDirection","AABBMin","AABBMax","tNear","tFar","intersect")+'\n  if (tNear < 0.0) tNear = 0.0;\n\n  // x / y should be within o-1\n  // should\n  float offset = rand(gl_FragCoord.xy);\n\n  // init the ray marching\n  float tStep = (tFar - tNear) / float(uSteps);\n  float tCurrent = tNear + offset * tStep;\n  vec4 accumulatedColor = vec4(0.0);\n  float accumulatedAlpha = 0.0;\n\n  // MIP volume rendering\n  float maxIntensity = 0.0;\n\n  mat4 dataToWorld = inverse(uWorldToData);\n\n  // rayOrigin -= rayDirection * 0.1; // gold_noise(vPos.xz, vPos.y) / 100.;  \n\n  for(int rayStep = 0; rayStep < maxSteps; rayStep++){\n    vec3 currentPosition = rayOrigin + rayDirection * tCurrent;\n    // some non-linear FUN\n    // some occlusion issue to be fixed\n    vec3 transformedPosition = currentPosition; //transformPoint(currentPosition, uAmplitude, uFrequence);\n    // world to data coordinates\n    // rounding trick\n    // first center of first voxel in data space is CENTERED on (0,0,0)\n    vec4 dataCoordinatesRaw = uWorldToData * vec4(transformedPosition, 1.0);\n    vec3 currentVoxel = vec3(dataCoordinatesRaw.x, dataCoordinatesRaw.y, dataCoordinatesRaw.z);\n    float intensity = 0.0;\n    vec3 gradient = vec3(0., 0., 0.);\n    getIntensity(currentVoxel, intensity, gradient);\n    // map gradient to world space and normalize before using\n    // we avoid to call "normalize" as it may be undefined if vector length == 0.\n    gradient = (vec3(dataToWorld * vec4(gradient, 0.)));\n    if (length(gradient) > 0.0) {\n      gradient = normalize(gradient);\n    }\n\n    vec4 colorSample;\n    float alphaSample;\n    if(uLut == 1){\n      vec4 colorFromLUT = texture2D( uTextureLUT, vec2( intensity, 1.0) );\n      // 256 colors\n      colorSample = colorFromLUT;\n      alphaSample = colorFromLUT.a;\n    }\n    else{\n      alphaSample = intensity;\n      colorSample.r = colorSample.g = colorSample.b = intensity;\n    }\n\n    // ray marching algorithm\n    // shading on\n    // interpolation on\n    if (uAlgorithm == 0 && uShading == 1 && uInterpolation != 0) {\n      //  && alphaSample > .3\n      vec3 ambientComponent = uSampleColorToAmbient == 1 ? colorSample.xyz : uAmbientColor;\n      ambientComponent *= uAmbient;\n      vec3 diffuseComponent = uSampleColorToDiffuse == 1 ? colorSample.xyz : uDiffuseColor;\n      diffuseComponent *= uDiffuse;\n      vec3 specularComponent = uSpecular * uSpecularColor;\n      float shininess = uShininess;\n      vec3 vIntensity = uIntensity;\n\n      colorSample.xyz += phongShading(\n        ambientComponent,\n        diffuseComponent,\n        specularComponent,\n        shininess,\n        currentPosition.xyz,\n        rayOrigin.xyz,\n        lightOrigin.xyz,\n        vIntensity,\n        gradient);\n    }\n\n    alphaSample = 1.0 - pow((1.0- alphaSample),tStep*uAlphaCorrection);\n    alphaSample *= (1.0 - accumulatedAlpha);\n\n    accumulatedColor += alphaSample * colorSample;\n    accumulatedAlpha += alphaSample;\n\n    tCurrent += tStep;\n\n    if (tCurrent > tFar || (uAlgorithm == 0 && accumulatedAlpha >= 1.0)) break;\n\n    if (uAlgorithm == 1 && (intensity >= maxIntensity)) {\n      maxIntensity = intensity;\n      accumulatedColor = colorSample;\n      accumulatedAlpha = 1.;\n    }\n  }\n\n  gl_FragColor = vec4(accumulatedColor.xyz, accumulatedAlpha);\n}\n   '},t.prototype.compute=function(){return"\n// uniforms\n"+this.uniforms()+"\n\n// varying (should fetch it from vertex directly)\nvarying vec4      vPos;\n\n// tailored functions\n"+this.functions()+"\n\n// main loop\n"+this._main+"\n      "},t}();e.a=o},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.compute=function(){return"\nvarying vec4 vPos;\n\n//\n// main\n//\nvoid main() {\n\n  vPos = modelMatrix * vec4(position, 1.0 );\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n\n}\n        "},t}();e.a=n},function(t,e,i){"use strict";var n=i(14),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i._concatenationUID=-1,i._seriesInstanceUID=-1,i._transferSyntaxUID="",i._seriesNumber=-1,i._seriesDescription="",i._seriesDate="",i._studyDescription="",i._studyDate="",i._accessionNumber=-1,i._modality="Modality not set",i._dimensionIndexSequence=[],i._numberOfFrames=0,i._numberOfChannels=1,i._rawHeader=null,i._patientID="",i._patientName="",i._patientAge="",i._patientBirthdate="",i._patientSex="",i._segmentationType=null,i._segmentationSegments=[],i._stack=[],i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.validate=function(e){return!!(t.prototype.validate.call(this,e)&&"function"==typeof e.mergeSeries&&e.hasOwnProperty("_seriesInstanceUID")&&e.hasOwnProperty("_numberOfFrames")&&e.hasOwnProperty("_numberOfChannels")&&e.hasOwnProperty("_stack")&&void 0!==e._stack&&Array===e._stack.constructor)},e.prototype.merge=function(t){return!!this.validate(t)&&(this._seriesInstanceUID===t.seriesInstanceUID&&(t.stack[0]&&(0===this._stack[0]._numberOfFrames&&this._stack[0].computeNumberOfFrames(),this._stack[0].computeCosines(),0===t.stack[0]._numberOfFrames&&t.stack[0].computeNumberOfFrames(),t.stack[0].computeCosines()),this.mergeModels(this._stack,t.stack)))},e.prototype.mergeSeries=function(t){var e=[this];return this.mergeModels(e,t),e},r(e,[{key:"seriesInstanceUID",set:function(t){this._seriesInstanceUID=t},get:function(){return this._seriesInstanceUID}},{key:"transferSyntaxUID",set:function(t){this._transferSyntaxUID=t},get:function(){return this._transferSyntaxUID}},{key:"transferSyntaxUIDLabel",get:function(){switch(this._transferSyntaxUID){case"1.2.840.10008.1.2.4.90":return"JPEG 2000 Lossless";case"1.2.840.10008.1.2.4.91":return"JPEG 2000 Lossy";case"1.2.840.10008.1.2.4.57":return"JPEG Lossless, Nonhierarchical (Processes 14)";case"1.2.840.10008.1.2.4.70":return"JPEG Lossless, Nonhierarchical (Processes 14 [Selection 1])";case"1.2.840.10008.1.2.4.50":return"JPEG Baseline lossy process 1 (8 bit)";case"1.2.840.10008.1.2.4.51":return"JPEG Baseline lossy process 2 & 4 (12 bit)";case"1.2.840.10008.1.2":return"Implicit VR Little Endian";case"1.2.840.10008.1.2.1":return"Explicit VR Little Endian";case"1.2.840.10008.1.2.2":return"Explicit VR Big Endian";default:return"Unknown transfersyntax: "+this._transferSyntaxUID}}},{key:"studyDate",set:function(t){this._studyDate=t},get:function(){return this._studyDate}},{key:"studyDescription",set:function(t){this._studyDescription=t},get:function(){return this._studyDescription}},{key:"seriesDate",set:function(t){this._seriesDate=t},get:function(){return this._seriesDate}},{key:"seriesDescription",set:function(t){this._seriesDescription=t},get:function(){return this._seriesDescription}},{key:"rawHeader",set:function(t){this._rawHeader=t},get:function(){return this._rawHeader}},{key:"patientID",set:function(t){this._patientID=t},get:function(){return this._patientID}},{key:"patientName",set:function(t){this._patientName=t},get:function(){return this._patientName}},{key:"patientAge",set:function(t){this._patientAge=t},get:function(){return this._patientAge}},{key:"patientBirthdate",set:function(t){this._patientBirthdate=t},get:function(){return this._patientBirthdate}},{key:"patientSex",set:function(t){this._patientSex=t},get:function(){return this._patientSex}},{key:"numberOfFrames",set:function(t){this._numberOfFrames=t},get:function(){return this._numberOfFrames}},{key:"numberOfChannels",set:function(t){this._numberOfChannels=t},get:function(){return this._numberOfChannels}},{key:"stack",set:function(t){this._stack=t},get:function(){return this._stack}},{key:"modality",set:function(t){this._modality=t},get:function(){return this._modality}},{key:"segmentationType",set:function(t){this._segmentationType=t},get:function(){return this._segmentationType}},{key:"segmentationSegments",set:function(t){this._segmentationSegments=t},get:function(){return this._segmentationSegments}}]),e}(n.a);e.a=o},function(t,e,i){"use strict";var n=i(6),r=i(1),o=i(15),a=i(7),s=i(2),l=i(14),c=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var h=i(137),u=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i._uid=null,i._stackID=-1,i._frame=[],i._numberOfFrames=0,i._rows=0,i._columns=0,i._numberOfChannels=1,i._bitsAllocated=8,i._pixelType=0,i._pixelRepresentation=0,i._textureSize=4096,i._textureUnits=7,i._rawData=[],i._windowCenter=0,i._windowWidth=0,i._rescaleSlope=1,i._rescaleIntercept=0,i._minMax=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],i._regMatrix=new n.a,i._ijk2LPS=null,i._lps2IJK=null,i._aabb2LPS=null,i._lps2AABB=null,i._dimensionsIJK=null,i._halfDimensionsIJK=null,i._spacing=new r.a(1,1,1),i._spacingBetweenSlices=0,i._sliceThickness=0,i._origin=null,i._rightHanded=!0,i._xCosine=new r.a(1,0,0),i._yCosine=new r.a(0,1,0),i._zCosine=new r.a(0,0,1),i._prepared=!1,i._packed=!1,i._packedPerPixel=1,i._modality="Modality not set",i._segmentationType=null,i._segmentationSegments=[],i._segmentationDefaultColor=[63,174,128],i._frameSegment=[],i._segmentationLUT=[],i._segmentationLUTO=[],i._invert=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.prepareSegmentation=function(){this._frameSegment=this._frame;var t=[];this.computeCosines(),this._frame.map(this._computeDistanceArrayMap.bind(null,this._zCosine)),this._frame.sort(this._sortDistanceArraySort);for(var e=-1,i=0;i<this._frame.length;i++){if(t[e]&&t[e]._dist==this._frame[i]._dist)for(var n=0;n<t[e]._rows*t[e]._columns;n++)t[e]._pixelData[n]+=this._frame[i].pixelData[n]*this._frame[i]._referencedSegmentNumber;else{t.push(this._frame[i]),e++;for(var r=0;r<t[e]._rows*t[e]._columns;r++)t[e]._pixelData[r]*=this._frame[i]._referencedSegmentNumber}t[e].minMax=s.a.minMax(t[e]._pixelData)}for(var o={},l=0,c=0;c<this._segmentationSegments.length;c++){l=Math.max(l,parseInt(this._segmentationSegments[c].segmentNumber,10));var h=this._segmentationSegments[c].recommendedDisplayCIELab;o[this._segmentationSegments[c].segmentNumber]=null===h?this._segmentationDefaultColor:a.b.cielab2RGB.apply(a.b,h)}for(var u=0;u<=l;u++){var d=u/l,f=u?1:0,p=[0,0,0];o.hasOwnProperty(u.toString())&&(p=o[u.toString()]),p[0]/=255,p[1]/=255,p[2]/=255,this._segmentationLUT.push([d].concat(p)),this._segmentationLUTO.push([d,f])}this._frame=t},e.prototype.prepare=function(){"SEG"===this._modality&&this.prepareSegmentation(),this.computeNumberOfFrames(),this._rows=this._frame[0].rows,this._columns=this._frame[0].columns,this._dimensionsIJK=new r.a(this._columns,this._rows,this._numberOfFrames),this._halfDimensionsIJK=new r.a(this._dimensionsIJK.x/2,this._dimensionsIJK.y/2,this._dimensionsIJK.z/2),this._spacingBetweenSlices=this._frame[0].spacingBetweenSlices,this._sliceThickness=this._frame[0].sliceThickness,this.computeCosines(),this._numberOfFrames>1&&this.orderFrames(),this.computeSpacing(),this._frame[0].imagePosition||(this._frame[0].imagePosition=[0,0,0]),this._frame[0].imageOrientation||(this._frame[0].imageOrientation=[1,0,0,0,1,0]),this._origin=this._arrayToVector3(this._frame[0].imagePosition,0),this.computeIJK2LPS(),this.computeLPS2AABB();var t=Math.floor(this._frame.length/2),e=this._frame[t];this._rescaleSlope=e.rescaleSlope||1,this._rescaleIntercept=e.rescaleIntercept||0,this.computeMinMaxIntensities(),this._minMax[0]=s.a.rescaleSlopeIntercept(this._minMax[0],this._rescaleSlope,this._rescaleIntercept),this._minMax[1]=s.a.rescaleSlopeIntercept(this._minMax[1],this._rescaleSlope,this._rescaleIntercept),this._windowWidth=e.windowWidth||this._minMax[1]-this._minMax[0],this._windowCenter=e.windowCenter||this._minMax[0]+this._windowWidth/2,this._bitsAllocated=e.bitsAllocated,this._prepared=!0},e.prototype.packEchos=function(){for(var t=[],e=0;e<this._frame.length;e+=4){for(var i=this._frame[e],n=0;n<this._rows*this._columns;n++){for(var o=1;o<4;o++)i.pixelData[n]+=this._frame[e+o].pixelData[n];i.pixelData[n]/=4}t.push(i)}this._frame=t,this._numberOfFrames=this._frame.length,this._dimensionsIJK=new r.a(this._columns,this._rows,this._numberOfFrames),this._halfDimensionsIJK=new r.a(this._dimensionsIJK.x/2,this._dimensionsIJK.y/2,this._dimensionsIJK.z/2)},e.prototype.computeNumberOfFrames=function(){if(!(this._frame&&this._frame.length>0))return console.warn("_frame doesn't contain anything...."),console.warn(this._frame),!1;this._numberOfFrames=this._frame.length},e.prototype.computeCosines=function(){if(this._frame&&this._frame[0]){var t=this._frame[0].cosines();this._xCosine=t[0],this._yCosine=t[1],this._zCosine=t[2]}},e.prototype.orderFrames=function(){this._frame[0].dimensionIndexValues?this._frame.sort(this._orderFrameOnDimensionIndicesArraySort):this._frame[0].imagePosition&&this._frame[0].imageOrientation&&this._frame[1]&&this._frame[1].imagePosition&&this._frame[1].imageOrientation&&this._frame[0].imagePosition.join()!==this._frame[1].imagePosition.join()?(this._frame.map(this._computeDistanceArrayMap.bind(null,this._zCosine)),this._frame.sort(this._sortDistanceArraySort)):null!==this._frame[0].instanceNumber&&this._frame[1]&&null!==this._frame[1].instanceNumber&&this._frame[0].instanceNumber!==this._frame[1].instanceNumber?this._frame.sort(this._sortInstanceNumberArraySort):this._frame[0].sopInstanceUID&&this._frame[1]&&this._frame[1].sopInstanceUID&&this._frame[0].sopInstanceUID!==this._frame[1].sopInstanceUID?this._frame.sort(this._sortSopInstanceUIDArraySort):this._frame[0].imagePosition&&console.warn("do not know how to order the frames...")},e.prototype.computeSpacing=function(){this.xySpacing(),this.zSpacing()},e.prototype.zSpacing=function(){this._numberOfFrames>1&&(this._frame[0].pixelSpacing&&this._frame[0].pixelSpacing[2]?this._spacing.z=this._frame[0].pixelSpacing[2]:(this._frame.map(this._computeDistanceArrayMap.bind(null,this._zCosine)),this._frame[1].dist!==this._frame[0].dist?(this._frame.sort(this._sortDistanceArraySort),this._spacing.z=this._frame[1].dist-this._frame[0].dist):this._spacingBetweenSlices?this._spacing.z=this._spacingBetweenSlices:this._frame[0].sliceThickness&&(this._spacing.z=this._frame[0].sliceThickness))),0===this._spacing.z&&(this._spacing.z=1)},e.prototype.xySpacing=function(){if(this._frame&&this._frame[0]){var t=this._frame[0].spacingXY();this._spacing.x=t[0],this._spacing.y=t[1]}},e.prototype.computeMinMaxIntensities=function(){for(var t=0;t<this._frame.length;t++){var e=this._frame[t].minMax[0];Number.isNaN(e)||(this._minMax[0]=Math.min(this._minMax[0],e));var i=this._frame[t].minMax[1];Number.isNaN(i)||(this._minMax[1]=Math.max(this._minMax[1],i))}},e.prototype.computeIJK2LPS=function(){this._ijk2LPS=s.a.ijk2LPS(this._xCosine,this._yCosine,this._zCosine,this._spacing,this._origin,this._regMatrix),this._lps2IJK=new n.a,this._lps2IJK.getInverse(this._ijk2LPS)},e.prototype.computeLPS2AABB=function(){this._aabb2LPS=s.a.aabb2LPS(this._xCosine,this._yCosine,this._zCosine,this._origin),this._lps2AABB=new n.a,this._lps2AABB.getInverse(this._aabb2LPS)},e.prototype.merge=function(t){return!!(this._stackID===t.stackID&&1===this._numberOfFrames&&1===t._numberOfFrames&&this._frame[0].columns===t.frame[0].columns&&this._frame[0].rows===t.frame[0].rows&&this._xCosine.equals(t.xCosine)&&this._yCosine.equals(t.yCosine)&&this._zCosine.equals(t.zCosine))&&this.mergeModels(this._frame,t.frame)},e.prototype.pack=function(){var t=this._dimensionsIJK.x*this._dimensionsIJK.y*this._dimensionsIJK.z;(8===this._bitsAllocated&&1===this._numberOfChannels||1===this._bitsAllocated)&&(this._packedPerPixel=4),16===this._bitsAllocated&&1===this._numberOfChannels&&(this._packedPerPixel=2);var e=this._textureSize*this._textureSize,i=Math.ceil(t/(e*this._packedPerPixel)),n=0,r=this._packedPerPixel*e;r>t&&(r=t),this._textureUnits<i&&(console.warn("Insufficient number of supported textures. Some frames will not be packed."),i=this._textureUnits);for(var o=0;o<i;o++){var a=this._packTo8Bits(this._numberOfChannels,this._frame,this._textureSize,n,r);this._textureType=a.textureType,this._rawData.push(a.data),n+=this._packedPerPixel*e,(r+=this._packedPerPixel*e)>t&&(r=t)}this._packed=!0},e.prototype._packTo8Bits=function(t,e,i,n,r){var a={textureType:null,data:null},s=e[0].bitsAllocated,l=e[0].pixelType,c=0;this._minMax[0]<0&&(c-=this._minMax[0]);var u=0,d=0,f=0,p=e[0].rows*e[0].columns;if(8===s&&1===t||1===s){for(var m=new Uint8Array(i*i*4),_=0,g=0,y=n;y<r;y++){f=y%p;var b=e[d=~~(y/p)].pixelData[f]+c;Number.isNaN(b)||(m[4*_+g]=b),u++,_=Math.floor(u/4),g=u%4}a.textureType=o.a,a.data=m}else if(16===s&&1===t){for(var v=new Uint8Array(i*i*4),w=0,x=0,A=n;A<r;A++){f=A%p;var S=e[d=~~(A/p)].pixelData[f]+c;Number.isNaN(S)||(v[4*w+2*x]=255&S,v[4*w+2*x+1]=S>>>8&255),u++,w=Math.floor(u/2),x=u%2}a.textureType=o.a,a.data=v}else if(32===s&&1===t&&0===l){for(var M=new Uint8Array(i*i*4),E=n;E<r;E++){f=E%p;var T=e[d=~~(E/p)].pixelData[f]+c;Number.isNaN(T)||(M[4*u]=255&T,M[4*u+1]=T>>>8&255,M[4*u+2]=T>>>16&255,M[4*u+3]=T>>>24&255),u++}a.textureType=o.a,a.data=M}else if(32===s&&1===t&&1===l){for(var k=new Uint8Array(i*i*4),C=n;C<r;C++){f=C%p;var I=e[d=~~(C/p)].pixelData[f]+c;if(!Number.isNaN(I)){var P=h(I).match(/.{1,8}/g);k[4*u]=parseInt(P[0],2),k[4*u+1]=parseInt(P[1],2),k[4*u+2]=parseInt(P[2],2),k[4*u+3]=parseInt(P[3],2)}u++}a.textureType=o.a,a.data=k}else if(8===s&&3===t){for(var R=new Uint8Array(i*i*3),B=n;B<r;B++)d=~~(B/p),f=B%p,R[3*u]=e[d].pixelData[3*f],R[3*u+1]=e[d].pixelData[3*f+1],R[3*u+2]=e[d].pixelData[3*f+2],u++;a.textureType=o.b,a.data=R}return a},e.prototype.worldCenter=function(){return this._halfDimensionsIJK.clone().addScalar(-.5).applyMatrix4(this._ijk2LPS)},e.prototype.worldBoundingBox=function(){for(var t=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],e=this._dimensionsIJK,i=0;i<=e.x;i+=e.x)for(var n=0;n<=e.y;n+=e.y)for(var o=0;o<=e.z;o+=e.z){var a=new r.a(i,n,o).applyMatrix4(this._ijk2LPS);t=[Math.min(t[0],a.x),Math.max(t[1],a.x),Math.min(t[2],a.y),Math.max(t[3],a.y),Math.min(t[4],a.z),Math.max(t[5],a.z)]}return t},e.prototype.AABBox=function(){var t=(new r.a).addScalar(-.5).applyMatrix4(this._ijk2LPS).applyMatrix4(this._lps2AABB),e=this._dimensionsIJK.clone().addScalar(-.5).applyMatrix4(this._ijk2LPS).applyMatrix4(this._lps2AABB);return new r.a(Math.abs(t.x-e.x),Math.abs(t.y-e.y),Math.abs(t.z-e.z))},e.prototype.centerAABBox=function(){var t=this.worldCenter();return t.applyMatrix4(this._lps2AABB),t},e.indexInDimensions=function(t,e){return t.x>=0&&t.y>=0&&t.z>=0&&t.x<e.x&&t.y<e.y&&t.z<e.z},e.prototype._arrayToVector3=function(t,e){return new r.a(t[e],t[e+1],t[e+2])},e.prototype._orderFrameOnDimensionIndicesArraySort=function(t,e){if("dimensionIndexValues"in t&&"[object Array]"===Object.prototype.toString.call(t.dimensionIndexValues)&&"dimensionIndexValues"in e&&"[object Array]"===Object.prototype.toString.call(e.dimensionIndexValues))for(var i=0;i<t.dimensionIndexValues.length;i++){if(parseInt(t.dimensionIndexValues[i],10)>parseInt(e.dimensionIndexValues[i],10))return 1;if(parseInt(t.dimensionIndexValues[i],10)<parseInt(e.dimensionIndexValues[i],10))return-1}else console.warn("One of the frames doesn't have a dimensionIndexValues array."),console.warn(t),console.warn(e);return 0},e.prototype._computeDistanceArrayMap=function(t,e){return e.imagePosition&&(e.dist=e.imagePosition[0]*t.x+e.imagePosition[1]*t.y+e.imagePosition[2]*t.z),e},e.prototype._sortDistanceArraySort=function(t,e){return t.dist-e.dist},e.prototype._sortInstanceNumberArraySort=function(t,e){return t.instanceNumber-e.instanceNumber},e.prototype._sortSopInstanceUIDArraySort=function(t,e){return t.sopInstanceUID-e.sopInstanceUID},e.value=function(t,e){return console.warn("models.stack.value is deprecated.\n       Please use core.utils.value instead."),s.a.value(t,e)},e.valueRescaleSlopeIntercept=function(t,e,i){return console.warn("models.stack.valueRescaleSlopeIntercept is deprecated.\n       Please use core.utils.rescaleSlopeIntercept instead."),s.a.rescaleSlopeIntercept(t,e,i)},e.worldToData=function(t,e){return console.warn("models.stack.worldToData is deprecated.\n       Please use core.utils.worldToData instead."),s.a.worldToData(t._lps2IJK,e)},c(e,[{key:"numberOfChannels",set:function(t){this._numberOfChannels=t},get:function(){return this._numberOfChannels}},{key:"frame",set:function(t){this._frame=t},get:function(){return this._frame}},{key:"prepared",set:function(t){this._prepared=t},get:function(){return this._prepared}},{key:"packed",set:function(t){this._packed=t},get:function(){return this._packed}},{key:"packedPerPixel",set:function(t){this._packedPerPixel=t},get:function(){return this._packedPerPixel}},{key:"dimensionsIJK",set:function(t){this._dimensionsIJK=t},get:function(){return this._dimensionsIJK}},{key:"halfDimensionsIJK",set:function(t){this._halfDimensionsIJK=t},get:function(){return this._halfDimensionsIJK}},{key:"regMatrix",set:function(t){this._regMatrix=t},get:function(){return this._regMatrix}},{key:"ijk2LPS",set:function(t){this._ijk2LPS=t},get:function(){return this._ijk2LPS}},{key:"lps2IJK",set:function(t){this._lps2IJK=t},get:function(){return this._lps2IJK}},{key:"lps2AABB",set:function(t){this._lps2AABB=t},get:function(){return this._lps2AABB}},{key:"textureSize",set:function(t){this._textureSize=t},get:function(){return this._textureSize}},{key:"textureUnits",set:function(t){this._textureUnits=t},get:function(){return this._textureUnits}},{key:"textureType",set:function(t){this._textureType=t},get:function(){return this._textureType}},{key:"bitsAllocated",set:function(t){this._bitsAllocated=t},get:function(){return this._bitsAllocated}},{key:"rawData",set:function(t){this._rawData=t},get:function(){return this._rawData}},{key:"windowWidth",get:function(){return this._windowWidth},set:function(t){this._windowWidth=t}},{key:"windowCenter",get:function(){return this._windowCenter},set:function(t){this._windowCenter=t}},{key:"rescaleSlope",get:function(){return this._rescaleSlope},set:function(t){this._rescaleSlope=t}},{key:"rescaleIntercept",get:function(){return this._rescaleIntercept},set:function(t){this._rescaleIntercept=t}},{key:"xCosine",get:function(){return this._xCosine},set:function(t){this._xCosine=t}},{key:"yCosine",get:function(){return this._yCosine},set:function(t){this._yCosine=t}},{key:"zCosine",get:function(){return this._zCosine},set:function(t){this._zCosine=t}},{key:"minMax",get:function(){return this._minMax},set:function(t){this._minMax=t}},{key:"stackID",get:function(){return this._stackID},set:function(t){this._stackID=t}},{key:"pixelType",get:function(){return this._pixelType},set:function(t){this._pixelType=t}},{key:"pixelRepresentation",get:function(){return this._pixelRepresentation},set:function(t){this._pixelRepresentation=t}},{key:"invert",set:function(t){this._invert=t},get:function(){return this._invert}},{key:"modality",set:function(t){this._modality=t},get:function(){return this._modality}},{key:"rightHanded",get:function(){return this._rightHanded},set:function(t){this._rightHanded=t}},{key:"spacingBetweenSlices",get:function(){return this._spacingBetweenSlices},set:function(t){this._spacingBetweenSlices=t}},{key:"segmentationSegments",set:function(t){this._segmentationSegments=t},get:function(){return this._segmentationSegments}},{key:"segmentationType",set:function(t){this._segmentationType=t},get:function(){return this._segmentationType}},{key:"segmentationLUT",set:function(t){this._segmentationLUT=t},get:function(){return this._segmentationLUT}},{key:"segmentationLUTO",set:function(t){this._segmentationLUTO=t},get:function(){return this._segmentationLUTO}}]),e}(l.a);e.a=u},function(t,e,i){"use strict";var n=i(14),r=i(1),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var a=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i._sopInstanceUID=null,i._url=null,i._stackID=-1,i._invert=!1,i._frameTime=null,i._ultrasoundRegions=[],i._rows=0,i._columns=0,i._dimensionIndexValues=[],i._imagePosition=null,i._imageOrientation=null,i._rightHanded=!0,i._sliceThickness=1,i._spacingBetweenSlices=null,i._pixelPaddingValue=null,i._pixelRepresentation=0,i._pixelType=0,i._pixelSpacing=null,i._pixelAspectRatio=null,i._pixelData=null,i._instanceNumber=null,i._windowCenter=null,i._windowWidth=null,i._rescaleSlope=null,i._rescaleIntercept=null,i._bitsAllocated=8,i._numberOfChannels=1,i._minMax=null,i._dist=null,i._index=-1,i._referencedSegmentNumber=-1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.validate=function(e){return!!(t.prototype.validate.call(this,e)&&"function"==typeof e.cosines&&"function"==typeof e.spacingXY&&e.hasOwnProperty("_sopInstanceUID")&&e.hasOwnProperty("_dimensionIndexValues")&&e.hasOwnProperty("_imageOrientation")&&e.hasOwnProperty("_imagePosition"))},e.prototype.merge=function(t){return!!this.validate(t)&&!!(this._compareArrays(this._dimensionIndexValues,t.dimensionIndexValues)&&this._compareArrays(this._imageOrientation,t.imageOrientation)&&this._compareArrays(this._imagePosition,t.imagePosition)&&this._instanceNumber===t.instanceNumber&&this._sopInstanceUID===t.sopInstanceUID)},e.prototype.cosines=function(){var t=[new r.a(1,0,0),new r.a(0,1,0),new r.a(0,0,1)];if(this._imageOrientation&&6===this._imageOrientation.length){var e=new r.a(this._imageOrientation[0],this._imageOrientation[1],this._imageOrientation[2]),i=new r.a(this._imageOrientation[3],this._imageOrientation[4],this._imageOrientation[5]);e.length()>0&&i.length()>0&&(t[0]=e,t[1]=i,t[2]=new r.a(0,0,0).crossVectors(t[0],t[1]).normalize())}else console.log("No valid image orientation for frame"),console.log(this),console.log("Returning default orientation.");return this._rightHanded||t[2].negate(),t},e.prototype.spacingXY=function(){var t=[1,1];return this.pixelSpacing?(t[0]=this.pixelSpacing[0],t[1]=this.pixelSpacing[1]):this.pixelAspectRatio&&(t[0]=1,t[1]=1*this.pixelAspectRatio[1]/this.pixelAspectRatio[0]),t},e.prototype.getPixelData=function(t,e){return t>=0&&t<this._columns&&e>=0&&e<this._rows?this.pixelData[t+this._columns*e]:null},e.prototype.setPixelData=function(t,e,i){this.pixelData[t+this._columns*e]=i},e.prototype.getImageDataUrl=function(){var t=document.createElement("canvas");t.width=this._columns,t.height=this._rows;var e=t.getContext("2d"),i=e.createImageData(t.width,t.height);return i.data.set(this._frameToCanvas()),e.putImageData(i,0,0),t.toDataURL()},e.prototype._frameToCanvas=function(){var t=this._columns*this._rows,e={invert:this._invert,min:this._minMax[0],padding:this._pixelPaddingValue},i=new Uint8Array(4*t);if(null!==e.padding){e.min=this._minMax[1];for(var n=0,r=this._pixelData.length;n<r;n++)this._pixelData[n]!==e.padding&&(e.min=Math.min(e.min,this._pixelData[n]))}if(this._windowWidth&&null!==this._windowCenter){var o=this._rescaleIntercept||0,a=this._rescaleSlope||1;e.min=Math.max((this._windowCenter-this._windowWidth/2-o)/a,e.min),e.max=Math.min((this._windowCenter+this._windowWidth/2-o)/a,this._minMax[1])}else e.max=this._minMax[1];if(e.range=e.max-e.min||255,1===this._numberOfChannels)for(var s=0;s<t;s++){var l=this._pixelTo8Bit(this._pixelData[s],e);i[4*s]=l,i[4*s+1]=l,i[4*s+2]=l,i[4*s+3]=255}else if(3===this._numberOfChannels)for(var c=0;c<t;c++)i[4*c]=this._pixelTo8Bit(this._pixelData[3*c],e),i[4*c+1]=this._pixelTo8Bit(this._pixelData[3*c+1],e),i[4*c+2]=this._pixelTo8Bit(this._pixelData[3*c+2],e),i[4*c+3]=255;return i},e.prototype._pixelTo8Bit=function(t,e){var i=t<=e.min||t===e.padding?0:255;return t>e.min&&t<e.max&&(i=Math.round(255*(t-e.min)/e.range)),Number.isNaN(i)?0:e.invert?255-i:i},e.prototype._compareArrays=function(t,e){return t===e||!(!t||!e||t.join()!==e.join())},o(e,[{key:"frameTime",get:function(){return this._frameTime},set:function(t){this._frameTime=t}},{key:"ultrasoundRegions",get:function(){return this._ultrasoundRegions},set:function(t){this._ultrasoundRegions=t}},{key:"rows",get:function(){return this._rows},set:function(t){this._rows=t}},{key:"columns",get:function(){return this._columns},set:function(t){this._columns=t}},{key:"spacingBetweenSlices",get:function(){return this._spacingBetweenSlices},set:function(t){this._spacingBetweenSlices=t}},{key:"sliceThickness",get:function(){return this._sliceThickness},set:function(t){this._sliceThickness=t}},{key:"imagePosition",get:function(){return this._imagePosition},set:function(t){this._imagePosition=t}},{key:"imageOrientation",get:function(){return this._imageOrientation},set:function(t){this._imageOrientation=t}},{key:"windowWidth",get:function(){return this._windowWidth},set:function(t){this._windowWidth=t}},{key:"windowCenter",get:function(){return this._windowCenter},set:function(t){this._windowCenter=t}},{key:"rescaleSlope",get:function(){return this._rescaleSlope},set:function(t){this._rescaleSlope=t}},{key:"rescaleIntercept",get:function(){return this._rescaleIntercept},set:function(t){this._rescaleIntercept=t}},{key:"bitsAllocated",get:function(){return this._bitsAllocated},set:function(t){this._bitsAllocated=t}},{key:"dist",get:function(){return this._dist},set:function(t){this._dist=t}},{key:"pixelSpacing",get:function(){return this._pixelSpacing},set:function(t){this._pixelSpacing=t}},{key:"pixelAspectRatio",get:function(){return this._pixelAspectRatio},set:function(t){this._pixelAspectRatio=t}},{key:"minMax",get:function(){return this._minMax},set:function(t){this._minMax=t}},{key:"dimensionIndexValues",get:function(){return this._dimensionIndexValues},set:function(t){this._dimensionIndexValues=t}},{key:"instanceNumber",get:function(){return this._instanceNumber},set:function(t){this._instanceNumber=t}},{key:"pixelData",get:function(){return this._pixelData},set:function(t){this._pixelData=t}},{key:"sopInstanceUID",set:function(t){this._sopInstanceUID=t},get:function(){return this._sopInstanceUID}},{key:"pixelPaddingValue",get:function(){return this._pixelPaddingValue},set:function(t){this._pixelPaddingValue=t}},{key:"pixelRepresentation",get:function(){return this._pixelRepresentation},set:function(t){this._pixelRepresentation=t}},{key:"pixelType",get:function(){return this._pixelType},set:function(t){this._pixelType=t}},{key:"url",get:function(){return this._url},set:function(t){this._url=t}},{key:"referencedSegmentNumber",get:function(){return this._referencedSegmentNumber},set:function(t){this._referencedSegmentNumber=t}},{key:"rightHanded",get:function(){return this._rightHanded},set:function(t){this._rightHanded=t}},{key:"index",get:function(){return this._index},set:function(t){this._index=t}},{key:"invert",get:function(){return this._invert},set:function(t){this._invert=t}},{key:"numberOfChannels",get:function(){return this._numberOfChannels},set:function(t){this._numberOfChannels=t}}]),e}(n.a);e.a=a},function(t,e,i){"use strict";var n=i(11),r=i(46),o=i.n(r);var a=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(r._id=n,r._arrayBuffer=i.buffer,r._url=i.url,r._dataSet=null,r._niftiHeader=null,r._niftiImage=null,r._ordered=!0,r._orderedData=null,r._qfac=1,!o.a.isNIFTI(r._arrayBuffer))throw new Error("parsers.nifti could not parse the file");return r._dataSet=o.a.readHeader(r._arrayBuffer),r._niftiImage=o.a.readImage(r._dataSet,r._arrayBuffer),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.seriesInstanceUID=function(){return this._url},e.prototype.numberOfFrames=function(){return this._dataSet.dims[3]},e.prototype.numberOfChannels=function(){var t=1;return this._dataSet.dims[0]>=5?(t=this._dataSet.dims[5],this._ordered=!1):128===this._dataSet.datatypeCode?t=3:2304===this._dataSet.datatypeCode&&(t=4),t},e.prototype.sopInstanceUID=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},e.prototype.rows=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.dims[2]},e.prototype.columns=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.dims[1]},e.prototype.pixelType=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=0;return 16!==this._dataSet.datatypeCode&&64!==this._dataSet.datatypeCode&&1536!==this._dataSet.datatypeCode||(t=1),t},e.prototype.bitsAllocated=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.numBitsPerVoxel},e.prototype.pixelSpacing=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[this._dataSet.pixDims[1],this._dataSet.pixDims[2],this._dataSet.pixDims[3]]},e.prototype.sliceThickness=function(){return null},e.prototype.imageOrientation=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._dataSet.qform_code>0){var t=0,e=this._dataSet.quatern_b,i=this._dataSet.quatern_c,n=this._dataSet.quatern_d;return(t=1-(e*e+i*i+n*n))<1e-7?(e*=t=1/Math.sqrt(e*e+i*i+n*n),i*=t,n*=t,t=0):t=Math.sqrt(t),this._dataSet.pixDims[0]<0&&(this._rightHanded=!1),[-(t*t+e*e-i*i-n*n),-2*(e*i+t*n),2*(e*n-t*i),-2*(e*i-t*n),-(t*t+i*i-e*e-n*n),2*(i*n+t*e)]}if(this._dataSet.sform_code>0){var r=[-this._dataSet.affine[0][0],-this._dataSet.affine[0][1],this._dataSet.affine[0][2]],o=[-this._dataSet.affine[1][0],-this._dataSet.affine[1][1],this._dataSet.affine[0][2]];return[].concat(r,o)}return this._dataSet.qform_code,[1,0,0,0,1,0]},e.prototype.imagePosition=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[-this._dataSet.qoffset_x,-this._dataSet.qoffset_y,this._dataSet.qoffset_z]},e.prototype.dimensionIndexValues=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},e.prototype.instanceNumber=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},e.prototype.windowCenter=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},e.prototype.windowWidth=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null},e.prototype.rescaleSlope=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.scl_slope},e.prototype.rescaleIntercept=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.scl_inter},e.prototype.extractPixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._decompressUncompressed(t)},e.prototype._decompressUncompressed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.numberOfChannels(),i=this.rows(t)*this.columns(t)*e,n=t*i,r=this._niftiImage;if(this._ordered||null!==this._orderedData||this._reorderData(),null!==this._orderedData)return this._orderedData.slice(n,n+i);if(2===this._dataSet.datatypeCode)return new Uint8Array(r,n,i);if(256===this._dataSet.datatypeCode)return new Int8Array(r,n,i);if(512===this._dataSet.datatypeCode)return n*=2,new Uint16Array(r,n,i);if(4===this._dataSet.datatypeCode)return n*=2,new Int16Array(r,n,i);if(8===this._dataSet.datatypeCode)return n*=4,new Int32Array(r,n,i);if(16===this._dataSet.datatypeCode){n*=4;for(var o=new Float32Array(r,n,i),a=0;a<o.length;a++)o[a]!==1/0&&o[a]!==-1/0||(o[a]=0);return o}console.warn("Unknown data type: datatypeCode : "+this._dataSet.datatypeCode)},e.prototype._reorderData=function(){var t=this.numberOfChannels(),e=this.rows()*this.columns()*t,i=this._niftiImage,n=e*this.numberOfFrames(),r=null;this._orderedData=null,2===this._dataSet.datatypeCode?(r=new Uint8Array(i,0,n),this._orderedData=new Uint8Array(r.length)):256===this._dataSet.datatypeCode?(r=new Int8Array(i,0,n),this._orderedData=new Int8Array(r.length)):512===this._dataSet.datatypeCode?(r=new Uint16Array(i,0,n),this._orderedData=new Uint16Array(r.length)):4===this._dataSet.datatypeCode?(r=new Int16Array(i,0,n),this._orderedData=new Int16Array(r.length)):16===this._dataSet.datatypeCode&&(r=new Float32Array(i,0,n),this._orderedData=new Float32Array(r.length));for(var o=r.length/3,a=0,s=0,l=o,c=2*o,h=0;h<o;h++)this._orderedData[a++]=r[s++],this._orderedData[a++]=r[l++],this._orderedData[a++]=r[c++];this._ordered=!0},e}(n.a);e.a=a},function(t,e,i){"use strict";var n=i(2),r=i(11),o=i(55),a=i(121);var s=i(154),l=i(155),c=i(157),h=i(158),u=void 0,d=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));r._id=n,r._arrayBuffer=i.buffer;var o=new Uint8Array(r._arrayBuffer);r._dataSet=null;try{r._dataSet=s.parseDicom(o)}catch(t){throw console.log(t),new Error("parsers.dicom could not parse the file")}return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.seriesInstanceUID=function(){return this._dataSet.string("x0020000e")},e.prototype.studyInstanceUID=function(){return this._dataSet.string("x0020000d")},e.prototype.modality=function(){return this._dataSet.string("x00080060")},e.prototype.segmentationType=function(){return this._dataSet.string("x00620001")},e.prototype.segmentationSegments=function(){var t=[],e=this._dataSet.elements.x00620002;if(!e)return t;for(var i=0;i<e.items.length;i++){var n=this._recommendedDisplayCIELab(e.items[i]),r=this._segmentationCode(e.items[i]),o=e.items[i].dataSet.uint16("x00620004"),a=e.items[i].dataSet.string("x00620005"),s=e.items[i].dataSet.string("x00620008");t.push({recommendedDisplayCIELab:n,segmentationCodeDesignator:r.segmentationCodeDesignator,segmentationCodeValue:r.segmentationCodeValue,segmentationCodeMeaning:r.segmentationCodeMeaning,segmentNumber:o,segmentLabel:a,segmentAlgorithmType:s})}return t},e.prototype._segmentationCode=function(t){var e="unknown",i="unknown",n="unknown",r=t.dataSet.elements.x00082218;return r&&r.items&&r.items.length>0&&(e=r.items[0].dataSet.string("x00080102"),i=r.items[0].dataSet.string("x00080100"),n=r.items[0].dataSet.string("x00080104")),{segmentationCodeDesignator:e,segmentationCodeValue:i,segmentationCodeMeaning:n}},e.prototype._recommendedDisplayCIELab=function(t){if(!t.dataSet.elements.x0062000d)return null;for(var e=t.dataSet.elements.x0062000d.dataOffset,i=t.dataSet.elements.x0062000d.length,n=t.dataSet.byteArray.slice(e,e+i),r=new Uint16Array(i/2),o=0;o<i/2;o++)r[o]=(n[2*o+1]<<8)+n[2*o];return[r[0]/65535*100,r[1]/65535*255-128,r[2]/65535*255-128]},e.prototype.rawHeader=function(){return this._dataSet},e.prototype.sopInstanceUID=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._findStringEverywhere("x2005140f","x00080018",t);return e},e.prototype.transferSyntaxUID=function(){return this._dataSet.string("x00020010")},e.prototype.studyDate=function(){return this._dataSet.string("x00080020")},e.prototype.studyDescription=function(){return this._dataSet.string("x00081030")},e.prototype.seriesDate=function(){return this._dataSet.string("x00080021")},e.prototype.seriesDescription=function(){return this._dataSet.string("x0008103e")},e.prototype.patientName=function(){return this._dataSet.string("x00100010")},e.prototype.patientID=function(){return this._dataSet.string("x00100020")},e.prototype.patientBirthdate=function(){return this._dataSet.string("x00100030")},e.prototype.patientSex=function(){return this._dataSet.string("x00100040")},e.prototype.patientAge=function(){return this._dataSet.string("x00101010")},e.prototype.photometricInterpretation=function(){return this._dataSet.string("x00280004")},e.prototype.planarConfiguration=function(){var t=this._dataSet.uint16("x00280006");return void 0===t&&(t=null),t},e.prototype.samplesPerPixel=function(){return this._dataSet.uint16("x00280002")},e.prototype.numberOfFrames=function(){var t=this._dataSet.intString("x00280008");return void 0===t&&(t=null),t},e.prototype.numberOfChannels=function(){var t=1,e=this.photometricInterpretation();return"RGB"!==e&&"PALETTE COLOR"!==e&&"YBR_FULL"!==e&&"YBR_FULL_422"!==e&&"YBR_PARTIAL_422"!==e&&"YBR_PARTIAL_420"!==e&&"YBR_RCT"!==e||(t=3),t},e.prototype.invert=function(){return"MONOCHROME1"===this.photometricInterpretation()},e.prototype.imageOrientation=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._findStringEverywhere("x00209116","x00200037",t);return e&&(e=e.split("\\").map(n.a.stringToNumber)),e},e.prototype.referencedSegmentNumber=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=-1,i=this._findInGroupSequence("x52009230","x0062000a",t);return null!==i&&(e=i.uint16("x0062000b")),e},e.prototype.pixelAspectRatio=function(){var t=[this._dataSet.intString("x00280034",0),this._dataSet.intString("x00280034",1)];return void 0===t[0]&&(t=null),t},e.prototype.imagePosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._findStringEverywhere("x00209113","x00200032",t);return e&&(e=e.split("\\").map(n.a.stringToNumber)),e},e.prototype.instanceNumber=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=null,i=this._dataSet.elements.x52009230;void 0!==i?i.items[t].dataSet.elements.x2005140f?e=i.items[t].dataSet.elements.x2005140f.items[0].dataSet.intString("x00200013"):(e=this._dataSet.intString("x00200013"),void 0===e&&(e=null)):(e=this._dataSet.intString("x00200013"),void 0===e&&(e=null));return e},e.prototype.pixelSpacing=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._findStringEverywhere("x00289110","x00280030",t);if(null===e&&(e=this._dataSet.string("x00181164"),void 0===e&&(e=null)),e){var i=e.split("\\");2!==i.length?(console.error('DICOM spacing format is not supported (could not split string on "\\"): '+e),e=null):e=i.map(n.a.stringToNumber)}return e},e.prototype.ultrasoundRegions=function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],this._dataSet.elements.x00186011);if(!e||!e.items)return[];var i=[];return e.items.forEach(function(e){i.push({x0:e.dataSet.uint32("x00186018"),y0:e.dataSet.uint32("x0018601a"),x1:e.dataSet.uint32("x0018601c"),y1:e.dataSet.uint32("x0018601e"),axisX:e.dataSet.int32("x00186020")||null,axisY:e.dataSet.int32("x00186022")||null,unitsX:t._getUnitsName(e.dataSet.uint16("x00186024")),unitsY:t._getUnitsName(e.dataSet.uint16("x00186026")),deltaX:e.dataSet.double("x0018602c"),deltaY:e.dataSet.double("x0018602e")})}),i},e.prototype.frameTime=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280009",1),e=this._dataSet.intString("x00082144"),i=void 0;return"number"==typeof t&&(t=t.toString(16),i=this._dataSet.floatString("x0018"+t)),void 0===i&&"number"==typeof e&&(i=1e3/e),void 0===i&&(i=null),i},e.prototype.rows=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280010");return void 0===t&&(t=null),t},e.prototype.columns=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280011");return void 0===t&&(t=null),t},e.prototype.pixelType=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0},e.prototype.pixelRepresentation=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280103");return t},e.prototype.pixelPaddingValue=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.int16("x00280120");return void 0===t&&(t=null),t},e.prototype.bitsAllocated=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280100");return t},e.prototype.highBit=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.uint16("x00280102");return t},e.prototype.rescaleIntercept=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._findFloatStringInFrameGroupSequence("x00289145","x00281052",t)},e.prototype.rescaleSlope=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._findFloatStringInFrameGroupSequence("x00289145","x00281053",t)},e.prototype.windowCenter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._findFloatStringInFrameGroupSequence("x00289132","x00281050",t)},e.prototype.windowWidth=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._findFloatStringInFrameGroupSequence("x00289132","x00281051",t)},e.prototype.sliceThickness=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._findFloatStringInFrameGroupSequence("x00289110","x00180050",t)},e.prototype.spacingBetweenSlices=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.floatString("x00180088");return void 0===t&&(t=null),t},e.prototype.dimensionIndexValues=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=null,i=this._dataSet.elements.x52009230;if(void 0!==i){var n=i.items[t].dataSet.elements.x00209111;if(void 0!==n&&null!==n){var r=(n=n.items[0].dataSet).elements.x00209157;if(void 0!==r&&null!==r){var o=r.length/4;e=[];for(var a=0;a<o;a++)e.push(n.uint32("x00209157",a))}}}return e},e.prototype.inStackPositionNumber=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=null,i=this._dataSet.elements.x52009230;void 0!==i?e=i.items[t].dataSet.elements.x00209111.items[0].dataSet.uint32("x00209057"):e=null;return e},e.prototype.stackID=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=null,i=this._dataSet.elements.x52009230;void 0!==i?e=i.items[t].dataSet.elements.x00209111.items[0].dataSet.intString("x00209056"):e=null;return e},e.prototype.extractPixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._decodePixelData(t);return this.numberOfChannels()>1?this._convertColorSpace(e):e},e.prototype._findInGroupSequence=function(t,e,i){var n=this._dataSet.elements[t];if(void 0!==n){var r=n.items[i].dataSet.elements[e];if(void 0!==r)return r.items[0].dataSet}return null},e.prototype._findStringInGroupSequence=function(t,e,i,n){var r=this._findInGroupSequence(t,e,n);return null!==r?r.string(i):null},e.prototype._findStringInFrameGroupSequence=function(t,e,i){return this._findStringInGroupSequence("x52009229",t,e,0)||this._findStringInGroupSequence("x52009230",t,e,i)},e.prototype._findStringEverywhere=function(t,e,i){var n=this._findStringInFrameGroupSequence(t,e,i);if(null===n){n=this._findStringInSequence("x00540022",e)}return null===n&&(n=this._dataSet.string(e)),void 0===n&&(n=null),n},e.prototype._findStringInSequence=function(t,e,i){var n=this._dataSet.elements[t],r=void 0;return n&&(r=n.items[0].dataSet.string(e)),void 0===r&&(r=null),r},e.prototype._findFloatStringInGroupSequence=function(t,e,i,n){var r=this._dataSet.floatString(i);return void 0===r&&null!==(r=this._findInGroupSequence(t,e,n))?r.floatString(i):r},e.prototype._findFloatStringInFrameGroupSequence=function(t,e,i){return this._findFloatStringInGroupSequence("x52009229",t,e,0)||this._findFloatStringInGroupSequence("x52009230",t,e,i)},e.prototype._decodePixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.transferSyntaxUID();if("1.2.840.10008.1.2.4.90"===e||"1.2.840.10008.1.2.4.91"===e)return this._decodeJ2K(t);if("1.2.840.10008.1.2.5"===e)return this._decodeRLE(t);if("1.2.840.10008.1.2.4.57"===e||"1.2.840.10008.1.2.4.70"===e)return this._decodeJPEGLossless(t);if("1.2.840.10008.1.2.4.50"===e||"1.2.840.10008.1.2.4.51"===e)return this._decodeJPEGBaseline(t);if("1.2.840.10008.1.2"===e||"1.2.840.10008.1.2.1"===e)return this._decodeUncompressed(t);if("1.2.840.10008.1.2.2"===e){var i=this._decodeUncompressed(t);return this._swapFrame(i)}throw{error:"no decoder for transfer syntax "+e}},e.prototype.framesAreFragmented=function(){return this._dataSet.intString("x00280008")!==this._dataSet.elements.x7fe00010.fragments.length},e.prototype.getEncapsulatedImageFrame=function(t){return this._dataSet.elements.x7fe00010&&this._dataSet.elements.x7fe00010.basicOffsetTable.length?s.readEncapsulatedImageFrame(this._dataSet,this._dataSet.elements.x7fe00010,t):this.framesAreFragmented()?s.readEncapsulatedImageFrame(this._dataSet,this._dataSet.elements.x7fe00010,t,s.createJPEGBasicOffsetTable(this._dataSet,this._dataSet.elements.x7fe00010)):s.readEncapsulatedPixelDataFromFragments(this._dataSet,this._dataSet.elements.x7fe00010,t)},e.prototype._decodeJpx=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new h;if(e.parse(this.getEncapsulatedImageFrame(t)),1!==e.componentsCount)throw new Error("JPEG2000 decoder returned a componentCount of ${componentsCount}, when 1 is expected");if(1!==e.tiles.length)throw new Error("JPEG2000 decoder returned a tileCount of ${tileCount}, when 1 is expected");return e.tiles[0].items},e.prototype._decodeOpenJPEG=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.getEncapsulatedImageFrame(t),i=this.bitsAllocated(t)<=8?1:2,n=1===this.pixelRepresentation(t),r=u._malloc(e.length);u.writeArrayToMemory(e,r);var o=u._malloc(4),a=u._malloc(4),s=u._malloc(4),l=u._malloc(4),c=u._malloc(4),h=u.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[r,e.length,o,a,s,l,c]),d=u.getValue(o,"*");if(0!==h)return console.log("[opj_decode] decoding failed!"),u._free(r),u._free(d),u._free(s),u._free(l),u._free(a),void u._free(c);var f=u.getValue(s,"i32")*u.getValue(l,"i32")*u.getValue(c,"i32"),p=new Int32Array(u.HEAP32.buffer,d,f),m=void 0;if(1===i)if(Uint8Array.from)m=Uint8Array.from(p);else{m=new Uint8Array(f);for(var _=0;_<f;_++)m[_]=p[_]}else if(n)if(Int16Array.from)m=Int16Array.from(p);else{m=new Int16Array(f);for(var g=0;g<f;g++)m[g]=p[g]}else if(Uint16Array.from)m=Uint16Array.from(p);else{m=new Uint16Array(f);for(var y=0;y<f;y++)m[y]=p[y]}return u._free(r),u._free(o),u._free(d),u._free(a),u._free(s),u._free(l),u._free(c),m},e.prototype._decodeJ2K=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return void 0===o?this._decodeJpx(t):u||(u=o())&&u._jp2_decode?this._decodeOpenJPEG(t):this._decodeJpx(t)},e.prototype._decodeRLE=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.bitsAllocated(t),i=this.planarConfiguration(),n=this.columns(),r=this.rows(),o=this.samplesPerPixel(t),l={pixelRepresentation:this.pixelRepresentation(t),bitsAllocated:e,planarConfiguration:i,columns:n,rows:r,samplesPerPixel:o},c=s.readEncapsulatedPixelDataFromFragments(this._dataSet,this._dataSet.elements.x7fe00010,t);return Object(a.a)(l,c).pixelData},e.prototype._decodeJPEGLossless=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.getEncapsulatedImageFrame(t),i=this.pixelRepresentation(t),n=this.bitsAllocated(t)<=8?1:2,r=(new l.lossless.Decoder).decode(e.buffer,e.byteOffset,e.length,n);return 0===i?2===n?new Uint16Array(r.buffer):new Uint8Array(r.buffer):new Int16Array(r.buffer)},e.prototype._decodeJPEGBaseline=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.getEncapsulatedImageFrame(t),i=this.rows(t),n=this.columns(t),r=this.bitsAllocated(t),o=new c;return o.parse(e),8===r?o.getData(n,i):16===r?o.getData16(n,i):void 0},e.prototype._decodeUncompressed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.pixelRepresentation(t),i=this.bitsAllocated(t),n=this._dataSet.elements.x7fe00010.dataOffset,r=this.numberOfChannels(),o=this.rows(t)*this.columns(t)*r,a=0,s=this._dataSet.byteArray.buffer;if(0===e&&8===i)return a=n+t*o,new Uint8Array(s,a,o);if(0===e&&16===i)return a=n+t*o*2,new Uint16Array(s,a,o);if(1===e&&16===i)return a=n+t*o*2,new Int16Array(s,a,o);if(0===e&&32===i)return a=n+t*o*4,new Uint32Array(s,a,o);if(0===e&&1===i){var l=new ArrayBuffer(o),c=new Uint8Array(l);a=n+t*o;for(var h=0,u=t*o,d=t*o+o,f=Math.floor(u/8),p=u-8*f,m=Math.ceil(d/8),_=new Uint8Array(s,n),g=f;g<=m;g++){for(;p<8;){switch(p){case 0:c[h]=1&_[g];break;case 1:c[h]=_[g]>>>1&1;break;case 2:c[h]=_[g]>>>2&1;break;case 3:c[h]=_[g]>>>3&1;break;case 4:c[h]=_[g]>>>4&1;break;case 5:c[h]=_[g]>>>5&1;break;case 6:c[h]=_[g]>>>6&1;break;case 7:c[h]=_[g]>>>7&1}if(p++,++h>=o)return c}p=0}}},e.prototype._interpretAsRGB=function(t){return-1!==["RGB","YBR_RCT","YBR_ICT","YBR_FULL_422"].indexOf(t)},e.prototype._convertColorSpace=function(t){var e=null,i=this.photometricInterpretation(),n=this.planarConfiguration();null===n&&(n=0,console.log("Planar Configuration was not set and was defaulted to  0"));var r=this._interpretAsRGB(i);if(r&&0===n)e=t;else if(r&&1===n){if(t instanceof Int8Array)e=new Int8Array(t.length);else if(t instanceof Uint8Array)e=new Uint8Array(t.length);else if(t instanceof Int16Array)e=new Int16Array(t.length);else{if(!(t instanceof Uint16Array))throw new Error("unsuported typed array: "+t);e=new Uint16Array(t.length)}for(var o=t.length/3,a=0,s=0,l=o,c=2*o,h=0;h<o;h++)e[a++]=t[s++],e[a++]=t[l++],e[a++]=t[c++]}else{if("YBR_FULL"!==i)throw new Error("photometric interpolation not supported: "+i);if(t instanceof Int8Array)e=new Int8Array(t.length);else if(t instanceof Uint8Array)e=new Uint8Array(t.length);else if(t instanceof Int16Array)e=new Int16Array(t.length);else{if(!(t instanceof Uint16Array))throw new Error("unsuported typed array: "+t);e=new Uint16Array(t.length)}for(var u=t.length/3,d=0,f=0,p=0;p<u;p++){var m=t[d++],_=t[d++],g=t[d++];e[f++]=m+1.402*(g-128),e[f++]=m-.34414*(_-128)-.71414*(g-128),e[f++]=m+1.772*(_-128)}}return e},e.prototype._swapFrame=function(t){var e=this.bitsAllocated();if(16===e)for(var i=0;i<t.length;i++)t[i]=this._swap16(t[i]);else if(32===e)for(var n=0;n<t.length;n++)t[n]=this._swap32(t[n]);return t},e.prototype._getUnitsName=function(t){var e={0:"none",1:"percent",2:"dB",3:"cm",4:"seconds",5:"hertz",6:"dB/seconds",7:"cm/sec",8:"cm2",9:"cm2/sec",10:"cm3",11:"cm3/sec",12:"degrees"};return e.hasOwnProperty(t)?e[t]:"none"},e}(r.a);e.a=d},function(t,e,i){"use strict";var n=i(11),r=i(1);var o=i(47),a=i(159),s=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));r._id=n,r._arrayBuffer=i.buffer,r._url=i.url,r._dataSet=null,r._unpackedData=null;try{r._dataSet=a.parse(r._arrayBuffer)}catch(t){console.log("ooops... :(")}return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.rightHanded=function(){return this._dataSet.space.match(/^right-anterior-superior/)||this._dataSet.space.match(/^left-posterior-superior/)?this._rightHanded=!0:this._rightHanded=!1,this._rightHanded},e.prototype.seriesInstanceUID=function(){return this._url},e.prototype.numberOfFrames=function(){return this._dataSet.sizes[2]},e.prototype.numberOfChannels=function(){return 1},e.prototype.sopInstanceUID=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},e.prototype.rows=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.sizes[1]},e.prototype.columns=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._dataSet.sizes[0]},e.prototype.pixelType=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=0;return"float"===this._dataSet.type&&(t=1),t},e.prototype.bitsAllocated=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=1;return"int8"===this._dataSet.type||"uint8"===this._dataSet.type||"char"===this._dataSet.type?t=8:"int16"===this._dataSet.type||"uint16"===this._dataSet.type||"short"===this._dataSet.type?t=16:"int32"!==this._dataSet.type&&"uint32"!==this._dataSet.type&&"float"!==this._dataSet.type||(t=32),t},e.prototype.pixelSpacing=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=new r.a(this._dataSet.spaceDirections[0][0],this._dataSet.spaceDirections[0][1],this._dataSet.spaceDirections[0][2]),e=new r.a(this._dataSet.spaceDirections[1][0],this._dataSet.spaceDirections[1][1],this._dataSet.spaceDirections[1][2]),i=new r.a(this._dataSet.spaceDirections[2][0],this._dataSet.spaceDirections[2][1],this._dataSet.spaceDirections[2][2]);return[t.length(),e.length(),i.length()]},e.prototype.imageOrientation=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._dataSet.space.match(/right/)?-1:1,e=this._dataSet.space.match(/anterior/)?-1:1,i=new r.a(this._dataSet.spaceDirections[0][0]*t,this._dataSet.spaceDirections[0][1]*e,this._dataSet.spaceDirections[0][2]);i.normalize();var n=new r.a(this._dataSet.spaceDirections[1][0]*t,this._dataSet.spaceDirections[1][1]*e,this._dataSet.spaceDirections[1][2]);return n.normalize(),[i.x,i.y,i.z,n.x,n.y,n.z]},e.prototype.imagePosition=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[this._dataSet.spaceOrigin[0],this._dataSet.spaceOrigin[1],this._dataSet.spaceOrigin[2]]},e.prototype.extractPixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._decompressUncompressed(t)},e.prototype._decompressUncompressed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._dataSet.buffer,i=this.numberOfChannels(),n=this.rows(t)*this.columns(t)*i;this.rightHanded()||(t=this.numberOfFrames()-1-t);var r=t*n;if(null===this._unpackedData&&"gzip"===this._dataSet.encoding){var a=o.inflate(this._dataSet.buffer);this._unpackedData=a.buffer,e=this._unpackedData}else"gzip"===this._dataSet.encoding&&(e=this._unpackedData);return"int8"===this._dataSet.type||"char"===this._dataSet.type?new Int8Array(e,r,n):"uint8"===this._dataSet.type?new Uint8Array(e,r,n):"int16"===this._dataSet.type||"short"===this._dataSet.type?(r*=2,new Int16Array(e,r,n)):"uint16"===this._dataSet.type?(r*=2,new Uint16Array(e,r,n)):"int32"===this._dataSet.type?(r*=4,new Int32Array(e,r,n)):"uint32"===this._dataSet.type?(r*=4,new Uint32Array(e,r,n)):"float"===this._dataSet.type?(r*=4,new Float32Array(e,r,n)):void 0},e}(n.a);e.a=s},function(t,e,i){"use strict";var n=i(11),r=i(1);var o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(o._id=n,o._url=i.url,o._buffer=null,o._bufferPos=0,o._dataPos=0,o._pixelData=null,o._version=1,o._width=0,o._height=0,o._depth=0,o._nframes=0,o._type=e.MRI_UCHAR,o._dof=0,o._goodRASFlag=0,o._spacingXYZ=[1,1,1],o._Xras=[-1,0,0],o._Yras=[0,0,-1],o._Zras=[0,1,0],o._Cras=[0,0,0],o._tr=0,o._flipAngle=0,o._te=0,o._ti=0,o._fov=0,o._tags=[],o._origin=[0,0,0],o._imageOrient=[0,0,0,0,0,0],o._buffer=i.buffer,o._version=o._readInt(),o._swapEndian=!1,1==o._version);else{if(16777216!=o._version)throw new Error("MGH/MGZ parser: Unknown Endian.  Version reports: "+o._version);o._swapEndian=!0,o._version=o._swap32(o._version)}o._width=o._readInt(),o._height=o._readInt(),o._depth=o._readInt(),o._nframes=o._readInt(),o._type=o._readInt(),o._dof=o._readInt(),o._goodRASFlag=o._readShort(),o._spacingXYZ=o._readFloat(3),o._Xras=o._readFloat(3),o._Yras=o._readFloat(3),o._Zras=o._readFloat(3),o._Cras=o._readFloat(3),o._bufferPos=284;var a=o._width*o._height*o._depth*o._nframes;o._width,o._height,o._depth;switch(o._type){case e.MRI_UCHAR:o._pixelData=o._readUChar(a);break;case e.MRI_INT:o._pixelData=o._readInt(a);break;case e.MRI_FLOAT:o._pixelData=o._readFloat(a);break;case e.MRI_SHORT:o._pixelData=o._readShort(a);break;default:throw Error("MGH/MGZ parser: Unknown _type.  _type reports: "+o._type)}o._tr=o._readFloat(1),o._flipAngle=o._readFloat(1),o._te=o._readFloat(1),o._ti=o._readFloat(1),o._fov=o._readFloat(1);for(var s=new TextDecoder,l=o._tagReadStart();void 0!=l[0];){var c=l[0],h=l[1],u=void 0;switch(c){case e.TAG_OLD_MGH_XFORM:case e.TAG_MGH_XFORM:u=o._readChar(h);break;default:u=o._readChar(h)}u=s.decode(u),o._tags.push({tagType:c,tagValue:u}),l=o._tagReadStart()}var d=(new r.a).fromArray(o._Xras),f=(new r.a).fromArray(o._Yras),p=(new r.a).crossVectors(d,f),m=(new r.a).fromArray(o._Zras);p.angleTo(m)>Math.PI/2&&(o._rightHanded=!1),o._imageOrient=[-o._Xras[0],-o._Xras[1],o._Xras[2],-o._Yras[0],-o._Yras[1],o._Yras[2]];for(var _=o._width/2,g=o._height/2,y=o._depth/2,b=0;b<3;++b)o._origin[b]=o._Cras[b]-(o._Xras[b]*o._spacingXYZ[0]*_+o._Yras[b]*o._spacingXYZ[1]*g+o._Zras[b]*o._spacingXYZ[2]*y);return o._origin=[-o._origin[0],-o._origin[1],o._origin[2]],o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.seriesInstanceUID=function(){return this._url},e.prototype.numberOfFrames=function(){return this._depth},e.prototype.sopInstanceUID=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},e.prototype.rows=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._width},e.prototype.columns=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._height},e.prototype.pixelType=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(this._type){case e.MRI_UCHAR:case e.MRI_INT:case e.MRI_SHORT:return 0;case e.MRI_FLOAT:return 1;default:throw Error("MGH/MGZ parser: Unknown _type.  _type reports: "+this._type)}},e.prototype.bitsAllocated=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(this._type){case e.MRI_UCHAR:return 8;case e.MRI_SHORT:return 16;case e.MRI_INT:case e.MRI_FLOAT:return 32;default:throw Error("MGH/MGZ parser: Unknown _type.  _type reports: "+this._type)}},e.prototype.pixelSpacing=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._spacingXYZ},e.prototype.imageOrientation=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._imageOrient},e.prototype.imagePosition=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._origin},e.prototype.extractPixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._width*this._height;return this._pixelData.slice(t*e,(t+1)*e)},e.prototype._readInt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+4*t));this._bufferPos+=4*t;var i=void 0;if(1==t)i=e.getInt32(0,this._swapEndian);else{i=new Int32Array(t);for(var n=0;n<t;n++)i[n]=e.getInt32(4*n,this._swapEndian)}return i},e.prototype._readShort=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+2*t));this._bufferPos+=2*t;var i=void 0;if(1==t)i=e.getInt16(0,this._swapEndian);else{i=new Int16Array(t);for(var n=0;n<t;n++)i[n]=e.getInt16(2*n,this._swapEndian)}return i},e.prototype._readLong=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+8*t));this._bufferPos+=8*t;for(var i=new Uint16Array(t),n=0;n<t;n++){var r=0,o=0;this._swapendian?r=4:o=4;var a=e.getInt32(8*n+r,this._swapEndian),s=e.getInt32(8*n+o,this._swapEndian);0!=a&&(console.log("Unable to read Int64 with high word: "+a+"low word: "+s),s=void 0),i[n]=s}return 0==t?void 0:1==t?i[0]:i},e.prototype._readChar=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+t));this._bufferPos+=t;var i=void 0;if(1==t)i=e.getInt8(0,this._swapEndian);else{i=new Int8Array(t);for(var n=0;n<t;n++)i[n]=e.getInt8(n,this._swapEndian)}return i},e.prototype._readUChar=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+t));this._bufferPos+=t;var i=void 0;if(1==t)i=e.getUint8(0,this._swapEndian);else{i=new Uint8Array(t);for(var n=0;n<t;n++)i[n]=e.getUint8(n,this._swapEndian)}return i},e.prototype._readFloat=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new DataView(this._buffer.slice(this._bufferPos,this._bufferPos+4*t));this._bufferPos+=4*t;var i=void 0;if(1==t)i=e.getFloat32(0,this._swapEndian);else{i=new Float32Array(t);for(var n=0;n<t;n++)i[n]=e.getFloat32(4*n,this._swapEndian)}return i},e.prototype._tagReadStart=function(){if(this._bufferPos>=this._buffer.byteLength)return[void 0,void 0];var t=this._readInt(),i=void 0;switch(t){case e.TAG_OLD_MGH_XFORM:i=this._readInt(),i-=1;break;case e.TAG_OLD_SURF_GEOM:case e.TAG_OLD_USEREALRAS:case e.TAG_OLD_COLORTABLE:i=0;break;default:i=this._readLong()}return void 0==i&&(t=void 0),[t,i]},e}(n.a);e.a=o,o.MRI_UCHAR=0,o.MRI_INT=1,o.MRI_LONG=2,o.MRI_FLOAT=3,o.MRI_SHORT=4,o.MRI_BITMAP=5,o.MRI_TENSOR=6,o.MRI_FLOAT_COMPLEX=7,o.MRI_DOUBLE_COMPLEX=8,o.MRI_RGB=9,o.TAG_OLD_COLORTABLE=1,o.TAG_OLD_USEREALRAS=2,o.TAG_CMDLINE=3,o.TAG_USEREALRAS=4,o.TAG_COLORTABLE=5,o.TAG_GCAMORPH_GEOM=10,o.TAG_GCAMORPH_TYPE=11,o.TAG_GCAMORPH_LABELS=12,o.TAG_OLD_SURF_GEOM=20,o.TAG_SURF_GEOM=21,o.TAG_OLD_MGH_XFORM=30,o.TAG_MGH_XFORM=31,o.TAG_GROUP_AVG_SURFACE_AREA=32,o.TAG_AUTO_ALIGN=33,o.TAG_SCALAR_DOUBLE=40,o.TAG_PEDIR=41,o.TAG_MRI_FRAME=42,o.TAG_FIELDSTRENGTH=43},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._id=-1,this._worldCoordinates=null,this._dataCoordinates=null,this._screenCoordinates=null,this._value=null}return n(t,[{key:"worldCoordinates",set:function(t){this._worldCoordinates=t},get:function(){return this._worldCoordinates}},{key:"dataCoordinates",set:function(t){this._dataCoordinates=t},get:function(){return this._dataCoordinates}},{key:"screenCoordinates",set:function(t){this._screenCoordinates=t},get:function(){return this._screenCoordinates}},{key:"value",set:function(t){this._value=t},get:function(){return this._value}},{key:"id",set:function(t){this._id=t},get:function(){return this._id}}]),t}();e.a=r},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,null,[{key:"code",get:function(){return'\n        .widgets-handle {\n            position: absolute;\n            border: 1px solid;\n            border-radius: 50%;\n            width: 10px;\n            height: 10px;\n            margin: -6px; /* border + width / 2 */\n            z-index: 3;\n        }\n        .widgets-line {\n            position: absolute;\n            width: 1px;\n            height: 1px;\n            margin-top: -0.5px; /* height / 2 */\n        }\n        .widgets-dashline {\n            position: absolute;\n            border-top: 1px dashed;\n            margin-top: -0.5px; /* border / 2 */\n        }\n        .widgets-line:before,\n        .widgets-dashline:before { /* for dragging */\n            content: " ";\n            position: absolute;\n            height: 12px;\n            left: 0;\n            right: 0;\n            margin-top: -6px;\n        }\n        .widgets-rectangle {\n            position: absolute;\n            border: 1px solid;\n            margin: -1px; /* border */\n        }\n        .widgets-rectangle-helper {\n            position: absolute;\n            border: 1px dashed;\n            margin: -1px; /* border */\n        }\n        .widgets-ellipse {\n            position: absolute;\n            border: 1px solid;\n            border-radius: 50%;\n            margin: -1px; /* border */\n            z-index: 2;\n        }\n        .widgets-label {\n            position: absolute;\n            border: 1px solid;\n            background-color: rgba(0, 0, 0, 0.7);\n            color: rgb(255, 255, 255);\n            padding: 4px;\n            z-index: 3;\n        }\n        '}}]),t}();e.a=r},function(t,e,i){"use strict";i.d(e,"a",function(){return r});const n=[];for(let t=0;t<256;t++)n[t]=(t<16?"0":"")+t.toString(16);Math.PI,Math.PI;function r(t,e,i){return Math.max(e,Math.min(i,t))}},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(0);var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._createMaterial=function(t){var e=new this._shadersFragment(this._uniforms),i=new this._shadersVertex,r={uniforms:this._uniforms,vertexShader:i.compute(),fragmentShader:e.compute()},o=Object.assign(t,r);this._material=new n.B(o),this._material.needsUpdate=!0},e.prototype._updateMaterial=function(){var t=new this._shadersFragment(this._uniforms),e=new this._shadersVertex;this._material.vertexShader=e.compute(),this._material.fragmentShader=t.compute(),this._material.needsUpdate=!0},e.prototype._prepareTexture=function(){this._textures=[];for(var t=0;t<this._stack._rawData.length;t++){var e=new n.i(this._stack.rawData[t],this._stack.textureSize,this._stack.textureSize,this._stack.textureType,n.J,n.I,n.f,n.f,n.u,n.u);e.needsUpdate=!0,e.flipY=!0,this._textures.push(e)}},e}(n.v)},function(t,e,i){"use strict";var n=n||{};n.NIFTI1=n.NIFTI1||i(82),n.NIFTI2=n.NIFTI2||i(147),n.Utils=n.Utils||i(52);var r=r||i(47);n.isNIFTI1=function(t){var e,i,r,o;return i=(e=new DataView(t)).getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION),r=e.getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION+1),o=e.getUint8(n.NIFTI1.MAGIC_NUMBER_LOCATION+2),!(i!==n.NIFTI1.MAGIC_NUMBER[0]||r!==n.NIFTI1.MAGIC_NUMBER[1]||o!==n.NIFTI1.MAGIC_NUMBER[2])},n.isNIFTI2=function(t){var e,i,r,o;return i=(e=new DataView(t)).getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION),r=e.getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION+1),o=e.getUint8(n.NIFTI2.MAGIC_NUMBER_LOCATION+2),!(i!==n.NIFTI2.MAGIC_NUMBER[0]||r!==n.NIFTI2.MAGIC_NUMBER[1]||o!==n.NIFTI2.MAGIC_NUMBER[2])},n.isNIFTI=function(t){return n.isNIFTI1(t)||n.isNIFTI2(t)},n.isCompressed=function(t){var e,i,r;if(t){if(i=(e=new DataView(t)).getUint8(0),r=e.getUint8(1),i===n.Utils.GUNZIP_MAGIC_COOKIE1)return!0;if(r===n.Utils.GUNZIP_MAGIC_COOKIE2)return!0}return!1},n.decompress=function(t){return r.inflate(t).buffer},n.readHeader=function(t){var e=null;return n.isCompressed(t)&&(t=n.decompress(t)),n.isNIFTI1(t)?e=new n.NIFTI1:n.isNIFTI2(t)&&(e=new n.NIFTI2),e?e.readHeader(t):console.error("That file does not appear to be NIFTI!"),e},n.hasExtension=function(t){return 0!=t.extensionFlag[0]},n.readImage=function(t,e){var i=t.vox_offset,n=1,r=1;t.dims[4]&&(n=t.dims[4]),t.dims[5]&&(r=t.dims[5]);var o=t.dims[1]*t.dims[2]*t.dims[3]*n*r*(t.numBitsPerVoxel/8);return e.slice(i,i+o)},n.readExtension=function(t,e){var i=t.getExtensionLocation(),n=t.extensionSize;return e.slice(i,i+n)},n.readExtensionData=function(t,e){var i=t.getExtensionLocation(),n=t.extensionSize;return e.slice(i+8,i+n-8)},"undefined"!==typeof t&&t.exports&&(t.exports=n)},function(t,e,i){"use strict";var n={};(0,i(12).assign)(n,i(129),i(132),i(79)),t.exports=n},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";t.exports=function(t){return"string"==typeof t}},function(t,e,i){"use strict";var n=i(142);t.exports=function(t){return n(t)&&t>=0}},function(t,e,i){"use strict";var n=i(49),r=i(50),o=9007199254740991;t.exports=function(t,e){var i,a;if(!n(t))throw new TypeError("invalid input argument. First argument must be a string. Value: `"+t+"`.");if(!r(e))throw new TypeError("invalid input argument. Second argument must be a nonnegative integer. Value: `"+e+"`.");if(0===t.length||0===e)return"";if(t.length*e>o)throw new RangeError("invalid input argument. Output string length exceeds maximum allowed string length.");for(i="",a=e;1==(1&a)&&(i+=t),0!=(a>>>=1);)t+=t;return i}},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||{},n.Utils.crcTable=null,n.Utils.GUNZIP_MAGIC_COOKIE1=31,n.Utils.GUNZIP_MAGIC_COOKIE2=139,n.Utils.getStringAt=function(t,e,i){var n,r,o="";for(n=e;n<i;n+=1)0!==(r=t.getUint8(n))&&(o+=String.fromCharCode(r));return o},n.Utils.getByteAt=function(t,e){return t.getInt8(e)},n.Utils.getShortAt=function(t,e,i){return t.getInt16(e,i)},n.Utils.getIntAt=function(t,e,i){return t.getInt32(e,i)},n.Utils.getFloatAt=function(t,e,i){return t.getFloat32(e,i)},n.Utils.getDoubleAt=function(t,e,i){return t.getFloat64(e,i)},n.Utils.getLongAt=function(t,e,i){var r,o=[],a=0;for(r=0;r<8;r+=1)o[r]=n.Utils.getByteAt(t,e+r,i);for(r=o.length-1;r>=0;r--)a=256*a+o[r];return a},n.Utils.toArrayBuffer=function(t){var e,i,n;for(e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;n+=1)i[n]=t[n];return e},n.Utils.isString=function(t){return"string"==typeof t||t instanceof String},n.Utils.formatNumber=function(t,e){var i=0;return i=n.Utils.isString(t)?Number(t):t,i=e?i.toPrecision(5):i.toPrecision(7),parseFloat(i)},n.Utils.makeCRCTable=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e},n.Utils.crc32=function(t){for(var e=n.Utils.crcTable||(n.Utils.crcTable=n.Utils.makeCRCTable()),i=-1,r=0;r<t.byteLength;r++)i=i>>>8^e[255&(i^t.getUint8(r))];return(-1^i)>>>0},"undefined"!==typeof t&&t.exports&&(t.exports=n.Utils)},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,c=[],h=!1,u=-1;function d(){h&&l&&(h=!1,l.length?c=l.concat(c):u=-1,c.length&&f())}function f(){if(!h){var t=s(d);h=!0;for(var e=c.length;e;){for(l=c,c=[];++u<e;)l&&l[u].run();u=-1,e=c.length}l=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new p(t,e)),1!==c.length||h||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){(function(e,n){t.exports=function(t){var r,o=void 0!==(t=t||{})?t:{},a={};for(r in o)o.hasOwnProperty(r)&&(a[r]=o[r]);o.arguments=[],o.thisProgram="./this.program",o.quit=function(t,e){throw e},o.preRun=[],o.postRun=[];var s,l,c=!1,h=!1,u=!1,d=!1;if(o.ENVIRONMENT)if("WEB"===o.ENVIRONMENT)c=!0;else if("WORKER"===o.ENVIRONMENT)h=!0;else if("NODE"===o.ENVIRONMENT)u=!0;else{if("SHELL"!==o.ENVIRONMENT)throw new Error("Module['ENVIRONMENT'] value is not valid. must be one of: WEB|WORKER|NODE|SHELL.");d=!0}else c="object"==typeof window,h="function"==typeof importScripts,u="object"==typeof e&&!c&&!h,d=!c&&!u&&!h;u?(o.read=function(t,e){var n;return(n=Tt(t))||(s||(s=i(152)),l||(l=i(153)),t=l.normalize(t),n=s.readFileSync(t)),e?n:n.toString()},o.readBinary=function(t){var e=o.read(t,!0);return e.buffer||(e=new Uint8Array(e)),y(e.buffer),e},e.argv.length>1&&(o.thisProgram=e.argv[1].replace(/\\/g,"/")),o.arguments=e.argv.slice(2),e.on("uncaughtException",function(t){if(!(t instanceof zt))throw t}),e.on("unhandledRejection",function(t,i){e.exit(1)}),o.inspect=function(){return"[Emscripten Module object]"}):d?("undefined"!=typeof read&&(o.read=function(t){var e=Tt(t);return e?Mt(e):read(t)}),o.readBinary=function(t){var e;return(e=Tt(t))?e:"function"==typeof readbuffer?new Uint8Array(readbuffer(t)):(y("object"==typeof(e=read(t,"binary"))),e)},"undefined"!=typeof scriptArgs?o.arguments=scriptArgs:void 0!==arguments&&(o.arguments=arguments),"function"==typeof quit&&(o.quit=function(t,e){quit(t)})):(c||h)&&(o.read=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText}catch(e){var i=Tt(t);if(i)return Mt(i);throw e}},h&&(o.readBinary=function(t){try{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}catch(e){var i=Tt(t);if(i)return i;throw e}}),o.readAsync=function(t,e,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){if(200==n.status||0==n.status&&n.response)e(n.response);else{var r=Tt(t);r?e(r.buffer):i()}},n.onerror=i,n.send(null)},void 0!==arguments&&(o.arguments=arguments),o.setWindowTitle=function(t){document.title=t});for(r in o.print="undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null,o.printErr="undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||o.print,o.print=o.print,o.printErr=o.printErr,a)a.hasOwnProperty(r)&&(o[r]=a[r]);a=void 0;var f=16;function p(t){y(!D);var e=L;return L=L+t+15&-16,e}function m(t,e){return e||(e=f),t=Math.ceil(t/e)*e}function _(t){switch(t){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:if("*"===t[t.length-1])return 4;if("i"===t[0]){var e=parseInt(t.substr(1));return y(e%8==0),e/8}return 0}}new Array(0);var g=0;function y(t,e){t||Ht("Assertion failed: "+e)}var b={stackSave:function(){Lt()},stackRestore:function(){Bt()},arrayToC:function(t){var e=Rt(t.length);return rt(t,e),e},stringToC:function(t){var e=0;if(null!==t&&void 0!==t&&0!==t){var i=1+(t.length<<2);!function(t,e,i){!function(t,e,i,n){if(!(n>0))return 0;for(var r=i+n-1,o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++o)),a<=127){if(i>=r)break;e[i++]=a}else if(a<=2047){if(i+1>=r)break;e[i++]=192|a>>6,e[i++]=128|63&a}else if(a<=65535){if(i+2>=r)break;e[i++]=224|a>>12,e[i++]=128|a>>6&63,e[i++]=128|63&a}else if(a<=2097151){if(i+3>=r)break;e[i++]=240|a>>18,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}else if(a<=67108863){if(i+4>=r)break;e[i++]=248|a>>24,e[i++]=128|a>>18&63,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}else{if(i+5>=r)break;e[i++]=252|a>>30,e[i++]=128|a>>24&63,e[i++]=128|a>>18&63,e[i++]=128|a>>12&63,e[i++]=128|a>>6&63,e[i++]=128|63&a}}e[i]=0}(t,C,e,i)}(t,e=Rt(i),i)}return e}},v={string:b.stringToC,array:b.arrayToC};function w(t,e,i,n){switch("*"===(i=i||"i8").charAt(i.length-1)&&(i="i32"),i){case"i1":case"i8":k[t>>0]=e;break;case"i16":I[t>>1]=e;break;case"i32":P[t>>2]=e;break;case"i64":tempI64=[e>>>0,(tempDouble=e,+ot(tempDouble)>=1?tempDouble>0?(0|ct(+st(tempDouble/4294967296),4294967295))>>>0:~~+at((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],P[t>>2]=tempI64[0],P[t+4>>2]=tempI64[1];break;case"float":R[t>>2]=e;break;case"double":B[t>>3]=e;break;default:Ht("invalid type for setValue: "+i)}}var x=2,A=4;function S(t,e){if(0===e||!t)return"";for(var i,n=0,r=0;n|=i=C[t+r>>0],(0!=i||e)&&(r++,!e||r!=e););e||(e=r);var o="";if(n<128){for(var a;e>0;)a=String.fromCharCode.apply(String,C.subarray(t,t+Math.min(e,1024))),o=o?o+a:a,t+=1024,e-=1024;return o}return function(t){return E(C,t)}(t)}var M="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(t,e){for(var i=e;t[i];)++i;if(i-e>16&&t.subarray&&M)return M.decode(t.subarray(e,i));for(var n,r,o,a,s,l="";;){if(!(n=t[e++]))return l;if(128&n)if(r=63&t[e++],192!=(224&n))if(o=63&t[e++],224==(240&n)?n=(15&n)<<12|r<<6|o:(a=63&t[e++],240==(248&n)?n=(7&n)<<18|r<<12|o<<6|a:(s=63&t[e++],n=248==(252&n)?(3&n)<<24|r<<18|o<<12|a<<6|s:(1&n)<<30|r<<24|o<<18|a<<12|s<<6|63&t[e++])),n<65536)l+=String.fromCharCode(n);else{var c=n-65536;l+=String.fromCharCode(55296|c>>10,56320|1023&c)}else l+=String.fromCharCode((31&n)<<6|r);else l+=String.fromCharCode(n)}}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var T,k,C,I,P,R,B,L,D,O,F,G,N,z,U=65536,H=16777216,V=16777216;function W(t,e){return t%e>0&&(t+=e-t%e),t}function j(){o.HEAP8=k=new Int8Array(T),o.HEAP16=I=new Int16Array(T),o.HEAP32=P=new Int32Array(T),o.HEAPU8=C=new Uint8Array(T),o.HEAPU16=new Uint16Array(T),o.HEAPU32=new Uint32Array(T),o.HEAPF32=R=new Float32Array(T),o.HEAPF64=B=new Float64Array(T)}function Z(){var t=o.usingWasm?U:H,e=2147483648-t;if(P[N>>2]>e)return!1;var i=X;for(X=Math.max(X,V);X<P[N>>2];)X=X<=536870912?W(2*X,t):Math.min(W((3*X+2147483648)/4,t),e);var n=o.reallocBuffer(X);return n&&n.byteLength==X?(function(t){o.buffer=T=t}(n),j(),!0):(X=i,!1)}L=O=N=0,D=!1,o.reallocBuffer||(o.reallocBuffer=function(t){var e;try{if(ArrayBuffer.transfer)e=ArrayBuffer.transfer(T,t);else{var i=k;e=new ArrayBuffer(t),new Int8Array(e).set(i)}}catch(t){return!1}return!!It(e)&&e});try{(z=Function.prototype.call.bind(Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get))(new ArrayBuffer(4))}catch(t){z=function(t){return t.byteLength}}var Y=o.TOTAL_STACK||5242880,X=o.TOTAL_MEMORY||16777216;if(X<Y&&o.printErr("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+X+"! (TOTAL_STACK="+Y+")"),o.buffer?T=o.buffer:(T=new ArrayBuffer(X),o.buffer=T),j(),P[0]=1668509029,I[1]=25459,115!==C[2]||99!==C[3])throw"Runtime error: expected the system to be little-endian!";function J(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var i=e.func;"number"==typeof i?void 0===e.arg?o.dynCall_v(i):o.dynCall_vi(i,e.arg):i(void 0===e.arg?null:e.arg)}else e()}}var Q=[],q=[],K=[],$=[],tt=[],et=!1;function it(t){Q.unshift(t)}function nt(t){tt.unshift(t)}function rt(t,e){k.set(t,e)}var ot=Math.abs,at=(Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil),st=Math.floor,lt=Math.pow,ct=(Math.imul,Math.fround,Math.round,Math.min),ht=(Math.max,Math.clz32,Math.trunc,0),ut=null,dt=null;o.preloadedImages={},o.preloadedAudios={};var ft=null,pt="data:application/octet-stream;base64,";function mt(t){return String.prototype.startsWith?t.startsWith(pt):0===t.indexOf(pt)}L=26360,q.push(),ft="data:application/octet-stream;base64,g8DKoUW2+z9/+zpwzojqP3/7OnDOiOo/g8DKoUW2+z/hehSuR+H8P166SQwCK/k/AAAAAAAA8D8AAAAAAAD4PwAAAAAAAAZAAAAAAACAFUBcj8L1KFwlQNejcD0KVzVA9ihcj8JVRUCF61G4HlVVQGZmZmZmVmVAzczMzMxUdUDP91PjpZvwP0a28/3UePk/JzEIrBxaB0AdWmQ7388WQClcj8L1qCZApHA9CtejNkAAAAAAAKBGQB+F61G4nlZAzczMzMycZkAAAAAAAAAAAM/3U+Olm/A/Rrbz/dR4+T8nMQisHFoHQB1aZDvfzxZAKVyPwvWoJkCkcD0K16M2QAAAAAAAoEZAH4XrUbieVkDNzMzMzJxmQAAAAAAAAAAArfpcbcX+5j9Wfa62Yn/tP8dLN4lBYPk/8tJNYhBYCED6fmq8dBMYQIXrUbgeBShAAAAAAAAAOEBcj8L1KPxHQOxRuB6F+1dAAAAAAAAAAAAAAAAAAADwP3E9CtejcP8/aJHtfD+1EEB1kxgEVs4gQGZmZmZm5jBA7FG4HoXrQEBcj8L1KOxQQJqZmZmZ6WBAmpmZmZnpcEAzMzMzM+eAQJMYBFYOLQBAtvP91HjpD0D2KFyPwrUgQArXo3A9CjFAw/UoXI8iQUC4HoXrUShRQJqZmZmZKWFAmpmZmZkpcUAAAAAAACiBQAAAAAAAAAAAkxgEVg4tAEC28/3UeOkPQPYoXI/CtSBACtejcD0KMUDD9ShcjyJBQLgehetRKFFAmpmZmZkpYUCamZmZmSlxQAAAAAAAKIFAAAAAAAAAAACkcD0K16MAQOxRuB6F6w5Ad76fGi+dIECuR+F6FC4xQHsUrkfhWkFA9ihcj8JlUUCamZmZmWlhQJqZmZmZaXFAmpmZmZlpgUAAAAAAAAAAAAQAAABDUFJMAAAAAAAAAABMUkNQAAAAAAMAAABQQ1JMAAAAAAEAAABSTENQAAAAAAIAAABSUENMAAAAAP////8AAAAAAAAAAAEAAAACAAAAAwAAAAQAAACQ/wAADAAAAAEAAABS/wAAFAAAAAIAAABT/wAAFAAAAAMAAABe/wAAFAAAAAQAAABc/wAAFAAAAAUAAABd/wAAFAAAAAYAAABf/wAAFAAAAAcAAABR/wAAAgAAAAgAAABV/wAABAAAAAkAAABX/wAABAAAAAoAAABY/wAAEAAAAAsAAABg/wAABAAAAAwAAABh/wAAEAAAAA0AAACR/wAAAAAAAAAAAABj/wAABAAAAA4AAABk/wAAFAAAAA8AAAB0/wAAFAAAABAAAAB4/wAABAAAABEAAAB1/wAAFAAAABIAAAB3/wAAFAAAABMAAAAAAAAAFAAAAAAAAAACAAAABAAAAAQAAAAIAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAAgIFBqFAAAAHB5dGYVAAAAaDJwahYAAAByZGhpFwAAAHJsb2MYAAAAY2NwYhkAAABybGNwGgAAAHBhbWMbAAAAZmVkYxwAAAABVgAAAAAAAKQEAAC0BAAAAVYAAAEAAAC0BAAApAQAAAE0AAAAAAAAxAQAAEQFAAABNAAAAQAAANQEAABUBQAAARgAAAAAAADkBAAApAUAAAEYAAABAAAA9AQAALQFAADBCgAAAAAAAAQFAAAEBgAAwQoAAAEAAAAUBQAAFAYAACEFAAAAAAAAJAUAACQIAAAhBQAAAQAAADQFAAA0CAAAIQIAAAAAAABECQAApAgAACECAAABAAAAVAkAALQIAAABVgAAAAAAAGQFAABUBQAAAVYAAAEAAAB0BQAARAUAAAFUAAAAAAAAhAUAAEQGAAABVAAAAQAAAJQFAABUBgAAAUgAAAAAAACkBQAARAYAAAFIAAABAAAAtAUAAFQGAAABOAAAAAAAAMQFAABEBgAAATgAAAEAAADUBQAAVAYAAAEwAAAAAAAA5AUAAKQGAAABMAAAAQAAAPQFAAC0BgAAASQAAAAAAAAEBgAAxAYAAAEkAAABAAAAFAYAANQGAAABHAAAAAAAACQGAAAEBwAAARwAAAEAAAA0BgAAFAcAAAEWAAAAAAAAJAgAACQHAAABFgAAAQAAADQIAAA0BwAAAVYAAAAAAABkBgAAVAYAAAFWAAABAAAAdAYAAEQGAAABVAAAAAAAAIQGAABEBgAAAVQAAAEAAACUBgAAVAYAAAFRAAAAAAAApAYAAGQGAAABUQAAAQAAALQGAAB0BgAAAUgAAAAAAADEBgAAhAYAAAFIAAABAAAA1AYAAJQGAAABOAAAAAAAAOQGAACkBgAAATgAAAEAAAD0BgAAtAYAAAE0AAAAAAAABAcAAMQGAAABNAAAAQAAABQHAADUBgAAATAAAAAAAAAkBwAA5AYAAAEwAAABAAAANAcAAPQGAAABKAAAAAAAAEQHAADkBgAAASgAAAEAAABUBwAA9AYAAAEkAAAAAAAAZAcAAAQHAAABJAAAAQAAAHQHAAAUBwAAASIAAAAAAACEBwAAJAcAAAEiAAABAAAAlAcAADQHAAABHAAAAAAAAKQHAABEBwAAARwAAAEAAAC0BwAAVAcAAAEYAAAAAAAAxAcAAGQHAAABGAAAAQAAANQHAAB0BwAAARYAAAAAAADkBwAAhAcAAAEWAAABAAAA9AcAAJQHAAABFAAAAAAAAAQIAACkBwAAARQAAAEAAAAUCAAAtAcAAAESAAAAAAAAJAgAAMQHAAABEgAAAQAAADQIAADUBwAAAREAAAAAAABECAAA5AcAAAERAAABAAAAVAgAAPQHAADBCgAAAAAAAGQIAAAECAAAwQoAAAEAAAB0CAAAFAgAAMEJAAAAAAAAhAgAACQIAADBCQAAAQAAAJQIAAA0CAAAoQgAAAAAAACkCAAARAgAAKEIAAABAAAAtAgAAFQIAAAhBQAAAAAAAMQIAABkCAAAIQUAAAEAAADUCAAAdAgAAEEEAAAAAAAA5AgAAIQIAABBBAAAAQAAAPQIAACUCAAAoQIAAAAAAAAECQAApAgAAKECAAABAAAAFAkAALQIAAAhAgAAAAAAACQJAADECAAAIQIAAAEAAAA0CQAA1AgAAEEBAAAAAAAARAkAAOQIAABBAQAAAQAAAFQJAAD0CAAAEQEAAAAAAABkCQAABAkAABEBAAABAAAAdAkAABQJAACFAAAAAAAAAIQJAAAkCQAAhQAAAAEAAACUCQAANAkAAEkAAAAAAAAApAkAAEQJAABJAAAAAQAAALQJAABUCQAAJQAAAAAAAADECQAAZAkAACUAAAABAAAA1AkAAHQJAAAVAAAAAAAAAOQJAACECQAAFQAAAAEAAAD0CQAAlAkAAAkAAAAAAAAABAoAAKQJAAAJAAAAAQAAABQKAAC0CQAABQAAAAAAAAAkCgAAxAkAAAUAAAABAAAANAoAANQJAAABAAAAAAAAACQKAADkCQAAAQAAAAEAAAA0CgAA9AkAAAFWAAAAAAAARAoAAEQKAAABVgAAAQAAAFQKAABUCgAAaAoAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAA6GIAAAAEAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAr/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC4YgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAEIAAgAoAAgAgQABABAAAAAAAAAAAAAAAAgACAAIAAgAAAAQABAAGAAYABAAIAAoACgAIAAwADgAMABAAEgAQABYAFgAUABoAGAAeABwAIgAgACYAJAAqACoALAAyADAANAA6ADgAPABCAEIARABIAE4ATgBQAFQAWABeAF4AYgBmAGgAbABwAHQAeAB8AIAAhACIAIwAkACWAJoAngCiAKQArACwALYAugC8AMQAygDOANAA2ADeAOAA6ADuAPAA+gD+AQABCgEMARYBGAEiASQBLgEwAToBPgFEAU4BUAFYAWIBZAFsAXYBegGAAYgBkgGWAZwBpAGsAbYBugHCAcoB0AHYAeAB6AHwAfgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAEAA4AEAAaABwAJgAoADIANAA+AEAASgBMAFYAWABiAGQAbgBwAHoAfACGAIgAkgCUAJ4AoACqAKwAtgC4AMIAxADOANAA2gDcAOYA6ADyAPQA/gEAAQoBDAEWARgBIgEkAS4BMAE6ATwBRgFIAVIBVAFeAWABagFsAXYBeAGCAYQBjgGQAZoBnAGmAagBsgG0Ab4BwAHKAcwB1gHYAIAAfAB4AHQAcABuAGoAZgBiAFwAXABYAFYAUgBMAEwASgBGAEAAQAA+ADgAOAA2ADAAMgAuACgAKgAkACYAIAAiABwAHgAYABoAFgAUABYAEAAQABIADAAMAA4ACgAIAAgACgAGAAQABAAEAAYAAgACAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAgACAAIAAAAEAAQABgAGAAQACAAKAAoACAAMAA4ADAAQABIAEAAWABYAFAAaABgAHgAcACIAIAAmACQAKgAqACwAMgAwADQAOgA4ADwAQgBCAEQASABOAE4AUABUAFgAXgBeAGIAZgBoAGwAcAB0AHgAfABiAFwAXgBYAFoAVABWAFAAUgBMAE4ASABKAEQARgBAAEIAPAA+ADgAOgA0ADYAMAAyACwALgAoACoAJAAmACAAIgAcAB4AGAAaABQAFgAQABIADAAOAAgACgAEAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAYABAAKAAgADgAMABIAEAAWABQAGgAYAB4AHAAiACAAJgAkACoAKAAuACwAMgAwADYANAA6ADgAPgA8AEIAQABGAEQASgBIAE4ATABSAFAAVgBUAFoAWABeAF1tFUlJPUl0gJXMAW0VSUk9SXSBvcGpfZGVjb21wcmVzczogZmFpbGVkIHRvIHNldHVwIHRoZSBkZWNvZGVyAFtFUlJPUl0gb3BqX2RlY29tcHJlc3M6IGZhaWxlZCB0byByZWFkIHRoZSBoZWFkZXIAW0VSUk9SXSBvcGpfZGVjb21wcmVzczogZmFpbGVkIHRvIGRlY29kZSB0aWxlIQBFcnJvciBvbiB3cml0aW5nIHN0cmVhbSEKAFN0cmVhbSByZWFjaGVkIGl0cyBlbmQgIQoAU3RyZWFtIGVycm9yIQoAMi4xLjEAd2IAcmIAQ29kZWMgcHJvdmlkZWQgdG8gdGhlIG9wal9zZXR1cF9kZWNvZGVyIGZ1bmN0aW9uIGlzIG5vdCBhIGRlY29tcHJlc3NvciBoYW5kbGVyLgoAQ29kZWMgcHJvdmlkZWQgdG8gdGhlIG9wal9yZWFkX2hlYWRlciBmdW5jdGlvbiBpcyBub3QgYSBkZWNvbXByZXNzb3IgaGFuZGxlci4KAEludmFsaWQgbnVtYmVyIG9mIHJlc29sdXRpb25zIDogJWQgbm90IGluIHJhbmdlIFsxLCVkXQoARGVwcmVjYXRlZCBmaWVsZHMgY3BfY2luZW1hIG9yIGNwX3JzaXogYXJlIHVzZWQKUGxlYXNlIGNvbnNpZGVyIHVzaW5nIG9ubHkgdGhlIHJzaXogZmllbGQKU2VlIG9wZW5qcGVnLmggZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBkZXRhaWxzCgBUaGUgZGVzaXJlZCBtYXhpbXVtIGNvZGVzdHJlYW0gc2l6ZSBoYXMgbGltaXRlZAphdCBsZWFzdCBvbmUgb2YgdGhlIGRlc2lyZWQgcXVhbGl0eSBsYXllcnMKAEpQRUcgMjAwMCBTY2FsYWJsZSBEaWdpdGFsIENpbmVtYSBwcm9maWxlcyBub3QgeWV0IHN1cHBvcnRlZAoASlBFRyAyMDAwIFByb2ZpbGUtMyBhbmQgNCAoMmsvNGsgZGMgcHJvZmlsZSkgcmVxdWlyZXM6CjEgc2luZ2xlIHF1YWxpdHkgbGF5ZXItPiBOdW1iZXIgb2YgbGF5ZXJzIGZvcmNlZCB0byAxIChyYXRoZXIgdGhhbiAlZCkKLT4gUmF0ZSBvZiB0aGUgbGFzdCBsYXllciAoJTMuMWYpIHdpbGwgYmUgdXNlZABKUEVHIDIwMDAgUHJvZmlsZS0zICgyayBkYyBwcm9maWxlKSByZXF1aXJlczoKTnVtYmVyIG9mIGRlY29tcG9zaXRpb24gbGV2ZWxzIDw9IDUKLT4gTnVtYmVyIG9mIGRlY29tcG9zaXRpb24gbGV2ZWxzIGZvcmNlZCB0byA1IChyYXRoZXIgdGhhbiAlZCkKAEpQRUcgMjAwMCBQcm9maWxlLTQgKDRrIGRjIHByb2ZpbGUpIHJlcXVpcmVzOgpOdW1iZXIgb2YgZGVjb21wb3NpdGlvbiBsZXZlbHMgPj0gMSAmJiA8PSA2Ci0+IE51bWJlciBvZiBkZWNvbXBvc2l0aW9uIGxldmVscyBmb3JjZWQgdG8gMSAocmF0aGVyIHRoYW4gJWQpCgBKUEVHIDIwMDAgUHJvZmlsZS00ICg0ayBkYyBwcm9maWxlKSByZXF1aXJlczoKTnVtYmVyIG9mIGRlY29tcG9zaXRpb24gbGV2ZWxzID49IDEgJiYgPD0gNgotPiBOdW1iZXIgb2YgZGVjb21wb3NpdGlvbiBsZXZlbHMgZm9yY2VkIHRvIDYgKHJhdGhlciB0aGFuICVkKQoASlBFRyAyMDAwIFByb2ZpbGUtMyBhbmQgNCAoMmsvNGsgZGMgcHJvZmlsZSkgcmVxdWlyZXM6Ck1heGltdW0gMTMwMjA4MyBjb21wcmVzc2VkIGJ5dGVzIEAgMjRmcHMKQXMgbm8gcmF0ZSBoYXMgYmVlbiBnaXZlbiwgdGhpcyBsaW1pdCB3aWxsIGJlIHVzZWQuCgBKUEVHIDIwMDAgUHJvZmlsZS0zIGFuZCA0ICgyay80ayBkYyBwcm9maWxlKSByZXF1aXJlczoKTWF4aW11bSAxMzAyMDgzIGNvbXByZXNzZWQgYnl0ZXMgQCAyNGZwcwotPiBTcGVjaWZpZWQgcmF0ZSBleGNlZWRzIHRoaXMgbGltaXQuIFJhdGUgd2lsbCBiZSBmb3JjZWQgdG8gMTMwMjA4MyBieXRlcy4KAEpQRUcgMjAwMCBQcm9maWxlLTMgYW5kIDQgKDJrLzRrIGRjIHByb2ZpbGUpIHJlcXVpcmVzOgpNYXhpbXVtIDEwNDE2NjYgY29tcHJlc3NlZCBieXRlcyBAIDI0ZnBzCkFzIG5vIHJhdGUgaGFzIGJlZW4gZ2l2ZW4sIHRoaXMgbGltaXQgd2lsbCBiZSB1c2VkLgoASlBFRyAyMDAwIFByb2ZpbGUtMyBhbmQgNCAoMmsvNGsgZGMgcHJvZmlsZSkgcmVxdWlyZXM6Ck1heGltdW0gMTA0MTY2NiBjb21wcmVzc2VkIGJ5dGVzIEAgMjRmcHMKLT4gU3BlY2lmaWVkIHJhdGUgZXhjZWVkcyB0aGlzIGxpbWl0LiBSYXRlIHdpbGwgYmUgZm9yY2VkIHRvIDEwNDE2NjYgYnl0ZXMuCgBKUEVHIDIwMDAgUHJvZmlsZS0zICgyayBkYyBwcm9maWxlKSByZXF1aXJlczoKMyBjb21wb25lbnRzLT4gTnVtYmVyIG9mIGNvbXBvbmVudHMgb2YgaW5wdXQgaW1hZ2UgKCVkKSBpcyBub3QgY29tcGxpYW50Ci0+IE5vbi1wcm9maWxlLTMgY29kZXN0cmVhbSB3aWxsIGJlIGdlbmVyYXRlZAoAc2lnbmVkAHVuc2lnbmVkAEpQRUcgMjAwMCBQcm9maWxlLTMgKDJrIGRjIHByb2ZpbGUpIHJlcXVpcmVzOgpQcmVjaXNpb24gb2YgZWFjaCBjb21wb25lbnQgc2hhbGwgYmUgMTIgYml0cyB1bnNpZ25lZC0+IEF0IGxlYXN0IGNvbXBvbmVudCAlZCBvZiBpbnB1dCBpbWFnZSAoJWQgYml0cywgJXMpIGlzIG5vdCBjb21wbGlhbnQKLT4gTm9uLXByb2ZpbGUtMyBjb2Rlc3RyZWFtIHdpbGwgYmUgZ2VuZXJhdGVkCgBKUEVHIDIwMDAgUHJvZmlsZS0zICgyayBkYyBwcm9maWxlKSByZXF1aXJlczoKd2lkdGggPD0gMjA0OCBhbmQgaGVpZ2h0IDw9IDEwODAKLT4gSW5wdXQgaW1hZ2Ugc2l6ZSAlZCB4ICVkIGlzIG5vdCBjb21wbGlhbnQKLT4gTm9uLXByb2ZpbGUtMyBjb2Rlc3RyZWFtIHdpbGwgYmUgZ2VuZXJhdGVkCgBKUEVHIDIwMDAgUHJvZmlsZS00ICg0ayBkYyBwcm9maWxlKSByZXF1aXJlczoKd2lkdGggPD0gNDA5NiBhbmQgaGVpZ2h0IDw9IDIxNjAKLT4gSW1hZ2Ugc2l6ZSAlZCB4ICVkIGlzIG5vdCBjb21wbGlhbnQKLT4gTm9uLXByb2ZpbGUtNCBjb2Rlc3RyZWFtIHdpbGwgYmUgZ2VuZXJhdGVkCgBKUEVHIDIwMDAgTG9uZyBUZXJtIFN0b3JhZ2UgcHJvZmlsZSBub3QgeWV0IHN1cHBvcnRlZAoASlBFRyAyMDAwIEJyb2FkY2FzdCBwcm9maWxlcyBub3QgeWV0IHN1cHBvcnRlZAoASlBFRyAyMDAwIElNRiBwcm9maWxlcyBub3QgeWV0IHN1cHBvcnRlZAoASlBFRyAyMDAwIFBhcnQtMiBwcm9maWxlIGRlZmluZWQKYnV0IG5vIFBhcnQtMiBleHRlbnNpb24gZW5hYmxlZC4KUHJvZmlsZSBzZXQgdG8gTk9ORS4KAFVuc3VwcG9ydGVkIFBhcnQtMiBleHRlbnNpb24gZW5hYmxlZApQcm9maWxlIHNldCB0byBOT05FLgoATm90IGVub3VnaCBtZW1vcnkgdG8gYWxsb2NhdGUgY29weSBvZiB1c2VyIGVuY29kaW5nIHBhcmFtZXRlcnMgbWF0cml4IAoATm90IGVub3VnaCBtZW1vcnkgdG8gYWxsb2NhdGUgY29weSBvZiBjb21tZW50IHN0cmluZwoATm90IGVub3VnaCBtZW1vcnkgdG8gYWxsb2NhdGUgY29tbWVudCBzdHJpbmcKACVzJXMAQ3JlYXRlZCBieSBPcGVuSlBFRyB2ZXJzaW9uIABOb3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSB0aWxlIGNvZGluZyBwYXJhbWV0ZXJzCgBOb3QgZW5vdWdoIG1lbW9yeSBmb3IgY2hlY2tpbmcgdGhlIHBvYyB2YWx1ZXMuCgBNaXNzaW5nIHBhY2tldHMgcG9zc2libGUgbG9zcyBvZiBkYXRhCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSB0aWxlIGNvbXBvbmVudCBjb2RpbmcgcGFyYW1ldGVycwoATm90IGVub3VnaCBtZW1vcnkgdG8gYWxsb2NhdGUgdGVtcCBidWZmZXIKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGFsbG9jYXRlIGVuY29kZXIgTUNUIGNvZGluZyBtYXRyaXggCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSBlbmNvZGVyIE1DVCBkZWNvZGluZyBtYXRyaXggCgBGYWlsZWQgdG8gaW52ZXJzZSBlbmNvZGVyIE1DVCBkZWNvZGluZyBtYXRyaXggCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBhbGxvY2F0ZSBlbmNvZGVyIE1DVCBub3JtcyAKAEZhaWxlZCB0byBzZXR1cCBqMmsgbWN0IGVuY29kaW5nCgBDYW5ub3QgcGVyZm9ybSBNQ1Qgb24gY29tcG9uZW50cyB3aXRoIGRpZmZlcmVudCBzaXplcy4gRGlzYWJsaW5nIE1DVC4KAENhbm5vdCBkZWNvZGUgdGlsZSwgbWVtb3J5IGVycm9yCgBTdGFydCB0byByZWFkIGoyayBtYWluIGhlYWRlciAoJWQpLgoATm90IGVub3VnaCBtZW1vcnkgdG8gYWRkIG1oIG1hcmtlcgoARXhwZWN0ZWQgYSBTT0MgbWFya2VyIAoAU3RyZWFtIHRvbyBzaG9ydAoAQSBtYXJrZXIgSUQgd2FzIGV4cGVjdGVkICgweGZmLS0pIGluc3RlYWQgb2YgJS44eAoAVW5rbm93biBtYXJrZXIKAE1hcmtlciBpcyBub3QgY29tcGxpYW50IHdpdGggaXRzIHBvc2l0aW9uCgBVbmtub3cgbWFya2VyIGhhdmUgYmVlbiBkZXRlY3RlZCBhbmQgZ2VuZXJhdGVkIGVycm9yLgoATm90IGVub3VnaCBtZW1vcnkgdG8gcmVhZCBoZWFkZXIKAE1hcmtlciBoYW5kbGVyIGZ1bmN0aW9uIGZhaWxlZCB0byByZWFkIHRoZSBtYXJrZXIgc2VnbWVudAoAcmVxdWlyZWQgU0laIG1hcmtlciBub3QgZm91bmQgaW4gbWFpbiBoZWFkZXIKAHJlcXVpcmVkIENPRCBtYXJrZXIgbm90IGZvdW5kIGluIG1haW4gaGVhZGVyCgByZXF1aXJlZCBRQ0QgbWFya2VyIG5vdCBmb3VuZCBpbiBtYWluIGhlYWRlcgoATm90IGVub3VnaCBieXRlcyB0byByZWFkIE5wcG0KAENvcnJ1cHRlZCBQUE0gbWFya2VycwoATm90IGVub3VnaCBtZW1vcnkgdG8gcmVhZCBQUE0gbWFya2VyCgBGYWlsZWQgdG8gbWVyZ2UgUFBNIGRhdGEKAE1haW4gaGVhZGVyIGhhcyBiZWVuIGNvcnJlY3RseSBkZWNvZGVkLgoARXJyb3IgcmVhZGluZyBNQ08gbWFya2VyCgBDYW5ub3QgdGFrZSBpbiBjaGFyZ2UgbXVsdGlwbGUgdHJhbnNmb3JtYXRpb24gc3RhZ2VzLgoARXJyb3IgcmVhZGluZyBNQ0MgbWFya2VyCgBDYW5ub3QgdGFrZSBpbiBjaGFyZ2UgbXVsdGlwbGUgZGF0YSBzcGFubmluZwoATm90IGVub3VnaCBtZW1vcnkgdG8gcmVhZCBNQ0MgbWFya2VyCgBDYW5ub3QgdGFrZSBpbiBjaGFyZ2UgbXVsdGlwbGUgY29sbGVjdGlvbnMKAENhbm5vdCB0YWtlIGluIGNoYXJnZSBjb2xsZWN0aW9ucyBvdGhlciB0aGFuIGFycmF5IGRlY29ycmVsYXRpb24KAENhbm5vdCB0YWtlIGluIGNoYXJnZSBjb2xsZWN0aW9ucyB3aXRoIGluZGl4IHNodWZmbGUKAENhbm5vdCB0YWtlIGluIGNoYXJnZSBjb2xsZWN0aW9ucyB3aXRob3V0IHNhbWUgbnVtYmVyIG9mIGluZGl4ZXMKAENycm9yIHJlYWRpbmcgQ0JEIG1hcmtlcgoARXJyb3IgcmVhZGluZyBNQ1QgbWFya2VyCgBDYW5ub3QgdGFrZSBpbiBjaGFyZ2UgbWN0IGRhdGEgd2l0aGluIG11bHRpcGxlIE1DVCByZWNvcmRzCgBOb3QgZW5vdWdoIG1lbW9yeSB0byByZWFkIE1DVCBtYXJrZXIKAENhbm5vdCB0YWtlIGluIGNoYXJnZSBtdWx0aXBsZSBNQ1QgbWFya2VycwoARXJyb3IgcmVhZGluZyBDUkcgbWFya2VyCgBFcnJvciByZWFkaW5nIFBQVCBtYXJrZXIKAEVycm9yIHJlYWRpbmcgUFBUIG1hcmtlcjogcGFja2V0IGhlYWRlciBoYXZlIGJlZW4gcHJldmlvdXNseSBmb3VuZCBpbiB0aGUgbWFpbiBoZWFkZXIgKFBQTSBtYXJrZXIpLgoATm90IGVub3VnaCBtZW1vcnkgdG8gcmVhZCBQUFQgbWFya2VyCgBacHB0ICV1IGFscmVhZHkgcmVhZAoARXJyb3IgcmVhZGluZyBQUE0gbWFya2VyCgBacHBtICV1IGFscmVhZHkgcmVhZAoARXJyb3IgcmVhZGluZyBQTFQgbWFya2VyCgBFcnJvciByZWFkaW5nIFBMTSBtYXJrZXIKAEVycm9yIHJlYWRpbmcgVExNIG1hcmtlcgoARXJyb3Igd2l0aCBTSVogbWFya2VyIHNpemUKAEVycm9yIHdpdGggU0laIG1hcmtlcjogbnVtYmVyIG9mIGNvbXBvbmVudCBpcyBpbGxlZ2FsIC0+ICVkCgBFcnJvciB3aXRoIFNJWiBtYXJrZXI6IG51bWJlciBvZiBjb21wb25lbnQgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgcmVtYWluaW5nIG51bWJlciBvZiBwYXJhbWV0ZXJzICggJWQgdnMgJWQpCgBFcnJvciB3aXRoIFNJWiBtYXJrZXI6IG5lZ2F0aXZlIG9yIHplcm8gaW1hZ2Ugc2l6ZSAoJWxsZCB4ICVsbGQpCgBFcnJvciB3aXRoIFNJWiBtYXJrZXI6IGludmFsaWQgdGlsZSBzaXplICh0ZHg6ICVkLCB0ZHk6ICVkKQoAUHJldmVudCBidWZmZXIgb3ZlcmZsb3cgKHgxOiAlZCwgeTE6ICVkKQoARXJyb3Igd2l0aCBTSVogbWFya2VyOiBpbGxlZ2FsIHRpbGUgb2Zmc2V0CgBOb3QgZW5vdWdoIG1lbW9yeSB0byB0YWtlIGluIGNoYXJnZSBTSVogbWFya2VyCgBJbnZhbGlkIHZhbHVlcyBmb3IgY29tcCA9ICVkIDogZHg9JXUgZHk9JXUgKHNob3VsZCBiZSBiZXR3ZWVuIDEgYW5kIDI1NSBhY2NvcmRpbmcgdG8gdGhlIEpQRUcyMDAwIG5vcm0pCgBJbnZhbGlkIHZhbHVlcyBmb3IgY29tcCA9ICVkIDogcHJlYz0ldSAoc2hvdWxkIGJlIGJldHdlZW4gMSBhbmQgMzggYWNjb3JkaW5nIHRvIHRoZSBKUEVHMjAwMCBub3JtKQoASW52YWxpZCBudW1iZXIgb2YgdGlsZXMgOiAldSB4ICV1IChtYXhpbXVtIGZpeGVkIGJ5IGpwZWcyMDAwIG5vcm0gaXMgNjU1MzUgdGlsZXMpCgBFcnJvciByZWFkaW5nIFBPQyBtYXJrZXIKAFRvbyBtYW55IFBPQ3MgJWQKAEVycm9yIHJlYWRpbmcgUUNDIG1hcmtlcgoASW52YWxpZCBjb21wb25lbnQgbnVtYmVyOiAlZCwgcmVnYXJkaW5nIHRoZSBudW1iZXIgb2YgY29tcG9uZW50cyAlZAoARXJyb3IgcmVhZGluZyBTUWNkIG9yIFNRY2MgZWxlbWVudAoAV2hpbGUgcmVhZGluZyBDQ1BfUU5UU1RZIGVsZW1lbnQgaW5zaWRlIFFDRCBvciBRQ0MgbWFya2VyIHNlZ21lbnQsIG51bWJlciBvZiBzdWJiYW5kcyAoJWQpIGlzIGdyZWF0ZXIgdG8gT1BKX0oyS19NQVhCQU5EUyAoJWQpLiBTbyB3ZSBsaW1pdCB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIHN0b3JlZCB0byBPUEpfSjJLX01BWEJBTkRTICglZCkgYW5kIHNraXAgdGhlIHJlc3QuIAoARXJyb3IgcmVhZGluZyBRQ0QgbWFya2VyCgBFcnJvciByZWFkaW5nIFJHTiBtYXJrZXIKAGJhZCBjb21wb25lbnQgbnVtYmVyIGluIFJHTiAoJWQgd2hlbiB0aGVyZSBhcmUgb25seSAlZCkKAEVycm9yIHJlYWRpbmcgQ09DIG1hcmtlcgoARXJyb3IgcmVhZGluZyBDT0MgbWFya2VyIChiYWQgbnVtYmVyIG9mIGNvbXBvbmVudHMpCgBFcnJvciByZWFkaW5nIFNQQ29kIFNQQ29jIGVsZW1lbnQKAEludmFsaWQgdmFsdWUgZm9yIG51bXJlc29sdXRpb25zIDogJWQsIG1heCB2YWx1ZSBpcyBzZXQgaW4gb3BlbmpwZWcuaCBhdCAlZAoARXJyb3IgZGVjb2RpbmcgY29tcG9uZW50ICVkLgpUaGUgbnVtYmVyIG9mIHJlc29sdXRpb25zIHRvIHJlbW92ZSBpcyBoaWdoZXIgdGhhbiB0aGUgbnVtYmVyIG9mIHJlc29sdXRpb25zIG9mIHRoaXMgY29tcG9uZW50Ck1vZGlmeSB0aGUgY3BfcmVkdWNlIHBhcmFtZXRlci4KCgBFcnJvciByZWFkaW5nIFNQQ29kIFNQQ29jIGVsZW1lbnQsIEludmFsaWQgY2Jsa3cvY2Jsa2ggY29tYmluYXRpb24KAEVycm9yIHJlYWRpbmcgU1BDb2QgU1BDb2MgZWxlbWVudCwgSW52YWxpZCBjb2RlLWJsb2NrIHN0eWxlIGZvdW5kCgBJbnZhbGlkIHByZWNpbmN0IHNpemUKAENPRCBtYXJrZXIgYWxyZWFkeSByZWFkLiBObyBtb3JlIHRoYW4gb25lIENPRCBtYXJrZXIgcGVyIHRpbGUuCgBFcnJvciByZWFkaW5nIENPRCBtYXJrZXIKAFVua25vd24gU2NvZCB2YWx1ZSBpbiBDT0QgbWFya2VyCgBVbmtub3duIHByb2dyZXNzaW9uIG9yZGVyIGluIENPRCBtYXJrZXIKAEludmFsaWQgbnVtYmVyIG9mIGxheWVycyBpbiBDT0QgbWFya2VyIDogJWQgbm90IGluIHJhbmdlIFsxLTY1NTM1XQoARXJyb3IgcmVhZGluZyBTT1QgbWFya2VyCgBJbnZhbGlkIHRpbGUgbnVtYmVyICVkCgBFbXB0eSBTT1QgbWFya2VyIGRldGVjdGVkOiBQc290PSVkLgoAUHNvdCB2YWx1ZSBpcyBub3QgY29ycmVjdCByZWdhcmRzIHRvIHRoZSBKUEVHMjAwMCBub3JtOiAlZC4KAFBzb3QgdmFsdWUgb2YgdGhlIGN1cnJlbnQgdGlsZS1wYXJ0IGlzIGVxdWFsIHRvIHplcm8sIHdlIGFzc3VtaW5nIGl0IGlzIHRoZSBsYXN0IHRpbGUtcGFydCBvZiB0aGUgY29kZXN0cmVhbS4KAEluIFNPVCBtYXJrZXIsIFRQU290ICglZCkgaXMgbm90IHZhbGlkIHJlZ2FyZHMgdG8gdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHRpbGUtcGFydCAoJWQpLCBnaXZpbmcgdXAKAEluIFNPVCBtYXJrZXIsIFRQU290ICglZCkgaXMgbm90IHZhbGlkIHJlZ2FyZHMgdG8gdGhlIGN1cnJlbnQgbnVtYmVyIG9mIHRpbGUtcGFydCAoaGVhZGVyKSAoJWQpLCBnaXZpbmcgdXAKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIHJlYWQgU09UIG1hcmtlci4gVGlsZSBpbmRleCBhbGxvY2F0aW9uIGZhaWxlZAoASW5jb25zaXN0ZW50IG1hcmtlciBzaXplCgBNYXJrZXIgc2l6ZSBpbmNvbnNpc3RlbnQgd2l0aCBzdHJlYW0gbGVuZ3RoCgBOb3Qgc3VyZSBob3cgdGhhdCBoYXBwZW5lZC4KAEZhaWwgdG8gcmVhZCB0aGUgY3VycmVudCBtYXJrZXIgc2VnbWVudCAoJSN4KQoATm90IGVub3VnaCBtZW1vcnkgdG8gYWRkIHRsIG1hcmtlcgoAVGlsZSBwYXJ0IGxlbmd0aCBzaXplIGluY29uc2lzdGVudCB3aXRoIHN0cmVhbSBsZW5ndGgKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGRlY29kZSB0aWxlCgBvcGpfajJrX2FwcGx5X25iX3RpbGVfcGFydHNfY29ycmVjdGlvbiBlcnJvcgoATm9uIGNvbmZvcm1hbnQgY29kZXN0cmVhbSBUUHNvdD09VE5zb3QuCgBGYWlsZWQgdG8gbWVyZ2UgUFBUIGRhdGEKAEhlYWRlciBvZiB0aWxlICVkIC8gJWQgaGFzIGJlZW4gcmVhZC4KAEZhaWxlZCB0byBkZWNvZGUuCgBObyBFT0MgbWFya2VyLiBQb3NzaWJseSBhIHRydW5jYXRlZCBzdHJlYW0KAFN0cmVhbSBkb2VzIG5vdCBlbmQgd2l0aCBFT0MKAFN0cmVhbSB0b28gc2hvcnQsIGV4cGVjdGVkIFNPVAoATmVlZCB0byBkZWNvZGUgdGhlIG1haW4gaGVhZGVyIGJlZm9yZSBiZWdpbiB0byBkZWNvZGUgdGhlIHJlbWFpbmluZyBjb2Rlc3RyZWFtAE5vIGRlY29kZWQgYXJlYSBwYXJhbWV0ZXJzLCBzZXQgdGhlIGRlY29kZWQgYXJlYSB0byB0aGUgd2hvbGUgaW1hZ2UKAExlZnQgcG9zaXRpb24gb2YgdGhlIGRlY29kZWQgYXJlYSAocmVnaW9uX3gwPSVkKSBpcyBvdXRzaWRlIHRoZSBpbWFnZSBhcmVhIChYc2l6PSVkKS4KAExlZnQgcG9zaXRpb24gb2YgdGhlIGRlY29kZWQgYXJlYSAocmVnaW9uX3gwPSVkKSBpcyBvdXRzaWRlIHRoZSBpbWFnZSBhcmVhIChYT3Npej0lZCkuCgBVcCBwb3NpdGlvbiBvZiB0aGUgZGVjb2RlZCBhcmVhIChyZWdpb25feTA9JWQpIGlzIG91dHNpZGUgdGhlIGltYWdlIGFyZWEgKFlzaXo9JWQpLgoAVXAgcG9zaXRpb24gb2YgdGhlIGRlY29kZWQgYXJlYSAocmVnaW9uX3kwPSVkKSBpcyBvdXRzaWRlIHRoZSBpbWFnZSBhcmVhIChZT3Npej0lZCkuCgBSaWdodCBwb3NpdGlvbiBvZiB0aGUgZGVjb2RlZCBhcmVhIChyZWdpb25feDE9JWQpIGlzIG91dHNpZGUgdGhlIGltYWdlIGFyZWEgKFhPc2l6PSVkKS4KAFJpZ2h0IHBvc2l0aW9uIG9mIHRoZSBkZWNvZGVkIGFyZWEgKHJlZ2lvbl94MT0lZCkgaXMgb3V0c2lkZSB0aGUgaW1hZ2UgYXJlYSAoWHNpej0lZCkuCgBCb3R0b20gcG9zaXRpb24gb2YgdGhlIGRlY29kZWQgYXJlYSAocmVnaW9uX3kxPSVkKSBpcyBvdXRzaWRlIHRoZSBpbWFnZSBhcmVhIChZT3Npej0lZCkuCgBCb3R0b20gcG9zaXRpb24gb2YgdGhlIGRlY29kZWQgYXJlYSAocmVnaW9uX3kxPSVkKSBpcyBvdXRzaWRlIHRoZSBpbWFnZSBhcmVhIChZc2l6PSVkKS4KAFNpemUgeCBvZiB0aGUgZGVjb2RlZCBjb21wb25lbnQgaW1hZ2UgaXMgaW5jb3JyZWN0IChjb21wWyVkXS53PSVkKS4KAFNpemUgeSBvZiB0aGUgZGVjb2RlZCBjb21wb25lbnQgaW1hZ2UgaXMgaW5jb3JyZWN0IChjb21wWyVkXS5oPSVkKS4KAFNldHRpbmcgZGVjb2RpbmcgYXJlYSB0byAlZCwlZCwlZCwlZAoAV3JvbmcgZmxhZwoAQ29kZXN0cmVhbSBpbmZvIGZyb20gbWFpbiBoZWFkZXI6IHsKAAkgdHgwPSVkLCB0eTA9JWQKAAkgdGR4PSVkLCB0ZHk9JWQKAAkgdHc9JWQsIHRoPSVkCgB9CgBDb2Rlc3RyZWFtIGluZGV4IGZyb20gbWFpbiBoZWFkZXI6IHsKAAkgTWFpbiBoZWFkZXIgc3RhcnQgcG9zaXRpb249JWxsaQoJIE1haW4gaGVhZGVyIGVuZCBwb3NpdGlvbj0lbGxpCgAJIE1hcmtlciBsaXN0OiB7CgAJCSB0eXBlPSUjeCwgcG9zPSVsbGksIGxlbj0lZAoACSB9CgAJIFRpbGUgaW5kZXg6IHsKAAkJIG5iIG9mIHRpbGUtcGFydCBpbiB0aWxlIFslZF09JWQKAAkJCSB0aWxlLXBhcnRbJWRdOiBzdGFyX3Bvcz0lbGxpLCBlbmRfaGVhZGVyPSVsbGksIGVuZF9wb3M9JWxsaS4KAAkgZGVmYXVsdCB0aWxlIHsKAAkJIGNzdHk9JSN4CgAJCSBwcmc9JSN4CgAJCSBudW1sYXllcnM9JWQKAAkJIG1jdD0leAoACQkgY29tcCAlZCB7CgAJCQkgY3N0eT0lI3gKAAkJCSBudW1yZXNvbHV0aW9ucz0lZAoACQkJIGNibGt3PTJeJWQKAAkJCSBjYmxraD0yXiVkCgAJCQkgY2Jsa3N0eT0lI3gKAAkJCSBxbWZiaWQ9JWQKAAkJCSBwcmVjY2ludHNpemUgKHcsaCk9ACglZCwlZCkgAAkJCSBxbnRzdHk9JWQKAAkJCSBudW1nYml0cz0lZAoACQkJIHN0ZXBzaXplcyAobSxlKT0ACQkJIHJvaXNoaWZ0PSVkCgAJCSB9CgBbREVWXSBEdW1wIGFuIGltYWdlX2hlYWRlciBzdHJ1Y3QgewoASW1hZ2UgaW5mbyB7CgAlcyB4MD0lZCwgeTA9JWQKACVzIHgxPSVkLCB5MT0lZAoAJXMgbnVtY29tcHM9JWQKACVzCSBjb21wb25lbnQgJWQgewoAJXN9CgBbREVWXSBEdW1wIGFuIGltYWdlX2NvbXBfaGVhZGVyIHN0cnVjdCB7CgAlcyBkeD0lZCwgZHk9JWQKACVzIHByZWM9JWQKACVzIHNnbmQ9JWQKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGRlY29kZSB0aWxlcwoATm90IGVub3VnaCBtZW1vcnkgdG8gZGVjb2RlIHRpbGUgJWQvJWQKAEZhaWxlZCB0byBkZWNvZGUgdGlsZSAlZC8lZAoAVGlsZSAlZC8lZCBoYXMgYmVlbiBkZWNvZGVkLgoASW1hZ2UgZGF0YSBoYXMgYmVlbiB1cGRhdGVkIHdpdGggdGlsZSAlZC4KCgBXZSBuZWVkIGFuIGltYWdlIHByZXZpb3VzbHkgY3JlYXRlZC4KAFRpbGUgaW5kZXggcHJvdmlkZWQgYnkgdGhlIHVzZXIgaXMgaW5jb3JyZWN0ICVkIChtYXggPSAlZCkgCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBkZWNvZGUgb25lIHRpbGUKAFByb2JsZW0gd2l0aCBzZWVrIGZ1bmN0aW9uCgBUaWxlIHJlYWQsIGRlY29kZWQgYW5kIHVwZGF0ZWQgaXMgbm90IHRoZSBkZXNpcmVkIG9uZSAoJWQgdnMgJWQpLgoAUmVzb2x1dGlvbiBmYWN0b3IgaXMgZ3JlYXRlciB0aGFuIHRoZSBtYXhpbXVtIHJlc29sdXRpb24gaW4gdGhlIGNvbXBvbmVudC4KAFRoZSBnaXZlbiB0aWxlIGluZGV4IGRvZXMgbm90IG1hdGNoLgB0aWxlIG51bWJlciAlZCAvICVkCgBFcnJvciBhbGxvY2F0aW5nIHRpbGUgY29tcG9uZW50IGRhdGEuAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGVuY29kZSBhbGwgdGlsZXMKAFNpemUgbWlzbWF0Y2ggYmV0d2VlbiB0aWxlIGRhdGEgYW5kIHNlbnQgZGF0YS4AQ2Fubm90IGVuY29kZSB0aWxlCgBGYWlsZWQgdG8gYWxsb2NhdGUgaW1hZ2UgaGVhZGVyLgBOb3QgZW5vdWdoIG1lbW9yeSB0byBjcmVhdGUgVGlsZSBDb2RlcgoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgQ0JEIG1hcmtlcgoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgTUNUIG1hcmtlcgoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgTUNDIG1hcmtlcgoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgTUNPIG1hcmtlcgoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgdGhlIENPTSBtYXJrZXIKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIHdyaXRlIFBPQyBtYXJrZXIKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIHdyaXRlIFRMTSBtYXJrZXIKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIHdyaXRlIFFDQyBtYXJrZXIKAEVycm9yIHdyaXRpbmcgU1FjZCBTUWNjIGVsZW1lbnQKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIHdyaXRlIENPQyBtYXJrZXIKAEVycm9yIHdyaXRpbmcgU1BDb2QgU1BDb2MgZWxlbWVudAoATm90IGVub3VnaCBtZW1vcnkgdG8gd3JpdGUgUUNEIG1hcmtlcgoARXJyb3Igd3JpdGluZyBRQ0QgbWFya2VyCgBOb3QgZW5vdWdoIG1lbW9yeSB0byB3cml0ZSBDT0QgbWFya2VyCgBFcnJvciB3cml0aW5nIENPRCBtYXJrZXIKAE5vdCBlbm91Z2ggbWVtb3J5IGZvciB0aGUgU0laIG1hcmtlcgoATnVtYmVyIG9mIHJlc29sdXRpb25zIGlzIHRvbyBoaWdoIGluIGNvbXBhcmlzb24gdG8gdGhlIHNpemUgb2YgdGlsZXMKAEVycm9yIHdoaWxlIG9wal9qMmtfcHJlX3dyaXRlX3RpbGUgd2l0aCB0aWxlIGluZGV4ID0gJWQKAEVycm9yIHdoaWxlIG9wal9qMmtfcG9zdF93cml0ZV90aWxlIHdpdGggdGlsZSBpbmRleCA9ICVkCgBGYWlsZWQgdG8gZGVjb2RlIHRoZSBjb2Rlc3RyZWFtIGluIHRoZSBKUDIgZmlsZQoAb3BqX2pwMl9hcHBseV9jZGVmOiBjbj0lZCwgbnVtY29tcHM9JWQKAG9wal9qcDJfYXBwbHlfY2RlZjogYWNuPSVkLCBudW1jb21wcz0lZAoASW52YWxpZCBjb21wb25lbnQgaW5kZXggJWQgKD49ICVkKS4KAEluY29tcGxldGUgY2hhbm5lbCBkZWZpbml0aW9ucy4KAFVuZXhwZWN0ZWQgT09NLgoASW52YWxpZCBjb21wb25lbnQvcGFsZXR0ZSBpbmRleCBmb3IgZGlyZWN0IG1hcHBpbmcgJWQuCgBDb21wb25lbnQgJWQgaXMgbWFwcGVkIHR3aWNlLgoARGlyZWN0IHVzZSBhdCAjJWQgaG93ZXZlciBwY29sPSVkLgoAQ29tcG9uZW50ICVkIGRvZXNuJ3QgaGF2ZSBhIG1hcHBpbmcuCgBDb21wb25lbnQgbWFwcGluZyBzZWVtcyB3cm9uZy4gVHJ5aW5nIHRvIGNvcnJlY3QuCgBJbnZhbGlkIG51bWJlciBvZiBjb21wb25lbnRzIHNwZWNpZmllZCB3aGlsZSBzZXR0aW5nIHVwIEpQMiBlbmNvZGVyCgBOb3QgZW5vdWdoIG1lbW9yeSB3aGVuIHNldHVwIHRoZSBKUDIgZW5jb2RlcgoAQWxwaGEgY2hhbm5lbCBzcGVjaWZpZWQgYnV0IHVua25vd24gZW51bWNzLiBObyBjZGVmIGJveCB3aWxsIGJlIGNyZWF0ZWQuCgBBbHBoYSBjaGFubmVsIHNwZWNpZmllZCBidXQgbm90IGVub3VnaCBpbWFnZSBjb21wb25lbnRzIGZvciBhbiBhdXRvbWF0aWMgY2RlZiBib3ggY3JlYXRpb24uCgBBbHBoYSBjaGFubmVsIHBvc2l0aW9uIGNvbmZsaWN0cyB3aXRoIGNvbG9yIGNoYW5uZWwuIE5vIGNkZWYgYm94IHdpbGwgYmUgY3JlYXRlZC4KAE11bHRpcGxlIGFscGhhIGNoYW5uZWxzIHNwZWNpZmllZC4gTm8gY2RlZiBib3ggd2lsbCBiZSBjcmVhdGVkLgoATm90IGVub3VnaCBtZW1vcnkgdG8gc2V0dXAgdGhlIEpQMiBlbmNvZGVyCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBoYW5kbGUganBlZzIwMDAgZmlsZSBoZWFkZXIKAENhbm5vdCBoYW5kbGUgYm94IHNpemVzIGhpZ2hlciB0aGFuIDJeMzIKAGJhZCBwbGFjZWQganBlZyBjb2Rlc3RyZWFtCgBDYW5ub3QgaGFuZGxlIGJveCBvZiB1bmRlZmluZWQgc2l6ZXMKAGludmFsaWQgYm94IHNpemUgJWQgKCV4KQoARm91bmQgYSBtaXNwbGFjZWQgJyVjJWMlYyVjJyBib3ggb3V0c2lkZSBqcDJoIGJveAoASlBFRzIwMDAgSGVhZGVyIGJveCBub3QgcmVhZCB5ZXQsICclYyVjJWMlYycgYm94IHdpbGwgYmUgaWdub3JlZAoAUHJvYmxlbSB3aXRoIHNraXBwaW5nIEpQRUcyMDAwIGJveCwgc3RyZWFtIGVycm9yCgBJbnZhbGlkIGJveCBzaXplICVkIGZvciBib3ggJyVjJWMlYyVjJy4gTmVlZCAlZCBieXRlcywgJWQgYnl0ZXMgcmVtYWluaW5nIAoATm90IGVub3VnaCBtZW1vcnkgdG8gaGFuZGxlIGpwZWcyMDAwIGJveAoAUHJvYmxlbSB3aXRoIHJlYWRpbmcgSlBFRzIwMDAgYm94LCBzdHJlYW0gZXJyb3IKAE1hbGZvcm1lZCBKUDIgZmlsZSBmb3JtYXQ6IGZpcnN0IGJveCBtdXN0IGJlIEpQRUcgMjAwMCBzaWduYXR1cmUgYm94CgBNYWxmb3JtZWQgSlAyIGZpbGUgZm9ybWF0OiBzZWNvbmQgYm94IG11c3QgYmUgZmlsZSB0eXBlIGJveAoASW5zdWZmaWNpZW50IGRhdGEgZm9yIENERUYgYm94LgoATnVtYmVyIG9mIGNoYW5uZWwgZGVzY3JpcHRpb24gaXMgZXF1YWwgdG8gemVybyBpbiBDREVGIGJveC4KAE5lZWQgdG8gcmVhZCBhIFBDTFIgYm94IGJlZm9yZSB0aGUgQ01BUCBib3guCgBPbmx5IG9uZSBDTUFQIGJveCBpcyBhbGxvd2VkLgoASW5zdWZmaWNpZW50IGRhdGEgZm9yIENNQVAgYm94LgoASW52YWxpZCBQQ0xSIGJveC4gUmVwb3J0cyAlZCBlbnRyaWVzCgBJbnZhbGlkIFBDTFIgYm94LiBSZXBvcnRzIDAgcGFsZXR0ZSBjb2x1bW5zCgBBIEJQQ0MgaGVhZGVyIGJveCBpcyBhdmFpbGFibGUgYWx0aG91Z2ggQlBDIGdpdmVuIGJ5IHRoZSBJSERSIGJveCAoJWQpIGluZGljYXRlIGNvbXBvbmVudHMgYml0IGRlcHRoIGlzIGNvbnN0YW50CgBCYWQgQlBDQyBoZWFkZXIgYm94IChiYWQgc2l6ZSkKAEJhZCBDT0xSIGhlYWRlciBib3ggKGJhZCBzaXplKQoAQSBjb25mb3JtaW5nIEpQMiByZWFkZXIgc2hhbGwgaWdub3JlIGFsbCBDb2xvdXIgU3BlY2lmaWNhdGlvbiBib3hlcyBhZnRlciB0aGUgZmlyc3QsIHNvIHdlIGlnbm9yZSB0aGlzIG9uZS4KAEJhZCBDT0xSIGhlYWRlciBib3ggKGJhZCBzaXplOiAlZCkKAE5vdCBlbm91Z2ggbWVtb3J5IGZvciBjaWVsYWIKAEJhZCBDT0xSIGhlYWRlciBib3ggKENJRUxhYiwgYmFkIHNpemU6ICVkKQoAQ09MUiBCT1ggbWV0aCB2YWx1ZSBpcyBub3QgYSByZWd1bGFyIHZhbHVlICglZCksIHNvIHdlIHdpbGwgaWdub3JlIHRoZSBlbnRpcmUgQ29sb3VyIFNwZWNpZmljYXRpb24gYm94LiAKAElnbm9yaW5nIGloZHIgYm94LiBGaXJzdCBpaGRyIGJveCBhbHJlYWR5IHJlYWQKAEJhZCBpbWFnZSBoZWFkZXIgYm94IChiYWQgc2l6ZSkKAEludmFsaWQgbnVtYmVyIG9mIGNvbXBvbmVudHMgKGloZHIpCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBoYW5kbGUgaW1hZ2UgaGVhZGVyIChpaGRyKQoASlAyIElIRFIgYm94OiBjb21wcmVzc2lvbiB0eXBlIGluZGljYXRlIHRoYXQgdGhlIGZpbGUgaXMgbm90IGEgY29uZm9ybWluZyBKUDIgZmlsZSAoJWQpIAoAVGhlICBib3ggbXVzdCBiZSB0aGUgZmlyc3QgYm94IGluIHRoZSBmaWxlLgoAQ2Fubm90IGhhbmRsZSBib3ggb2YgbGVzcyB0aGFuIDggYnl0ZXMKAENhbm5vdCBoYW5kbGUgWEwgYm94IG9mIGxlc3MgdGhhbiAxNiBieXRlcwoAQm94IGxlbmd0aCBpcyBpbmNvbnNpc3RlbnQuCgBTdHJlYW0gZXJyb3Igd2hpbGUgcmVhZGluZyBKUDIgSGVhZGVyIGJveAoAU3RyZWFtIGVycm9yIHdoaWxlIHJlYWRpbmcgSlAyIEhlYWRlciBib3g6IGJveCBsZW5ndGggaXMgaW5jb25zaXN0ZW50LgoAU3RyZWFtIGVycm9yIHdoaWxlIHJlYWRpbmcgSlAyIEhlYWRlciBib3g6IG5vICdpaGRyJyBib3guCgBUaGUgZnR5cCBib3ggbXVzdCBiZSB0aGUgc2Vjb25kIGJveCBpbiB0aGUgZmlsZS4KAEVycm9yIHdpdGggRlRZUCBzaWduYXR1cmUgQm94IHNpemUKAE5vdCBlbm91Z2ggbWVtb3J5IHdpdGggRlRZUCBCb3gKAFRoZSBzaWduYXR1cmUgYm94IG11c3QgYmUgdGhlIGZpcnN0IGJveCBpbiB0aGUgZmlsZS4KAEVycm9yIHdpdGggSlAgc2lnbmF0dXJlIEJveCBzaXplCgBFcnJvciB3aXRoIEpQIFNpZ25hdHVyZSA6IGJhZCBtYWdpYyBudW1iZXIKAEZhaWxlZCB0byBzZWVrIGluIHRoZSBzdHJlYW0uCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBob2xkIEpQMiBIZWFkZXIgZGF0YQoAU3RyZWFtIGVycm9yIHdoaWxlIHdyaXRpbmcgSlAyIEhlYWRlciBib3gKAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGhhbmRsZSBmdHlwIGRhdGEKAEVycm9yIHdoaWxlIHdyaXRpbmcgZnR5cCBkYXRhIHRvIHN0cmVhbQoASlAyIGJveCB3aGljaCBhcmUgYWZ0ZXIgdGhlIGNvZGVzdHJlYW0gd2lsbCBub3QgYmUgcmVhZCBieSB0aGlzIGZ1bmN0aW9uLgoAVGlsZSBYIGNvb3JkaW5hdGVzIGFyZSBub3Qgc3VwcG9ydGVkCgBUaWxlIFkgY29vcmRpbmF0ZXMgYXJlIG5vdCBzdXBwb3J0ZWQKAHRpbGVzIHJlcXVpcmUgYXQgbGVhc3Qgb25lIHJlc29sdXRpb24KAE5vdCBlbm91Z2ggbWVtb3J5IGZvciB0aWxlIGRhdGEKAE5vdCBlbm91Z2ggbWVtb3J5IGZvciB0aWxlIHJlc29sdXRpb25zCgBOb3QgZW5vdWdoIG1lbW9yeSB0byBoYW5kbGUgYmFuZCBwcmVjaW50cwoATm90IGVub3VnaCBtZW1vcnkgZm9yIGN1cnJlbnQgcHJlY2luY3QgY29kZWJsb2NrIGVsZW1lbnQKAE5vIGluY2x0cmVlIGNyZWF0ZWQuCgBObyBpbXNidHJlZSBjcmVhdGVkLgoAVGlsZXMgZG9uJ3QgYWxsIGhhdmUgdGhlIHNhbWUgZGltZW5zaW9uLiBTa2lwIHRoZSBNQ1Qgc3RlcC4KAE51bWJlciBvZiBjb21wb25lbnRzICglZCkgaXMgaW5jb25zaXN0ZW50IHdpdGggYSBNQ1QuIFNraXAgdGhlIE1DVCBzdGVwLgoATm90IGVub3VnaCBtZW1vcnkgdG8gY3JlYXRlIFRhZy10cmVlCgB0Z3RfY3JlYXRlIHRyZWUtPm51bW5vZGVzID09IDAsIG5vIHRyZWUgY3JlYXRlZC4KAE5vdCBlbm91Z2ggbWVtb3J5IHRvIGNyZWF0ZSBUYWctdHJlZSBub2RlcwoATm90IGVub3VnaCBtZW1vcnkgdG8gcmVpbml0aWFsaXplIHRoZSB0YWcgdHJlZQoATm90IGVub3VnaCBtZW1vcnkgdG8gYWRkIGEgbmV3IHZhbGlkYXRpb24gcHJvY2VkdXJlCgAAAQECAQICAgECAgICAgICAwMDAwMDAwMDAwMDAwMDAwUGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHAwMDAwMDAwMDAwMDAwMDAwQEBAQEBAQEBAQEBAQEBAQHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwUGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAAEBAgECAgIBAgICAgICAgUGBgYGBgYGBgYGBgYGBgYDAwMDAwMDAwMDAwMDAwMDBwcHBwcHBwcHBwcHBwcHBwUGBgYGBgYGBgYGBgYGBgYICAgICAgICAgICAgICAgIBwcHBwcHBwcHBwcHBwcHBwgICAgICAgICAgICAgICAgDAwMDAwMDAwMDAwMDAwMDBwcHBwcHBwcHBwcHBwcHBwQEBAQEBAQEBAQEBAQEBAQHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwgICAgICAgICAgICAgICAgHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAABAQIBAgICAQICAgICAgIDAwMDAwMDAwMDAwMDAwMDBQYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBQYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgAAwMGAwYGCAMGBggGCAgIAQQEBwQHBwgEBwcIBwgICAEEBAcEBwcIBAcHCAcICAgCBQUHBQcHCAUHBwgHCAgIAQQEBwQHBwgEBwcIBwgICAIFBQcFBwcIBQcHCAcICAgCBQUHBQcHCAUHBwgHCAgIAgUFBwUHBwgFBwcIBwgICAEEBAcEBwcIBAcHCAcICAgCBQUHBQcHCAUHBwgHCAgIAgUFBwUHBwgFBwcIBwgICAIFBQcFBwcIBQcHCAcICAgCBQUHBQcHCAUHBwgHCAgIAgUFBwUHBwgFBwcIBwgICAIFBQcFBwcIBQcHCAcICAgCBQUHBQcHCAUHBwgHCAgICQoMDQoKDQ0MDQwNDQ0NDQkKDAsKCQ0MDAsMCw0MDQwJCgwLCgoLCwwNCQoNDQoKCQoMDQoJCwwMCwkKDQwKCQkKDA0KCQsMDA0MDQsMCwwJCgwLCgoLCwwLDAsLCwsLCQoMCwoJDQwMDQkKCwwKCQkKDA0KCg0NDAsJCgsLCgoJCgwNCgoNDQwLCQoLCwoKCQoMCwoJDQwMDQkKCwwKCQkKDAsKCgsLDAsMCwsLCwsJCgwNCgkLDAwNDA0LDAsMCQoMDQoJCwwMCwkKDQwKCQkKDAsKCgsLDA0JCg0NCgoJCgwLCgkNDAwLDAsNDA0MCQoMDQoKDQ0MDQwNDQ0NDQAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAQAAAQEAAAAAAAAAAAABAQEAAAEBAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAAAAAEAAAEBAAAAAAAAAAAAAAAAAQEBAAEBAAAAAAAAAQAAAQEBAQEBAQAAAAEAAAEBAAAAAAAAAAABAQAAAQEAAAABAAAAAAAAAQEAAQEBAAAAAAEBAAABAQEBAQEBAQEBAAEBAQAAAQEBAQEBAQEBAQAAAAABAAAAAQEAAAEBAQAAAQAAAQEAAAEBAAEBAQEBAAABAQEAAQEBAQEBAQEBAQABAQEBAQEBAQEBAQEBAQFyZWFkOiBzZWdtZW50IHRvbyBsb25nICglZCkgd2l0aCBtYXggKCVkKSBmb3IgY29kZWJsb2NrICVkIChwPSVkLCBiPSVkLCByPSVkLCBjPSVkKQoAcmVhZDogc2VnbWVudCB0b28gbG9uZyAoJWQpIHdpdGggY3VycmVudCBzaXplICglZCA+ICVkKSBmb3IgY29kZWJsb2NrICVkIChwPSVkLCBiPSVkLCByPSVkLCBjPSVkKQoAc2tpcDogc2VnbWVudCB0b28gbG9uZyAoJWQpIHdpdGggbWF4ICglZCkgZm9yIGNvZGVibG9jayAlZCAocD0lZCwgYj0lZCwgcj0lZCwgYz0lZCkKAEludmFsaWQgcHJlY2luY3QKAE5vdCBlbm91Z2ggc3BhY2UgZm9yIGV4cGVjdGVkIFNPUCBtYXJrZXIKAEV4cGVjdGVkIFNPUCBtYXJrZXIKAE5vdCBlbm91Z2ggc3BhY2UgZm9yIGV4cGVjdGVkIEVQSCBtYXJrZXIKAEV4cGVjdGVkIEVQSCBtYXJrZXIKAHJ3YQARAAoAERERAAAAAAUAAAAAAAAJAAAAAAsAAAAAAAAAABEADwoREREDCgcAARMJCwsAAAkGCwAACwAGEQAAABEREQAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAARAAoKERERAAoAAAIACQsAAAAJAAsAAAsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAMAAAAAAkMAAAAAAAMAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAA0AAAAEDQAAAAAJDgAAAAAADgAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAPAAAAAA8AAAAACRAAAAAAABAAABAAABIAAAASEhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAABISEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAoAAAAACgAAAAAJCwAAAAAACwAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAwAAAAACQwAAAAAAAwAAAwAAC0rICAgMFgweAAobnVsbCkALTBYKzBYIDBYLTB4KzB4IDB4AGluZgBJTkYAbmFuAE5BTgAwMTIzNDU2Nzg5QUJDREVGLgBUISIZDQECAxFLHAwQBAsdEh4naG5vcHFiIAUGDxMUFRoIFgcoJBcYCQoOGx8lI4OCfSYqKzw9Pj9DR0pNWFlaW1xdXl9gYWNkZWZnaWprbHJzdHl6e3wASWxsZWdhbCBieXRlIHNlcXVlbmNlAERvbWFpbiBlcnJvcgBSZXN1bHQgbm90IHJlcHJlc2VudGFibGUATm90IGEgdHR5AFBlcm1pc3Npb24gZGVuaWVkAE9wZXJhdGlvbiBub3QgcGVybWl0dGVkAE5vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnkATm8gc3VjaCBwcm9jZXNzAEZpbGUgZXhpc3RzAFZhbHVlIHRvbyBsYXJnZSBmb3IgZGF0YSB0eXBlAE5vIHNwYWNlIGxlZnQgb24gZGV2aWNlAE91dCBvZiBtZW1vcnkAUmVzb3VyY2UgYnVzeQBJbnRlcnJ1cHRlZCBzeXN0ZW0gY2FsbABSZXNvdXJjZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZQBJbnZhbGlkIHNlZWsAQ3Jvc3MtZGV2aWNlIGxpbmsAUmVhZC1vbmx5IGZpbGUgc3lzdGVtAERpcmVjdG9yeSBub3QgZW1wdHkAQ29ubmVjdGlvbiByZXNldCBieSBwZWVyAE9wZXJhdGlvbiB0aW1lZCBvdXQAQ29ubmVjdGlvbiByZWZ1c2VkAEhvc3QgaXMgZG93bgBIb3N0IGlzIHVucmVhY2hhYmxlAEFkZHJlc3MgaW4gdXNlAEJyb2tlbiBwaXBlAEkvTyBlcnJvcgBObyBzdWNoIGRldmljZSBvciBhZGRyZXNzAEJsb2NrIGRldmljZSByZXF1aXJlZABObyBzdWNoIGRldmljZQBOb3QgYSBkaXJlY3RvcnkASXMgYSBkaXJlY3RvcnkAVGV4dCBmaWxlIGJ1c3kARXhlYyBmb3JtYXQgZXJyb3IASW52YWxpZCBhcmd1bWVudABBcmd1bWVudCBsaXN0IHRvbyBsb25nAFN5bWJvbGljIGxpbmsgbG9vcABGaWxlbmFtZSB0b28gbG9uZwBUb28gbWFueSBvcGVuIGZpbGVzIGluIHN5c3RlbQBObyBmaWxlIGRlc2NyaXB0b3JzIGF2YWlsYWJsZQBCYWQgZmlsZSBkZXNjcmlwdG9yAE5vIGNoaWxkIHByb2Nlc3MAQmFkIGFkZHJlc3MARmlsZSB0b28gbGFyZ2UAVG9vIG1hbnkgbGlua3MATm8gbG9ja3MgYXZhaWxhYmxlAFJlc291cmNlIGRlYWRsb2NrIHdvdWxkIG9jY3VyAFN0YXRlIG5vdCByZWNvdmVyYWJsZQBQcmV2aW91cyBvd25lciBkaWVkAE9wZXJhdGlvbiBjYW5jZWxlZABGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQATm8gbWVzc2FnZSBvZiBkZXNpcmVkIHR5cGUASWRlbnRpZmllciByZW1vdmVkAERldmljZSBub3QgYSBzdHJlYW0ATm8gZGF0YSBhdmFpbGFibGUARGV2aWNlIHRpbWVvdXQAT3V0IG9mIHN0cmVhbXMgcmVzb3VyY2VzAExpbmsgaGFzIGJlZW4gc2V2ZXJlZABQcm90b2NvbCBlcnJvcgBCYWQgbWVzc2FnZQBGaWxlIGRlc2NyaXB0b3IgaW4gYmFkIHN0YXRlAE5vdCBhIHNvY2tldABEZXN0aW5hdGlvbiBhZGRyZXNzIHJlcXVpcmVkAE1lc3NhZ2UgdG9vIGxhcmdlAFByb3RvY29sIHdyb25nIHR5cGUgZm9yIHNvY2tldABQcm90b2NvbCBub3QgYXZhaWxhYmxlAFByb3RvY29sIG5vdCBzdXBwb3J0ZWQAU29ja2V0IHR5cGUgbm90IHN1cHBvcnRlZABOb3Qgc3VwcG9ydGVkAFByb3RvY29sIGZhbWlseSBub3Qgc3VwcG9ydGVkAEFkZHJlc3MgZmFtaWx5IG5vdCBzdXBwb3J0ZWQgYnkgcHJvdG9jb2wAQWRkcmVzcyBub3QgYXZhaWxhYmxlAE5ldHdvcmsgaXMgZG93bgBOZXR3b3JrIHVucmVhY2hhYmxlAENvbm5lY3Rpb24gcmVzZXQgYnkgbmV0d29yawBDb25uZWN0aW9uIGFib3J0ZWQATm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZQBTb2NrZXQgaXMgY29ubmVjdGVkAFNvY2tldCBub3QgY29ubmVjdGVkAENhbm5vdCBzZW5kIGFmdGVyIHNvY2tldCBzaHV0ZG93bgBPcGVyYXRpb24gYWxyZWFkeSBpbiBwcm9ncmVzcwBPcGVyYXRpb24gaW4gcHJvZ3Jlc3MAU3RhbGUgZmlsZSBoYW5kbGUAUmVtb3RlIEkvTyBlcnJvcgBRdW90YSBleGNlZWRlZABObyBtZWRpdW0gZm91bmQAV3JvbmcgbWVkaXVtIHR5cGUATm8gZXJyb3IgaW5mb3JtYXRpb24=";var _t=L;L+=16;var gt={varargs:0,get:function(t){return gt.varargs+=4,P[gt.varargs-4>>2]},getStr:function(){return S(gt.get())},get64:function(){var t=gt.get(),e=gt.get();return y(t>=0?0===e:-1===e),t},getZero:function(){y(0===gt.get())}};function yt(t,e){gt.varargs=e;try{var i=gt.get(),n=gt.get(),r=gt.get(),a=0;yt.buffers||(yt.buffers=[null,[],[]],yt.printChar=function(t,e){var i=yt.buffers[t];y(i),0===e||10===e?((1===t?o.print:o.printErr)(E(i,0)),i.length=0):i.push(e)});for(var s=0;s<r;s++){for(var l=P[n+8*s>>2],c=P[n+(8*s+4)>>2],h=0;h<c;h++)yt.printChar(i,C[l+h]);a+=c}return a}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}}var bt=function(t,e,i,n){var r,o;"number"==typeof t?(r=!0,o=t):(r=!1,o=t.length);var a,s="string"==typeof e?e:null;if(a=i==A?n:["function"==typeof Pt?Pt:p,Rt,p,function(t){y(N);var e=P[N>>2],i=e+t+15&-16;return P[N>>2]=i,i>=X&&!Z()?(P[N>>2]=e,0):e}][void 0===i?x:i](Math.max(o,s?1:e.length)),r){var l;for(n=a,y(0==(3&a)),l=a+(-4&o);n<l;n+=4)P[n>>2]=0;for(l=a+o;n<l;)k[n++>>0]=0;return a}if("i8"===s)return t.subarray||t.slice?C.set(t,a):C.set(new Uint8Array(t),a),a;for(var c,h,u,d=0;d<o;){var f=t[d];0!==(c=s||e[d])?("i64"==c&&(c="i32"),w(a+d,f,c),u!==c&&(h=_(c),u=c),d+=h):d++}return a}([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",x);var vt=at,wt=st,xt=st,At=lt;N=p(4),G=m(F=(O=m(L))+Y),P[N>>2]=G,D=!0;var St=!1;function Mt(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];n>255&&(St&&y(!1,"Character code "+n+" ("+String.fromCharCode(n)+")  at offset "+i+" not in 0x00-0xFF."),n&=255),e.push(String.fromCharCode(n))}return e.join("")}var Et="function"==typeof atob?atob:function(t){var e,i,n,r,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=s.indexOf(t.charAt(c++))<<2|(r=s.indexOf(t.charAt(c++)))>>4,i=(15&r)<<4|(o=s.indexOf(t.charAt(c++)))>>2,n=(3&o)<<6|(a=s.indexOf(t.charAt(c++))),l+=String.fromCharCode(e),64!==o&&(l+=String.fromCharCode(i)),64!==a&&(l+=String.fromCharCode(n))}while(c<t.length);return l};function Tt(t){if(mt(t))return function(t){if("boolean"==typeof u&&u){var e;try{e=n.from(t,"base64")}catch(i){e=new n(t,"base64")}return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}try{for(var i=Et(t),r=new Uint8Array(i.length),o=0;o<i.length;++o)r[o]=i.charCodeAt(o);return r}catch(t){throw new Error("Converting base64 string to bytes failed.")}}(t.slice(pt.length))}o.asmGlobalArg={Math:Math,Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0,byteLength:z},o.asmLibraryArg={abort:Ht,assert:y,enlargeMemory:Z,getTotalMemory:function(){return X},abortOnCannotGrowMemory:function(){Ht("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+X+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or (4) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")},invoke_di:function(t,e){try{return o.dynCall_di(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_ii:function(t,e){try{return o.dynCall_ii(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iii:function(t,e,i){try{return o.dynCall_iii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiii:function(t,e,i,n){try{return o.dynCall_iiii(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiiii:function(t,e,i,n,r){try{return o.dynCall_iiiii(t,e,i,n,r)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiiiii:function(t,e,i,n,r,a){try{return o.dynCall_iiiiii(t,e,i,n,r,a)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiiiiii:function(t,e,i,n,r,a,s){try{return o.dynCall_iiiiiii(t,e,i,n,r,a,s)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiiiiiii:function(t,e,i,n,r,a,s,l){try{return o.dynCall_iiiiiiii(t,e,i,n,r,a,s,l)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_iiiiiiiiiiii:function(t,e,i,n,r,a,s,l,c,h,u,d){try{return o.dynCall_iiiiiiiiiiii(t,e,i,n,r,a,s,l,c,h,u,d)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_vi:function(t,e){try{o.dynCall_vi(t,e)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_vii:function(t,e,i){try{o.dynCall_vii(t,e,i)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_viii:function(t,e,i,n){try{o.dynCall_viii(t,e,i,n)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},invoke_viiii:function(t,e,i,n,r){try{o.dynCall_viiii(t,e,i,n,r)}catch(t){if("number"!=typeof t&&"longjmp"!==t)throw t;o.setThrew(1,0)}},___lock:function(){},___setErrNo:function(t){return o.___errno_location&&(P[o.___errno_location()>>2]=t),t},___syscall140:function(t,e){gt.varargs=e;try{var i=gt.getStreamFromFD(),n=(gt.get(),gt.get()),r=gt.get(),o=gt.get(),a=n;return FS.llseek(i,a,o),P[r>>2]=i.position,i.getdents&&0===a&&0===o&&(i.getdents=null),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___syscall145:function(t,e){gt.varargs=e;try{var i=gt.getStreamFromFD(),n=gt.get(),r=gt.get();return gt.doReadv(i,n,r)}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___syscall146:yt,___syscall221:function(t,e){gt.varargs=e;try{return 0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___syscall5:function(t,e){gt.varargs=e;try{var i=gt.getStr(),n=gt.get(),r=gt.get();return FS.open(i,n,r).fd}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___syscall54:function(t,e){gt.varargs=e;try{return 0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___syscall6:function(t,e){gt.varargs=e;try{var i=gt.getStreamFromFD();return FS.close(i),0}catch(t){return"undefined"!=typeof FS&&t instanceof FS.ErrnoError||Ht(t),-t.errno}},___unlock:function(){},_emscripten_memcpy_big:function(t,e,i){return C.set(C.subarray(e,e+i),t),t},_llvm_ceil_f32:vt,_llvm_floor_f32:wt,_llvm_floor_f64:xt,_llvm_pow_f64:At,flush_NO_FILESYSTEM:function(){var t=o._fflush;t&&t(0);var e=yt.printChar;if(e){var i=yt.buffers;i[1].length&&e(1,10),i[2].length&&e(2,10)}},DYNAMICTOP_PTR:N,tempDoublePtr:_t,ABORT:g,STACKTOP:O,STACK_MAX:F,cttz_i8:bt};var kt,Ct=function(t,e,i){"almost asm";var n=t.Int8Array,r=new n(i),o=t.Int16Array,a=new o(i),s=t.Int32Array,l=new s(i),c=t.Uint8Array,h=new c(i),u=t.Uint16Array,d=new u(i),f=t.Uint32Array,p=(new f(i),t.Float32Array),m=new p(i),_=t.Float64Array,g=new _(i),y=t.byteLength,b=0|e.DYNAMICTOP_PTR,v=0|e.tempDoublePtr,w=(e.ABORT,0|e.STACKTOP),x=(e.STACK_MAX,0|e.cttz_i8),A=0,S=(t.NaN,t.Infinity,0),M=t.Math.floor,E=(t.Math.abs,t.Math.sqrt),T=t.Math.pow,k=(t.Math.cos,t.Math.sin,t.Math.tan,t.Math.acos,t.Math.asin,t.Math.atan,t.Math.atan2,t.Math.exp,t.Math.log,t.Math.ceil),C=t.Math.imul,I=(t.Math.min,t.Math.max,t.Math.clz32),P=e.abort,R=(e.assert,e.enlargeMemory),B=e.getTotalMemory,L=e.abortOnCannotGrowMemory,D=(e.invoke_di,e.invoke_ii,e.invoke_iii,e.invoke_iiii,e.invoke_iiiii,e.invoke_iiiiii,e.invoke_iiiiiii,e.invoke_iiiiiiii,e.invoke_iiiiiiiiiiii,e.invoke_vi,e.invoke_vii,e.invoke_viii,e.invoke_viiii,e.___lock),O=e.___setErrNo,F=e.___syscall140,G=e.___syscall145,N=e.___syscall146,z=e.___syscall221,U=e.___syscall5,H=e.___syscall54,V=e.___syscall6,W=e.___unlock,j=e._emscripten_memcpy_big;function Z(t,e){t|=0,e|=0;var i=0;return(i=0|Ut(1,72))?(l[i+64>>2]=t,t=0|zt(t),l[i+32>>2]=t,t?(l[i+36>>2]=t,e=0==(0|e),l[(t=i+68|0)>>2]=l[t>>2]|(e?1:2),l[i+40>>2]=e?29:30,l[i+44>>2]=e?31:32,l[i+16>>2]=4,l[i+20>>2]=5,l[i+24>>2]=6,l[i+28>>2]=7,0|i):(jt(i),0|(i=0))):0|(i=0)}function Y(t){t|=0;var e,i=0;return(e=0|Ut(1,72))?(l[e+64>>2]=1048576,i=0|zt(1048576),l[e+32>>2]=i,i?(l[e+36>>2]=i,i=0==(0|t),l[(t=e+68|0)>>2]=l[t>>2]|(i?1:2),l[e+40>>2]=i?29:30,l[e+44>>2]=i?31:32,l[e+16>>2]=4,l[e+20>>2]=5,l[e+24>>2]=6,l[e+28>>2]=7,0|(i=e)):(jt(e),0|(i=0))):0|(i=0)}function X(t){var e=0;(t|=0)&&(0|(e=0|l[t+4>>2])&&io[7&e](0|l[t>>2]),jt(0|l[(e=t+32|0)>>2]),l[e>>2]=0,jt(t))}function J(t,e){e|=0,(t|=0)&&2&l[t+68>>2]&&(l[t+16>>2]=e)}function Q(t,e){e|=0,(t|=0)&&(l[t+28>>2]=e)}function q(t,e){e|=0,(t|=0)&&(l[t+24>>2]=e)}function K(t,e,i){e|=0,i|=0,(t|=0)&&(l[t>>2]=e,l[t+4>>2]=i)}function $(t,e,i){e|=0,i|=0,(t|=0)&&(l[(t=t+8|0)>>2]=e,l[t+4>>2]=i)}function tt(t,e){e|=0,(t|=0)&&1&l[t+68>>2]&&(l[t+20>>2]=e)}function et(t,e,i,n){e|=0,i|=0,n|=0;var r,o=0;return l[36+(t|=0)>>2]=l[t+32>>2],l[t+48>>2]=0,o=0==(0|Qr[63&l[t+28>>2]](e,i,0|l[t>>2])),r=0|l[(n=t+68|0)>>2],o?(l[n>>2]=4|r,0|(o=0)):(l[n>>2]=-5&r,l[(o=t+56|0)>>2]=e,l[o+4>>2]=i,0|(o=1))}function it(t,e,i){t|=0,e|=0,i|=0;var n,o,a=0;if(o=w,w=w+16|0,l[(n=o)>>2]=e,i){for(a=0,e=n+i|0;e=e+-1|0,r[t>>0]=0|r[e>>0],(0|(a=a+1|0))!=(0|i);)t=t+1|0;w=o}else w=o}function nt(t,e,i){t|=0,i|=0;var n=0;if(l[(e|=0)>>2]=0,i)for(n=e+i|0,e=t,t=0;r[(n=n+-1|0)>>0]=0|r[e>>0],(0|(t=t+1|0))!=(0|i);)e=e+1|0}function rt(t,e){t|=0,e=+e;var i,n=0,o=0;g[v>>3]=e,o=0|Er(0|(i=0|l[v>>2]),0|(n=0|l[v+4>>2]),56),r[t>>0]=o,o=0|Er(0|i,0|n,48),r[t+1>>0]=o,o=0|Er(0|i,0|n,40),r[t+2>>0]=o,r[t+3>>0]=n,o=0|Er(0|i,0|n,24),r[t+4>>0]=o,o=0|Er(0|i,0|n,16),r[t+5>>0]=o,n=0|Er(0|i,0|n,8),r[t+6>>0]=n,r[t+7>>0]=i}function ot(t,e){var i;t|=0,r[(i=8+(e|=0)|0)-1>>0]=0|r[t>>0],r[i+-2>>0]=0|r[t+1>>0],r[i+-3>>0]=0|r[t+2>>0],r[i+-4>>0]=0|r[t+3>>0],r[i+-5>>0]=0|r[t+4>>0],r[i+-6>>0]=0|r[t+5>>0],r[i+-7>>0]=0|r[t+6>>0],r[e>>0]=0|r[t+7>>0]}function at(t,e){t|=0,e=+e;var i=0;m[v>>2]=e,i=0|l[v>>2],r[t>>0]=i>>>24,r[t+1>>0]=i>>>16,r[t+2>>0]=i>>>8,r[t+3>>0]=i}function st(t,e){var i;t|=0,r[(i=4+(e|=0)|0)-1>>0]=0|r[t>>0],r[i+-2>>0]=0|r[t+1>>0],r[i+-3>>0]=0|r[t+2>>0],r[e>>0]=0|r[t+3>>0]}function lt(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0;if(a=w,w=w+16|0,y=a+8|0,g=a,(s=0|l[(o=48+(t|=0)|0)>>2])>>>0>=i>>>0)return Cr(0|e,0|l[(y=t+36|0)>>2],0|i),l[y>>2]=(0|l[y>>2])+i,l[o>>2]=(0|l[o>>2])-i,g=0|br(0|l[(g=y=t+56|0)>>2],0|l[g+4>>2],0|i,0),l[y>>2]=g,l[y+4>>2]=S,w=a,0|(y=i);if(4&l[(r=t+68|0)>>2]|0)return Cr(0|e,0|l[(y=t+36|0)>>2],0|s),g=0|l[o>>2],l[y>>2]=(0|l[y>>2])+g,g=0|br(0|l[(n=y=t+56|0)>>2],0|l[n+4>>2],0|g,0),l[y>>2]=g,l[y+4>>2]=S,l[o>>2]=0,w=a,0|(y=0|s?s:-1);for(s?(Cr(0|e,0|l[(m=t+36|0)>>2],0|s),c=0|l[(_=t+32|0)>>2],l[m>>2]=c,p=0|l[o>>2],d=0|br(0|l[(d=f=t+56|0)>>2],0|l[d+4>>2],0|p,0),l[f>>2]=d,l[f+4>>2]=S,l[o>>2]=0,i=i-p|0,e=e+p|0):(c=0|l[(_=t+32|0)>>2],l[(m=t+36|0)>>2]=c,s=0),f=t+64|0,p=t+16|0,d=t+56|0;;){if(h=0|l[f>>2],u=0|l[p>>2],i>>>0>=h>>>0){if(h=0|Qr[63&u](e,i,0|l[t>>2]),l[o>>2]=h,-1==(0|h)){c=16;break}if(s=h+s|0,!(h>>>0<i>>>0)){c=19;break}c=h}else{if(c=0|Qr[63&u](c,h,0|l[t>>2]),l[o>>2]=c,-1==(0|c)){c=11;break}if(c>>>0>=i>>>0){c=14;break}Cr(0|e,0|l[m>>2],0|c),s=c+s|0,c=0|l[o>>2]}u=0|l[_>>2],l[m>>2]=u,b=0|br(0|l[(b=d)>>2],0|l[b+4>>2],0|c,0),l[(h=d)>>2]=b,l[h+4>>2]=S,l[o>>2]=0,i=i-c|0,e=e+c|0,c=u}return 11==(0|c)?(mt(n,4,4386,g),l[o>>2]=0,l[r>>2]=4|l[r>>2],w=a,0|(b=0|s?s:-1)):14==(0|c)?(Cr(0|e,0|l[m>>2],0|i),l[m>>2]=(0|l[m>>2])+i,l[o>>2]=(0|l[o>>2])-i,y=0|br(0|l[(y=b=t+56|0)>>2],0|l[y+4>>2],0|i,0),l[b>>2]=y,l[b+4>>2]=S,w=a,0|(b=s+i|0)):16==(0|c)?(mt(n,4,4386,y),l[o>>2]=0,l[r>>2]=4|l[r>>2],w=a,0|(b=0|s?s:-1)):19==(0|c)?(y=0|br(0|l[(y=b=t+56|0)>>2],0|l[y+4>>2],0|h,0),l[b>>2]=y,l[b+4>>2]=S,l[m>>2]=l[_>>2],l[o>>2]=0,w=a,0|(b=s)):0}function ct(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0;if(s=w,w=w+16|0,a=s,8&l[(r=68+(t|=0)|0)>>2]|0)return w=s,0|(y=-1);o=t+64|0,f=0|l[(y=t+48|0)>>2],c=(0|l[o>>2])-f|0;do{if(c>>>0<i>>>0){m=t+32|0,h=t+36|0,_=t+20|0,u=t+56|0,d=0,p=c;t:for(;;){if(p?(Cr(0|l[h>>2],0|e,0|p),c=0|l[m>>2],l[h>>2]=c,f=(0|l[y>>2])+p|0,l[y>>2]=f,v=0|br(0|l[(v=u)>>2],0|l[v+4>>2],0|p,0),l[(b=u)>>2]=v,l[b+4>>2]=S,d=p+d|0,i=i-p|0,e=e+p|0):c=0|l[m>>2],l[h>>2]=c,f){do{if(-1==(0|(f=0|Qr[63&l[_>>2]](c,f,0|l[t>>2]))))break t;c=(0|l[h>>2])+f|0,l[h>>2]=c,f=(0|l[y>>2])-f|0,l[y>>2]=f}while(0!=(0|f));c=0|l[m>>2]}if(l[h>>2]=c,i>>>0<=(p=0|l[o>>2])>>>0){g=5;break}f=0}if(5==(0|g))break;return l[r>>2]=8|l[r>>2],mt(n,4,4360,a),w=s,0|(v=-1)}d=0,u=t+56|0,h=c=t+36|0,c=0|l[c>>2]}while(0);return Cr(0|c,0|e,0|i),l[h>>2]=(0|l[h>>2])+i,l[y>>2]=(0|l[y>>2])+i,b=0|br(0|l[(b=u)>>2],0|l[b+4>>2],0|i,0),l[(v=u)>>2]=b,l[v+4>>2]=S,w=s,0|(v=d+i|0)}function ht(t){return S=0|l[4+(t=56+(t|=0)|0)>>2],0|l[t>>2]}function ut(t){var e=0,i=0;return 0==(0|(e=0|l[(i=8+(t|=0)|0)>>2]))&0==(0|(i=0|l[i+4>>2]))?(S=e=0,0|(i=0)):(i=0|vr(0|e,0|i,0|l[(t=t+56|0)>>2],0|l[t+4>>2]),S=e=S,0|i)}function dt(t,e,i,n){return e|=0,i|=0,n|=0,0|(n=0|qr[63&l[40+(t|=0)>>2]](t,e,i,n))}function ft(t,e,i,n){return e|=0,i|=0,n|=0,0|qr[63&l[44+(t|=0)>>2]](t,e,i,n)}function pt(t){return 7!=(0|l[28+(t|=0)>>2])|0}function mt(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r,o,a,s=0;a=w,w=w+528|0,r=a,o=a+16|0;t:do{if(t){switch(0|e){case 1:e=t+12|0;break;case 2:e=t+16|0,t=t+4|0;break;case 4:e=t+20|0,t=t+8|0;break;default:e=0;break t}s=0|l[e>>2],e=0|l[t>>2],s?i?(Ir(0|o,0,512),l[r>>2]=n,lr(o,512,i,r),no[7&s](o,e),e=1):e=1:e=0}else e=0}while(0);return w=a,0|e}function _t(t){l[(t|=0)>>2]=0,l[t+4>>2]=0,l[t+8>>2]=0,l[t+12>>2]=4,l[t+20>>2]=4,l[t+16>>2]=4}function gt(t,e,i){t|=0,e|=0,i|=0;var n,r,o=0,a=0,s=0,c=0,h=0;if(!(n=0|Ut(1,36)))return 0|(s=n);if(l[n+20>>2]=i,l[(r=n+16|0)>>2]=t,o=0|Ut(1,52*t|0),l[(s=n+24|0)>>2]=o,!o)return 0|(i=0|l[n+28>>2])&&jt(i),jt(n),0|(s=0);if(!t)return 0|(s=n);for(i=0;l[o+(52*i|0)>>2]=l[e+(36*i|0)>>2],l[o+(52*i|0)+4>>2]=l[e+(36*i|0)+4>>2],c=0|l[e+(36*i|0)+8>>2],l[o+(52*i|0)+8>>2]=c,h=0|l[e+(36*i|0)+12>>2],l[o+(52*i|0)+12>>2]=h,l[o+(52*i|0)+16>>2]=l[e+(36*i|0)+16>>2],l[o+(52*i|0)+20>>2]=l[e+(36*i|0)+20>>2],l[o+(52*i|0)+24>>2]=l[e+(36*i|0)+24>>2],l[o+(52*i|0)+28>>2]=l[e+(36*i|0)+28>>2],l[o+(52*i|0)+32>>2]=l[e+(36*i|0)+32>>2],c=0|Ut(0|C(h,c),4),l[o+(52*i|0)+44>>2]=c,i=i+1|0,c;){if(i>>>0>=t>>>0){a=22;break}o=0|l[s>>2]}if(22==(0|a))return 0|n;if(0|(i=0|l[s>>2])){if(o=0|l[r>>2]){for(t=0;(i=0|l[i+(52*t|0)+44>>2])&&(jt(i),o=0|l[r>>2]),!((i=t+1|0)>>>0>=o>>>0);)t=i,i=0|l[s>>2];i=0|l[s>>2]}jt(i)}return 0|(i=0|l[n+28>>2])&&jt(i),jt(n),0|(h=0)}function yt(t){var e,i=0,n=0,r=0,o=0;if(t|=0){if(0|(i=0|l[(e=t+24|0)>>2])){if(n=0|l[(o=t+16|0)>>2]){for(r=0;(i=0|l[i+(52*r|0)+44>>2])&&(jt(i),n=0|l[o>>2]),!((i=r+1|0)>>>0>=n>>>0);)r=i,i=0|l[e>>2];i=0|l[e>>2]}jt(i)}0|(i=0|l[t+28>>2])&&jt(i),jt(t)}}function bt(){return 0|Ut(1,36)}function vt(t,e){t|=0;var i,n,r=0,o=0,a=0,s=0,c=0;if(l[(e|=0)>>2]=l[t>>2],l[e+4>>2]=l[t+4>>2],l[e+8>>2]=l[t+8>>2],l[e+12>>2]=l[t+12>>2],i=e+16|0,o=0|l[(n=e+24|0)>>2]){if(a=0|l[i>>2]){for(r=0;(o=0|l[o+(52*r|0)+44>>2])&&(jt(o),a=0|l[i>>2]),!((r=r+1|0)>>>0>=a>>>0);)o=0|l[n>>2];r=n,o=0|l[n>>2]}else r=n;jt(o),l[n>>2]=0}else r=n;if(o=0|l[t+16>>2],l[i>>2]=o,o=0|zt(52*o|0),l[r>>2]=o,!o)return l[n>>2]=0,void(l[i>>2]=0);if(0|l[i>>2]){c=t+24|0,s=0,r=o;do{r=r+(52*s|0)|0,o=(0|l[c>>2])+(52*s|0)|0,a=r+52|0;do{l[r>>2]=l[o>>2],r=r+4|0,o=o+4|0}while((0|r)<(0|a));r=0|l[n>>2],l[r+(52*s|0)+44>>2]=0,s=s+1|0}while(s>>>0<(0|l[i>>2])>>>0)}if(l[e+20>>2]=l[t+20>>2],r=0|l[(a=t+32|0)>>2],l[(s=e+32|0)>>2]=r,r)return o=0|zt(r),l[(r=e+28|0)>>2]=o,o?void Cr(0|o,0|l[t+28>>2],0|l[a>>2]):(l[r>>2]=0,void(l[s>>2]=0));l[e+28>>2]=0}function wt(t){t|=0;var e=0;if(!(e=0|Ut(1,84)))return 0|(e=0);switch(l[e+68>>2]=0,0|t){case 0:if(l[e+4>>2]=8,l[e+12>>2]=9,l[e>>2]=33,l[e+8>>2]=1,l[e+16>>2]=1,l[e+20>>2]=34,t=0|Yt(),l[e+40>>2]=t,!t)return jt(e),0|(e=0);break;case 2:if(l[e+4>>2]=10,l[e+12>>2]=11,l[e>>2]=35,l[e+8>>2]=2,l[e+16>>2]=2,l[e+20>>2]=36,t=0|Ie(0),l[e+40>>2]=t,!t)return jt(e),0|(e=0);break;default:return jt(e),0|(e=0)}return _t(e+44|0),0|e}function xt(t){t|=0;var e=0;if(!(e=0|Ut(1,84)))return 0|(e=0);switch(l[e+68>>2]=1,0|t){case 0:if(l[e+72>>2]=13,l[e+76>>2]=2,l[e+80>>2]=3,l[e+4>>2]=37,l[e+16>>2]=12,l[e>>2]=38,l[e+20>>2]=1,l[e+24>>2]=5,l[e+8>>2]=1,l[e+12>>2]=3,l[e+28>>2]=1,l[e+32>>2]=1,l[e+36>>2]=13,t=0|ae(),l[e+40>>2]=t,!t)return jt(e),0|(e=0);break;case 2:if(l[e+72>>2]=14,l[e+76>>2]=4,l[e+80>>2]=5,l[e+4>>2]=39,l[e+16>>2]=14,l[e>>2]=40,l[e+8>>2]=2,l[e+12>>2]=4,l[e+20>>2]=2,l[e+24>>2]=6,l[e+28>>2]=2,l[e+32>>2]=2,l[e+36>>2]=15,t=0|Ie(1),l[e+40>>2]=t,!t)return jt(e),0|(e=0);break;default:return jt(e),0|(e=0)}return _t(e+44|0),0|e}function At(t,e,i){return i|=0,0!=(0|(t|=0))&0!=(0|(e|=0))&&0|l[t+68>>2]?0|(i=0|qr[63&l[t+4>>2]](0|l[t+40>>2],e,i,t+44|0)):0|(i=0)}function St(t){var e=0;(t|=0)&&(0|l[t+68>>2]?(e=t+40|0,io[7&l[t+20>>2]](0|l[e>>2])):(e=t+40|0,io[7&l[t+16>>2]](0|l[e>>2])),l[e>>2]=0,jt(t))}function Mt(t){var e,i=0;(t|=0)&&(i=0|l[t>>2],(e=0|l[i+48>>2])&&(jt(e),i=0|l[t>>2]),jt(i),l[t>>2]=0)}function Et(t,e){return 0!=(0|(t|=0))&0!=(0|(e|=0))?0|l[t+68>>2]?0|(e=0):0|(e=0|Qr[63&l[t+4>>2]](0|l[t+40>>2],e,t+44|0)):0|(e=0)}function Tt(t,e){return 0!=(0|(t|=0))&0!=(0|(e|=0))?0|l[t+68>>2]?0|(e=0):0|(e=0|Qr[63&l[t+12>>2]](0|l[t+40>>2],e,t+44|0)):0|(e=0)}function kt(t,e,i){var n;return i|=0,n=w,w=w+16|0,0!=(0|(t|=0))&0!=(0|(e|=0))?0|l[e+68>>2]?(i=0|qr[63&l[e>>2]](t,0|l[e+40>>2],i,e+44|0),w=n,0|i):(mt(e+44|0,1,4520,n),w=n,0|(i=0)):(w=n,0|(i=0))}function Ct(t){(t|=0)&&(Ir(0|t,0,8248),l[t+8200>>2]=-1,l[t+8204>>2]=-1,l[t+8248>>2]=0)}function It(t){(t|=0)&&(Ir(0|t,0,18708),l[t+5592>>2]=6,l[t+18684>>2]=0,l[t+5596>>2]=64,l[t+5600>>2]=64,l[t+44>>2]=0,l[t+5612>>2]=-1,l[t+18188>>2]=1,l[t+18192>>2]=1,r[t+18688>>0]=0,l[t+18196>>2]=-1,l[t+18200>>2]=-1,m[t+4792>>2]=0,l[t+4788>>2]=0,l[t+20>>2]=0,l[t+24>>2]=0,l[t+28>>2]=0,l[t+18692>>2]=0)}function Pt(t,e,i){return e|=0,i|=0,(t|=0)?(l[t+56>>2]=e,l[t+44>>2]=i,0|(i=1)):0|(i=0)}function Rt(t,e,i){return e|=0,i|=0,(t|=0)?(l[t+64>>2]=e,l[t+52>>2]=i,0|(i=1)):0|(i=0)}function Bt(t,e,i){return e|=0,i|=0,(t|=0)?(l[t+60>>2]=e,l[t+48>>2]=i,0|(i=1)):0|(i=0)}function Lt(t,e){var i;return i=w,w=w+16|0,0!=(0|(t|=0))&0!=(0|(e|=0))?0|l[t+68>>2]?(no[7&l[t+24>>2]](0|l[t+40>>2],e),w=i,0|(e=1)):(mt(t+44|0,1,4439,i),w=i,0|(e=0)):(w=i,0|(e=0))}function Dt(t,e,i){return 0!=(0|(t|=0))&0!=(0|(e|=0))&0!=(0|(i|=0))?0|l[t+68>>2]?0|(i=0):0|(i=0|qr[63&l[t+20>>2]](0|l[t+40>>2],e,i,t+44|0)):0|(i=0)}function Ot(t,e,i){return e|=0,0!=(0|(t|=0))&0!=(0|(i|=0))?0|l[t+68>>2]?0|(i=0):0|(i=0|qr[63&l[t>>2]](0|l[t+40>>2],i,e,t+44|0)):0|(i=0)}function Ft(t,e){e|=0;var i=0;return(t|=0)&&(i=0|Y(e))?(K(i,t,0),$(i,0|l[t+8>>2],0),e?J(i,16):tt(i,17),q(i,18),Q(i,19),0|i):0|(i=0)}function Gt(t,e,i){e|=0,i|=0;var n=0;return(t|=0)&&(n=0|Dn(t,0==(0|i)?4433:4436))?(t=0|Z(e,i))?(K(t,n,6),Vn(n,0,2),i=0|function(t){return 0|function(t){var e=0,i=0;return(0|l[76+(t|=0)>>2])>-1?(i=0==(0|Cn()),e=0|gr(t),i||kn()):e=0|gr(t),0|e}(t|=0)}(n),Vn(n,0,0),$(t,i,((0|i)<0)<<31>>31),J(t,20),tt(t,21),q(t,22),Q(t,23),0|(n=t)):(zn(n),0|(n=0)):0|(n=0)}function Nt(){return 4427}function zt(t){return 0|(t=(t|=0)?0|_n(t):0)}function Ut(t,e){return 0==(0|(t|=0))|0==(0|(e|=0))?0|(e=0):0|(e=0|function(t,e){e|=0;var i=0;return(t|=0)?(i=0|C(e,t),(e|t)>>>0>65535&&(i=(0|(i>>>0)/(t>>>0))==(0|e)?i:-1)):i=0,(t=0|_n(i))&&3&l[t+-4>>2]?(Ir(0|t,0,0|i),0|t):0|t}(t,e))}function Ht(t){var e,i;t|=0,i=w,w=w+16|0,e=i;do{if(t){if(0|vn(e,16,t)){l[e>>2]=0,t=0;break}t=0|l[e>>2];break}t=0}while(0);return w=i,0|t}function Vt(t){gn(t|=0)}function Wt(t,e){return t|=0,0|(t=(e|=0)?0|function(t,e){e|=0;var i=0,n=0;return(t|=0)?e>>>0>4294967231?(l[(e=25296)>>2]=12,0|(e=0)):0|(i=0|function(t,e){e|=0;var i=0,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0;if(d=0|l[(u=4+(t|=0)|0)>>2],s=t+(i=-8&d)|0,!(3&d))return e>>>0<256?0|(t=0):i>>>0>=(e+4|0)>>>0&&(i-e|0)>>>0<=l[6304]<<1>>>0?0|t:0|(t=0);if(i>>>0>=e>>>0)return(i=i-e|0)>>>0<=15?0|t:(h=t+e|0,l[u>>2]=1&d|e|2,l[h+4>>2]=3|i,l[(d=s+4|0)>>2]=1|l[d>>2],yn(h,i),0|t);if((0|l[6190])==(0|s))return h=(0|l[6187])+i|0,i=h-e|0,n=t+e|0,h>>>0<=e>>>0?0|(t=0):(l[u>>2]=1&d|e|2,l[n+4>>2]=1|i,l[6190]=n,l[6187]=i,0|t);if((0|l[6189])==(0|s))return(n=(0|l[6186])+i|0)>>>0<e>>>0?0|(t=0):((i=n-e|0)>>>0>15?(h=t+e|0,n=t+n|0,l[u>>2]=1&d|e|2,l[h+4>>2]=1|i,l[n>>2]=i,l[(n=n+4|0)>>2]=-2&l[n>>2],n=h):(l[u>>2]=1&d|n|2,l[(n=t+n+4|0)>>2]=1|l[n>>2],n=0,i=0),l[6186]=i,l[6189]=n,0|t);if(2&(n=0|l[s+4>>2])|0)return 0|(t=0);if((c=(-8&n)+i|0)>>>0<e>>>0)return 0|(t=0);h=c-e|0,r=n>>>3;do{if(n>>>0<256){if(n=0|l[s+8>>2],(0|(i=0|l[s+12>>2]))==(0|n)){l[6184]=l[6184]&~(1<<r);break}l[n+12>>2]=i,l[i+8>>2]=n;break}a=0|l[s+24>>2],i=0|l[s+12>>2];do{if((0|i)==(0|s)){if(i=0|l[(n=4+(r=s+16|0)|0)>>2])o=n;else{if(!(i=0|l[r>>2])){r=0;break}o=r}for(;;)if(0|(n=0|l[(r=i+20|0)>>2]))i=n,o=r;else{if(!(r=0|l[(n=i+16|0)>>2]))break;i=r,o=n}l[o>>2]=0,r=i}else r=0|l[s+8>>2],l[r+12>>2]=i,l[i+8>>2]=r,r=i}while(0);if(0|a){if(i=0|l[s+28>>2],(0|l[(n=25040+(i<<2)|0)>>2])==(0|s)){if(l[n>>2]=r,!r){l[6185]=l[6185]&~(1<<i);break}}else if(l[a+16+(((0|l[a+16>>2])!=(0|s)&1)<<2)>>2]=r,!r)break;l[r+24>>2]=a,0|(n=0|l[(i=s+16|0)>>2])&&(l[r+16>>2]=n,l[n+24>>2]=r),0|(i=0|l[i+4>>2])&&(l[r+20>>2]=i,l[i+24>>2]=r)}}while(0);return h>>>0<16?(l[u>>2]=c|1&d|2,l[(d=t+c+4|0)>>2]=1|l[d>>2],0|t):(s=t+e|0,l[u>>2]=1&d|e|2,l[s+4>>2]=3|h,l[(d=t+c+4|0)>>2]=1|l[d>>2],yn(s,h),0|t)}(t+-8|0,e>>>0<11?16:e+11&-8))?0|(e=i+8|0):(i=0|_n(e))?(n=0|l[t+-4>>2],Cr(0|i,0|t,0|((n=(-8&n)-(0==(3&n|0)?8:4)|0)>>>0<e>>>0?n:e)),gn(t),0|(e=i)):0|(e=0):0|(e=0|_n(e))}(t,e):0)}function jt(t){gn(t|=0)}function Zt(t,e){0!=(0|(t|=0))&0!=(0|(e|=0))&&(l[t+172>>2]=l[e+4>>2],l[t+168>>2]=l[e>>2])}function Yt(){var t=0,e=0;return(t=0|Ut(1,208))?(l[t>>2]=0,r[(e=t+184|0)>>0]=-3&r[e>>0],e=0|zt(1e3),l[t+44>>2]=e,e?(l[t+48>>2]=1e3,e=0|mi(),l[t+192>>2]=e,e?(e=0|mi(),l[t+188>>2]=e,0|e?0|(e=t):(Xt(t),0|(e=0))):(Xt(t),0|(e=0))):(Xt(t),0|(e=0))):0|(t=0)}function Xt(t){var e=0,i=0,n=0,o=0,a=0,s=0;if(t|=0){if(0|l[t>>2]?(0|(i=0|l[(e=t+12|0)>>2])&&(Jt(i),jt(0|l[e>>2]),l[e>>2]=0),0|(i=0|l[(e=t+16|0)>>2])&&(jt(i),l[e>>2]=0,l[t+20>>2]=0)):(0|(i=0|l[(e=t+36|0)>>2])&&(jt(i),l[e>>2]=0),0|(i=0|l[(e=t+24|0)>>2])&&(jt(i),l[e>>2]=0,l[t+28>>2]=0),0|(i=0|l[(e=t+44|0)>>2])&&(jt(i),l[e>>2]=0,l[t+48>>2]=0)),$e(0|l[t+204>>2]),e=t+88|0,0|(i=0|l[(a=t+164|0)>>2])){if(o=0|C(0|l[t+112>>2],0|l[t+116>>2])){for(n=0;Jt(i),(0|(n=n+1|0))!=(0|o);)i=i+5640|0;i=0|l[a>>2]}jt(i),l[a>>2]=0}if(0|(i=0|l[(a=t+124|0)>>2])){if(n=0|l[(s=t+120|0)>>2]){for(o=0;(i=0|l[i+(o<<3)>>2])&&(jt(i),n=0|l[s>>2]),!((i=o+1|0)>>>0>=n>>>0);)o=i,i=0|l[a>>2];i=0|l[a>>2]}l[s>>2]=0,jt(i),l[a>>2]=0}jt(0|l[(s=t+144|0)>>2]),l[s>>2]=0,l[t+128>>2]=0,jt(0|l[(s=t+108|0)>>2]),l[s>>2]=0,2&r[t+184>>0]||(jt(0|l[(s=t+176|0)>>2]),l[s>>2]=0),i=e+100|0;do{l[e>>2]=0,e=e+4|0}while((0|e)<(0|i));_i(0|l[(s=t+188|0)>>2]),l[s>>2]=0,_i(0|l[t+192>>2]),l[s>>2]=0,Qt(0|l[(s=t+196|0)>>2]),l[s>>2]=0,yt(0|l[(s=t+80|0)>>2]),l[s>>2]=0,yt(0|l[(s=t+84|0)>>2]),l[s>>2]=0,jt(t)}}function Jt(t){var e,i=0,n=0,r=0,o=0,a=0,s=0;if(t|=0){if(0|(i=0|l[(o=t+5164|0)>>2])){if(n=0|l[(a=t+5160|0)>>2]){for(r=0;(i=0|l[i+(r<<3)>>2])&&(jt(i),n=0|l[a>>2]),!((i=r+1|0)>>>0>=n>>>0);)r=i,i=0|l[o>>2];i=0|l[o>>2]}l[a>>2]=0,jt(i),l[o>>2]=0}if(0|(n=0|l[(i=t+5172|0)>>2])&&(jt(n),l[i>>2]=0),0|(n=0|l[(i=t+5584|0)>>2])&&(jt(n),l[i>>2]=0),0|(n=0|l[(i=t+5608|0)>>2])&&(jt(n),l[i>>2]=0),0|(n=0|l[(i=t+5604|0)>>2])&&(jt(n),l[i>>2]=0),0|(n=0|l[(i=t+5624|0)>>2])&&(jt(n),l[i>>2]=0,l[t+5632>>2]=0,l[t+5628>>2]=0),0|(i=0|l[(e=t+5612|0)>>2])){if(n=0|l[(s=t+5616|0)>>2]){for(a=0;(o=0|l[(r=i+12|0)>>2])&&(jt(o),l[r>>2]=0,n=0|l[s>>2]),!((a=a+1|0)>>>0>=n>>>0);)i=i+20|0;i=0|l[e>>2]}jt(i),l[e>>2]=0}0|(n=0|l[(i=t+5600|0)>>2])&&(jt(n),l[i>>2]=0),(n=0|l[(i=t+5592|0)>>2])&&(jt(n),l[i>>2]=0,l[t+5596>>2]=0)}}function Qt(t){var e,i=0,n=0,r=0,o=0;if(t|=0){if(0|(n=0|l[(i=t+28|0)>>2])&&(jt(n),l[i>>2]=0),0|(i=0|l[(e=t+40|0)>>2])){if(0|l[(o=t+36|0)>>2]){r=0;do{(n=0|l[i+(40*r|0)+36>>2])&&(jt(n),i=0|l[e>>2],l[i+(40*r|0)+36>>2]=0),(n=0|l[i+(40*r|0)+16>>2])&&(jt(n),i=0|l[e>>2],l[i+(40*r|0)+16>>2]=0),(n=0|l[i+(40*r|0)+24>>2])&&(jt(n),i=0|l[e>>2],l[i+(40*r|0)+24>>2]=0),r=r+1|0}while(r>>>0<(0|l[o>>2])>>>0)}jt(i),l[e>>2]=0}jt(t)}}function qt(t,e,i,n){n|=0;var o,s,c,h,u,d,f,p,_,y,b,v,x,A,S,E,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0,et=0,it=0,nt=0,rt=0,ot=0,at=0,st=0,lt=0,ct=0;if(E=w,w=w+320|0,lt=E+296|0,S=E+288|0,A=E+280|0,x=E+272|0,v=E+264|0,b=E+256|0,y=E+248|0,_=E+240|0,ot=E+232|0,u=E+224|0,h=E+216|0,rt=E+208|0,c=E+200|0,s=E+192|0,o=E+184|0,N=E+176|0,G=E+168|0,F=E+160|0,O=E+152|0,L=E+144|0,K=E+136|0,q=E+128|0,it=E+112|0,Q=E+104|0,J=E+96|0,X=E+88|0,Y=E+80|0,Z=E+72|0,W=E+64|0,V=E+56|0,H=E+48|0,U=E+32|0,z=E+24|0,B=E+16|0,P=E+8|0,k=E,tt=E+309|0,et=E+300|0,!(0!=(0|(t|=0))&0!=(0|(e|=0))&0!=(0|(i|=0))))return w=E,0|(lt=0);if(((T=0|l[(p=e+5592|0)>>2])-1|0)>>>0>32)return l[k>>2]=T,l[k+4>>2]=33,mt(n,1,4599,k),w=E,0|(lt=0);l[(d=t+112|0)>>2]=1,l[(f=t+116|0)>>2]=1,$=e+18704|0;do{if(!(0|a[$>>1])){switch(0|l[e+18676>>2]){case 1:T=1041666,k=1302083,I=3,st=8;break;case 2:T=520833,k=651041,I=3,st=8;break;case 3:T=1041666,k=1302083,I=4,st=8;break;default:k=0}8==(0|st)&&(a[$>>1]=I,l[e+18700>>2]=k,l[e+18680>>2]=T,k=1),T=0|l[e+18684>>2];t:do{if((0|T)<4){switch(0|T){case 3:break;default:st=13;break t}T=3,st=12}else{if((0|T)<33024)switch(0|T){case 4:T=4,st=12;break t;default:st=13;break t}switch(0|T){case 33024:break;default:st=13;break t}T=-32512,st=12}}while(0);if(12==(0|st))a[$>>1]=T;else if(13==(0|st)&&0==(0|k))break;mt(n,2,4655,P)}}while(0);T=0|l[(j=e+18700|0)>>2];do{if((0|T)<1){if((D=+m[e+4792+((0|l[e+4788>>2])-1<<2)>>2])>0){at=0|l[i+24>>2],B=0|C(0|l[at+8>>2],0|l[i+16>>2]),B=0|C(B,0|l[at+12>>2]),ct=+((0|C(B,0|l[at+24>>2]))>>>0),at=~~+M(+ct/(8*D*+((0|l[at>>2])>>>0)*+((0|l[at+4>>2])>>>0))),l[j>>2]=at;break}l[j>>2]=0;break}if(R=0|l[i+24>>2],at=0|C(0|l[R+8>>2],0|l[i+16>>2]),at=0|C(at,0|l[R+12>>2]),D=+((0|C(at,0|l[R+24>>2]))>>>0),T=0|C(T<<3,0|l[R>>2]),D/=+((0|C(T,0|l[R+4>>2]))>>>0),0|(T=0|l[(R=e+4788|0)>>2])){P=0,k=0;do{+m[(I=e+4792+(P<<2)|0)>>2]<D&&(m[I>>2]=D,k=1,T=0|l[R>>2]),P=P+1|0}while(P>>>0<T>>>0);0|k&&mt(n,2,4792,B)}}while(0);T=0|a[$>>1];t:do{if((T+-3&65535)>=4){if(T<<16>>16==7){mt(n,2,6952,L),a[$>>1]=0;break}if((T+-256&65535)<524){mt(n,2,7007,O),a[$>>1]=0;break}if((T+-1024&65535)<1180){mt(n,2,7055,F),a[$>>1]=0;break}if(T<<16>>16<=-1)switch(T<<16>>16){case-32512:break t;case-32768:mt(n,2,7097,G),a[$>>1]=0;break t;default:mt(n,2,7185,N),a[$>>1]=0;break t}}else{if((T+-5&65535)<2){mt(n,2,4884,z),a[$>>1]=0;break}l[e>>2]=0,l[e+12>>2]=1,l[e+16>>2]=1,r[e+18689>>0]=67,r[e+18688>>0]=1,l[e+4>>2]=0,l[e+8>>2]=0,l[e+18180>>2]=0,l[e+18184>>2]=0,l[e+5596>>2]=32,l[e+5600>>2]=32,l[e+5604>>2]=0,l[e+5612>>2]=-1,l[e+18188>>2]=1,l[e+18192>>2]=1,l[e+5608>>2]=1,(0|(I=0|l[(k=e+4788|0)>>2]))>1&&(ct=+m[e+4792+(I+-1<<2)>>2],l[U>>2]=I,g[U+8>>3]=ct,mt(n,2,4946,U),l[e+4792>>2]=l[e+4792+((0|l[k>>2])-1<<2)>>2],l[k>>2]=1,T=0|a[$>>1]);e:do{switch(T<<16>>16){case 3:(0|(T=0|l[p>>2]))>6&&(l[H>>2]=T+1,mt(n,2,5119,H),l[p>>2]=6,T=6);break;case 4:if((0|(T=0|l[p>>2]))<2){l[V>>2]=T+1,mt(n,2,5265,V),l[p>>2]=1,T=1;break e}(0|T)>7&&(l[W>>2]=T+1,mt(n,2,5419,W),l[p>>2]=7,T=7);break;default:T=0|l[p>>2]}}while(0);if(l[(k=e+40|0)>>2]=1|l[k>>2],l[(k=e+5620|0)>>2]=T+-1,(0|T)>1){T=0;do{l[e+5624+(T<<2)>>2]=256,l[e+5756+(T<<2)>>2]=256,T=T+1|0}while((0|T)<(0|l[k>>2]))}l[e+44>>2]=4,4==(0|a[$>>1])?(T=0|l[p>>2],l[e+96>>2]=1,l[e+48>>2]=0,l[e+52>>2]=0,l[e+56>>2]=1,at=T+-1|0,l[e+60>>2]=at,l[e+64>>2]=3,l[e+80>>2]=4,l[e+244>>2]=1,l[e+196>>2]=at,l[e+200>>2]=0,l[e+204>>2]=1,l[e+208>>2]=T,l[e+212>>2]=3,l[e+228>>2]=4,T=2):T=0,l[e+4784>>2]=T,l[e+20>>2]=1,(0|(T=0|l[j>>2]))>=1?(0|T)>1302083&&(mt(n,2,5722,Y),l[j>>2]=1302083):(l[j>>2]=1302083,mt(n,2,5573,Z)),(0|(k=0|l[(T=e+18680|0)>>2]))>=1?(0|k)>1041666&&(mt(n,2,6044,J),l[T>>2]=1041666):(l[T>>2]=1041666,mt(n,2,5895,X)),T=0|l[i+16>>2],k=0|l[i+24>>2],P=0|l[k+8>>2],I=0|C(P,T),B=0|l[k+12>>2],I=0|C(I,B),ct=+((0|C(I,0|l[k+24>>2]))>>>0),I=0|C(l[j>>2]<<3,0|l[k>>2]),ct/=+((0|C(I,0|l[k+4>>2]))>>>0),m[e+4792>>2]=ct,I=0|a[$>>1];e:do{if(3==(0|T)){if(T=0|l[k+28>>2],(R=0|l[k+32>>2])|12!=(0|T))B=0;else if(T=0|l[k+80>>2],(R=0|l[k+84>>2])|12!=(0|T))B=1;else if(T=0|l[k+132>>2],(k=0|l[k+136>>2])|12!=(0|T))B=2,R=k;else switch(I<<16>>16){case 3:if(!(P>>>0>2048|B>>>0>1080))break t;l[q>>2]=P,l[q+4>>2]=B,mt(n,2,6616,q);break e;case 4:if(!(P>>>0>4096|B>>>0>2160))break t;l[K>>2]=P,l[K+4>>2]=B,mt(n,2,6787,K);break e;default:break t}r[tt>>0]=0|r[6383],r[tt+1>>0]=0|r[6384],r[tt+2>>0]=0|r[6385],r[tt+3>>0]=0|r[6386],r[tt+4>>0]=0|r[6387],r[tt+5>>0]=0|r[6388],r[tt+6>>0]=0|r[6389],I=6390,P=(k=et)+9|0;do{r[k>>0]=0|r[I>>0],k=k+1|0,I=I+1|0}while((0|k)<(0|P));l[it>>2]=B,l[it+4>>2]=T,l[it+8>>2]=0|R?tt:et,mt(n,2,6399,it)}else l[Q>>2]=T,mt(n,2,6217,Q)}while(0);a[$>>1]=0}}while(0);l[t+168>>2]=l[e+18680>>2],a[(at=t+88|0)>>1]=0|a[$>>1],tt=-2&r[(it=t+181|0)>>0]|1&l[e+20>>2],r[it>>0]=tt,tt=(255&l[(et=e+24|0)>>2])<<1&2|-3&tt,r[it>>0]=tt,r[it>>0]=-5&tt|(255&l[e+28>>2])<<2&4;do{if(0|l[et>>2]&&0|l[(nt=e+32|0)>>2]){if(k=0|zt(T=0|C(12*(0|l[e+4788>>2])|0,0|l[p>>2])),l[t+176>>2]=k,0|k){Cr(0|k,0|l[nt>>2],0|T);break}return mt(n,1,7244,o),w=E,0|(lt=0)}}while(0);l[(P=t+100|0)>>2]=l[e+12>>2],l[(R=t+104|0)>>2]=l[e+16>>2],l[(I=t+92|0)>>2]=l[e+4>>2],l[(B=t+96|0)>>2]=l[e+8>>2],T=0|l[(k=e+36|0)>>2];do{if(T){if(T=0|zt(1+(0|Sn(T))|0),l[t+108>>2]=T,0|T){cr(T,0|l[k>>2]);break}return mt(n,1,7316,s),w=E,0|(lt=0)}if(k=0|zt(29+(0|Sn(T=4427))|0),l[t+108>>2]=k,0|k){l[rt>>2]=7421,l[rt+4>>2]=T,ur(k,7416,rt);break}return mt(n,1,7370,c),w=E,0|(lt=0)}while(0);if(T=(0|l[i+8>>2])-(0|l[I>>2])|0,0|l[e>>2]?(rt=0|l[P>>2],l[d>>2]=(T+-1+rt|0)/(0|rt)|0,rt=0|l[R>>2],l[f>>2]=((0|l[i+12>>2])-1-(0|l[B>>2])+rt|0)/(0|rt)|0):(l[P>>2]=T,l[R>>2]=(0|l[i+12>>2])-(0|l[B>>2])),0|r[e+18688>>0]&&(r[t+180>>0]=0|r[e+18689>>0],r[it>>0]=8|r[it>>0]),rt=0|Ut(0|C(0|l[f>>2],0|l[d>>2]),5640),l[(et=t+164|0)>>2]=rt,!rt)return mt(n,1,7450,h),w=E,0|(lt=0);W=0|l[(tt=e+4784|0)>>2];do{if(0|W){if(z=e+48|0,j=0|l[p>>2],Z=0|l[i+16>>2],Y=0|l[e+4788>>2],X=0|C(Z,j),!(J=0|Ut(0|C(X,Y),4))){mt(n,1,7504,u);break}if((T=0|l[z>>2])>>>0<(I=0|l[(O=e+60|0)>>2])>>>0)for(L=0|C(T,Z),F=e+52|0,N=e+56|0,k=0|l[(G=e+64|0)>>2];;){if((P=0|l[F>>2])>>>0<k>>>0){for(B=P+L|0,I=0|l[N>>2];;){if(I){for(k=B,R=0;l[J+(k<<2)>>2]=1,!((R=R+1|0)>>>0>=(I=0|l[N>>2])>>>0);)k=k+X|0;k=0|l[G>>2]}else I=0;if((P=P+1|0)>>>0>=k>>>0)break;B=B+1|0}I=0|l[O>>2]}if((T=T+1|0)>>>0>=I>>>0)break;L=L+Z|0}if(W>>>0>1){G=1;do{if(T=z,z=z+148|0,U=0|l[T+8>>2],U=(R=0|l[(N=T+156|0)>>2])>>>0>U>>>0?U:0,(k=0|l[z>>2])>>>0<(I=0|l[(H=T+160|0)>>2])>>>0)for(L=0|C(k,Z),V=T+152|0,O=T+164|0,F=0|C(U,X),T=0|l[O>>2];;){if((P=0|l[V>>2])>>>0<T>>>0){for(B=P+L|0;;){if(U>>>0<R>>>0){for(T=B+F|0,I=U;l[J+(T<<2)>>2]=1,!((I=I+1|0)>>>0>=(R=0|l[N>>2])>>>0);)T=T+X|0;T=0|l[O>>2]}if((P=P+1|0)>>>0>=T>>>0)break;B=B+1|0}I=0|l[H>>2]}if((k=k+1|0)>>>0>=I>>>0)break;L=L+Z|0}G=G+1|0}while((0|G)!=(0|W))}if(!(0==(0|Y)|0==(0|j)|0==(0|Z))){for(T=0,B=0,L=0;;){for(I=0,R=B;;){for(P=0,k=R;T|=1!=(0|l[J+(k<<2)>>2]),(0|(P=P+1|0))!=(0|Z);)k=k+1|0;if((0|(I=I+1|0))==(0|j))break;R=R+Z|0}if((0|(L=L+1|0))==(0|Y))break;B=B+X|0}0|T&&mt(n,1,7552,ot)}jt(J)}}while(0);t:do{if(0|C(0|l[f>>2],0|l[d>>2])){U=e+4788|0,H=e+40|0,V=e+44|0,W=e+18690|0,j=i+16|0,k=e+18696|0,Z=i+24|0,Y=e+5596|0,X=e+5600|0,J=e+5604|0,Q=e+5608|0,q=e+5612|0,K=e+5616|0,$=e+5620|0,z=0;e:for(;;){O=(L=0|l[et>>2])+(5640*z|0)|0,ot=0|l[U>>2],l[(I=L+(5640*z|0)+8|0)>>2]=ot;i:do{if(0|ot){if(((0|a[at>>1])-3&65535)<4)T=0;else for(T=0;;)if(ot=0==(4&r[it>>0]),l[(ot?L+(5640*z|0)+20+(T<<2)|0:L+(5640*z|0)+5184+(T<<2)|0)>>2]=l[(ot?e+4792+(T<<2)|0:e+5192+(T<<2)|0)>>2],(T=T+1|0)>>>0>=(0|l[I>>2])>>>0)break i;do{4&r[it>>0]&&(l[L+(5640*z|0)+5184+(T<<2)>>2]=l[e+5192+(T<<2)>>2]),l[L+(5640*z|0)+20+(T<<2)>>2]=l[e+4792+(T<<2)>>2],T=T+1|0}while(T>>>0<(0|l[I>>2])>>>0)}}while(0);if(l[O>>2]=l[H>>2],l[L+(5640*z|0)+4>>2]=l[V>>2],l[(B=L+(5640*z|0)+16|0)>>2]=r[W>>0],I=0|r[(T=L+(5640*z|0)+5636|0)>>0],r[T>>0]=-5&I,0|l[tt>>2]){if(r[T>>0]=4|I,P=0|l[tt>>2]){R=z+1|0,T=0,I=0;do{(0|R)==(0|l[e+48+(148*I|0)+48>>2])&&(l[L+(5640*z|0)+424+(148*T|0)>>2]=l[e+48+(148*T|0)>>2],l[L+(5640*z|0)+424+(148*T|0)+4>>2]=l[e+48+(148*T|0)+4>>2],l[L+(5640*z|0)+424+(148*T|0)+8>>2]=l[e+48+(148*T|0)+8>>2],l[L+(5640*z|0)+424+(148*T|0)+12>>2]=l[e+48+(148*T|0)+12>>2],l[L+(5640*z|0)+424+(148*T|0)+16>>2]=l[e+48+(148*T|0)+16>>2],l[L+(5640*z|0)+424+(148*T|0)+32>>2]=l[e+48+(148*T|0)+32>>2],l[L+(5640*z|0)+424+(148*T|0)+48>>2]=l[e+48+(148*T|0)+48>>2],T=T+1|0),I=I+1|0}while(I>>>0<P>>>0)}else T=0;T=T+-1|0}else T=0;if(l[L+(5640*z|0)+420>>2]=T,ot=0|Ut(0|l[j>>2],1080),l[(N=L+(5640*z|0)+5584|0)>>2]=ot,!ot){st=141;break}do{if(0|l[k>>2]){if(I=0|l[j>>2],P=0|zt(I=0|C(I<<2,I)),R=(0|l[k>>2])+I|0,!P){st=144;break e}if(l[B>>2]=2,T=0|zt(I),l[L+(5640*z|0)+5608>>2]=T,!T){st=146;break e}if(Cr(0|T,0|l[k>>2],0|I),Cr(0|P,0|l[k>>2],0|I),T=0|zt(I),l[(I=L+(5640*z|0)+5604|0)>>2]=T,!T){st=148;break e}if(!(0|Ni(P,T,0|l[j>>2]))){st=150;break e}if(T=0|zt(l[j>>2]<<3),l[L+(5640*z|0)+5600>>2]=T,!T){st=152;break e}if(Fe(T,0|l[j>>2],0|l[I>>2]),jt(P),0|(I=0|l[j>>2])){P=0|l[N>>2],T=0;do{l[P+(1080*T|0)+1076>>2]=l[R+(T<<2)>>2],T=T+1|0}while(T>>>0<I>>>0)}if(!(0|Kt(O,i))){st=158;break e}0|l[j>>2]&&(O=0,st=172)}else{i:do{if(1==(0|l[B>>2])){if((T=0|l[j>>2])>>>0<=2){P=T;break}I=0|l[Z>>2],T=0|l[I>>2];do{if((0|T)==(0|l[I+52>>2])){if((0|T)!=(0|l[I+104>>2]))break;if((0|(T=0|l[I+4>>2]))!=(0|l[I+56>>2]))break;if((0|T)==(0|l[I+108>>2])){st=166;break i}}}while(0);mt(n,2,7948,lt),l[B>>2]=0,st=166}else st=166}while(0);if(166==(0|st)&&(st=0,P=0|l[j>>2]),!P)break;I=0|l[Z>>2],T=0;do{0|l[I+(52*T|0)+32>>2]||(l[(0|l[N>>2])+(1080*T|0)+1076>>2]=1<<(0|l[I+(52*T|0)+24>>2])-1),T=T+1|0}while(T>>>0<P>>>0);O=0,st=172}}while(0);if(172==(0|st))for(;;){if(st=0,G=(F=0|l[N>>2])+(1080*O|0)|0,P=1&l[H>>2],l[G>>2]=P,R=0|l[p>>2],l[(B=F+(1080*O|0)+4|0)>>2]=R,(0|(T=0|l[Y>>2]))>1)for(I=T,T=0;T=T+1|0,I>>>0>3;)I>>>=1;else T=0;if(l[F+(1080*O|0)+8>>2]=T,(0|(T=0|l[X>>2]))>1)for(I=T,T=0;T=T+1|0,I>>>0>3;)I>>>=1;else T=0;l[F+(1080*O|0)+12>>2]=T,l[F+(1080*O|0)+16>>2]=l[J>>2],ot=0|l[Q>>2],l[F+(1080*O|0)+20>>2]=0==(0|ot)&1,l[F+(1080*O|0)+24>>2]=0|ot?2:0,l[F+(1080*O|0)+804>>2]=2,T=(0|O)==(0|l[q>>2])?0|l[K>>2]:0,l[F+(1080*O|0)+808>>2]=T;do{if(P){if(!((0|R)>0))break;for(L=0;;){B=R,R=R+-1|0,T=0|l[$>>2];do{if((0|L)<(0|T)){T=0|l[e+5624+(L<<2)>>2];do{if((0|T)<1)T=1;else{if(1==(0|T)){T=0;break}for(I=T,T=0;T=T+1|0,I>>>0>3;)I>>>=1}}while(0);if(l[F+(1080*O|0)+812+(R<<2)>>2]=T,(0|(T=0|l[e+5756+(L<<2)>>2]))<1){T=1;break}if(1==(0|T)){T=0;break}for(I=T,T=0;T=T+1|0,I>>>0>3;)I>>>=1}else{I=L-(ot=T+-1|0)|0,T=l[e+5624+(ot<<2)>>2]>>I,I=l[e+5756+(ot<<2)>>2]>>I;do{if((0|T)<1)T=1;else{if(1==(0|T)){T=0;break}for(P=T,T=0;T=T+1|0,P>>>0>3;)P>>>=1}}while(0);if(l[F+(1080*O|0)+812+(R<<2)>>2]=T,(0|I)<1){T=1;break}if(1==(0|I)){T=0;break}for(T=0;T=T+1|0,I>>>0>3;)I>>>=1}}while(0);if(l[F+(1080*O|0)+944+(R<<2)>>2]=T,(0|B)<=1)break;L=L+1|0}}else{if(!R)break;T=0;do{l[F+(1080*O|0)+812+(T<<2)>>2]=15,l[F+(1080*O|0)+944+(T<<2)>>2]=15,T=T+1|0}while(T>>>0<(0|l[B>>2])>>>0)}}while(0);if(Li(G,0|l[(0|l[Z>>2])+(52*O|0)+24>>2]),(O=O+1|0)>>>0>=(0|l[j>>2])>>>0)break;st=172}if((z=z+1|0)>>>0>=(0|C(0|l[f>>2],0|l[d>>2]))>>>0)break t}if(141==(0|st))return mt(n,1,7591,_),w=E,0|(lt=0);if(144==(0|st))return mt(n,1,7655,y),w=E,0|(lt=0);if(146==(0|st))return jt(P),mt(n,1,7698,b),w=E,0|(lt=0);if(148==(0|st))return jt(P),mt(n,1,7756,v),w=E,0|(lt=0);if(150==(0|st))return jt(P),mt(n,1,7816,x),w=E,0|(lt=0);if(152==(0|st))return jt(P),mt(n,1,7864,A),w=E,0|(lt=0);if(158==(0|st))return mt(n,1,7914,S),w=E,0|(lt=0)}else k=e+18696|0}while(0);return(T=0|l[k>>2])?(jt(T),l[k>>2]=0,w=E,0|(lt=1)):(w=E,0|(lt=1))}function Kt(t,e){e|=0;var i,n,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,_=0,g=0;if(2!=(0|l[16+(t|=0)>>2]))return 0|(t=1);f=t+5604|0,a=0|l[(g=t+5616|0)>>2],p=t+5620|0;do{if(0|l[f>>2]){do{if((0|a)==(0|l[p>>2])){if(a=a+10|0,l[p>>2]=a,0|(a=0|Wt(0|l[(o=t+5612|0)>>2],20*a|0))){l[o>>2]=a,Ir(a+(20*(_=0|l[g>>2])|0)|0,0,20*((0|l[p>>2])-_|0)|0),a=0|l[g>>2];break}return jt(0|l[o>>2]),l[o>>2]=0,l[p>>2]=0,l[g>>2]=0,0|(t=0)}o=t+5612|0}while(0);if(s=(u=0|l[o>>2])+(20*a|0)|0,0|(o=0|l[(d=u+(20*a|0)+12|0)>>2])&&(jt(o),l[d>>2]=0),l[u+(20*a|0)+8>>2]=1,l[u+(20*a|0)+4>>2]=1,l[s>>2]=2,o=0|l[e+16>>2],h=0|zt(c=(o=0|C(o,o))<<2),l[d>>2]=h,h){ro[15&l[768+(l[s>>2]<<2)>>2]](0|l[f>>2],h,o),l[u+(20*a|0)+16>>2]=c,a=1+(0|l[g>>2])|0,l[g>>2]=a,c=2;break}return 0|(t=0)}c=1,s=0}while(0);do{if((0|a)==(0|l[p>>2])){if(a=a+10|0,l[p>>2]=a,0|(a=0|Wt(0|l[(o=t+5612|0)>>2],20*a|0))){l[o>>2]=a,Ir(0|(a=a+(20*(_=0|l[g>>2])|0)|0),0,20*((0|l[p>>2])-_|0)|0),s=0==(0|s)?0:a+-20|0,a=0|l[g>>2];break}return jt(0|l[o>>2]),l[o>>2]=0,l[p>>2]=0,l[g>>2]=0,0|(t=0)}o=t+5612|0}while(0);if(_=(p=0|l[o>>2])+(20*a|0)|0,0|(o=0|l[(i=p+(20*a|0)+12|0)>>2])&&(jt(o),l[i>>2]=0),n=c+1|0,l[p+(20*a|0)+8>>2]=c,l[p+(20*a|0)+4>>2]=2,l[_>>2]=2,f=0|zt(d=(u=0|l[(e=e+16|0)>>2])<<2),l[i>>2]=f,!f)return 0|(t=0);if(!(f=0|zt(d)))return jt(0|l[i>>2]),l[i>>2]=0,0|(t=0);if(0|u)for(o=0,c=0|l[t+5584>>2],h=f;m[h>>2]=+(0|l[c+1076>>2]),(0|(o=o+1|0))!=(0|u);)c=c+1080|0,h=h+4|0;ro[15&l[768+(l[_>>2]<<2)>>2]](f,0|l[i>>2],u),jt(f),l[p+(20*a|0)+16>>2]=d,l[g>>2]=1+(0|l[g>>2]),o=0|l[(h=t+5628|0)>>2],c=t+5632|0;do{if((0|o)==(0|l[c>>2])){if(o=o+10|0,l[c>>2]=o,0|(o=0|Wt(0|l[(a=t+5624|0)>>2],20*o|0))){l[a>>2]=o,Ir(o+(20*(t=0|l[h>>2])|0)|0,0,20*((0|l[c>>2])-t|0)|0),o=0|l[h>>2];break}return jt(0|l[a>>2]),l[a>>2]=0,l[c>>2]=0,l[h>>2]=0,0|(t=0)}a=t+5624|0}while(0);return t=0|l[a>>2],l[t+(20*o|0)+8>>2]=s,r[(g=t+(20*o|0)+16|0)>>0]=1|r[g>>0],l[t+(20*o|0)+4>>2]=l[e>>2],l[t+(20*o|0)>>2]=n,l[t+(20*o|0)+12>>2]=_,l[h>>2]=1+(0|l[h>>2]),0|(t=1)}function $t(t,e,i){return 1}function te(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r=0,o=0,a=0,s=0,c=0,h=0;if(c=0|bt(),l[(h=e+80|0)>>2]=c,!c)return 0|(h=0);if(0|gi(0|l[(r=e+192|0)>>2],24,n)&&0|gi(0|l[r>>2],25,n)){if(c=0|yi(s=0|l[r>>2]),r=0|bi(s),c){for(o=1,a=0;o=o?0!=(0|Qr[63&l[r>>2]](e,t,n)):0,(0|(a=a+1|0))!=(0|c);)r=r+4|0,o&=1;if(vi(s),!o)return yt(0|l[h>>2]),l[h>>2]=0,0|(h=0)}else vi(s);if(0|gi(0|l[(r=e+188|0)>>2],26,n)&&0|gi(0|l[r>>2],27,n)){if(c=0|yi(s=0|l[r>>2]),r=0|bi(s),c){for(o=1,a=0;o=o?0!=(0|Qr[63&l[r>>2]](e,t,n)):0,(0|(a=a+1|0))!=(0|c);)r=r+4|0,o&=1;if(vi(s),!o)return yt(0|l[h>>2]),l[h>>2]=0,0|(h=0)}else vi(s);if(r=0|bt(),l[i>>2]=r,!r)return 0|(h=0);if(vt(0|l[h>>2],r),o=0|C(0|l[e+116>>2],0|l[e+112>>2]),l[36+(0|l[(s=e+196|0)>>2])>>2]=o,o=0|Ut(o,40),r=0|l[s>>2],l[r+40>>2]=o,!o)return 0|(h=0);if(!(0|l[r+36>>2]))return 0|(h=1);for(a=0;;){if(l[o+(40*a|0)+28>>2]=100,l[o+(40*a|0)+20>>2]=0,h=0|Ut(100,24),r=0|l[s>>2],o=0|l[r+40>>2],l[o+(40*a|0)+24>>2]=h,a=a+1|0,!h){r=0,o=30;break}if(a>>>0>=(0|l[r+36>>2])>>>0){r=1,o=30;break}}if(30==(0|o))return 0|r}return yt(0|l[h>>2]),l[h>>2]=0,0|(h=0)}return yt(0|l[h>>2]),l[h>>2]=0,0|(h=0)}function ee(t,e,i,n,r){e|=0,i|=0,n|=0,r|=0;var o,a,s,c,h,u=0,d=0;if(h=w,w=w+32|0,o=h+8|0,s=h+20|0,t=16==(0|l[8+(t|=0)>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],c=0|l[t+5584>>2],!(t=0|l[n>>2]))return mt(r,1,10568,h),w=h,0|(e=0);l[n>>2]=t+-1,nt(i,s,1),i=i+1|0,u=31&(t=0|l[s>>2]),l[(a=c+(1080*e|0)+24|0)>>2]=u,l[c+(1080*e|0)+804>>2]=t>>>5;do{if(1==(0|u))t=1,d=8;else{if((t=(0|l[n>>2])>>>(0!=(0|u)&1))>>>0>97&&(l[o>>2]=t,l[o+4>>2]=97,l[o+8>>2]=97,mt(r,2,10604,o),u=0|l[a>>2]),r=0==(0|t),0|u){if(r){t=0,d=20;break}d=8;break}if(!r)for(u=0;nt(i,s,1),u>>>0<97&&(l[c+(1080*e|0)+28+(u<<3)>>2]=(0|l[s>>2])>>>3,l[c+(1080*e|0)+28+(u<<3)+4>>2]=0),(0|(u=u+1|0))!=(0|t);)i=i+1|0;t=(0|l[n>>2])-t|0}}while(0);if(8==(0|d))for(u=0;;){if(nt(i,s,2),u>>>0<97&&(d=0|l[s>>2],l[c+(1080*e|0)+28+(u<<3)>>2]=d>>>11,l[c+(1080*e|0)+28+(u<<3)+4>>2]=2047&d),(0|(u=u+1|0))==(0|t)){d=20;break}i=i+2|0}if(20==(0|d)&&(t=(0|l[n>>2])-(t<<1)|0),l[n>>2]=t,1!=(0|l[a>>2]))return w=h,0|(e=1);i=c+(1080*e|0)+28|0,u=c+(1080*e|0)+32|0,t=1;do{n=(0|l[i>>2])-(((t+-1|0)>>>0)/3|0)|0,l[c+(1080*e|0)+28+(t<<3)>>2]=(0|n)>0?n:0,l[c+(1080*e|0)+28+(t<<3)+4>>2]=l[u>>2],t=t+1|0}while(97!=(0|t));return w=h,0|(t=1)}function ie(t,e,i,n,r){e|=0,i|=0,n|=0,r|=0;var o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0;if(u=w,w=w+64|0,h=u+48|0,o=u+40|0,m=u+16|0,p=u+8|0,c=u+52|0,d=16==(0|l[(f=8+(t|=0)|0)>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],a=0|l[d+5584>>2],(0|l[n>>2])>>>0<5)return mt(r,1,11008,u),w=u,0|(n=0);if(nt(i,s=a+(1080*e|0)+4|0,1),d=1+(0|l[s>>2])|0,l[s>>2]=d,d>>>0>33)return l[p>>2]=d,l[p+4>>2]=33,mt(r,1,11043,p),w=u,0|(n=0);if((0|l[t+168>>2])>>>0>=d>>>0)return l[m>>2]=e,mt(r,1,11120,m),l[f>>2]=32768|l[f>>2],w=u,0|(n=0);if(nt(i+1|0,p=a+(1080*e|0)+8|0,1),l[p>>2]=2+(0|l[p>>2]),nt(i+2|0,f=a+(1080*e|0)+12|0,1),m=2+(0|l[f>>2])|0,l[f>>2]=m,m>>>0>10|(p=0|l[p>>2])>>>0>10|(p+m|0)>>>0>12)return mt(r,1,11278,u+24|0),w=u,0|(n=0);if(nt(i+3|0,m=a+(1080*e|0)+16|0,1),192&l[m>>2]|0)return mt(r,1,11346,u+32|0),w=u,0|(n=0);if(nt(i+4|0,a+(1080*e|0)+20|0,1),d=(0|l[n>>2])-5|0,l[n>>2]=d,t=0|l[s>>2],!(1&l[a+(1080*e|0)>>2])){if(!t)return w=u,0|(n=1);d=0;do{l[a+(1080*e|0)+812+(d<<2)>>2]=15,l[a+(1080*e|0)+944+(d<<2)>>2]=15,d=d+1|0}while(d>>>0<(0|l[s>>2])>>>0);return w=u,0|(d=1)}if(d>>>0<t>>>0)return mt(r,1,11008,o),w=u,0|(n=0);do{if(t){for(p=0,f=i+5|0;nt(f,c,1),f=f+1|0,d=0|l[c>>2],!(0|p&&d>>>0<16|0==(15&d|0));)if(l[a+(1080*e|0)+812+(p<<2)>>2]=15&d,l[a+(1080*e|0)+944+(p<<2)>>2]=d>>>4,(p=p+1|0)>>>0>=(t=0|l[s>>2])>>>0){_=24;break}if(24==(0|_)){d=0|l[n>>2];break}return mt(r,1,11413,h),w=u,0|(n=0)}t=0}while(0);return l[n>>2]=d-t,w=u,0|(n=1)}function ne(t,e,i,n,o,s,c,h,u,d,f){t|=0,e|=0,i|=0,n|=0,o|=0,s|=0,c|=0,h|=0,u|=0,d|=0,f|=0;var p,m,_,g,y,b,v,x,A,M,E,T,k,I,P,R,B,L,D,O,F,G,N,z,U,H,V,W,j,Z,Y,X,J,Q,q,K,$,tt=0,et=0,it=0,rt=0,ot=0,at=0,st=0,ct=0,_t=0,gt=0,yt=0,bt=0,vt=0,wt=0,xt=0,At=0,St=0,Mt=0,Et=0,Tt=0,kt=0,Ct=0,It=0,Pt=0,Rt=0,Bt=0,Lt=0,Dt=0,Ot=0,Ft=0;switch($=w,w=w+256|0,K=$+200|0,q=$+192|0,J=$+184|0,X=$+176|0,W=$+168|0,V=$+160|0,H=$+152|0,U=$+144|0,z=$+136|0,N=$+128|0,F=$+120|0,O=$+112|0,D=$+104|0,L=$+96|0,B=$+88|0,R=$+80|0,P=$+72|0,I=$+64|0,k=$+56|0,T=$+48|0,Y=$+40|0,Z=$+32|0,j=$+24|0,G=$+16|0,E=$+8|0,M=$,p=$+240|0,m=$+236|0,_=$+232|0,g=$+228|0,y=$+224|0,b=$+220|0,v=$+216|0,A=$+208|0,l[(x=$+212|0)>>2]=65424,0|l[(Q=t+8|0)>>2]){case 256:l[x>>2]=65497,tt=t+76|0;break;case 8:if(!(1&r[(tt=t+76|0)>>0])){xt=t+164|0,At=t+200|0,St=t+72|0,Mt=t+24|0,Et=t+196|0,Tt=t+112|0,It=t+116|0,Pt=p+2|0,Rt=p+6|0,Bt=p+7|0,Lt=t+16|0,Dt=t+20|0,Ot=t+64|0,et=65424;t:do{e:do{if(65427!=(0|et)){for(;;){if(0==(0|(bt=0|ut(d)))&0==(0|S)){vt=50;break}if(2!=(0|lt(d,0|l[Lt>>2],2,f))){vt=8;break t}if(nt(0|l[Lt>>2],A,2),(0|l[A>>2])>>>0<2){vt=10;break t}if(32896==(0|l[x>>2])&&0==(0|(bt=0|ut(d)))&0==(0|S)){vt=50;break}for(rt=0|l[Q>>2],et=0|l[A>>2],16&rt|0&&(l[Mt>>2]=-2-et+(0|l[Mt>>2])),it=et+-2|0,l[A>>2]=it,et=0|l[x>>2],yt=784;!(0==(0|(bt=0|l[yt>>2]))|(0|bt)==(0|et));)yt=yt+12|0;if(!(l[yt+4>>2]&rt)){vt=18;break t}if(it>>>0>(0|l[Dt>>2])>>>0){if(bt=0|ut(d),(0|(gt=S))<0|0==(0|gt)&bt>>>0<it>>>0){vt=22;break t}if(!(et=0|Wt(0|l[Lt>>2],0|l[A>>2]))){vt=24;break t}l[Lt>>2]=et,it=0|l[A>>2],l[Dt>>2]=it}else et=0|l[Lt>>2];if((0|(et=0|lt(d,et,it,f)))!=(0|l[A>>2])){vt=27;break t}if(!(it=0|l[yt+8>>2])){vt=29;break t}if(!(0|qr[63&it](t,0|l[Lt>>2],et,f))){vt=31;break t}if(st=0|l[At>>2],at=0|l[Et>>2],ct=0|l[yt>>2],_t=(_t=0|ht(d))-(gt=0|l[A>>2])-4|0,gt=gt+4|0,ot=0|l[(at=at+40|0)>>2],(1+(et=0|l[ot+(40*st|0)+20>>2])|0)>>>0>(rt=0|l[(it=ot+(40*st|0)+28|0)>>2])>>>0){if(rt=~~(+(rt>>>0)+100)>>>0,l[it>>2]=rt,it=0|Wt(0|l[ot+(40*st|0)+24>>2],24*rt|0),et=(rt=0|l[at>>2])+(40*st|0)+24|0,!it){vt=39;break t}l[et>>2]=it,at=rt,et=0|l[rt+(40*st|0)+20>>2]}else at=ot,it=0|l[ot+(40*st|0)+24>>2];a[it+(24*et|0)>>1]=ct,l[(bt=it+(24*et|0)+8|0)>>2]=_t,l[bt+4>>2]=((0|_t)<0)<<31>>31,l[it+(24*et|0)+16>>2]=gt,l[at+(40*st|0)+20>>2]=et+1,65424==(0|ct)&&0|(wt=0|l[at+(40*st|0)+16>>2])&&(bt=wt+(24*(0|l[at+(40*st|0)+12>>2])|0)|0,l[bt>>2]=_t,l[bt+4>>2]=0);do{if(65424==(0|l[yt>>2])){if(et=0|ht(d),et=-4-(0|l[A>>2])+et|0,!((0|(yt=0|l[(bt=Ot)+4>>2]))<0|(0==(0|yt)?(0|l[bt>>2])>>>0<et>>>0:0)))break;l[(bt=Ot)>>2]=et,l[bt+4>>2]=0}}while(0);if(4&r[tt>>0])break;if(2!=(0|lt(d,0|l[Lt>>2],2,f))){vt=48;break t}if(nt(0|l[Lt>>2],x,2),65427==(0|l[x>>2]))break e}if(50==(0|vt)){vt=0,l[Q>>2]=64;break}if(bt=0|dt(d,0|l[Mt>>2],0,f),0!=(0|S)||(0|bt)!=(0|l[Mt>>2])){vt=45;break t}l[x>>2]=65427}}while(0);if(0==(0|(bt=0|ut(d)))&0==(0|S)&&64==(0|l[Q>>2])){vt=114;break}if(4&(et=0|r[tt>>0])){if(r[tt>>0]=-6&et,l[Q>>2]=8,2!=(0|lt(d,0|l[Lt>>2],2,f))){vt=112;break}nt(0|l[Lt>>2],x,2)}else{it=0|l[xt>>2],rt=0|l[At>>2],0|l[St>>2]?(et=0|br(0|(et=0|ut(d)),0|S,-2,0),vt=57):(et=0|l[Mt>>2])>>>0>1&&(et=et+-2|0,vt=57),57==(0|vt)&&(vt=0,l[Mt>>2]=et),bt=it+(5640*rt|0)+5592|0,yt=it+(5640*rt|0)+5596|0;do{if(et){if(gt=0|ut(d),(0|(_t=S))<0|0==(0|_t)&gt>>>0<et>>>0&&mt(f,2,12386,B),!(et=0|l[bt>>2])){if(gt=0|zt(0|l[Mt>>2]),l[bt>>2]=gt,gt){_t=0;break}vt=66;break t}if(!(et=0|Wt(et,(0|l[Mt>>2])+(0|l[yt>>2])|0))){vt=64;break t}l[bt>>2]=et,_t=0}else _t=1}while(0);if(0|(et=0|l[Et>>2])){if(gt=0|br(0|(Ft=0|ht(d)),0|(rt=S),-2,-1),ot=0|l[(at=et+40|0)>>2],st=0|l[At>>2],ct=0|l[ot+(40*st|0)+12>>2],it=0|l[ot+(40*st|0)+16>>2],l[(et=it+(24*ct|0)+8|0)>>2]=gt,l[et+4>>2]=S,et=0|br(0|Ft,0|rt,0|l[Mt>>2],0),l[(ct=it+(24*ct|0)+16|0)>>2]=et,l[ct+4>>2]=S,ct=2+(0|l[Mt>>2])|0,(1+(et=0|l[ot+(40*st|0)+20>>2])|0)>>>0>(rt=0|l[(it=ot+(40*st|0)+28|0)>>2])>>>0){if(rt=~~(+(rt>>>0)+100)>>>0,l[it>>2]=rt,it=0|Wt(0|l[ot+(40*st|0)+24>>2],24*rt|0),et=(rt=0|l[at>>2])+(40*st|0)+24|0,!it){vt=73;break}l[et>>2]=it,at=rt,et=0|l[rt+(40*st|0)+20>>2]}else at=ot,it=0|l[ot+(40*st|0)+24>>2];a[it+(24*et|0)>>1]=-109,gt=0|Mr(0,0|gt,32),l[(Ft=it+(24*et|0)+8|0)>>2]=gt,l[Ft+4>>2]=S,l[it+(24*et|0)+16>>2]=ct,l[at+(40*st|0)+20>>2]=et+1}if(et=_t?0:0|lt(d,(0|l[bt>>2])+(0|l[yt>>2])|0,0|l[Mt>>2],f),l[Q>>2]=(0|et)!=(0|l[Mt>>2])?64:8,l[yt>>2]=(0|l[yt>>2])+et,1==(9&(et=0|r[tt>>0]))){r[tt>>0]=8|et,it=0|l[At>>2];do{if(0==(0|pt(d))||-1==(0|(kt=0|ht(d)))&-1==(0|(Ct=S)))et=1,it=0;else{for(;;){if(2!=(0|lt(d,p,2,f))){vt=80;break}if(nt(p,m,2),65424!=(0|l[m>>2])){vt=82;break}if(2!=(0|lt(d,p,2,f))){vt=84;break}if(nt(p,_,2),10!=(0|l[_>>2])){vt=86;break}if(l[_>>2]=8,(0|(et=0|lt(d,p,8,f)))!=(0|l[_>>2])){vt=88;break}if(8!=(0|et)){vt=90;break}if(nt(p,g,2),nt(Pt,y,4),nt(Rt,b,1),nt(Bt,v,1),(0|l[g>>2])==(0|it)){vt=96;break}if((et=0|l[y>>2])>>>0<14){vt=93;break}if(Ft=et+-12|0,l[y>>2]=Ft,Ft=0|dt(d,Ft,0,f),0!=(0|S)||(0|Ft)!=(0|l[y>>2])){vt=95;break}}if(80==(0|vt)){vt=0,et=0!=(0|ft(d,kt,Ct,f)),it=0;break}if(82==(0|vt)){vt=0,et=0!=(0|ft(d,kt,Ct,f)),it=0;break}if(84==(0|vt)){vt=0,mt(f,1,8150,O),et=0,it=0;break}if(86==(0|vt)){vt=0,mt(f,1,12203,F),et=0,it=0;break}if(88==(0|vt)){vt=0,mt(f,1,8150,N),et=0,it=0;break}if(90==(0|vt)){vt=0,mt(f,1,11669,z),et=0,it=0;break}if(93==(0|vt)){vt=0,et=0!=(0|ft(d,kt,Ct,f)),it=0;break}if(95==(0|vt)){vt=0,et=0!=(0|ft(d,kt,Ct,f)),it=0;break}if(96==(0|vt)){vt=0,it=(0|l[b>>2])==(0|l[v>>2])&1,et=0!=(0|ft(d,kt,Ct,f));break}}}while(0);if(!et){vt=98;break}if(0|it){if(it=0|C(0|l[It>>2],0|l[Tt>>2]),r[tt>>0]=-18&r[tt>>0]|16,0|it){rt=0|l[xt>>2],et=0;do{0|(at=0|l[(ot=rt+(5640*et|0)+5588|0)>>2])&&(l[ot>>2]=at+1),et=et+1|0}while((0|et)!=(0|it))}mt(f,2,12521,H)}}if(!(1&r[tt>>0])){if(2!=(0|lt(d,0|l[Lt>>2],2,f))){vt=108;break}nt(0|l[Lt>>2],x,2)}}et=0|l[x>>2]}while(65497!=(0|et)&0==(1&r[tt>>0]));switch(0|vt){case 8:return mt(f,1,8150,M),w=$,0|(Ft=0);case 10:return mt(f,1,12203,E),w=$,0|(Ft=0);case 18:return mt(f,1,8235,G),w=$,0|(Ft=0);case 22:return mt(f,1,12229,j),w=$,0|(Ft=0);case 24:return jt(0|l[Lt>>2]),l[Lt>>2]=0,l[Dt>>2]=0,mt(f,1,8333,Z),w=$,0|(Ft=0);case 27:return mt(f,1,8150,Y),w=$,0|(Ft=0);case 29:return mt(f,1,12274,T),w=$,0|(Ft=0);case 31:return l[k>>2]=l[x>>2],mt(f,1,12303,k),w=$,0|(Ft=0);case 39:return jt(0|l[et>>2]),Ft=0|l[at>>2],l[Ft+(40*st|0)+24>>2]=0,l[Ft+(40*st|0)+28>>2]=0,l[Ft+(40*st|0)+20>>2]=0,mt(f,1,12350,I),w=$,0|(Ft=0);case 45:return mt(f,1,8150,P),w=$,0|(Ft=0);case 48:return mt(f,1,8150,R),w=$,0|(Ft=0);case 64:jt(0|l[bt>>2]),l[bt>>2]=0,vt=66;break;case 73:return jt(0|l[et>>2]),Ft=0|l[at>>2],l[Ft+(40*st|0)+24>>2]=0,l[Ft+(40*st|0)+28>>2]=0,l[Ft+(40*st|0)+20>>2]=0,mt(f,1,12350,D),w=$,0|(Ft=0);case 98:return mt(f,1,12475,U),w=$,0|(Ft=0);case 108:return mt(f,1,8150,V),w=$,0|(Ft=0);case 112:return mt(f,1,8150,W),w=$,0|(Ft=0);case 114:et=0|l[x>>2]}if(66==(0|vt))return mt(f,1,12441,L),w=$,0|(Ft=0);65497==(0|et)&&256!=(0|l[Q>>2])&&(l[t+200>>2]=0,l[Q>>2]=256)}break;default:return w=$,0|(Ft=0)}if(1&r[tt>>0])rt=tt=t+200|0,ot=0|l[t+164>>2],tt=0|l[tt>>2];else{it=0|C(0|l[t+112>>2],0|l[t+116>>2]),ot=0|l[t+164>>2],tt=0|l[(rt=t+200|0)>>2];t:do{if(tt>>>0<it>>>0)for(et=ot+(5640*tt|0)|0;;){if(0|l[et+5592>>2])break t;if(tt=tt+1|0,l[rt>>2]=tt,!(tt>>>0<it>>>0))break;et=et+5640|0}}while(0);if((0|tt)==(0|it))return l[u>>2]=0,w=$,0|(Ft=1)}if(2&r[ot+(5640*tt|0)+5636>>0]){if(at=0|l[(vt=ot+(5640*tt|0)+5160|0)>>2]){st=0|l[ot+(5640*tt|0)+5164>>2],it=0,et=0;do{et=(0|l[st+(it<<3)+4>>2])+et|0,it=it+1|0}while((0|it)!=(0|at))}else et=0;if(Ft=0|zt(et),l[(bt=ot+(5640*tt|0)+5172|0)>>2]=Ft,!Ft)return mt(f,1,9491,X),mt(f,1,12562,J),w=$,0|(Ft=0);if(l[(yt=ot+(5640*tt|0)+5180|0)>>2]=et,gt=ot+(5640*tt|0)+5164|0,it=0|l[vt>>2])for(_t=0,st=0,ct=et=0|l[gt>>2];(at=0|l[ct+(_t<<3)>>2])?(Cr((0|l[bt>>2])+st|0,0|at,0|l[ct+(_t<<3)+4>>2]),at=0|l[gt>>2],st=(0|l[at+(_t<<3)+4>>2])+st|0,jt(0|l[at+(_t<<3)>>2]),at=0|l[gt>>2],l[at+(_t<<3)>>2]=0,l[at+(_t<<3)+4>>2]=0,it=0|l[vt>>2],et=at):at=ct,!((_t=_t+1|0)>>>0>=it>>>0);)ct=at;else et=0|l[gt>>2];l[vt>>2]=0,jt(et),l[gt>>2]=0,l[ot+(5640*tt|0)+5168>>2]=l[bt>>2],l[ot+(5640*tt|0)+5176>>2]=l[yt>>2]}return 0|function(t,e,i){return 0|ii(t|=0,e|=0,0,.5,56,i|=0)}(0|l[(tt=t+204|0)>>2],0|l[rt>>2],f)?(Ft=0|C(0|l[t+112>>2],0|l[t+116>>2]),l[K>>2]=1+(0|l[rt>>2]),l[K+4>>2]=Ft,mt(f,4,12588,K),l[e>>2]=l[rt>>2],l[u>>2]=1,Ft=0|function(t){var e=0,i=0,n=0,r=0,o=0,a=0;if(e=0|l[24+(t|=0)>>2],!(r=0|l[e+16>>2]))return 0|(r=0);for(n=0|l[20+(0|l[l[t+20>>2]>>2])>>2],e=0|l[e+24>>2],t=0,i=0;a=((a=0|l[e+24>>2])>>>3)+(0!=(7&a|0)&1)|0,o=(0|l[n+24>>2])+(136*(0|l[n+20>>2])|0)-136|0,t=(0|C(0|C(3==(0|a)?4:a,(0|l[o+8>>2])-(0|l[o>>2])|0),(0|l[o+12>>2])-(0|l[o+4>>2])|0))+t|0,!((i=i+1|0)>>>0>=r>>>0);)n=n+52|0,e=e+52|0;return 0|t}(0|l[tt>>2]),l[i>>2]=Ft,Ft=0|l[l[20+(0|l[tt>>2])>>2]>>2],l[n>>2]=l[Ft>>2],l[o>>2]=l[Ft+4>>2],l[s>>2]=l[Ft+8>>2],l[c>>2]=l[Ft+12>>2],l[h>>2]=l[Ft+16>>2],l[Q>>2]=128|l[Q>>2],w=$,0|(Ft=1)):(mt(f,1,8019,q),w=$,0|(Ft=0))}function re(t,e,i,n,o,a){e|=0,i|=0,n|=0,o|=0,a|=0;var s,c,h,u,d,f,p,m,_=0,g=0,y=0;if(m=w,w=w+48|0,f=m+28|0,p=m+32|0,!(128&l[(y=8+(t|=0)|0)>>2]))return w=m,0|(y=0);if((0|l[(d=t+200|0)>>2])!=(0|e))return w=m,0|(y=0);if(s=(_=0|l[t+164>>2])+(5640*e|0)|0,!(c=0|l[(g=_+(5640*e|0)+5592|0)>>2]))return Jt(s),w=m,0|(y=0);if(u=_+(5640*e|0)+5596|0,!(0|ri(0|l[(h=t+204|0)>>2],c,0|l[u>>2],e,0|l[t+196>>2],a)))return Jt(s),l[y>>2]=32768|l[y>>2],mt(a,1,12627,m),w=m,0|(y=0);if(!(0|oi(0|l[h>>2],i,n)))return w=m,0|(y=0);if(0|(_=0|l[g>>2])&&(jt(_),l[g>>2]=0,l[u>>2]=0),r[(t=t+76|0)>>0]=-2&r[t>>0],l[y>>2]=-129&l[y>>2],t=0|ut(o),256==(0|(g=0|l[y>>2]))|0==(0|t)&0==(0|S)&64==(0|g))return w=m,0|(y=1);if(2!=(0|lt(o,p,2,a)))return mt(a,2,12646,m+8|0),w=m,0|(y=1);switch(nt(p,f,2),0|l[f>>2]){case 65497:return l[d>>2]=0,l[y>>2]=256,w=m,0|(y=1);case 65424:return w=m,0|(y=1);default:return 0==(0|ut(o))&0==(0|S)?(l[y>>2]=64,mt(a,2,12690,m+16|0),w=m,0|(y=1)):(mt(a,1,12720,m+24|0),w=m,0|(y=0))}return 0}function oe(t,e,i,n,o,a,s){e|=0,i|=0,n|=0,o|=0,a|=0,s|=0;var c,h,u,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,M=0,E=0;if(u=w,w=w+112|0,E=u+96|0,h=u+88|0,c=u+80|0,M=u+72|0,A=u+64|0,x=u+56|0,b=u+48|0,_=u+40|0,m=u+32|0,p=u+24|0,f=u+16|0,y=0|l[80+(t|=0)>>2],8!=(0|l[t+8>>2]))return mt(s,1,12752,u),w=u,0|(E=0);if(!(n|i|o|a))return mt(s,4,12831,u+8|0),l[t+28>>2]=0,l[t+32>>2]=0,l[t+36>>2]=l[t+112>>2],l[t+40>>2]=l[t+116>>2],w=u,0|(E=1);if((d=0|l[(v=y+8|0)>>2])>>>0<i>>>0)return l[f>>2]=i,l[f+4>>2]=d,mt(s,1,12900,f),w=u,0|(E=0);if((d=0|l[y>>2])>>>0>i>>>0?(l[p>>2]=i,l[p+4>>2]=d,mt(s,2,12987,p),l[t+28>>2]=0,i=0|l[y>>2]):l[t+28>>2]=((i-(0|l[t+92>>2])|0)>>>0)/((0|l[t+100>>2])>>>0)|0,l[e>>2]=i,(i=0|l[(g=y+12|0)>>2])>>>0<n>>>0)return l[m>>2]=n,l[m+4>>2]=i,mt(s,1,13075,m),w=u,0|(E=0);if((i=0|l[(f=y+4|0)>>2])>>>0>n>>>0?(l[_>>2]=n,l[_+4>>2]=i,mt(s,2,13160,_),l[t+32>>2]=0,i=0|l[f>>2]):(l[t+32>>2]=((n-(0|l[t+96>>2])|0)>>>0)/((0|l[t+104>>2])>>>0)|0,i=n),l[(p=e+4|0)>>2]=i,(i=0|l[y>>2])>>>0>o>>>0)return l[b>>2]=o,l[b+4>>2]=i,mt(s,1,13246,b),w=u,0|(E=0);if((i=0|l[v>>2])>>>0<o>>>0?(l[x>>2]=o,l[x+4>>2]=i,mt(s,2,13335,x),l[t+36>>2]=l[t+112>>2],o=0|l[v>>2]):(x=0|l[t+100>>2],l[t+36>>2]=(o+-1-(0|l[t+92>>2])+x|0)/(0|x)|0),l[(d=e+8|0)>>2]=o,(o=0|l[f>>2])>>>0>a>>>0)return l[A>>2]=a,l[A+4>>2]=o,mt(s,1,13423,A),w=u,0|(E=0);(o=0|l[g>>2])>>>0<a>>>0?(l[M>>2]=a,l[M+4>>2]=o,mt(s,2,13513,M),l[t+40>>2]=l[t+116>>2],a=0|l[g>>2]):(M=0|l[t+104>>2],l[t+40>>2]=(a+-1-(0|l[t+96>>2])+M|0)/(0|M)|0),l[(M=e+12|0)>>2]=a,r[(A=t+76|0)>>0]=2|r[A>>0],A=0|l[e+16>>2],t=0|l[e>>2];t:do{if(A){for(x=(i=0|l[p>>2])-1|0,b=(o=0|l[d>>2])-1|0,v=t+-1|0,y=0,g=0|l[e+24>>2];;){if(_=(v+(e=0|l[g>>2])|0)/(0|e)|0,l[g+16>>2]=_,f=(x+(d=0|l[g+4>>2])|0)/(0|d)|0,l[g+20>>2]=f,e=(b+e|0)/(0|e)|0,m=0|Tr(1,0,0|(p=0|l[g+40>>2])),n=S,(0|(_=(e=0|Mr(0|(e=0|br(0|(e=0|br(0|e,((0|e)<0)<<31>>31|0,-1,-1)),0|S,0|m,0|n)),0|S,0|p))-(_=0|Mr(0|(_=0|br(0|(_=0|br(0|_,((0|_)<0)<<31>>31|0,-1,-1)),0|S,0|m,0|n)),0|S,0|p))|0))<0){d=29;break}if(e=(d+-1+(a=0|l[M>>2])|0)/(0|d)|0,l[g+8>>2]=_,(0|(f=(e=0|Mr(0|(e=0|br(0|(e=0|br(0|e,((0|e)<0)<<31>>31|0,-1,-1)),0|S,0|m,0|n)),0|S,0|p))-(f=0|Mr(0|(f=0|br(0|(f=0|br(0|f,((0|f)<0)<<31>>31|0,-1,-1)),0|S,0|m,0|n)),0|S,0|p))|0))<0){d=31;break}if(l[g+12>>2]=f,!((d=y+1|0)>>>0<A>>>0))break t;y=d,g=g+52|0}if(29==(0|d))return l[c>>2]=y,l[c+4>>2]=_,mt(s,1,13602,c),w=u,0|(E=0);if(31==(0|d))return l[h>>2]=y,l[h+4>>2]=f,mt(s,1,13671,h),w=u,0|(E=0)}else i=0|l[p>>2],o=0|l[d>>2],a=0|l[M>>2]}while(0);return l[E>>2]=t,l[E+4>>2]=i,l[E+8>>2]=o,l[E+12>>2]=a,mt(s,4,13740,E),w=u,0|(E=1)}function ae(){var t,e=0,i=0;if(!(t=0|Ut(1,208)))return 0|(e=0);if(l[t>>2]=1,r[(e=t+184|0)>>0]=2|r[e>>0],e=0|Ut(1,5640),l[t+12>>2]=e,!e)return Xt(t),0|(e=0);if(e=0|Ut(1,1e3),l[t+16>>2]=e,!e)return Xt(t),0|(e=0);l[t+20>>2]=1e3,l[t+60>>2]=-1,l[(e=t+64|0)>>2]=0,l[e+4>>2]=0,e=0|Ut(1,48);do{if(0|e){if(l[e+32>>2]=100,l[e+24>>2]=0,i=0|Ut(100,24),l[e+28>>2]=i,!i){jt(e);break}return l[e+40>>2]=0,l[t+196>>2]=e,i=0|mi(),l[t+192>>2]=i,i?(i=0|mi(),l[t+188>>2]=i,0|i?0|(i=t):(Xt(t),0|(i=0))):(Xt(t),0|(i=0))}}while(0);return l[t+196>>2]=0,Xt(t),0|(i=0)}function se(t,e,i){t|=0,i|=0;var n,r,o,a,s,c=0,h=0,u=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0;if(s=w,w=w+128|0,a=s+104|0,o=s+72|0,r=s+64|0,v=s+40|0,y=s+24|0,n=s+16|0,m=s+8|0,p=s,384&(e|=0)|0)return En(13778,11,1,i),void(w=s);if(1&e|0&&0|(f=0|l[t+80>>2])&&le(f,0,i),2&e|0&&0|l[(h=t+80|0)>>2]&&(En(13790,36,1,i),f=0|l[t+96>>2],l[p>>2]=l[t+92>>2],l[p+4>>2]=f,Wn(i,13827,p),p=0|l[t+104>>2],l[m>>2]=l[t+100>>2],l[m+4>>2]=p,Wn(i,13845,m),m=0|l[t+116>>2],l[n>>2]=l[t+112>>2],l[n+4>>2]=m,Wn(i,13863,n),ce(0|l[t+12>>2],0|l[16+(0|l[h>>2])>>2],i),En(13879,2,1,i)),8&e|0&&(_=0|C(0|l[t+112>>2],0|l[t+116>>2]),!(0==(0|(u=0|l[(g=t+80|0)>>2]))|0==(0|_)))&&(ce(c=0|l[t+164>>2],0|l[u+16>>2],i),1!=(0|_))){h=1;do{ce(c=c+5640|0,0|l[16+(0|l[g>>2])>>2],i),h=h+1|0}while((0|h)!=(0|_))}if(16&e){f=0|l[t+196>>2],En(13882,37,1,i),_=0|l[(e=f)+4>>2],g=0|l[(h=f+8|0)>>2],h=0|l[h+4>>2],l[(u=y)>>2]=l[e>>2],l[u+4>>2]=_,l[(u=y+8|0)>>2]=g,l[u+4>>2]=h,Wn(i,13920,y),En(13987,17,1,i),h=0|l[(u=f+28|0)>>2];t:do{if(0|h&&(b=f+24|0,0|l[b>>2]))for(c=0;;){if(e=0|l[(_=h+(24*c|0)+8|0)>>2],_=0|l[_+4>>2],y=0|l[h+(24*c|0)+16>>2],l[v>>2]=d[h+(24*c|0)>>1],l[(g=v+8|0)>>2]=e,l[g+4>>2]=_,l[v+16>>2]=y,Wn(i,14005,v),(c=c+1|0)>>>0>=(0|l[b>>2])>>>0)break t;h=0|l[u>>2]}}while(0);if(En(14036,4,1,i),0|(u=0|l[(m=f+40|0)>>2])&&0|(x=0|l[(A=f+36|0)>>2])){c=0,h=0;do{c=(0|l[u+(40*h|0)+4>>2])+c|0,h=h+1|0}while((0|h)!=(0|x));if(0|c){if(En(14041,16,1,i),0|l[A>>2]){p=0,c=0|l[m>>2];do{f=0|l[c+(40*p|0)+4>>2],l[r>>2]=p,l[r+4>>2]=f,Wn(i,14058,r),c=0|l[m>>2],u=0|l[c+(40*p|0)+16>>2];t:do{if(0!=(0|f)&0!=(0|u))for(h=0,c=u;;){if(_=0|l[(g=c+(24*h|0)|0)>>2],g=0|l[g+4>>2],y=0|l[(b=c+(24*h|0)+8|0)>>2],b=0|l[b+4>>2],v=0|l[(x=c+(24*h|0)+16|0)>>2],x=0|l[x+4>>2],l[o>>2]=h,l[(c=o+8|0)>>2]=_,l[c+4>>2]=g,l[(c=o+16|0)>>2]=y,l[c+4>>2]=b,l[(c=o+24|0)>>2]=v,l[c+4>>2]=x,Wn(i,14094,o),h=h+1|0,c=0|l[m>>2],(0|h)==(0|f))break t;c=0|l[c+(40*p|0)+16>>2]}}while(0);u=0|l[c+(40*p|0)+24>>2];t:do{if(0!=(0|u)&&0!=(0|l[c+(40*p|0)+20>>2]))for(h=0,c=u;;){if(b=0|l[(v=c+(24*h|0)+8|0)>>2],v=0|l[v+4>>2],x=0|l[c+(24*h|0)+16>>2],l[a>>2]=d[c+(24*h|0)>>1],l[(c=a+8|0)>>2]=b,l[c+4>>2]=v,l[a+16>>2]=x,Wn(i,14005,a),h=h+1|0,c=0|l[m>>2],h>>>0>=(0|l[c+(40*p|0)+20>>2])>>>0)break t;c=0|l[c+(40*p|0)+24>>2]}}while(0);p=p+1|0}while(p>>>0<(0|l[A>>2])>>>0)}En(14036,4,1,i)}}En(13879,2,1,i),w=s}else w=s}function le(t,e,i){t|=0,i|=0;var n,o,a,s,c,h,u=0,d=0,f=0;if(c=w,w=w+64|0,s=c+48|0,a=c+40|0,n=c+32|0,f=c+16|0,d=c,o=c+52|0,(e|=0)?(En(14455,36,1,0|l[665]),u=0):(En(14492,13,1,i),r[o>>0]=9,u=1),r[o+u>>0]=0,h=0|l[t>>2],u=0|l[t+4>>2],l[d>>2]=o,l[d+4>>2]=h,l[d+8>>2]=u,Wn(i,14506,d),u=0|l[t+8>>2],d=0|l[t+12>>2],l[f>>2]=o,l[f+4>>2]=u,l[f+8>>2]=d,Wn(i,14523,f),d=0|l[(f=t+16|0)>>2],l[n>>2]=o,l[n+4>>2]=d,Wn(i,14540,n),!(0|l[(d=t+24|0)>>2]))return En(13879,2,1,i),void(w=c);if(!(0|l[f>>2]))return En(13879,2,1,i),void(w=c);u=0;do{l[a>>2]=o,l[a+4>>2]=u,Wn(i,14556,a),he((0|l[d>>2])+(52*u|0)|0,e,i),l[s>>2]=o,Wn(i,14576,s),u=u+1|0}while(u>>>0<(0|l[f>>2])>>>0);En(13879,2,1,i),w=c}function ce(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p,m,_,g=0,y=0,b=0,v=0,x=0,A=0;if(_=w,w=w+128|0,m=_+120|0,p=_+112|0,f=_+104|0,d=_+96|0,u=_+88|0,h=_+80|0,c=_+72|0,s=_+64|0,a=_+56|0,o=_+48|0,r=_+40|0,n=_+32|0,v=_+24|0,b=_+16|0,y=_+8|0,g=_,t|=0){if(En(14160,17,1,i),l[g>>2]=l[t>>2],Wn(i,14178,g),l[y>>2]=l[t+4>>2],Wn(i,14191,y),l[b>>2]=l[t+8>>2],Wn(i,14203,b),l[v>>2]=l[t+16>>2],Wn(i,14220,v),(0|e)>0){b=t+5584|0,y=0;do{if(v=0|l[b>>2],l[n>>2]=y,Wn(i,14231,n),l[r>>2]=l[v+(1080*y|0)>>2],Wn(i,14245,r),g=v+(1080*y|0)+4|0,l[o>>2]=l[g>>2],Wn(i,14259,o),l[a>>2]=l[v+(1080*y|0)+8>>2],Wn(i,14282,a),l[s>>2]=l[v+(1080*y|0)+12>>2],Wn(i,14298,s),l[c>>2]=l[v+(1080*y|0)+16>>2],Wn(i,14314,c),l[h>>2]=l[v+(1080*y|0)+20>>2],Wn(i,14331,h),En(14346,23,1,i),0|l[g>>2]){t=0;do{A=0|l[v+(1080*y|0)+944+(t<<2)>>2],l[u>>2]=l[v+(1080*y|0)+812+(t<<2)>>2],l[u+4>>2]=A,Wn(i,14370,u),t=t+1|0}while(t>>>0<(0|l[g>>2])>>>0)}if(mr(10,i),A=v+(1080*y|0)+24|0,l[d>>2]=l[A>>2],Wn(i,14379,d),l[f>>2]=l[v+(1080*y|0)+804>>2],Wn(i,14394,f),En(14411,20,1,i),1!=(0|l[A>>2])?(0|(t=3*(0|l[g>>2])|0))>2&&(g=t+-2|0,x=8):(g=1,x=8),8==(0|x)){x=0,t=0;do{A=0|l[v+(1080*y|0)+28+(t<<3)>>2],l[p>>2]=l[v+(1080*y|0)+28+(t<<3)+4>>2],l[p+4>>2]=A,Wn(i,14370,p),t=t+1|0}while((0|t)!=(0|g))}mr(10,i),l[m>>2]=l[v+(1080*y|0)+808>>2],Wn(i,14432,m),En(14449,5,1,i),y=y+1|0}while((0|y)!=(0|e))}En(14036,4,1,i),w=_}else w=_}function he(t,e,i){t|=0,i|=0;var n,o,a,s,c,h=0,u=0;s=w,w=w+48|0,a=s+24|0,u=s+16|0,h=s,o=s+32|0,(n=0!=(0|(e|=0)))?(En(14581,41,1,0|l[665]),e=0):(r[o>>0]=9,r[o+1>>0]=9,e=2),r[o+e>>0]=0,c=0|l[t>>2],e=0|l[t+4>>2],l[h>>2]=o,l[h+4>>2]=c,l[h+8>>2]=e,Wn(i,14623,h),h=0|l[t+24>>2],l[u>>2]=o,l[u+4>>2]=h,Wn(i,14640,u),u=0|l[t+32>>2],l[a>>2]=o,l[a+4>>2]=u,Wn(i,14652,a),n?(En(13879,2,1,i),w=s):w=s}function ue(t){var e,i,n,r,o,a=0,s=0,c=0,h=0,u=0;if(o=w,w=w+16|0,s=o,r=0|l[16+(0|l[(a=80+(t|=0)|0)>>2])>>2],e=0|Ut(1,56),l[s>>2]=e,!e)return w=o,0|(u=0);if(a=0|l[16+(0|l[a>>2])>>2],l[e+24>>2]=a,l[e>>2]=l[t+92>>2],l[e+4>>2]=l[t+96>>2],l[e+8>>2]=l[t+100>>2],l[e+12>>2]=l[t+104>>2],l[e+16>>2]=l[t+112>>2],l[e+20>>2]=l[t+116>>2],l[e+52>>2]=0,t=0|l[t+12>>2],l[e+32>>2]=l[t>>2],l[e+36>>2]=l[t+4>>2],l[e+40>>2]=l[t+8>>2],l[e+44>>2]=l[t+16>>2],a=0|Ut(a,1080),l[(n=e+48|0)>>2]=a,!a)return Mt(s),w=o,0|(u=0);if(!r)return w=o,0|(u=e);for(i=t+5584|0,t=0;;){if(h=0|l[i>>2],l[a+(1080*t|0)+4>>2]=l[h+(1080*t|0)>>2],c=0|l[(s=h+(1080*t|0)+4|0)>>2],l[a+(1080*t|0)+8>>2]=c,l[a+(1080*t|0)+12>>2]=l[h+(1080*t|0)+8>>2],l[a+(1080*t|0)+16>>2]=l[h+(1080*t|0)+12>>2],l[a+(1080*t|0)+20>>2]=l[h+(1080*t|0)+16>>2],l[a+(1080*t|0)+24>>2]=l[h+(1080*t|0)+20>>2],c>>>0<33&&(Cr(a+(1080*t|0)+948|0,h+(1080*t|0)+944|0,0|c),Cr(a+(1080*t|0)+816|0,h+(1080*t|0)+812|0,0|l[s>>2])),c=0|l[h+(1080*t|0)+24>>2],l[a+(1080*t|0)+28>>2]=c,l[a+(1080*t|0)+808>>2]=l[h+(1080*t|0)+804>>2],1!=(0|c)?((s=3*(0|l[s>>2])|0)-3|0)>>>0<96&&(c=s+-2|0,u=10):(c=1,u=10),10==(0|u)){u=0,s=0;do{l[a+(1080*t|0)+32+(s<<2)>>2]=l[h+(1080*t|0)+28+(s<<3)+4>>2],l[a+(1080*t|0)+420+(s<<2)>>2]=l[h+(1080*t|0)+28+(s<<3)>>2],s=s+1|0}while((0|s)!=(0|c))}if(l[a+(1080*t|0)+812>>2]=l[h+(1080*t|0)+808>>2],(0|(t=t+1|0))==(0|r))break;a=0|l[n>>2]}return w=o,0|e}function de(t){t|=0;var e,i,n,r=0,o=0,a=0,s=0,c=0,h=0;if(!(e=0|Ut(1,48)))return 0|(h=0);if(r=0|l[(n=t+196|0)>>2],h=0|l[(c=r)+4>>2],l[(t=e)>>2]=l[c>>2],l[t+4>>2]=h,h=0|l[4+(t=r+8|0)>>2],l[(c=e+8|0)>>2]=l[t>>2],l[c+4>>2]=h,h=0|l[4+(c=r+16|0)>>2],l[(t=e+16|0)>>2]=l[c>>2],l[t+4>>2]=h,r=0|l[r+24>>2],l[(t=e+24|0)>>2]=r,r=0|zt(24*r|0),l[(h=e+28|0)>>2]=r,!r)return jt(e),0|(h=0);if((o=0|l[28+(0|l[n>>2])>>2])?Cr(0|r,0|o,24*(0|l[t>>2])|0):(jt(r),l[h>>2]=0),t=0|l[36+(0|l[n>>2])>>2],l[(i=e+36|0)>>2]=t,t=0|Ut(t,40),l[(c=e+40|0)>>2]=t,!t)return jt(0|l[h>>2]),jt(e),0|(h=0);if(!(r=0|l[40+(0|l[n>>2])>>2]))return jt(t),l[c>>2]=0,0|(h=e);if(!(0|l[i>>2]))return 0|(h=e);r=0|l[r+20>>2],l[t+20>>2]=r,r=0|zt(24*r|0),t=0|l[c>>2],l[t+24>>2]=r;t:do{if(r){for(o=0;(a=0|l[(0|l[40+(0|l[n>>2])>>2])+(40*o|0)+24>>2])?(Cr(0|r,0|a,24*(0|l[t+(40*o|0)+20>>2])|0),t=0|l[c>>2]):(jt(r),t=0|l[c>>2],l[t+(40*o|0)+24>>2]=0),r=0|l[(0|l[40+(0|l[n>>2])>>2])+(40*o|0)+4>>2],l[t+(40*o|0)+4>>2]=r,r=0|zt(24*r|0),t=0|l[c>>2],l[t+(40*o|0)+16>>2]=r,r;){if((a=0|l[(0|l[40+(0|l[n>>2])>>2])+(40*o|0)+16>>2])?(Cr(0|r,0|a,24*(0|l[t+(40*o|0)+4>>2])|0),t=0|l[c>>2]):(jt(r),t=0|l[c>>2],l[t+(40*o|0)+16>>2]=0),l[t+(40*o|0)+32>>2]=0,l[t+(40*o|0)+36>>2]=0,(o=o+1|0)>>>0>=(0|l[i>>2])>>>0){s=28;break}if(r=0|l[(0|l[40+(0|l[n>>2])>>2])+(40*o|0)+20>>2],l[t+(40*o|0)+20>>2]=r,r=0|zt(24*r|0),t=0|l[c>>2],l[t+(40*o|0)+24>>2]=r,!r)break t}if(28==(0|s))return 0|e;if(o){r=0;do{jt(0|l[t+(40*r|0)+24>>2]),jt(0|l[(0|l[c>>2])+(40*r|0)+16>>2]),r=r+1|0,t=0|l[c>>2]}while((0|r)!=(0|o))}return jt(t),jt(0|l[h>>2]),jt(e),0|(h=0)}o=0}while(0);if(o){r=0;do{jt(0|l[t+(40*r|0)+24>>2]),r=r+1|0,t=0|l[c>>2]}while((0|r)!=(0|o))}return jt(t),jt(0|l[h>>2]),jt(e),0|(h=0)}function fe(t,e,i,n){t|=0,e|=0,n|=0;var r,o,a=0,s=0,c=0,h=0;if(!(i|=0))return 0|(i=0);if(a=0|bt(),l[(o=t+84|0)>>2]=a,!a)return 0|(i=0);if(vt(i,a),gi(0|l[(h=t+188|0)>>2],28,n),r=0|yi(h=0|l[h>>2]),a=0|bi(h),r){for(s=1,c=0;s=s?0!=(0|Qr[63&l[a>>2]](t,e,n)):0,(0|(c=c+1|0))!=(0|r);)a=a+4|0,s&=1;if(vi(h),!s)return yt(0|l[(i=t+80|0)>>2]),l[i>>2]=0,0|(i=0)}else vi(h);if(!(h=0|l[i+16>>2]))return 0|(i=1);c=0|l[24+(0|l[o>>2])>>2],s=0|l[i+24>>2],a=0;do{l[s+(52*a|0)+36>>2]=l[c+(52*a|0)+36>>2],i=c+(52*a|0)+44|0,l[s+(52*a|0)+44>>2]=l[i>>2],l[i>>2]=0,a=a+1|0}while(a>>>0<h>>>0);return 0|(a=1)}function pe(t,e,i,n){t|=0,i|=0,n|=0;var o=0,s=0,c=0,u=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0;if(!(0|l[(R=16+(e|=0)|0)>>2]))return 0|(R=1);for(P=0,I=0|l[e+24>>2];;){if(u=n+8|0,e=0|l[(c=n+44|0)>>2])s=n+12|0;else{if(e=0|l[u>>2],!(o=0|l[(s=n+12|0)>>2])){i=0,t=66;break}if(e>>>0>(4294967295/(o>>>0)|0)>>>0){i=0,t=66;break}if(e=0|Ut(0|C(o,e),4),l[c>>2]=e,!e){i=0,t=66;break}}p=I+36|0,l[n+36>>2]=l[p>>2],w=0|l[I+24>>2],b=0|l[t+24>>2],p=0|l[p>>2],x=3==(0|(w=(w>>>3)+(0!=(7&w|0)&1)|0)),M=(f=0|l[b+(136*p|0)+8>>2])-(o=0|l[b+(136*p|0)>>2])|0,b=(y=0|l[b+(136*p|0)+12>>2])-(p=0|l[b+(136*p|0)+4>>2])|0,c=0|l[n+16>>2],_=0|Tr(1,0,0|(m=0|l[n+40>>2])),k=S,c=0|Er(0|(c=0|br(0|(c=0|br(0|c,0,-1,-1)),0|S,0|_,0|k)),0|S,0|m),m=0|Er(0|(k=0|br(0|(T=0|br(0|l[n+20>>2],0,-1,-1)),0|S,0|_,0|k)),0|S,0|m),u=(k=0|l[u>>2])+c|0,_=(s=0|l[s>>2])+m|0;do{if(o>>>0<=c>>>0){if(o=c-o|0,f>>>0>u>>>0){T=k,A=o,g=0,v=f-u|0;break}T=M-o|0,A=o,g=0,v=0;break}v=u-o|0,T=(E=f>>>0>u>>>0)?v:M,A=0,g=o-c|0,v=E?M-v|0:0}while(0);do{if(p>>>0<=m>>>0){if(o=m-p|0,y>>>0>_>>>0){E=s,f=o,c=0,o=y-_|0;break}E=b-o|0,f=o,c=0,o=0;break}o=_-p|0,E=(y=y>>>0>_>>>0)?o:b,f=0,c=p-m|0,o=y?b-o|0:0}while(0);if((A|v|T|o|f|E|0)<0){i=0,t=66;break}switch(s=(u=0|C(f,M))+A|0,m=A+v|0,_=(0|C(o,M))-A|0,c=e+((0|C(k,c))+g<<2)|0,1073741823&(x?4:w)|0){case 1:o=i+s|0,e=0!=(0|E);do{if(0|l[I+32>>2])if(e){if(!T){i=i+(v+u+(0|C(m,E+-1|0))+(A<<1))|0;break}for(p=T+v+u+(0|C(T+A+v|0,E+-1|0))+(A<<1)|0,e=o,s=0;;){for(f=e+T|0,u=0,o=c;l[o>>2]=r[e>>0],(0|(u=u+1|0))!=(0|T);)e=e+1|0,o=o+4|0;if((0|(s=s+1|0))==(0|E))break;e=f+m|0,c=c+(k<<2)|0}i=i+p|0}else i=o;else if(e){if(!T){i=i+(v+u+(0|C(m,E+-1|0))+(A<<1))|0;break}for(p=T+v+u+(0|C(T+A+v|0,E+-1|0))+(A<<1)|0,f=0,e=o;;){for(u=e+T|0,s=0,o=c;l[o>>2]=h[e>>0],(0|(s=s+1|0))!=(0|T);)e=e+1|0,o=o+4|0;if((0|(f=f+1|0))==(0|E))break;e=u+m|0,c=c+(k<<2)|0}i=i+p|0}else i=o}while(0);i=i+_|0;break;case 2:e=i+(s<<1)|0,o=0!=(0|E);do{if(0|l[I+32>>2])if(o){if(!T){i=i+((0|C(f<<1,M))+(0|C(m<<1,E+-1|0))+(A<<2)+(v<<1))|0;break}for(i=i+((0|C(T+m<<1,E+-1|0))+(A<<2)+(T+v+u<<1))|0,f=0;;){for(u=e+(T<<1)|0,o=0,s=c;l[s>>2]=a[e>>1],(0|(o=o+1|0))!=(0|T);)e=e+2|0,s=s+4|0;if((0|(f=f+1|0))==(0|E))break;e=u+(m<<1)|0,c=c+(k<<2)|0}}else i=e;else if(o){if(!T){i=i+((0|C(f<<1,M))+(0|C(m<<1,E+-1|0))+(A<<2)+(v<<1))|0;break}for(i=i+((0|C(T+m<<1,E+-1|0))+(A<<2)+(T+v+u<<1))|0,f=0;;){for(u=e+(T<<1)|0,s=0,o=c;l[o>>2]=d[e>>1],(0|(s=s+1|0))!=(0|T);)e=e+2|0,o=o+4|0;if((0|(f=f+1|0))==(0|E))break;e=u+(m<<1)|0,c=c+(k<<2)|0}}else i=e}while(0);i=i+(_<<1)|0;break;case 4:e=i+(s<<2)|0;do{if(E){if(!T){i=i+((0|C(f<<2,M))+(0|C(m<<2,E+-1|0))+(A<<3)+(v<<2))|0;break}for(i=i+((0|C(T+m<<2,E+-1|0))+(A<<3)+(T+v+u<<2))|0,f=0;;){for(u=e+(T<<2)|0,o=0,s=c;l[s>>2]=l[e>>2],(0|(o=o+1|0))!=(0|T);)e=e+4|0,s=s+4|0;if((0|(f=f+1|0))==(0|E))break;e=u+(m<<2)|0,c=c+(k<<2)|0}}else i=e}while(0);i=i+(_<<2)|0}if((P=P+1|0)>>>0>=(0|l[R>>2])>>>0){i=1,t=66;break}t=t+52|0,n=n+52|0,I=I+52|0}return 66==(0|t)?0|i:0}function me(t,e,i,n,r){t|=0,e|=0,n|=0,r|=0;var o,a,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,M=0,E=0;if(a=w,w=w+16|0,h=a+8|0,!(i|=0))return mt(n,1,14842,a),w=a,0|(y=0);if(c=0|l[t+112>>2],(s=0|C(0|l[t+116>>2],c))>>>0<=r>>>0)return l[h>>2]=r,l[h+4>>2]=s+-1,mt(n,1,14880,h),w=a,0|(y=0);if(y=(r>>>0)%(c>>>0)|0,g=(r>>>0)/(c>>>0)|0,s=(s=0|C(0|l[(c=t+100|0)>>2],y))+(0|l[(h=t+92|0)>>2])|0,l[i>>2]=s,s=s>>>0<(u=0|l[l[(o=t+80|0)>>2]>>2])>>>0?u:s,l[i>>2]=s,h=(y=0|C(0|l[c>>2],y+1|0))+(0|l[h>>2])|0,l[(y=i+8|0)>>2]=h,h=h>>>0>(c=0|l[8+(0|l[o>>2])>>2])>>>0?c:h,l[y>>2]=h,c=(c=0|C(0|l[(y=t+104|0)>>2],g))+(0|l[(u=t+96|0)>>2])|0,l[(m=i+4|0)>>2]=c,c=c>>>0<(_=0|l[4+(0|l[o>>2])>>2])>>>0?_:c,l[m>>2]=c,u=(g=0|C(0|l[y>>2],g+1|0))+(0|l[u>>2])|0,l[(g=i+12|0)>>2]=u,u=u>>>0>(y=0|l[12+(0|l[o>>2])>>2])>>>0?y:u,l[g>>2]=u,g=i+24|0,0|(m=0|l[(y=i+16|0)>>2]))for(_=0|l[24+(0|l[o>>2])>>2],p=s+-1|0,f=c+-1|0,d=h+-1|0,h=u+-1|0,s=0,c=0|l[g>>2];u=0|l[_+(52*s|0)+40>>2],l[c+40>>2]=u,M=(p+(E=0|l[c>>2])|0)/(0|E)|0,l[c+16>>2]=M,A=(f+(b=0|l[c+4>>2])|0)/(0|b)|0,l[c+20>>2]=A,E=(d+E|0)/(0|E)|0,b=(h+b|0)/(0|b)|0,x=0|Tr(1,0,0|u),v=S,E=0|Mr(0|(E=0|br(0|(E=0|br(0|E,((0|E)<0)<<31>>31|0,-1,-1)),0|S,0|x,0|v)),0|S,0|u),M=0|Mr(0|(M=0|br(0|(M=0|br(0|M,((0|M)<0)<<31>>31|0,-1,-1)),0|S,0|x,0|v)),0|S,0|u),l[c+8>>2]=E-M,b=0|Mr(0|(b=0|br(0|(b=0|br(0|b,((0|b)<0)<<31>>31|0,-1,-1)),0|S,0|x,0|v)),0|S,0|u),u=0|Mr(0|(v=0|br(0|(A=0|br(0|A,((0|A)<0)<<31>>31|0,-1,-1)),0|S,0|x,0|v)),0|S,0|u),l[c+12>>2]=b-u,!((s=s+1|0)>>>0>=m>>>0);)c=c+52|0;if(0|(s=0|l[(f=t+84|0)>>2])&&yt(s),s=0|bt(),l[f>>2]=s,!s)return w=a,0|(E=0);if(vt(i,s),l[t+60>>2]=r,gi(0|l[(u=t+188|0)>>2],29,n),d=0|yi(u=0|l[u>>2]),s=0|bi(u),d){for(c=1,h=0;c=c?0!=(0|Qr[63&l[s>>2]](t,e,n)):0,(0|(h=h+1|0))!=(0|d);)s=s+4|0,c&=1;if(vi(u),!c)return yt(0|l[o>>2]),l[o>>2]=0,w=a,0|(E=0)}else vi(u);if(!(s=0|l[y>>2]))return w=a,0|(E=1);for(d=0,u=0|l[24+(0|l[f>>2])>>2],h=0|l[g>>2];;){if(l[h+(52*d|0)+36>>2]=l[u+(52*d|0)+36>>2],(c=0|l[h+(52*d|0)+44>>2])?(jt(c),c=0|l[24+(0|l[f>>2])>>2],h=0|l[g>>2],s=0|l[y>>2]):c=u,E=c+(52*d|0)+44|0,l[h+(52*d|0)+44>>2]=l[E>>2],l[E>>2]=0,(d=d+1|0)>>>0>=s>>>0){s=1;break}u=c}return w=a,0|s}function _e(t,e,i){e|=0,i|=0;var n,r,o,a=0,s=0,c=0,h=0;o=w,w=w+16|0,r=o,l[168+(t|=0)>>2]=e,n=0|l[t+80>>2];t:do{if(0!=(0|n)&&(h=0|l[n+24>>2],0!=(0|h))&&(c=t+12|0,a=0|l[c>>2],0!=(0|a))&&(s=0|l[a+5584>>2],0!=(0|s)))if(a=0|l[n+16>>2]){if((0|l[s+4>>2])>>>0>e>>>0){t=0;do{if(l[h+(52*t|0)+40>>2]=e,(t=t+1|0)>>>0>=a>>>0){t=1;break t}}while((0|l[(0|l[5584+(0|l[c>>2])>>2])+(1080*t|0)+4>>2])>>>0>e>>>0)}mt(i,1,15074,r),t=0}else t=1;else t=0}while(0);return w=o,0|t}function ge(t,e,i){e|=0,i|=0;var n,o,s,c,h,u,d,f,p,m,_,g,y,b,v,x,A,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0;if(A=w,w=w+48|0,x=A+32|0,v=A+24|0,b=A+16|0,y=A+8|0,g=A,S=0|l[(f=204+(t|=0)|0)>>2],p=t+116|0,o=1==(0|(_=0|C(0|l[(m=t+112|0)>>2],0|l[p>>2]))),!_)return w=A,0|(V=1);s=t+200|0,c=t+12|0,h=t+164|0,u=t+8|0,d=S+20|0,n=S+24|0,H=0,P=0,S=0;t:for(;;){if((0|l[s>>2])!=(0|H)){V=5;break}if(z=H,H=H+1|0,U=0|C(0|l[p>>2],0|l[m>>2]),l[y>>2]=H,l[y+4>>2]=U,mt(i,4,15187,y),l[c>>2]=0,U=0|l[f>>2],l[U+12>>2]=l[(0|l[h>>2])+(5640*z|0)+5588>>2],l[u>>2]=0,!(0|ei(U,0|l[s>>2],i)))break;if(M=0|l[f>>2],I=0|l[16+(0|l[M+24>>2])>>2])if(o){T=0|l[20+(0|l[l[d>>2]>>2])>>2],k=0|l[24+(0|l[n>>2])>>2],E=0;do{l[T+(52*E|0)+32>>2]=l[k+(52*E|0)+44>>2],l[T+(52*E|0)+36>>2]=0,E=E+1|0}while(E>>>0<I>>>0)}else{E=0;do{if(!(0|ti((0|l[20+(0|l[l[d>>2]>>2])>>2])+(52*E|0)|0))){V=14;break t}E=E+1|0,M=0|l[f>>2]}while(E>>>0<(0|l[16+(0|l[M+24>>2])>>2])>>>0)}if(U=0|ai(M),o)M=P;else{if(U>>>0>S>>>0){if(!(S=0|Wt(P,U))){V=20;break}M=S,S=U}else M=P;if(E=0|l[f>>2],T=0|l[(z=E+24|0)>>2],0|l[T+16>>2]){N=E+20|0,E=M,G=0;do{L=0|l[20+(0|l[l[N>>2]>>2])>>2],R=0|l[T+24>>2],W=((W=0|l[R+(52*G|0)+24>>2])>>>3)+(0!=(7&W|0)&1)|0,O=(I=0|l[L+(52*G|0)+8>>2])-(P=0|l[L+(52*G|0)>>2])|0,F=(B=0|l[L+(52*G|0)+12>>2])-(L=0|l[L+(52*G|0)+4>>2])|0,Z=0|l[T>>2],j=0|l[R+(52*G|0)>>2],k=0|l[R+(52*G|0)+4>>2],D=(j+~Z+(0|l[T+8>>2])|0)/(0|j)|0,k=P-((Z+-1+j|0)/(0|j)|0)+(0|C(D,L-(((0|l[T+4>>2])-1+k|0)/(0|k)|0)|0))|0,k=(0|l[R+(52*G|0)+44>>2])+(k<<2)|0;e:do{switch(1073741823&(3==(0|W)?4:W)|0){case 1:if(T=0==(0|O)|0==(0|F),0|l[R+(52*G|0)+32>>2]){if(T)break e;for(L=B+-1-L|0,B=E,T=k,k=0;;){for(I=0,P=B,R=T;r[P>>0]=l[R>>2],(0|(I=I+1|0))!=(0|O);)P=P+1|0,R=R+4|0;if((0|(k=k+1|0))==(0|F))break;B=B+O|0,T=T+(D<<2)|0}E=E+(O+(0|C(L,O)))|0;break e}if(T)break e;for(L=B+-1-L|0,R=0,B=E;;){for(T=0,I=B,P=k;r[I>>0]=l[P>>2],(0|(T=T+1|0))!=(0|O);)I=I+1|0,P=P+4|0;if((0|(R=R+1|0))==(0|F))break;B=B+O|0,k=k+(D<<2)|0}E=E+(O+(0|C(L,O)))|0;break e;case 2:if(T=0==(0|O)|0==(0|F),0|l[R+(52*G|0)+32>>2]){if(T)break e;for(L=(R=I-P<<1)+(0|C(B+-1-L|0,R))|0,R=E,B=0;;){for(T=R,I=0,P=k;a[T>>1]=l[P>>2],(0|(I=I+1|0))!=(0|O);)T=T+2|0,P=P+4|0;if((0|(B=B+1|0))==(0|F))break;R=R+(O<<1)|0,k=k+(D<<2)|0}E=E+L|0;break e}if(T)break e;for(L=(R=I-P<<1)+(0|C(B+-1-L|0,R))|0,R=E,B=0;;){for(T=0,I=R,P=k;a[I>>1]=l[P>>2],(0|(T=T+1|0))!=(0|O);)I=I+2|0,P=P+4|0;if((0|(B=B+1|0))==(0|F))break;R=R+(O<<1)|0,k=k+(D<<2)|0}E=E+L|0;break e;case 4:if(!(0==(0|O)|0==(0|F))){for(L=(R=I-P<<2)+(0|C(B+-1-L|0,R))|0,R=E,B=0;;){for(T=R,I=0,P=k;l[T>>2]=l[P>>2],(0|(I=I+1|0))!=(0|O);)T=T+4|0,P=P+4|0;if((0|(B=B+1|0))==(0|F))break;R=R+(O<<2)|0,k=k+(D<<2)|0}E=E+L|0}}}while(0);G=G+1|0,T=0|l[z>>2]}while(G>>>0<(0|l[T+16>>2])>>>0);E=0|l[f>>2]}if(!(0|si(E,M,U))){V=61;break}}if(!(0|ye(t,e,i))){V=63;break}if(H>>>0>=_>>>0){V=65;break}P=M}if(5==(0|V))mt(i,1,15150,g);else{if(14==(0|V))return mt(i,1,15208,b),P?(jt(P),w=A,0|(Z=0)):(w=A,0|(Z=0));if(20==(0|V))return 0|P&&jt(P),mt(i,1,15246,v),w=A,0|(Z=0);if(61==(0|V))return mt(i,1,15285,x),jt(M),w=A,0|(Z=0);if(63==(0|V))return M?(jt(M),w=A,0|(Z=0)):(w=A,0|(Z=0));if(65==(0|V))return M?(jt(M),w=A,0|(Z=1)):(w=A,0|(Z=1))}return P?(jt(P),w=A,0|(Z=0)):(w=A,0|(Z=0))}function ye(t,e,i){e|=0,i|=0;var n,r,o,s,c,h,u,d,f,p,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=0,L=0;if(p=w,w=w+32|0,u=p+16|0,C=p+8|0,v=p,h=p+20|0,f=0|l[40+(t|=0)>>2],A=0|l[(B=t+36|0)>>2],b=0|l[(S=t+204|0)>>2],l[b+16>>2]=0,l[(o=t+8|0)>>2]=0,it(A,65424,2),it(A+2|0,10,2),it(A+4|0,0|l[(d=t+200|0)>>2],2),it(A+10|0,0|l[(s=t+12|0)>>2],1),it(A+11|0,0|l[(0|l[(c=t+164|0)>>2])+(5640*(0|l[d>>2])|0)+5588>>2],1),l[h>>2]=12,_=A+12|0,m=f+-12|0,((0|a[(x=t+88|0)>>1])-3&65535)>=4&&(g=0|l[c>>2],y=0|l[d>>2],0!=(0|l[g+(5640*y|0)+420>>2]))?(l[h>>2]=0,be(0|l[16+(0|l[t+80>>2])>>2],g,y,_,h),g=12+(R=0|l[h>>2])|0,_=_+R|0,m=m-R|0):g=12,l[h>>2]=0,it(_,65427,2),l[b+4>>2]=l[o>>2],l[b+8>>2]=l[s>>2],0|l[s>>2]||(l[840+(0|l[l[b+20>>2]>>2])>>2]=0),l[h>>2]=0,!(0|ni(b,0|l[d>>2],_+2|0,h,m+-4|0,0)))return mt(i,1,15332,v),w=p,0|(B=0);m=2+(0|l[h>>2])|0,l[h>>2]=m,it(A+6|0,m=m+g|0,4),((0|a[x>>1])-3&65535)<4&&(it(0|l[(R=t+28|0)>>2],0|l[d>>2],1),P=1+(0|l[R>>2])|0,l[R>>2]=P,it(P,m,4),l[R>>2]=4+(0|l[R>>2])),g=A+m|0,R=f-m|0,n=0|l[S>>2],r=t+88|0,T=0|l[c>>2],x=0|ve(r,0,k=0|l[d>>2]),P=t+8|0,l[s>>2]=1+(0|l[s>>2]);t:do{if(x>>>0>1){for(A=n+4|0,S=n+8|0,M=n+20|0,E=t+28|0,b=g,_=R,m=0,v=1;l[P>>2]=v,l[h>>2]=0,it(b,65424,2),it(b+2|0,10,2),it(b+4|0,0|l[d>>2],2),it(b+10|0,0|l[s>>2],1),it(b+11|0,0|l[(0|l[c>>2])+(5640*(0|l[d>>2])|0)+5588>>2],1),g=b+12|0,l[h>>2]=0,it(g,65427,2),l[A>>2]=l[o>>2],l[S>>2]=l[s>>2],0|l[s>>2]||(l[840+(0|l[l[M>>2]>>2])>>2]=0),l[h>>2]=0,0|ni(n,0|l[d>>2],b+14|0,h,_+-16|0,0);){if(L=2+(y=0|l[h>>2])|0,l[h>>2]=L,g=g+L|0,m=m+12+L|0,_=_+-12+(-2-y)|0,it(b+6|0,y=y+14|0,4),((0|a[r>>1])-3&65535)<4&&(it(0|l[E>>2],0|l[d>>2],1),L=1+(0|l[E>>2])|0,l[E>>2]=L,it(L,y,4),l[E>>2]=4+(0|l[E>>2])),l[s>>2]=1+(0|l[s>>2]),(v=v+1|0)>>>0>=x>>>0){I=12;break t}b=g}mt(i,1,15332,C)}else _=R,m=0,I=12}while(0);t:do{if(12==(0|I)){M=T+(5640*k|0)+420|0;e:do{if(0|l[M>>2]){E=n+16|0,T=n+4|0,k=n+8|0,C=n+20|0,S=t+28|0,A=1;i:for(;;){if(l[E>>2]=A,x=0|ve(r,A,0|l[d>>2]))for(v=0;;){if(l[P>>2]=v,l[h>>2]=0,it(g,65424,2),it(g+2|0,10,2),it(g+4|0,0|l[d>>2],2),it(g+10|0,0|l[s>>2],1),it(g+11|0,0|l[(0|l[c>>2])+(5640*(0|l[d>>2])|0)+5588>>2],1),y=g+12|0,l[h>>2]=0,it(y,65427,2),l[T>>2]=l[o>>2],l[k>>2]=l[s>>2],0|l[s>>2]||(l[840+(0|l[l[C>>2]>>2])>>2]=0),l[h>>2]=0,!(0|ni(n,0|l[d>>2],g+14|0,h,_+-16|0,0)))break i;if(b=2+(L=0|l[h>>2])|0,l[h>>2]=b,m=m+12+b|0,b=y+b|0,_=_+-12+(-2-L)|0,it(g+6|0,y=L+14|0,4),((0|a[r>>1])-3&65535)<4&&(it(0|l[S>>2],0|l[d>>2],1),L=1+(0|l[S>>2])|0,l[S>>2]=L,it(L,y,4),l[S>>2]=4+(0|l[S>>2])),l[s>>2]=1+(0|l[s>>2]),(v=v+1|0)>>>0>=x>>>0){g=b;break}g=b}if((A=A+1|0)>>>0>(0|l[M>>2])>>>0)break e}mt(i,1,15332,u);break t}}while(0);return L=m-R+f|0,(0|ct(e,0|l[B>>2],L,i))!=(0|L)?(w=p,0|(L=0)):(l[d>>2]=1+(0|l[d>>2]),w=p,0|(L=1))}}while(0);return w=p,0|(L=0)}function be(t,e,i,n,r){t|=0,n|=0,r|=0;var o,a,s,c,h=0,u=0,d=0,f=0,p=0,m=0;if(h=0|l[(e|=0)+(5640*(i|=0)|0)+5584>>2],c=1+(0|l[e+(5640*i|0)+420>>2])|0,s=4+(u=0|C(c,5+((a=t>>>0<257?1:2)<<1)|0))|0,it(n,65375,2),it(n+2|0,u+2|0,2),c){for(u=e+(5640*i|0)+8|0,o=h+4|0,e=e+(5640*i|0)+424|0,i=0,h=n+4|0;it(h,0|l[e>>2],1),it(h=h+1|0,0|l[e+4>>2],a),it(h=h+a|0,0|l[(p=e+8|0)>>2],2),it(h=h+2|0,0|l[(d=e+12|0)>>2],1),it(h=h+1|0,0|l[(n=e+16|0)>>2],a),it(h=h+a|0,0|l[e+36>>2],1),m=0|l[p>>2],f=0|l[u>>2],l[p>>2]=(0|m)<(0|f)?m:f,p=0|l[d>>2],f=0|l[o>>2],l[d>>2]=(0|p)<(0|f)?p:f,d=0|l[n>>2],l[n>>2]=(0|d)<(0|t)?d:t,(0|(i=i+1|0))!=(0|c);)e=e+148|0,h=h+1|0;l[r>>2]=s}else l[r>>2]=s}function ve(t,e,i){e|=0,i|=0;var n,o,a=0,s=0,c=0,u=0,d=0,f=0;for(c=0|l[76+(t|=0)>>2],a=0|l[c+(5640*i|0)+4>>2],u=696;!(-1==(0|(d=0|l[u>>2]))|(0|d)==(0|a));)u=u+12|0;if(!(8&r[t+93>>0]))return 0|(t=1);switch(d=0|h[t+92>>0],s=c+(5640*i|0)+424+(148*e|0)+92|0,n=c+(5640*i|0)+424+(148*e|0)+88|0,o=c+(5640*i|0)+424+(148*e|0)+96|0,c=c+(5640*i|0)+424+(148*e|0)+84|0,0|(e=0|r[u+4>>0])){case 67:a=s,f=8;break;case 82:a=n,f=8;break;case 80:a=o,f=8;break;case 76:a=c,f=8;break;default:a=1}if(8==(0|f)&&(a=0|l[a>>2]),(0|d)!=(0|e)){switch(0|(i=0|r[u+5>>0])){case 67:e=s,f=16;break;case 82:e=n,f=16;break;case 80:e=o,f=16;break;case 76:e=c,f=16}if(16==(0|f)&&(a=0|C(0|l[e>>2],a)),(0|d)!=(0|i)){switch(0|(i=0|r[u+6>>0])){case 67:e=s,f=22;break;case 82:e=n,f=22;break;case 80:e=o,f=22;break;case 76:e=c,f=22}if(22==(0|f)&&(a=0|C(0|l[e>>2],a)),(0|d)!=(0|i)){switch(0|(e=0|r[u+7>>0])){case 67:f=28;break;case 82:s=n,f=28;break;case 80:s=o,f=28;break;case 76:s=c,f=28}if(28==(0|f)&&(a=0|C(0|l[s>>2],a)),(0|d)!=(0|e))return 0|(t=a);s=3}else s=2}else s=1}else s=0;return l[t+84>>2]=s,0|(t=a)}function we(t,e,i){e|=0,i|=0;var n,r=0,o=0,s=0,c=0;if(!(0|gi(0|l[(r=188+(t|=0)|0)>>2],30,i)))return 0|(c=0);if(((0|a[t+88>>1])-3&65535)<4&&0==(0|gi(0|l[r>>2],31,i)))return 0|(c=0);if(!(0|gi(0|l[r>>2],32,i)))return 0|(c=0);if(!(0|gi(0|l[r>>2],33,i)))return 0|(c=0);if(!(0|gi(0|l[r>>2],34,i)))return 0|(c=0);if(n=0|yi(c=0|l[r>>2]),r=0|bi(c),n)for(o=r,r=1,s=0;r=r?0!=(0|Qr[63&l[o>>2]](t,e,i)):0,r&=1,(0|(s=s+1|0))!=(0|n);)o=o+4|0;else r=1;return vi(c),0|(c=r)}function xe(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r,o,s=0,c=0,h=0,u=0;if(o=w,w=w+16|0,s=0|bt(),l[(r=t+80|0)>>2]=s,!s)return mt(n,1,15352,o),w=o,0|(n=0);if(vt(i,s),0|(h=0|l[i+24>>2])&&0|(u=0|l[i+16>>2])){s=0;do{0|(c=0|l[(i=h+(52*s|0)+44|0)>>2])&&(l[(0|l[24+(0|l[r>>2])>>2])+(52*s|0)+44>>2]=c,l[i>>2]=0),s=s+1|0}while(s>>>0<u>>>0)}if(!(0|gi(0|l[(s=t+192|0)>>2],35,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],36,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],37,n)))return w=o,0|(n=0);if(u=0|yi(h=0|l[s>>2]),s=0|bi(h),u){for(i=1,c=0;i=i?0!=(0|Qr[63&l[s>>2]](t,e,n)):0,(0|(c=c+1|0))!=(0|u);)s=s+4|0,i&=1;if(vi(h),!i)return w=o,0|(n=0)}else vi(h);if(!(0|gi(0|l[(s=t+188|0)>>2],38,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],39,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],40,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],41,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],42,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],43,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],44,n)))return w=o,0|(n=0);if(((0|a[(i=t+88|0)>>1])-3&65535)<4){if(!(0|gi(0|l[s>>2],45,n)))return w=o,0|(n=0);if(4==(0|a[i>>1])&&0==(0|gi(0|l[s>>2],46,n)))return w=o,0|(n=0)}if(!(0|gi(0|l[s>>2],47,n)))return w=o,0|(n=0);if(0|l[t+108>>2]&&0==(0|gi(0|l[s>>2],48,n)))return w=o,0|(n=0);if(256&a[i>>1]&&0==(0|gi(0|l[s>>2],49,n)))return w=o,0|(n=0);if(0|l[t+196>>2]&&0==(0|gi(0|l[s>>2],50,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],51,n)))return w=o,0|(n=0);if(!(0|gi(0|l[s>>2],52,n)))return w=o,0|(n=0);if(h=0|yi(u=0|l[s>>2]),s=0|bi(u),h)for(i=s,s=1,c=0;s=s?0!=(0|Qr[63&l[i>>2]](t,e,n)):0,s&=1,(0|(c=c+1|0))!=(0|h);)i=i+4|0;else s=1;return vi(u),w=o,0|(n=s)}function Ae(t,e,i,n,r,o){i|=0,n|=0,r|=0,o|=0;var a,s,c,h,u=0,d=0;h=w,w=w+16|0,s=h+8|0,a=h,c=0|l[(t|=0)+(5640*(e|=0)|0)+5584>>2],e=0|l[c+(1080*i|0)+24>>2];do{if(1!=(0|e))if(u=(t=3*(0|l[c+(1080*i|0)+4>>2])|0)-2|0,e)d=7;else{if(t=t+-1|0,(0|l[r>>2])>>>0<t>>>0)return mt(o,1,15741,a),w=h,0|(r=0);if(it(n,l[c+(1080*i|0)+804>>2]<<5,1),!u)break;e=0;do{it(n=n+1|0,l[c+(1080*i|0)+28+(e<<3)>>2]<<3,1),e=e+1|0}while((0|e)!=(0|u))}else u=1,e=1,d=7}while(0);if(7==(0|d)){if(t=u<<1|1,(0|l[r>>2])>>>0<t>>>0)return mt(o,1,15741,s),w=h,0|(r=0);if(it(n,(l[c+(1080*i|0)+804>>2]<<5)+e|0,1),u)for(n=n+1|0,e=0;it(n,(l[c+(1080*i|0)+28+(e<<3)>>2]<<11)+(0|l[c+(1080*i|0)+28+(e<<3)+4>>2])|0,2),(0|(e=e+1|0))!=(0|u);)n=n+2|0}return l[r>>2]=(0|l[r>>2])-t,w=h,0|(r=1)}function Se(t,e,i,n,r){var o,a,s;if(i|=0,n|=0,r|=0,s=w,w=w+16|0,o=0|l[(t|=0)+(5640*(e|=0)|0)+5584>>2],(0|l[n>>2])>>>0<5)return mt(r,1,15813,s),w=s,0|(n=0);if(it(i,(0|l[(a=o+4|0)>>2])-1|0,1),it(i+1|0,(0|l[o+8>>2])-2|0,1),it(i+2|0,(0|l[o+12>>2])-2|0,1),it(i+3|0,0|l[o+16>>2],1),it(i+4|0,0|l[o+20>>2],1),t=(0|l[n>>2])-5|0,l[n>>2]=t,!(1&l[o>>2]))return w=s,0|(n=1);if(t>>>0<(e=0|l[a>>2])>>>0)return mt(r,1,15813,s+8|0),w=s,0|(n=0);if(e){for(t=i+5|0,i=0;it(t,(l[o+944+(i<<2)>>2]<<4)+(0|l[o+812+(i<<2)>>2])|0,1),!((i=i+1|0)>>>0>=(e=0|l[a>>2])>>>0);)t=t+1|0;t=0|l[n>>2]}else e=0;return l[n>>2]=t-e,w=s,0|(n=1)}function Me(t,e,i,n,r,o){e|=0,i|=0,n|=0,r|=0,o|=0;var a,s,c,h,u=0,d=0,f=0,p=0;if(h=w,w=w+48|0,c=h+40|0,p=h+32|0,s=h+24|0,a=h+16|0,u=h+8|0,(0|l[(d=200+(t|=0)|0)>>2])!=(0|e))return mt(o,1,15150,h),l[a>>2]=e,mt(o,1,16086,a),w=h,0;if(f=0|C(0|l[t+116>>2],0|l[t+112>>2]),l[u>>2]=e+1,l[u+4>>2]=f,mt(o,4,15187,u),l[t+12>>2]=0,u=0|l[(f=t+204|0)>>2],l[u+12>>2]=l[(0|l[t+164>>2])+(5640*e|0)+5588>>2],l[t+8>>2]=0,!(0|ei(u,0|l[d>>2],o)))return l[a>>2]=e,mt(o,1,16086,a),w=h,0;u=0|l[f>>2];t:do{if(0|l[16+(0|l[u+24>>2])>>2]){for(d=0;0|ti((0|l[20+(0|l[l[u+20>>2]>>2])>>2])+(52*d|0)|0);)if(d=d+1|0,u=0|l[f>>2],d>>>0>=(0|l[16+(0|l[u+24>>2])>>2])>>>0)break t;return mt(o,1,15208,s),w=h,0|(p=0)}}while(0);return 0|si(u,i,n)?0|ye(t,r,o)?(w=h,0|(p=1)):(l[c>>2]=e,mt(o,1,16143,c),w=h,0|(p=0)):(mt(o,1,15285,p),w=h,0|(p=0))}function Ee(t,e,i){t|=0,i|=0;var n,o,s,c,u,f,p,m,_,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0;_=w,w=w+80|0,T=_+72|0,m=_+64|0,p=_+56|0,f=_+48|0,u=_+40|0,c=_+32|0,s=_+24|0,E=_+16|0,A=_+8|0,x=_,g=0|l[8+(e|=0)>>2];t:do{if(g){M=0|l[g>>2],S=0|a[g+4>>1],y=0|l[t+16>>2],0!=(0|(g=0|l[e+12>>2]))&&0!=(0|l[g+12>>2])&&(y=0|h[g+18>>0]);e:do{if(S<<16>>16){v=0;i:for(;;){if(y>>>0<=(b=0|d[M+(6*(e=65535&v)|0)>>1])>>>0){v=14;break}switch((e=0|a[M+(6*e|0)+4>>1])<<16>>16){case 0:case-1:break;default:if((e=(65535&e)-1|0)>>>0>=y>>>0){v=17;break i}}if((65535&(v=v+1<<16>>16))>=(65535&S)){v=8;break}}if(8==(0|v))for(;;){y=y+-1|0,e=0;do{if((0|y)==(0|d[M+(6*(65535&e)|0)>>1]))break;e=e+1<<16>>16}while((65535&e)<(65535&S));if(e<<16>>16==S<<16>>16)break e;if(!y)break t;v=8}else{if(14==(0|v))return l[x>>2]=b,l[x+4>>2]=y,mt(i,1,16331,x),w=_,0|(T=0);if(17==(0|v))return l[A>>2]=e,l[A+4>>2]=y,mt(i,1,16331,A),w=_,0|(T=0)}}else if(!y)break t}while(0);return mt(i,1,16368,E),w=_,0|(T=0)}g=0|l[e+12>>2]}while(0);if(!g)return w=_,0|(T=1);if(!(o=0|l[g+12>>2]))return w=_,0|(T=1);if(n=255&(S=0|r[g+18>>0]),E=S<<24>>24==0)g=1;else{v=t+16|0,g=1,b=0,e=0;do{e=0|d[o+(e<<2)>>1],(y=0|l[v>>2])>>>0<=e>>>0&&(l[s>>2]=e,l[s+4>>2]=y,mt(i,1,16331,s),g=0),e=65535&(b=b+1<<16>>16)}while(e>>>0<n>>>0)}if(!(M=0|Ut(n,4)))return mt(i,1,16401,c),w=_,0|(T=0);if(!E){x=0,A=0;do{b=255&(y=0|r[o+(A<<2)+3>>0]);do{if((255&y)<(255&S)){if(v=M+(b<<2)|0,e=0|r[o+(A<<2)+2>>0],0!=(0|l[v>>2])&e<<24>>24==1){l[f>>2]=b,mt(i,1,16474,f),g=0;break}if(e<<24>>24!=0|y<<24>>24==0){l[v>>2]=1;break}l[p>>2]=A,l[p+4>>2]=b,mt(i,1,16505,p),g=0;break}l[u>>2]=b,mt(i,1,16418,u),g=0}while(0);A=65535&(x=x+1<<16>>16)}while(A>>>0<n>>>0);if(!E){y=0,e=0;do{0==(0|l[M+(e<<2)>>2])&&0!=(0|r[o+(e<<2)+2>>0])&&(l[m>>2]=e,mt(i,1,16541,m),g=0),e=65535&(y=y+1<<16>>16)}while(e>>>0<n>>>0)}}if(!g)return jt(M),w=_,0|(T=0);t:do{if(!(1!=(0|l[t+16>>2])|E)){for(e=0,g=0;e=e+1<<16>>16,0|l[M+(g<<2)>>2];)if((g=65535&e)>>>0>=n>>>0)break t;l[T>>2]=g,mt(i,2,16579,T),g=0,e=0;do{r[o+(e<<2)+2>>0]=1,r[o+(e<<2)+3>>0]=g,e=65535&(g=g+1<<16>>16)}while(e>>>0<n>>>0)}}while(0);return jt(M),w=_,0|(T=1)}function Te(t,e){t|=0;var i,n,o,s,c,u,f,p,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0;if(e=0|l[(p=12+(e|=0)|0)>>2],v=0|l[e+8>>2],w=0|l[e+4>>2],o=0|l[e>>2],n=0|l[e+12>>2],e=0|r[e+18>>0],c=0|l[(s=t+24|0)>>2],f=0|zt(52*(u=255&e)|0)){if(!(i=e<<24>>24==0)){y=0,b=0;do{if(e=0|a[n+(b<<2)>>1],0|r[n+(b<<2)+2>>0]){_=c+(52*(e&=65535)|0)|0,g=52+(m=f+(52*(0|h[n+(b<<2)+3>>0])|0)|0)|0;do{l[m>>2]=l[_>>2],m=m+4|0,_=_+4|0}while((0|m)<(0|g))}else{_=c+(52*(e&=65535)|0)|0,g=52+(m=f+(52*b|0)|0)|0;do{l[m>>2]=l[_>>2],m=m+4|0,_=_+4|0}while((0|m)<(0|g))}if(g=0|zt(0|C(l[c+(52*e|0)+8>>2]<<2,0|l[c+(52*e|0)+12>>2])),l[f+(52*b|0)+44>>2]=g,!g){x=7;break}l[f+(52*b|0)+24>>2]=h[v+b>>0],l[f+(52*b|0)+32>>2]=h[w+b>>0],b=65535&(y=y+1<<16>>16)}while(b>>>0<u>>>0);if(7==(0|x))return void jt(f);if(w=(v=0|d[16+(0|l[p>>2])>>1])-1|0,!i){g=0,e=0;do{if(y=0|l[c+(52*(0|d[n+(e<<2)>>1])|0)+44>>2],_=0|h[n+(e<<2)+3>>0],b=0|C(0|l[f+(52*_|0)+12>>2],0|l[f+(52*_|0)+8>>2]),0|r[n+(e<<2)+2>>0]){if(m=0|l[f+(52*_|0)+44>>2],0|b){e=0;do{x=0|l[y+(e<<2)>>2],x=o+((0|C((0|x)<0?0:(0|x)<(0|v)?x:w,u))+_<<2)|0,l[m+(e<<2)>>2]=l[x>>2],e=e+1|0}while((0|e)!=(0|b))}}else if(m=0|l[f+(52*e|0)+44>>2],0|b){e=0;do{l[m+(e<<2)>>2]=l[y+(e<<2)>>2],e=e+1|0}while((0|e)!=(0|b))}e=65535&(g=g+1<<16>>16)}while(e>>>0<u>>>0)}}if(0|(g=0|l[(_=t+16|0)>>2])){m=0,e=0;do{0|(e=0|l[c+(52*e|0)+44>>2])&&jt(e),e=65535&(m=m+1<<16>>16)}while(g>>>0>e>>>0)}jt(c),l[s>>2]=f,l[_>>2]=u,jt(0|l[4+(0|l[p>>2])>>2]),jt(0|l[8+(0|l[p>>2])>>2]),jt(0|l[l[p>>2]>>2]),e=0|l[p>>2],(m=0|l[e+12>>2])&&(jt(m),e=0|l[p>>2]),jt(e),l[p>>2]=0}}function ke(t,e,i){t|=0,i|=0;var n,r,o,s,c,h,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0;if(h=w,w=w+80|0,s=h+8|0,o=h,r=h+16|0,u=0|l[(c=8+(e|=0)|0)>>2],e=0|l[u>>2],(n=0|a[u+4>>1])<<16>>16){for(E=t+16|0,y=t+24|0,M=65535&n,A=1,S=0;;){v=65535&(b=0|a[e+(6*S|0)>>1]),t=0|l[E>>2];t:do{if(t>>>0>v>>>0){switch((u=0|a[e+(6*S|0)+4>>1])<<16>>16){case-1:case 0:a[(0|l[y>>2])+(52*v|0)+48>>1]=0|a[e+(6*S|0)+2>>1];break t}if(x=65535+(65535&u)&65535,t>>>0<=(m=65535&(g=u+-1<<16>>16))>>>0){l[s>>2]=m,l[s+4>>2]=t,mt(i,2,16290,s);break}if(_=e+(6*S|0)+2|0,b<<16>>16!=g<<16>>16&&0==(0|a[_>>1])){f=t=(u=0|l[y>>2])+(52*v|0)|0,p=(d=r)+52|0;do{l[d>>2]=l[f>>2],d=d+4|0,f=f+4|0}while((0|d)<(0|p));f=u+(52*m|0)|0,p=(d=t)+52|0;do{l[d>>2]=l[f>>2],d=d+4|0,f=f+4|0}while((0|d)<(0|p));f=r,p=52+(d=(0|l[y>>2])+(52*m|0)|0)|0;do{l[d>>2]=l[f>>2],d=d+4|0,f=f+4|0}while((0|d)<(0|p));if((65535&n)>(S+1&65535)){d=A;do{(u=0|a[(t=e+(6*d|0)|0)>>1])<<16>>16!=b<<16>>16?u<<16>>16==g<<16>>16&&(u=b,T=14):(u=x,T=14),14==(0|T)&&(T=0,a[t>>1]=u),d=d+1|0}while(n<<16>>16!=(65535&d)<<16>>16)}}a[(0|l[y>>2])+(52*v|0)+48>>1]=0|a[_>>1]}else l[o>>2]=v,l[o+4>>2]=t,mt(i,2,16250,o)}while(0);if((0|(S=S+1|0))==(0|M))break;A=A+1|0}u=e=0|l[c>>2],e=0|l[e>>2]}return e?(jt(e),jt(T=0|l[c>>2]),l[c>>2]=0,void(w=h)):(jt(T=u),l[c>>2]=0,void(w=h))}function Ce(t){var e=0,i=0,n=0;(t|=0)&&(Xt(0|l[t>>2]),l[t>>2]=0,0|(i=0|l[(e=t+72|0)>>2])&&(jt(i),l[e>>2]=0),0|(i=0|l[(e=t+68|0)>>2])&&(jt(i),l[e>>2]=0),0|(e=0|l[(i=t+108|0)>>2])&&(jt(e),l[i>>2]=0),0|(e=0|l[(n=t+116|0)>>2])&&((i=0|l[e>>2])&&(jt(i),e=0|l[n>>2],l[e>>2]=0),jt(e),l[n>>2]=0),0|(e=0|l[(n=t+120|0)>>2])&&((i=0|l[e+12>>2])&&(jt(i),e=0|l[n>>2],l[e+12>>2]=0),(i=0|l[e+4>>2])&&(jt(i),e=0|l[n>>2],l[e+4>>2]=0),(i=0|l[e+8>>2])&&(jt(i),e=0|l[n>>2],l[e+8>>2]=0),(i=0|l[e>>2])&&(jt(i),e=0|l[n>>2],l[e>>2]=0),jt(e),l[n>>2]=0),0|(i=0|l[(e=t+4|0)>>2])&&(_i(i),l[e>>2]=0),0|(i=0|l[(e=t+8|0)>>2])&&(_i(i),l[e>>2]=0),jt(t))}function Ie(t){t|=0;var e=0;return(e=0|Ut(1,136))?(t=t?0|ae():0|Yt(),l[e>>2]=t,t?(l[(t=e+108|0)>>2]=0,l[t+4>>2]=0,l[t+8>>2]=0,l[t+12>>2]=0,r[t+16>>0]=0,t=0|mi(),l[e+4>>2]=t,t?(t=0|mi(),l[e+8>>2]=t,0|t?0|e:(Ce(e),0|(e=0))):(Ce(e),0|(e=0))):(Ce(e),0|(e=0))):0|e}function Pe(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0,s=0,c=0,h=0,u=0;if(n|=0){r=0;do{s=0|l[(u=t+(r<<2)|0)>>2],a=0|l[(c=e+(r<<2)|0)>>2],h=0|l[(o=i+(r<<2)|0)>>2],l[u>>2]=(a<<1)+s+h>>2,l[c>>2]=h-a,l[o>>2]=s-a,r=r+1|0}while((0|r)!=(0|n))}}function Re(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0,s=0,c=0,h=0,u=0;if(n|=0){r=0;do{h=t+(r<<2)|0,a=0|l[(c=e+(r<<2)|0)>>2],u=0|l[(o=i+(r<<2)|0)>>2],s=(0|l[h>>2])-(u+a>>2)|0,l[h>>2]=s+u,l[c>>2]=s,l[o>>2]=s+a,r=r+1|0}while((0|r)!=(0|n))}}function Be(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0;if(n|=0){r=0;do{v=0|l[(p=t+(r<<2)|0)>>2],b=0|l[(h=e+(r<<2)|0)>>2],y=0|l[(o=i+(r<<2)|0)>>2],_=0|Er(0|(_=0|br(0|(_=0|yr(0|v,0|(c=((0|v)<0)<<31>>31),2449,0)),0|S,4096,0)),0|S,13),g=0|Er(0|(g=0|br(0|(g=0|yr(0|b,0|(s=((0|b)<0)<<31>>31),4809,0)),0|S,4096,0)),0|S,13),m=0|Er(0|(m=0|br(0|(m=0|yr(0|y,0|(a=((0|y)<0)<<31>>31),934,0)),0|S,4096,0)),0|S,13),u=0|Er(0|(u=0|br(0|(u=0|yr(0|v,0|c,1382,0)),0|S,4096,0)),0|S,13),d=0|Er(0|(d=0|br(0|(d=0|yr(0|b,0|s,2714,0)),0|S,4096,0)),0|S,13),f=0|Er(0|(f=0|br(0|(f=0|Tr(0|y,0|a,12)),0|S,4096,0)),0|S,13),c=0|Er(0|(c=0|br(0|(c=0|Tr(0|v,0|c,12)),0|S,4096,0)),0|S,13),s=0|Er(0|(s=0|br(0|(s=0|yr(0|b,0|s,3430,0)),0|S,4096,0)),0|S,13),a=0|Er(0|(a=0|br(0|(a=0|yr(0|y,0|a,666,0)),0|S,4096,0)),0|S,13),l[p>>2]=g+_+m,l[h>>2]=f-(d+u),l[o>>2]=c-s-a,r=r+1|0}while((0|r)!=(0|n))}}function Le(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0,s=0,l=0,c=0,h=0;if(n|=0){r=0;do{s=+m[(h=t+(r<<2)|0)>>2],a=+m[(l=e+(r<<2)|0)>>2],c=+m[(o=i+(r<<2)|0)>>2],m[h>>2]=s+1.4019999504089355*c,m[l>>2]=s-.3441300094127655*a-.714139997959137*c,m[o>>2]=s+1.7719999551773071*a,r=r+1|0}while((0|r)!=(0|n))}}function De(t,e,i,n,r){t|=0,e|=0,i|=0,r|=0;var o,a,s=0,c=0,h=0,u=0,d=0,f=0,p=0,_=0;if(!(a=0|zt((s=0|C(n|=0,n))+n<<2)))return 0|(e=0);if(o=a+(n<<2)|0,0|s)for(r=t,t=0;l[o+(t<<2)>>2]=~~(8192*+m[r>>2]),(0|(t=t+1|0))!=(0|s);)r=r+4|0;t:do{if(0|e){if(n)f=0;else for(r=0;;)if((0|(r=r+1|0))==(0|e))break t;do{r=0;do{l[a+(r<<2)>>2]=l[l[i+(r<<2)>>2]>>2],r=r+1|0}while((0|r)!=(0|n));for(t=o,s=0;;){for(u=0|l[(h=i+(s<<2)|0)>>2],l[u>>2]=0,r=0,c=t,d=0;p=0|l[c>>2],d=d+(p=0|Er(0|(p=0|br(0|(p=0|yr(0|(_=0|l[a+(r<<2)>>2]),((0|_)<0)<<31>>31|0,0|p,((0|p)<0)<<31>>31|0)),0|S,4096,0)),0|S,13))|0,l[u>>2]=d,(0|(r=r+1|0))!=(0|n);)c=c+4|0;if(l[h>>2]=u+4,(0|(s=s+1|0))==(0|n))break;t=t+(n<<2)|0}f=f+1|0}while((0|f)!=(0|e))}}while(0);return jt(a),0|(_=1)}function Oe(t,e,i,n,r){t|=0,e|=0,i|=0,r|=0;var o,a,s=0,c=0,h=0,u=0,d=0,f=0;if(!(a=0|zt((n|=0)<<3)))return 0|(e=0);o=a+(n<<2)|0;t:do{if(0|e){if(n)f=0;else for(r=0;;)if((0|(r=r+1|0))==(0|e))break t;do{r=0;do{l[a+(r<<2)>>2]=l[l[i+(r<<2)>>2]>>2],r=r+1|0}while((0|r)!=(0|n));for(s=t,h=0;;){for(m[(u=o+(h<<2)|0)>>2]=0,r=0,c=s,d=0;d+=+m[c>>2]*+m[a+(r<<2)>>2],m[u>>2]=d,(0|(r=r+1|0))!=(0|n);)c=c+4|0;if(u=0|l[(c=i+(h<<2)|0)>>2],l[c>>2]=u+4,m[u>>2]=d,(0|(h=h+1|0))==(0|n))break;s=s+(n<<2)|0}f=f+1|0}while((0|f)!=(0|e))}}while(0);return jt(a),0|(e=1)}function Fe(t,e,i){t|=0,i|=0;var n=0,r=0,o=0,a=0,s=0,l=0;if(e|=0){o=0;do{for(g[(s=t+(o<<3)|0)>>3]=0,n=0,r=o,a=0;a+=(l=+m[i+(r<<2)>>2])*l,(0|(n=n+1|0))!=(0|e);)r=r+e|0;l=+E(+a),g[s>>3]=l,o=o+1|0}while((0|o)!=(0|e))}}function Ge(t,e,i){t|=0,i|=0;var n,o,a,s,c,h,u,d,f,p,m,_,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0;if(_=w,w=w+32|0,E=_+28|0,A=_+24|0,T=_+20|0,n=_+16|0,k=_+12|0,o=_+8|0,S=_+4|0,x=_,m=0|l[(g=76+(e|=0)|0)>>2],B=1+(0|l[(u=m+(5640*i|0)+420|0)>>2])|0,!(d=0|zt(528*(0|l[(M=t+16|0)>>2])|0)))return w=_,0|(B=0);if(!(f=0|zt(l[M>>2]<<2)))return jt(d),w=_,0|(B=0);if(!(g=0|Ne(t,0|l[g>>2],i)))return jt(d),jt(f),w=_,0|(B=0);if(0|(v=0|l[M>>2]))for(y=d,b=0;l[f+(b<<2)>>2]=y,!((b=b+1|0)>>>0>=v>>>0);)y=y+528|0;if(ze(t,e,i,T,n,k,o,S,x,A,E,f),p=0|l[A>>2],s=0|C(0|l[M>>2],p),h=0|l[E>>2],a=0|C(h,s),l[(b=g+4|0)>>2]=0,a>>>0<=(4294967295/((y=1+(0|l[(c=m+(5640*i|0)+8|0)>>2])|0)>>>0)|0)>>>0&&(R=0|Ut(0|C(y,a),2),l[b>>2]=R,0|R)){if(y=0|l[g+196>>2],R=0|l[t+24>>2],P=0|l[T>>2],l[g+200>>2]=P,I=0|l[k>>2],l[g+204>>2]=I,k=0|l[n>>2],l[g+208>>2]=k,T=0|l[o>>2],l[g+212>>2]=T,l[g+20>>2]=1,l[g+16>>2]=p,l[g+12>>2]=s,l[g+8>>2]=a,0|(M=0|l[g+192>>2]))for(S=R,e=y,x=0;;){if(y=0|l[e+12>>2],b=0|l[f+(x<<2)>>2],l[e>>2]=l[S>>2],l[e+4>>2]=l[S+4>>2],0|(A=0|l[e+8>>2]))for(v=0;l[y>>2]=l[b>>2],l[y+4>>2]=l[b+4>>2],l[y+8>>2]=l[b+8>>2],l[y+12>>2]=l[b+12>>2],!((v=v+1|0)>>>0>=A>>>0);)y=y+16|0,b=b+16|0;if((x=x+1|0)>>>0>=M>>>0)break;S=S+52|0,e=e+16|0}if(B>>>0>1){S=1,E=g;do{if(y=0|l[E+428>>2],l[E+432>>2]=P,l[E+436>>2]=I,l[E+440>>2]=k,l[E+444>>2]=T,l[E+252>>2]=1,l[E+248>>2]=p,l[E+244>>2]=s,l[E+240>>2]=a,0|(t=0|l[E+424>>2]))for(M=R,x=0;;){if(b=0|l[y+12>>2],v=0|l[f+(x<<2)>>2],l[y>>2]=l[M>>2],l[y+4>>2]=l[M+4>>2],0|(A=0|l[y+8>>2]))for(e=0;l[b>>2]=l[v>>2],l[b+4>>2]=l[v+4>>2],l[b+8>>2]=l[v+8>>2],l[b+12>>2]=l[v+12>>2],!((e=e+1|0)>>>0>=A>>>0);)b=b+16|0,v=v+16|0;if((x=x+1|0)>>>0>=t>>>0)break;M=M+52|0,y=y+16|0}l[E+236>>2]=l[E+4>>2],E=E+232|0,S=S+1|0}while((0|S)!=(0|B))}if(jt(d),jt(f),y=0==(0|(x=1+(0|l[u>>2])|0)),4&r[m+(5640*i|0)+5636>>0]){if(y)return w=_,0|(B=g);for(y=m+(5640*i|0)+424|0,b=g,v=0;l[b+80>>2]=l[y+36>>2],l[b+40>>2]=1,l[b+44>>2]=l[y>>2],l[b+48>>2]=l[y+4>>2],l[b+64>>2]=0,l[b+68>>2]=0,l[b+56>>2]=l[y+12>>2],l[b+60>>2]=l[y+16>>2],l[b+52>>2]=l[y+8>>2],l[b+72>>2]=p,(0|(v=v+1|0))!=(0|x);)y=y+148|0,b=b+232|0;return w=_,0|g}if(y)return w=_,0|(B=g);for(e=0|l[m+(5640*i|0)+4>>2],v=0|l[c>>2],y=0,b=g;l[b+80>>2]=e,l[b+40>>2]=1,l[b+44>>2]=0,l[b+48>>2]=0,l[b+64>>2]=0,l[b+68>>2]=0,l[b+56>>2]=h,l[b+60>>2]=l[b+192>>2],l[b+52>>2]=v,l[b+72>>2]=p,(0|(y=y+1|0))!=(0|x);)b=b+232|0;return w=_,0|g}if(jt(d),jt(f),0|(y=0|l[b>>2])&&(jt(y),l[b>>2]=0),0|B)for(S=g,M=0;;){if(0|(y=0|l[(E=S+196|0)>>2])){if(b=0|l[(A=S+192|0)>>2]){for(x=0;(e=0|l[(v=y+12|0)>>2])&&(jt(e),l[v>>2]=0,b=0|l[A>>2]),!((x=x+1|0)>>>0>=b>>>0);)y=y+16|0;y=0|l[E>>2]}jt(y),l[E>>2]=0}if((0|(M=M+1|0))==(0|B))break;S=S+232|0}return jt(g),w=_,0|(B=0)}function Ne(t,e,i){t|=0;var n,r=0,o=0,a=0,s=0,c=0,h=0,u=0;if(!(n=0|Ut(u=1+(0|l[(e|=0)+(5640*(i|=0)|0)+420>>2])|0,232)))return 0|(u=0);if(!u)return 0|(u=n);s=e+(5640*i|0)+5584|0,o=n,a=0,t=0|l[(c=t+16|0)>>2];t:for(;;){if(e=0|Ut(t,16),l[(r=o+196|0)>>2]=e,!e){t=5;break}h=0|l[c>>2],l[o+192>>2]=h;e:do{if(h){if(t=4+(0|l[s>>2])|0,h=0|Ut(0|l[t>>2],16),l[e+12>>2]=h,!h){t=19;break t}for(i=0;;){if(l[e+(i<<4)+8>>2]=l[t>>2],(i=i+1|0)>>>0>=(t=0|l[c>>2])>>>0)break e;if(e=0|l[r>>2],t=(0|l[s>>2])+(1080*i|0)+4|0,h=0|Ut(0|l[t>>2],16),l[e+(i<<4)+12>>2]=h,!h){t=19;break t}}}else t=0}while(0);if((a=a+1|0)>>>0>=u>>>0){t=33;break}o=o+232|0}if(5==(0|t)){for((e=0|l[(t=n+4|0)>>2])?(jt(e),l[t>>2]=0,s=n,c=0):(s=n,c=0);;){if(0|(t=0|l[(h=s+196|0)>>2])){if(e=0|l[(a=s+192|0)>>2]){for(o=0;(r=0|l[(i=t+12|0)>>2])&&(jt(r),l[i>>2]=0,e=0|l[a>>2]),!((o=o+1|0)>>>0>=e>>>0);)t=t+16|0;t=0|l[h>>2]}jt(t),l[h>>2]=0}if((0|(c=c+1|0))==(0|u))break;s=s+232|0}return jt(n),0|(u=0)}if(19==(0|t)){for((e=0|l[(t=n+4|0)>>2])?(jt(e),l[t>>2]=0,s=n,c=0):(s=n,c=0);;){if(0|(t=0|l[(h=s+196|0)>>2])){if(e=0|l[(a=s+192|0)>>2]){for(o=0;(r=0|l[(i=t+12|0)>>2])&&(jt(r),l[i>>2]=0,e=0|l[a>>2]),!((o=o+1|0)>>>0>=e>>>0);)t=t+16|0;t=0|l[h>>2]}jt(t),l[h>>2]=0}if((0|(c=c+1|0))==(0|u))break;s=s+232|0}return jt(n),0|(u=0)}return 33==(0|t)?0|n:0}function ze(t,e,i,n,r,o,a,s,c,h,u,d){t|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,c|=0,h|=0,u|=0,d|=0;var f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0;if(f=0|l[(0|l[76+(e|=0)>>2])+(5640*i|0)+5584>>2],p=0|l[t+24>>2],k=0|l[e+24>>2],T=(0|C(0|l[(I=e+12|0)>>2],(i>>>0)%(k>>>0)|0))+(0|l[e+4>>2])|0,E=0|l[t>>2],l[n>>2]=T>>>0>E>>>0?T:E,T=0|br(0|l[I>>2],0,0|T,0),T|=0-S,I=0|l[t+8>>2],l[r>>2]=T>>>0<I>>>0?T:I,k=(0|C(0|l[(I=e+16|0)>>2],(i>>>0)/(k>>>0)|0))+(0|l[e+8>>2])|0,T=0|l[t+4>>2],l[o>>2]=k>>>0>T>>>0?k:T,k=0|br(0|l[I>>2],0,0|k,0),k|=0-S,I=0|l[t+12>>2],l[a>>2]=k>>>0<I>>>0?k:I,l[h>>2]=0,l[u>>2]=0,l[s>>2]=2147483647,l[c>>2]=2147483647,0|l[(I=t+16|0)>>2])for(E=0;;){if(v=0|l[d+(E<<2)>>2],m=0|l[p>>2],e=((0|l[n>>2])-1+m|0)/(0|m)|0,_=0|l[(T=p+4|0)>>2],i=((0|l[o>>2])-1+_|0)/(0|_)|0,m=(m+-1+(0|l[r>>2])|0)/(0|m)|0,_=(_+-1+(0|l[a>>2])|0)/(0|_)|0,(t=0|l[(k=f+4|0)>>2])>>>0>(0|l[u>>2])>>>0&&(l[u>>2]=t,t=0|l[k>>2]),0|t)for(A=0|br(0|e,((0|e)<0)<<31>>31|0,-1,-1),M=S,w=0|br(0|i,((0|i)<0)<<31>>31|0,-1,-1),x=S,b=0|br(0|m,((0|m)<0)<<31>>31|0,-1,-1),y=S,_=0|br(0|_,((0|_)<0)<<31>>31|0,-1,-1),g=S,m=0,i=v;t=t+-1|0,e=0|l[f+812+(m<<2)>>2],v=0|l[f+944+(m<<2)>>2],l[i>>2]=e,l[i+4>>2]=v,B=l[p>>2]<<e+t,F=l[T>>2]<<v+t,L=0|l[s>>2],l[s>>2]=(0|L)<(0|B)?L:B,B=0|l[c>>2],l[c>>2]=(0|B)<(0|F)?B:F,L=0|Mr(0|(L=0|br(0|A,0|M,0|(F=0|Tr(1,0,0|t)),0|(B=S))),0|S,0|t),P=0|Mr(0|(P=0|br(0|w,0|x,0|F,0|B)),0|S,0|t),O=0|Mr(0|(O=0|br(0|b,0|y,0|F,0|B)),0|S,0|t),B=0|Mr(0|(B=0|br(0|_,0|g,0|F,0|B)),0|S,0|t),F=0|Tr(1,0,0|e),D=S,D=0|Mr(0|(D=0|br(0|(R=0|br(0|O,((0|O)<0)<<31>>31|0,-1,-1)),0|S,0|F,0|D)),0|S,0|e),F=0|Tr(1,0,0|v),R=S,R=0|Mr(0|(R=0|br(0|br(0|B,((0|B)<0)<<31>>31|0,-1,-1),0|S,0|F,0|R)),0|S,0|v),e=(0|L)==(0|O)?0:(D<<e)-(L>>e<<e)>>e,v=(0|P)==(0|B)?0:(R<<v)-(P>>v<<v)>>v,l[i+8>>2]=e,l[i+12>>2]=v,(e=0|C(v,e))>>>0>(0|l[h>>2])>>>0&&(l[h>>2]=e),!((m=m+1|0)>>>0>=(0|l[k>>2])>>>0);)i=i+16|0;if((E=E+1|0)>>>0>=(0|l[I>>2])>>>0)break;f=f+1080|0,p=p+52|0}}function Ue(t,e){e|=0;var i=0,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0;if(t|=0){if(0|(n=0|l[(i=t+4|0)>>2])&&(jt(n),l[i>>2]=0),0|e)for(c=t,h=0;;){if(0|(i=0|l[(u=c+196|0)>>2])){if(n=0|l[(s=c+192|0)>>2]){for(a=0;(o=0|l[(r=i+12|0)>>2])&&(jt(o),l[r>>2]=0,n=0|l[s>>2]),!((a=a+1|0)>>>0>=n>>>0);)i=i+16|0;i=0|l[u>>2]}jt(i),l[u>>2]=0}if((0|(h=h+1|0))==(0|e))break;c=c+232|0}jt(t)}}function He(t,e,i,n){t|=0,i|=0,n|=0;var o,s,c,u,d,f,p,m,_,g,y,b,v,x,A,S,M,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0;if(M=w,w=w+32|0,P=M+28|0,I=M+24|0,R=M+20|0,L=M+16|0,B=M+12|0,D=M+8|0,O=M+4|0,s=M,g=0|l[(x=76+(e|=0)|0)>>2],G=1+(0|l[g+(5640*i|0)+420>>2])|0,!(y=0|zt(528*(0|l[(v=t+16|0)>>2])|0)))return w=M,0|(G=0);if(!(b=0|zt(l[v>>2]<<2)))return jt(y),w=M,0|(G=0);if(!(o=0|Ne(t,0|l[x>>2],i)))return jt(y),jt(b),w=M,0|(G=0);if(0|(k=0|l[v>>2]))for(E=y,T=0;l[b+(T<<2)>>2]=E,!((T=T+1|0)>>>0>=k>>>0);)E=E+528|0;if(ze(t,e,i,R,L,B,D,O,s,I,P,b),S=0|l[I>>2],d=0|C(0|l[v>>2],S),A=0|l[P>>2],u=0|C(A,d),r[o>>0]=(0|h[e+93>>0])>>>3&1,F=0|Ut(0|C(0|l[g+(5640*i|0)+8>>2],u),2),l[(T=o+4|0)>>2]=F,!F){if(jt(y),jt(b),0|(E=0|l[T>>2])&&(jt(E),l[T>>2]=0),0|G)for(R=o,B=0;;){if(0|(E=0|l[(L=R+196|0)>>2])){if(T=0|l[(t=R+192|0)>>2]){for(P=0;(I=0|l[(k=E+12|0)>>2])&&(jt(I),l[k>>2]=0,T=0|l[t>>2]),!((P=P+1|0)>>>0>=T>>>0);)E=E+16|0;E=0|l[L>>2]}jt(E),l[L>>2]=0}if((0|(B=B+1|0))==(0|G))break;R=R+232|0}return jt(o),w=M,0|(G=0)}if(I=0|l[o+196>>2],c=0|l[t+24>>2],F=0|l[R>>2],l[o+200>>2]=F,_=0|l[B>>2],l[o+204>>2]=_,m=0|l[L>>2],l[o+208>>2]=m,p=0|l[D>>2],l[o+212>>2]=p,f=0|l[O>>2],l[o+224>>2]=f,O=0|l[s>>2],l[o+228>>2]=O,l[o+20>>2]=1,l[o+16>>2]=S,l[o+12>>2]=d,l[o+8>>2]=u,0|(B=0|l[o+192>>2]))for(R=c,P=0;;){if(E=0|l[I+12>>2],T=0|l[b+(P<<2)>>2],l[I>>2]=l[R>>2],l[I+4>>2]=l[R+4>>2],0|(t=0|l[I+8>>2]))for(k=0;l[E>>2]=l[T>>2],l[E+4>>2]=l[T+4>>2],l[E+8>>2]=l[T+8>>2],l[E+12>>2]=l[T+12>>2],!((k=k+1|0)>>>0>=t>>>0);)E=E+16|0,T=T+16|0;if((P=P+1|0)>>>0>=B>>>0)break;R=R+52|0,I=I+16|0}if(G>>>0>1){R=1,L=o;do{if(E=0|l[L+428>>2],l[L+432>>2]=F,l[L+436>>2]=_,l[L+440>>2]=m,l[L+444>>2]=p,l[L+456>>2]=f,l[L+460>>2]=O,l[L+252>>2]=1,l[L+248>>2]=S,l[L+244>>2]=d,l[L+240>>2]=u,0|(D=0|l[L+424>>2]))for(B=c,P=0;;){if(T=0|l[E+12>>2],k=0|l[b+(P<<2)>>2],l[E>>2]=l[B>>2],l[E+4>>2]=l[B+4>>2],0|(t=0|l[E+8>>2]))for(I=0;l[T>>2]=l[k>>2],l[T+4>>2]=l[k+4>>2],l[T+8>>2]=l[k+8>>2],l[T+12>>2]=l[k+12>>2],!((I=I+1|0)>>>0>=t>>>0);)T=T+16|0,k=k+16|0;if((P=P+1|0)>>>0>=D>>>0)break;B=B+52|0,E=E+16|0}l[L+236>>2]=l[L+4>>2],L=L+232|0,R=R+1|0}while((0|R)!=(0|G))}jt(y),jt(b);do{if(4&r[g+(5640*i|0)+5636>>0]){if((65535&(E=0|a[e>>1]))>2){if(!(1==(0|n)|(65535&E)<7))break}else if(1!=(0|n))break;return Ve(0|l[x>>2],i,F,m,_,p,S,f,O),w=M,0|(G=o)}}while(0);if(t=0|l[v>>2],E=0|l[x>>2],!(k=1+(0|l[E+(5640*i|0)+420>>2])|0))return w=M,0|(G=o);for(I=0|l[E+(5640*i|0)+8>>2],P=0|l[E+(5640*i|0)+4>>2],T=0,E=E+(5640*i|0)+424|0;l[E+76>>2]=0,l[E+92>>2]=t,l[E+72>>2]=0,l[E+88>>2]=A,l[E+68>>2]=0,l[E+84>>2]=I,l[E+36>>2]=P,l[E+80>>2]=0,l[E+96>>2]=S,l[E+100>>2]=F,l[E+104>>2]=m,l[E+108>>2]=_,l[E+112>>2]=p,l[E+116>>2]=f,l[E+120>>2]=O,(0|(T=T+1|0))!=(0|k);)E=E+148|0;return w=M,0|o}function Ve(t,e,i,n,r,o,a,s,c){i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,c|=0;var h,u=0;if(h=1+(0|l[(t|=0)+(5640*(e|=0)|0)+420>>2])|0,l[t+(5640*e|0)+500>>2]=l[t+(5640*e|0)+428>>2],l[t+(5640*e|0)+516>>2]=l[t+(5640*e|0)+440>>2],l[t+(5640*e|0)+496>>2]=l[t+(5640*e|0)+424>>2],l[t+(5640*e|0)+512>>2]=l[t+(5640*e|0)+436>>2],l[t+(5640*e|0)+508>>2]=l[t+(5640*e|0)+432>>2],l[t+(5640*e|0)+492>>2]=0,l[t+(5640*e|0)+460>>2]=l[t+(5640*e|0)+456>>2],l[t+(5640*e|0)+504>>2]=0,l[t+(5640*e|0)+520>>2]=a,l[t+(5640*e|0)+524>>2]=i,l[t+(5640*e|0)+528>>2]=n,l[t+(5640*e|0)+532>>2]=r,l[t+(5640*e|0)+536>>2]=o,l[t+(5640*e|0)+540>>2]=s,l[t+(5640*e|0)+544>>2]=c,!(h>>>0<=1))for(u=1,t=t+(5640*e|0)+572|0;l[t+76>>2]=l[t+4>>2],l[t+92>>2]=l[t+16>>2],l[t+72>>2]=l[t>>2],l[t+88>>2]=l[t+12>>2],e=0|l[t+8>>2],l[t+84>>2]=e,l[t+36>>2]=l[t+32>>2],l[t+80>>2]=0,l[t+68>>2]=e>>>0>(0|l[t+-64>>2])>>>0?e:0,l[t+96>>2]=a,l[t+100>>2]=i,l[t+104>>2]=n,l[t+108>>2]=r,l[t+112>>2]=o,l[t+116>>2]=s,l[t+120>>2]=c,(0|(u=u+1|0))!=(0|h);)t=t+148|0}function We(t,e,i,n,o,s,c){t|=0,i|=0,n|=0,o|=0,s|=0,c|=0;var h,u,d,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0;Q=0|l[76+(e|=0)>>2],h=0|function(t){t|=0;var e=0,i=0;for(e=696;!(-1==(0|(i=0|l[e>>2]))|(0|i)==(0|t));)e=e+12|0;return e+4|0}(0|l[(d=Q+(5640*i|0)+424+(148*n|0)+36|0)>>2]),l[t+(232*n|0)+40>>2]=1,u=t+(232*n|0)+44|0,l[t+(232*n|0)+80>>2]=l[d>>2];do{if(8&r[e+93>>0]){if((65535&(f=0|a[e>>1]))>2){if(!(1==(0|c)&(65535&f)>6|(f+-3&65535)<4))break}else if(!(1==(0|c)|(f+-3&65535)<4))break;t:do{if((0|s)<3)for(y=Q+(5640*i|0)+424+(148*n|0)+72|0,b=Q+(5640*i|0)+424+(148*n|0)+88|0,v=t+(232*n|0)+56|0,w=Q+(5640*i|0)+424+(148*n|0)+76|0,x=t+(232*n|0)+48|0,A=Q+(5640*i|0)+424+(148*n|0)+92|0,S=t+(232*n|0)+60|0,M=Q+(5640*i|0)+424+(148*n|0)+68|0,E=t+(232*n|0)+64|0,T=Q+(5640*i|0)+424+(148*n|0)+84|0,k=t+(232*n|0)+52|0,C=Q+(5640*i|0)+424+(148*n|0)+80|0,I=t+(232*n|0)+68|0,P=Q+(5640*i|0)+424+(148*n|0)+96|0,R=t+(232*n|0)+72|0,B=Q+(5640*i|0)+424+(148*n|0)+100|0,L=t+(232*n|0)+96|0,D=Q+(5640*i|0)+424+(148*n|0)+108|0,O=t+(232*n|0)+104|0,F=Q+(5640*i|0)+424+(148*n|0)+104|0,G=t+(232*n|0)+100|0,N=Q+(5640*i|0)+424+(148*n|0)+112|0,z=t+(232*n|0)+108|0,f=s;;){switch(c=f,0|r[h+(f=f+1|0)>>0]){case 82:p=v,m=b,_=u,g=y,J=10;break;case 67:p=S,m=A,_=x,g=w,J=10;break;case 76:p=k,m=T,_=E,g=M,J=10;break;case 80:(0|l[d>>2])>>>0<2?(p=R,m=P,_=I,g=C,J=10):(l[L>>2]=l[B>>2],l[O>>2]=l[D>>2],p=z,m=N,_=G,g=F,J=10)}if(10==(0|J)&&(J=0,l[_>>2]=l[g>>2],l[p>>2]=l[m>>2]),(0|c)>=2)break t}}while(0);if(f=(0|s)>-1,!o){if(!f)return;for(m=Q+(5640*i|0)+424+(148*n|0)+76|0,_=Q+(5640*i|0)+424+(148*n|0)+132|0,g=t+(232*n|0)+48|0,y=t+(232*n|0)+60|0,b=Q+(5640*i|0)+424+(148*n|0)+72|0,v=Q+(5640*i|0)+424+(148*n|0)+128|0,w=t+(232*n|0)+56|0,x=Q+(5640*i|0)+424+(148*n|0)+68|0,A=Q+(5640*i|0)+424+(148*n|0)+124|0,S=t+(232*n|0)+64|0,M=t+(232*n|0)+52|0,E=Q+(5640*i|0)+424+(148*n|0)+80|0,T=Q+(5640*i|0)+424+(148*n|0)+136|0,k=t+(232*n|0)+68|0,C=t+(232*n|0)+72|0,I=Q+(5640*i|0)+424+(148*n|0)+100|0,P=Q+(5640*i|0)+424+(148*n|0)+140|0,R=Q+(5640*i|0)+424+(148*n|0)+108|0,B=Q+(5640*i|0)+424+(148*n|0)+144|0,L=t+(232*n|0)+96|0,D=Q+(5640*i|0)+424+(148*n|0)+116|0,O=t+(232*n|0)+100|0,F=t+(232*n|0)+104|0,p=Q+(5640*i|0)+424+(148*n|0)+120|0,c=t+(232*n|0)+108|0,f=s;;){t:do{switch(0|r[h+f>>0]){case 67:n=0|l[m>>2],l[g>>2]=n,n=n+1|0,l[y>>2]=n,l[_>>2]=n;break;case 82:n=0|l[b>>2],l[u>>2]=n,n=n+1|0,l[w>>2]=n,l[v>>2]=n;break;case 76:n=0|l[x>>2],l[S>>2]=n,n=n+1|0,l[M>>2]=n,l[A>>2]=n;break;case 80:if((0|l[d>>2])>>>0<2){n=0|l[E>>2],l[k>>2]=n,n=n+1|0,l[C>>2]=n,l[T>>2]=n;break t}n=0|l[I>>2],s=0|l[R>>2],l[L>>2]=n,i=(i=0|l[D>>2])+n-((n>>>0)%(i>>>0)|0)|0,l[O>>2]=i,l[F>>2]=s,n=(n=0|l[p>>2])+s-((s>>>0)%(n>>>0)|0)|0,l[c>>2]=n,l[P>>2]=i,l[B>>2]=n;break t}}while(0);if(!((0|f)>0))break;f=f+-1|0}return}if(!f)return;for(W=Q+(5640*i|0)+424+(148*n|0)+128|0,j=Q+(5640*i|0)+424+(148*n|0)+88|0,Z=Q+(5640*i|0)+424+(148*n|0)+72|0,Y=t+(232*n|0)+56|0,X=Q+(5640*i|0)+424+(148*n|0)+132|0,x=Q+(5640*i|0)+424+(148*n|0)+92|0,A=Q+(5640*i|0)+424+(148*n|0)+76|0,S=t+(232*n|0)+48|0,M=t+(232*n|0)+60|0,E=Q+(5640*i|0)+424+(148*n|0)+124|0,T=Q+(5640*i|0)+424+(148*n|0)+84|0,k=Q+(5640*i|0)+424+(148*n|0)+68|0,C=t+(232*n|0)+64|0,I=t+(232*n|0)+52|0,P=Q+(5640*i|0)+424+(148*n|0)+136|0,R=Q+(5640*i|0)+424+(148*n|0)+96|0,B=Q+(5640*i|0)+424+(148*n|0)+80|0,L=t+(232*n|0)+68|0,D=t+(232*n|0)+72|0,O=Q+(5640*i|0)+424+(148*n|0)+140|0,F=Q+(5640*i|0)+424+(148*n|0)+104|0,G=t+(232*n|0)+96|0,N=Q+(5640*i|0)+424+(148*n|0)+116|0,z=t+(232*n|0)+100|0,o=Q+(5640*i|0)+424+(148*n|0)+144|0,U=Q+(5640*i|0)+424+(148*n|0)+112|0,H=t+(232*n|0)+104|0,V=Q+(5640*i|0)+424+(148*n|0)+120|0,v=t+(232*n|0)+108|0,w=Q+(5640*i|0)+424+(148*n|0)+100|0,b=Q+(5640*i|0)+424+(148*n|0)+108|0,f=1,y=s;;){g=h+y|0;t:do{switch(0|r[g>>0]){case 67:c=M,p=X,m=(0|l[X>>2])-1|0,_=S,J=35;break;case 82:c=Y,p=W,m=(0|l[W>>2])-1|0,_=u,J=35;break;case 76:c=I,p=E,m=(0|l[E>>2])-1|0,_=C,J=35;break;case 80:if((0|l[d>>2])>>>0<2){c=D,p=P,m=(0|l[P>>2])-1|0,_=L,J=35;break t}_=0|l[O>>2],m=0|l[N>>2],l[G>>2]=_-m-((_>>>0)%(m>>>0)|0),l[z>>2]=_,c=v,p=o,m=(_=0|l[o>>2])-(m=0|l[V>>2])-((_>>>0)%(m>>>0)|0)|0,_=H,J=35;break t}}while(0);35==(0|J)&&(J=0,l[_>>2]=m,l[c>>2]=l[p>>2]);t:do{if(1==(0|f))switch(0|r[g>>0]){case 82:if((0|(f=0|l[W>>2]))!=(0|l[j>>2])){l[u>>2]=f,f=f+1|0,l[Y>>2]=f,l[W>>2]=f,f=0;break t}if(!(0|je(y+-1|0,e,i,n,h))){f=0;break t}f=0|l[Z>>2],l[u>>2]=f,f=f+1|0,l[Y>>2]=f,l[W>>2]=f,f=1;break t;case 67:if((0|(f=0|l[X>>2]))!=(0|l[x>>2])){l[S>>2]=f,f=f+1|0,l[M>>2]=f,l[X>>2]=f,f=0;break t}if(!(0|je(y+-1|0,e,i,n,h))){f=0;break t}f=0|l[A>>2],l[S>>2]=f,f=f+1|0,l[M>>2]=f,l[X>>2]=f,f=1;break t;case 76:if((0|(f=0|l[E>>2]))!=(0|l[T>>2])){l[C>>2]=f,f=f+1|0,l[I>>2]=f,l[E>>2]=f,f=0;break t}if(!(0|je(y+-1|0,e,i,n,h))){f=0;break t}f=0|l[k>>2],l[C>>2]=f,f=f+1|0,l[I>>2]=f,l[E>>2]=f,f=1;break t;case 80:if((0|l[d>>2])>>>0<2){if((0|(f=0|l[P>>2]))!=(0|l[R>>2])){l[L>>2]=f,f=f+1|0,l[D>>2]=f,l[P>>2]=f,f=0;break t}if(!(0|je(y+-1|0,e,i,n,h))){f=0;break t}f=0|l[B>>2],l[L>>2]=f,f=f+1|0,l[D>>2]=f,l[P>>2]=f,f=1;break t}if((f=0|l[O>>2])>>>0<(0|l[F>>2])>>>0){l[G>>2]=f,f=(s=0|l[N>>2])+f-((f>>>0)%(s>>>0)|0)|0,l[z>>2]=f,l[O>>2]=f,f=0;break t}if((c=0|l[o>>2])>>>0<(0|l[U>>2])>>>0)l[H>>2]=c,f=0,p=(s=0|l[V>>2])+c|0,c=(c>>>0)%(s>>>0)|0;else{if(!(0|je(y+-1|0,e,i,n,h))){f=0;break t}s=0|l[b>>2],l[o>>2]=s,l[H>>2]=s,f=1,p=(c=0|l[V>>2])+s|0,c=(s>>>0)%(c>>>0)|0}Q=p-c|0,l[v>>2]=Q,l[o>>2]=Q,Q=0|l[w>>2],l[G>>2]=Q,s=(s=0|l[N>>2])+Q-((Q>>>0)%(s>>>0)|0)|0,l[z>>2]=s,l[O>>2]=s;break t;default:f=1;break t}}while(0);if(!((0|y)>0))break;y=y+-1|0}return}}while(0);l[u>>2]=l[Q+(5640*i|0)+424+(148*n|0)+72>>2],l[t+(232*n|0)+56>>2]=l[Q+(5640*i|0)+424+(148*n|0)+88>>2],l[t+(232*n|0)+48>>2]=l[Q+(5640*i|0)+424+(148*n|0)+76>>2],l[t+(232*n|0)+60>>2]=l[Q+(5640*i|0)+424+(148*n|0)+92>>2],l[t+(232*n|0)+64>>2]=l[Q+(5640*i|0)+424+(148*n|0)+68>>2],l[t+(232*n|0)+52>>2]=l[Q+(5640*i|0)+424+(148*n|0)+84>>2],l[t+(232*n|0)+68>>2]=l[Q+(5640*i|0)+424+(148*n|0)+80>>2],l[t+(232*n|0)+72>>2]=l[Q+(5640*i|0)+424+(148*n|0)+96>>2],l[t+(232*n|0)+96>>2]=l[Q+(5640*i|0)+424+(148*n|0)+100>>2],l[t+(232*n|0)+104>>2]=l[Q+(5640*i|0)+424+(148*n|0)+108>>2],l[t+(232*n|0)+100>>2]=l[Q+(5640*i|0)+424+(148*n|0)+104>>2],l[t+(232*n|0)+108>>2]=l[Q+(5640*i|0)+424+(148*n|0)+112>>2]}function je(t,e,i,n,o){t|=0,i|=0,n|=0,o|=0;var a,s=0,c=0;if(a=0|l[76+(e|=0)>>2],!((0|t)>-1))return c=0,0|(c&=1);s=t;t:for(;;){switch(0|r[o+s>>0]){case 82:c=3;break t;case 67:c=5;break t;case 76:c=7;break t;case 80:c=9;break t}s=s+-1|0}return 3==(0|c)?(0|l[a+(5640*i|0)+424+(148*n|0)+128>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+88>>2])?(c=1,0|(c&=1)):(c=0!=(0|je(t+-1|0,e,i,n,o)),0|(c&=1)):5==(0|c)?(0|l[a+(5640*i|0)+424+(148*n|0)+132>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+92>>2])?(c=1,0|(c&=1)):(c=0!=(0|je(t+-1|0,e,i,n,o)),0|(c&=1)):7==(0|c)?(0|l[a+(5640*i|0)+424+(148*n|0)+124>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+84>>2])?(c=1,0|(c&=1)):(c=0!=(0|je(t+-1|0,e,i,n,o)),0|(c&=1)):9==(0|c)?(0|l[a+(5640*i|0)+424+(148*n|0)+36>>2])>>>0<2?(0|l[a+(5640*i|0)+424+(148*n|0)+136>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+96>>2])?(c=1,0|(c&=1)):(c=0!=(0|je(s+-1|0,e,i,n,o)),0|(c&=1)):(0|l[a+(5640*i|0)+424+(148*n|0)+140>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+104>>2])?(c=1,0|(c&=1)):(0|l[a+(5640*i|0)+424+(148*n|0)+144>>2])!=(0|l[a+(5640*i|0)+424+(148*n|0)+112>>2])?(c=1,0|(c&=1)):(c=0!=(0|je(s+-1|0,e,i,n,o)),0|(c&=1)):0}function Ze(t,e,i){t|=0,i|=0;var n,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0;if(n=0|l[76+(e|=0)>>2],O=(i>>>0)%((B=0|l[e+24>>2])>>>0)|0,B=(i>>>0)/(B>>>0)|0,L=0|l[e+4>>2],I=0|l[e+12>>2],D=(0|(k=(0|C(I,O))+L|0))>(0|(D=0|l[t>>2]))?k:D,O=(0|(L=(0|C(I,O+1|0))+L|0))<(0|(O=0|l[t+8>>2]))?L:O,L=0|l[e+8>>2],I=0|l[e+16>>2],R=(0|(k=(0|C(I,B))+L|0))>(0|(R=0|l[t+4>>2]))?k:R,B=(0|(L=(0|C(I,B+1|0))+L|0))<(0|(B=0|l[t+12>>2]))?L:B,L=0|l[t+16>>2])for(E=D+-1|0,T=R+-1|0,k=O+-1|0,I=B+-1|0,u=2147483647,M=0|l[n+(5640*i|0)+5584>>2],x=0|l[t+24>>2],A=0,h=2147483647,d=0,o=0;;){if(e=(E+(b=0|l[x>>2])|0)/(0|b)|0,t=(T+(v=0|l[x+4>>2])|0)/(0|v)|0,a=(k+b|0)/(0|b)|0,s=(I+v|0)/(0|v)|0,(w=0|l[M+4>>2])>>>0<=d>>>0?w&&(P=5):(d=w,P=5),5==(0|P)&&(P=0,g=0|br(0|e,((0|e)<0)<<31>>31|0,-1,-1),y=S,m=0|br(0|t,((0|t)<0)<<31>>31|0,-1,-1),_=S,f=0|br(0|a,((0|a)<0)<<31>>31|0,-1,-1),p=S,s=0|br(0|s,((0|s)<0)<<31>>31|0,-1,-1),c=S,G=0|l[M+812>>2],e=v<<(a=0|l[M+944>>2])+(F=w+-1|0),h=h>>>0<(z=b<<F+G)>>>0?h:z,u=u>>>0<e>>>0?u:e,N=0|Mr(0|(N=0|br(0|g,0|y,0|(e=0|Tr(1,0,0|F)),0|(z=S))),0|S,0|F),t=0|Mr(0|(t=0|br(0|m,0|_,0|e,0|z)),0|S,0|F),U=0|Mr(0|(U=0|br(0|f,0|p,0|e,0|z)),0|S,0|F),F=0|Mr(0|(z=0|br(0|s,0|c,0|e,0|z)),0|S,0|F),z=0|Mr(0|(z=0|br(0|(z=0|br(0|(z=0|Tr(1,0,0|G)),0|S,-1,-1)),0|S,0|U,((0|U)<0)<<31>>31|0)),0|S,0|G),e=0|Mr(0|(e=0|br(0|(e=0|br(0|(e=0|Tr(1,0,0|a)),0|S,-1,-1)),0|S,0|F,((0|F)<0)<<31>>31|0)),0|S,0|a),o=(a=0|C((0|N)==(0|U)?0:(z<<G)-(N>>G<<G)>>G,(0|t)==(0|F)?0:(e<<a)-(t>>a<<a)>>a))>>>0>o>>>0?a:o,w>>>0>1))for(t=-1,a=1;G=0|l[M+812+(a<<2)>>2],z=v<<(e=0|l[M+944+(a<<2)>>2])+(N=t+-1+w|0),h=h>>>0<(t=b<<N+G)>>>0?h:t,u=u>>>0<z>>>0?u:z,F=0|Mr(0|(F=0|br(0|g,0|y,0|(z=0|Tr(1,0,0|N)),0|(t=S))),0|S,0|N),U=0|Mr(0|(U=0|br(0|m,0|_,0|z,0|t)),0|S,0|N),H=0|Mr(0|(H=0|br(0|f,0|p,0|z,0|t)),0|S,0|N),N=0|Mr(0|(t=0|br(0|s,0|c,0|z,0|t)),0|S,0|N),t=0|Mr(0|(t=0|br(0|(t=0|br(0|(t=0|Tr(1,0,0|G)),0|S,-1,-1)),0|S,0|H,((0|H)<0)<<31>>31|0)),0|S,0|G),z=0|Mr(0|(z=0|br(0|(z=0|br(0|(z=0|Tr(1,0,0|e)),0|S,-1,-1)),0|S,0|N,((0|N)<0)<<31>>31|0)),0|S,0|e),o=(e=0|C((0|F)==(0|H)?0:(t<<G)-(F>>G<<G)>>G,(0|U)==(0|N)?0:(z<<e)-(U>>e<<e)>>e))>>>0>o>>>0?e:o,(e=a+1|0)>>>0<w>>>0;)t=~a,a=e;if((A=A+1|0)>>>0>=L>>>0)break;M=M+1080|0,x=x+52|0}else d=0,u=2147483647,h=2147483647,o=0;if(4&r[n+(5640*i|0)+5636>>0])Ve(n,i,D,O,R,B,o,h,u);else if(a=1+(0|l[n+(5640*i|0)+420>>2])|0)for(s=0|l[n+(5640*i|0)+8>>2],c=0|l[n+(5640*i|0)+4>>2],t=0,e=n+(5640*i|0)+424|0;l[e+76>>2]=0,l[e+92>>2]=L,l[e+72>>2]=0,l[e+88>>2]=d,l[e+68>>2]=0,l[e+84>>2]=s,l[e+36>>2]=c,l[e+80>>2]=0,l[e+96>>2]=o,l[e+100>>2]=D,l[e+104>>2]=O,l[e+108>>2]=R,l[e+112>>2]=B,l[e+116>>2]=h,l[e+120>>2]=u,(0|(t=t+1|0))!=(0|a);)e=e+148|0}function Ye(t){var e=0,i=0,n=0,o=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0,et=0,it=0,nt=0,rt=0,ot=0,at=0,st=0,lt=0,ct=0,ht=0,ut=0,dt=0,ft=0,pt=0,mt=0,_t=0,gt=0,yt=0,bt=0,vt=0,wt=0,xt=0,At=0,St=0,Mt=0,Et=0,Tt=0,kt=0,Ct=0,It=0,Pt=0,Rt=0,Bt=0,Lt=0,Dt=0,Ot=0,Ft=0,Gt=0,Nt=0,zt=0,Ut=0,Ht=0,Vt=0,Wt=0,jt=0,Zt=0,Yt=0,Xt=0,Jt=0,Qt=0,qt=0,Kt=0,$t=0,te=0,ee=0,ie=0,ne=0,re=0,oe=0,ae=0,se=0,le=0,ce=0,he=0,ue=0,de=0,fe=0;switch(0|l[80+(t|=0)>>2]){case 0:for(0|l[(e=t+40|0)>>2]?(l[e>>2]=0,w=0|l[t+64>>2],l[t+36>>2]=w,i=5):(u=P=t+32|0,P=0|l[P>>2],i=18);;){if(5==(0|i)){if(w>>>0>=(0|l[t+52>>2])>>>0){fe=0,i=153;break}M=0|l[t+44>>2],l[t+28>>2]=M,i=7}else 18==(0|i)&&(c=P+1|0,l[u>>2]=c,o=u,i=14);for(;;){if(7==(0|i)){if(i=0,M>>>0>=(0|l[t+56>>2])>>>0){i=21;break}E=0|l[t+48>>2],l[(m=t+24|0)>>2]=E}else if(14==(0|i)){if(c>>>0<(0|l[t+72>>2])>>>0){i=16;break}f=R=t+24|0,R=0|l[R>>2],i=19}for(;;){if(19==(0|i)&&(i=0,E=R+1|0,l[f>>2]=E,m=f),E>>>0>=(0|l[t+60>>2])>>>0){i=20;break}if(T=0|l[t+196>>2],(k=0|l[t+28>>2])>>>0<(0|l[T+(E<<4)+8>>2])>>>0)break;f=m,R=E,i=19}20!=(0|i)?(e=0|l[T+(E<<4)+12>>2],0|r[t>>0]||(de=0|C(0|l[e+(k<<4)+12>>2],0|l[e+(k<<4)+8>>2]),l[t+72>>2]=de),c=0|l[t+68>>2],l[(o=t+32|0)>>2]=c,i=14):(M=1+(0|l[(i=t+28|0)>>2])|0,l[i>>2]=M,i=7)}if(16==(0|i)){if(i=0,I=0|C(0|l[t+8>>2],0|l[t+36>>2]),I=(I=(I=(0|C(0|l[t+12>>2],0|l[t+28>>2]))+I|0)+(0|C(0|l[t+16>>2],0|l[t+24>>2]))|0)+(0|C(0|l[t+20>>2],c))|0,I=(0|l[t+4>>2])+(I<<1)|0,0|a[I>>1]){u=o,P=c,i=18;continue}break}21!=(0|i)||(w=1+(0|l[(i=t+36|0)>>2])|0,l[i>>2]=w,i=5)}return 153==(0|i)?0|fe:(a[I>>1]=1,0|(t=1));case 1:for(0|l[(e=t+40|0)>>2]?(l[e>>2]=0,B=0|l[t+44>>2],l[t+28>>2]=B,i=25):(h=A=t+32|0,A=0|l[A>>2],i=38);;){if(25==(0|i)){if(B>>>0>=(0|l[t+56>>2])>>>0){fe=0,i=153;break}g=0|l[t+64>>2],l[t+36>>2]=g,i=27}else 38==(0|i)&&(s=A+1|0,l[h>>2]=s,n=h,i=34);for(;;){if(27==(0|i)){if(i=0,g>>>0>=(0|l[t+52>>2])>>>0){i=41;break}y=0|l[t+48>>2],l[(p=t+24|0)>>2]=y}else if(34==(0|i)){if(s>>>0<(0|l[t+72>>2])>>>0){i=36;break}d=S=t+24|0,S=0|l[S>>2],i=39}for(;;){if(39==(0|i)&&(i=0,y=S+1|0,l[d>>2]=y,p=d),y>>>0>=(0|l[t+60>>2])>>>0){i=40;break}if(b=0|l[t+196>>2],(v=0|l[t+28>>2])>>>0<(0|l[b+(y<<4)+8>>2])>>>0)break;d=p,S=y,i=39}40!=(0|i)?(e=0|l[b+(y<<4)+12>>2],0|r[t>>0]||(de=0|C(0|l[e+(v<<4)+12>>2],0|l[e+(v<<4)+8>>2]),l[t+72>>2]=de),s=0|l[t+68>>2],l[(n=t+32|0)>>2]=s,i=34):(g=1+(0|l[(i=t+36|0)>>2])|0,l[i>>2]=g,i=27)}if(36==(0|i)){if(i=0,x=0|C(0|l[t+8>>2],0|l[t+36>>2]),x=(x=(x=(0|C(0|l[t+12>>2],0|l[t+28>>2]))+x|0)+(0|C(0|l[t+16>>2],0|l[t+24>>2]))|0)+(0|C(0|l[t+20>>2],s))|0,x=(0|l[t+4>>2])+(x<<1)|0,0|a[x>>1]){h=n,A=s,i=38;continue}break}41!=(0|i)||(B=1+(0|l[(i=t+28|0)>>2])|0,l[i>>2]=B,i=25)}return 153==(0|i)?0|fe:(a[x>>1]=1,0|(t=1));case 2:if(0|l[(e=t+40|0)>>2]){if(l[e>>2]=0,l[(m=t+224|0)>>2]=0,l[(_=t+228|0)>>2]=0,0|(g=0|l[t+192>>2])){y=0|l[t+196>>2],p=0,i=0,e=0;do{if(c=0|l[y+(p<<4)+8>>2]){if(h=0|l[y+(p<<4)+12>>2],u=0|l[y+(p<<4)>>2],d=0|l[y+(p<<4)+4>>2],f=c+-1|0,Vt=u<<(0|l[h>>2])+f,Wt=d<<(0|l[h+4>>2])+f,i=0==(0|i)?Vt:i>>>0<Vt>>>0?i:Vt,e=0==(0|e)?Wt:e>>>0<Wt>>>0?e:Wt,1!=(0|c))for(o=-1,s=1;Wt=u<<(n=f+o|0)+(0|l[h+(s<<4)>>2]),n=d<<(0|l[h+(s<<4)+4>>2])+n,i=0==(0|i)?Wt:i>>>0<Wt>>>0?i:Wt,e=0==(0|e)?n:e>>>0<n>>>0?e:n,(n=s+1|0)>>>0<c>>>0;)o=~s,s=n;l[m>>2]=i,l[_>>2]=e}p=p+1|0}while((0|p)!=(0|g))}0|r[t>>0]||(l[t+104>>2]=l[t+204>>2],l[t+96>>2]=l[t+200>>2],l[t+108>>2]=l[t+212>>2],l[t+100>>2]=l[t+208>>2]),O=0|l[t+44>>2],l[t+28>>2]=O,i=54}else jt=ue=t+36|0,ue=0|l[ue>>2],i=75;for(;;){if(54==(0|i)){if(O>>>0>=(0|l[t+56>>2])>>>0){fe=0,i=153;break}Jt=0|l[t+104>>2],l[t+220>>2]=Jt,i=56}else 75==(0|i)&&(ce=ue+1|0,l[jt>>2]=ce,Zt=jt,i=71);for(;;){if(56==(0|i)){if((0|Jt)>=(0|l[t+108>>2])){i=79;break}Qt=0|l[t+96>>2],l[t+216>>2]=Qt,i=58}else if(71==(0|i)){if(ce>>>0<(0|l[t+52>>2])>>>0){i=73;break}Yt=de=t+24|0,de=0|l[de>>2],i=76}for(;;){if(58==(0|i)){if((0|Qt)>=(0|l[t+100>>2])){i=78;break}qt=0|l[t+48>>2],l[(Xt=t+24|0)>>2]=qt}else 76==(0|i)&&(qt=de+1|0,l[Yt>>2]=qt,Xt=Yt);if(qt>>>0>=(0|l[t+60>>2])>>>0)Qt=0|l[t+224>>2],Qt=(Wt=0|l[(i=t+216|0)>>2])+Qt-((0|Wt)%(0|Qt)|0)|0,l[i>>2]=Qt,i=58;else if(i=0|l[t+196>>2],(d=0|l[t+28>>2])>>>0>=(e=0|l[i+(qt<<4)+8>>2])>>>0)Yt=Xt,de=qt,i=76;else{if(f=0|l[i+(qt<<4)+12>>2],s=e+~d|0,$t=((c=0|l[t+200>>2])-1+(Kt=(h=0|l[i+(qt<<4)>>2])<<s)|0)/(0|Kt)|0,ee=((u=0|l[t+204>>2])-1+(te=(Wt=0|l[i+(qt<<4)+4>>2])<<s)|0)/(0|te)|0,e=((ie=Kt+-1|0)+(0|l[t+208>>2])|0)/(0|Kt)|0,i=((ne=te+-1|0)+(0|l[t+212>>2])|0)/(0|te)|0,n=(re=0|l[f+(d<<4)>>2])+s|0,o=(oe=0|l[f+(d<<4)+4>>2])+s|0,0|(0|(ae=0|l[t+220>>2]))%(Wt<<o|0)){if((0|ae)!=(0|u)){Yt=Xt,de=qt,i=76;continue}if(!((ee<<s|0)%(1<<o|0)|0)){Yt=Xt,de=qt,i=76;continue}}if(0|(0|(se=0|l[t+216>>2]))%(h<<n|0)){if((0|se)!=(0|c)){Yt=Xt,de=qt,i=76;continue}if(!(($t<<s|0)%(1<<n|0)|0)){Yt=Xt,de=qt,i=76;continue}}if(le=0|l[f+(d<<4)+8>>2]){if(!((0|ee)==(0|i)|((0|$t)==(0|e)?1:0==(0|l[f+(d<<4)+12>>2])))){i=70;break}Yt=Xt,de=qt,i=76}else Yt=Xt,de=qt,i=76}}70!=(0|i)?78!=(0|i)||(Jt=0|l[t+228>>2],Jt=(Wt=0|l[(i=t+220|0)>>2])+Jt-((0|Wt)%(0|Jt)|0)|0,l[i>>2]=Jt,i=56):(ce=(((ie+se|0)/(0|Kt)|0)>>re)-($t>>re)+(0|C((((ne+ae|0)/(0|te)|0)>>oe)-(ee>>oe)|0,le))|0,l[t+32>>2]=ce,ce=0|l[t+64>>2],l[(Zt=t+36|0)>>2]=ce,i=71)}if(73==(0|i)){if(i=0,he=0|C(0|l[t+8>>2],ce),he=(he=(he=(0|C(0|l[t+12>>2],0|l[t+28>>2]))+he|0)+(0|C(0|l[t+16>>2],0|l[t+24>>2]))|0)+(0|C(0|l[t+20>>2],0|l[t+32>>2]))|0,he=(0|l[t+4>>2])+(he<<1)|0,0|a[he>>1]){jt=Zt,ue=ce,i=75;continue}break}79!=(0|i)||(O=1+(0|l[(i=t+28|0)>>2])|0,l[i>>2]=O,i=54)}return 153==(0|i)?0|fe:(a[he>>1]=1,0|(t=1));case 3:if(0|l[(i=t+40|0)>>2]){if(l[i>>2]=0,l[(m=t+224|0)>>2]=0,l[(_=t+228|0)>>2]=0,0|(g=0|l[t+192>>2])){y=0|l[t+196>>2],p=0,i=0,e=0;do{if(c=0|l[y+(p<<4)+8>>2]){if(h=0|l[y+(p<<4)+12>>2],u=0|l[y+(p<<4)>>2],d=0|l[y+(p<<4)+4>>2],f=c+-1|0,ue=u<<(0|l[h>>2])+f,de=d<<(0|l[h+4>>2])+f,i=0==(0|i)?ue:i>>>0<ue>>>0?i:ue,e=0==(0|e)?de:e>>>0<de>>>0?e:de,1!=(0|c))for(o=-1,s=1;de=u<<(n=f+o|0)+(0|l[h+(s<<4)>>2]),n=d<<(0|l[h+(s<<4)+4>>2])+n,i=0==(0|i)?de:i>>>0<de>>>0?i:de,e=0==(0|e)?n:e>>>0<n>>>0?e:n,(n=s+1|0)>>>0<c>>>0;)o=~s,s=n;l[m>>2]=i,l[_>>2]=e}p=p+1|0}while((0|p)!=(0|g))}0|r[t>>0]?e=0|l[t+104>>2]:(e=0|l[t+204>>2],l[t+104>>2]=e,l[t+96>>2]=l[t+200>>2],l[t+108>>2]=l[t+212>>2],l[t+100>>2]=l[t+208>>2]),l[t+220>>2]=e,i=93}else Vt=0|l[t+24>>2],zt=t+36|0,gt=(0|l[t+196>>2])+(Vt<<4)|0,bt=zt,zt=0|l[zt>>2],i=113;for(;;){if(93==(0|i)){if((0|e)>=(0|l[t+108>>2])){fe=0,i=153;break}At=0|l[t+96>>2],l[t+216>>2]=At,i=95}else 113==(0|i)&&(Ft=zt+1|0,l[bt>>2]=Ft,_t=gt,vt=bt,Gt=Vt,i=109);for(;;){if(95==(0|i)){if((0|At)>=(0|l[t+100>>2])){i=117;break}St=0|l[t+48>>2],l[t+24>>2]=St,i=97}else if(109==(0|i)){if(Ft>>>0<(0|l[t+52>>2])>>>0){i=111;break}yt=_t,wt=Ut=t+28|0,Ut=0|l[Ut>>2],Wt=Gt,i=114}for(;;){if(97==(0|i)){if(St>>>0>=(0|l[t+60>>2])>>>0){i=116;break}mt=(0|l[t+196>>2])+(St<<4)|0,Mt=0|l[t+44>>2],l[(xt=t+28|0)>>2]=Mt,Ht=St}else 114==(0|i)&&(Mt=Ut+1|0,l[wt>>2]=Mt,mt=yt,xt=wt,Ht=Wt);if(Mt>>>0>=((de=0|l[t+56>>2])>>>0<(i=0|l[mt+8>>2])>>>0?de:i)>>>0)St=Ht+1|0,l[t+24>>2]=St,i=97;else{if(f=0|l[mt+12>>2],i=i+~Mt|0,Tt=((n=0|l[t+200>>2])-1+(Et=(o=0|l[mt>>2])<<i)|0)/(0|Et)|0,Ct=((s=0|l[t+204>>2])-1+(kt=(de=0|l[mt+4>>2])<<i)|0)/(0|kt)|0,c=((It=Et+-1|0)+(0|l[t+208>>2])|0)/(0|Et)|0,h=((Pt=kt+-1|0)+(0|l[t+212>>2])|0)/(0|kt)|0,u=(Rt=0|l[f+(Mt<<4)>>2])+i|0,d=(Bt=0|l[f+(Mt<<4)+4>>2])+i|0,0|(0|(Lt=0|l[t+220>>2]))%(de<<d|0)){if((0|Lt)!=(0|s)){yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114;continue}if(!((Ct<<i|0)%(1<<d|0)|0)){yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114;continue}}if(0|(0|(Dt=0|l[t+216>>2]))%(o<<u|0)){if((0|Dt)!=(0|n)){yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114;continue}if(!((Tt<<i|0)%(1<<u|0)|0)){yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114;continue}}if(Ot=0|l[f+(Mt<<4)+8>>2]){if(!((0|Ct)==(0|h)|((0|Tt)==(0|c)?1:0==(0|l[f+(Mt<<4)+12>>2])))){i=108;break}yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114}else yt=mt,wt=xt,Ut=Mt,Wt=Ht,i=114}}108!=(0|i)?116!=(0|i)||(At=0|l[t+224>>2],At=(de=0|l[(i=t+216|0)>>2])+At-((0|de)%(0|At)|0)|0,l[i>>2]=At,i=95):(Ft=(((It+Dt|0)/(0|Et)|0)>>Rt)-(Tt>>Rt)+(0|C((((Pt+Lt|0)/(0|kt)|0)>>Bt)-(Ct>>Bt)|0,Ot))|0,l[t+32>>2]=Ft,Ft=0|l[t+64>>2],l[(vt=t+36|0)>>2]=Ft,_t=mt,Gt=Ht,i=109)}if(111==(0|i)){if(i=0,Nt=0|C(0|l[t+8>>2],Ft),Nt=(Nt=(Nt=(0|C(0|l[t+12>>2],0|l[t+28>>2]))+Nt|0)+(0|C(0|l[t+16>>2],Gt))|0)+(0|C(0|l[t+20>>2],0|l[t+32>>2]))|0,Nt=(0|l[t+4>>2])+(Nt<<1)|0,0|a[Nt>>1]){gt=_t,bt=vt,zt=Ft,Vt=Gt,i=113;continue}break}117!=(0|i)||(e=0|l[t+228>>2],e=(de=0|l[(i=t+220|0)>>2])+e-((0|de)%(0|e)|0)|0,l[i>>2]=e,i=93)}return 153==(0|i)?0|fe:(a[Nt>>1]=1,0|(t=1));case 4:for(0|l[(e=t+40|0)>>2]?(l[e>>2]=0,Z=0|l[t+48>>2],l[t+24>>2]=Z,i=121):(ut=0|l[t+24>>2],ct=t+36|0,z=(0|l[t+196>>2])+(ut<<4)|0,H=ct,ct=0|l[ct>>2],i=148);;){if(121==(0|i)){if(Z>>>0>=(0|l[t+60>>2])>>>0){fe=0,i=153;break}if(_=(e=0|l[t+196>>2])+(Z<<4)|0,l[(p=t+224|0)>>2]=0,l[(m=t+228|0)>>2]=0,0|(u=0|l[e+(Z<<4)+8>>2])){if(d=0|l[e+(Z<<4)+12>>2],f=0|l[_>>2],c=0|l[e+(Z<<4)+4>>2],h=u+-1|0,i=f<<(0|l[d>>2])+h,e=c<<(0|l[d+4>>2])+h,1!=(0|u))for(o=-1,s=1;de=f<<(n=h+o|0)+(0|l[d+(s<<4)>>2]),n=c<<(0|l[d+(s<<4)+4>>2])+n,i=0==(0|i)?de:i>>>0<de>>>0?i:de,e=0==(0|e)?n:e>>>0<n>>>0?e:n,(n=s+1|0)>>>0<u>>>0;)o=~s,s=n;l[p>>2]=i,l[m>>2]=e}0|r[t>>0]?e=0|l[t+104>>2]:(e=0|l[t+204>>2],l[t+104>>2]=e,l[t+96>>2]=l[t+200>>2],l[t+108>>2]=l[t+212>>2],l[t+100>>2]=l[t+208>>2]),l[t+220>>2]=e,L=e,D=Z,i=130}else 148==(0|i)&&(at=ct+1|0,l[H>>2]=at,N=z,V=H,st=ut,i=144);for(;;){if(130==(0|i)){if((0|L)>=(0|l[t+108>>2])){i=152;break}Y=0|l[t+96>>2],l[t+216>>2]=Y,F=_,dt=D,i=132}else if(144==(0|i)){if(at>>>0<(0|l[t+52>>2])>>>0){i=146;break}U=N,W=ht=t+28|0,ht=0|l[ht>>2],pt=st,i=149}for(;;){if(132==(0|i)){if((0|Y)>=(0|l[t+100>>2])){i=151;break}X=0|l[t+44>>2],l[(j=t+28|0)>>2]=X,G=F,ft=dt}else 149==(0|i)&&(X=ht+1|0,l[W>>2]=X,G=U,j=W,ft=pt);if(X>>>0>=((de=0|l[t+56>>2])>>>0<(e=0|l[G+8>>2])>>>0?de:e)>>>0)Y=0|l[t+224>>2],Y=(dt=0|l[(F=t+216|0)>>2])+Y-((0|dt)%(0|Y)|0)|0,l[F>>2]=Y,F=G,dt=ft,i=132;else{if(d=0|l[G+12>>2],e=e+~X|0,Q=((i=0|l[t+200>>2])-1+(J=(n=0|l[G>>2])<<e)|0)/(0|J)|0,K=((o=0|l[t+204>>2])-1+(q=(de=0|l[G+4>>2])<<e)|0)/(0|q)|0,s=(($=J+-1|0)+(0|l[t+208>>2])|0)/(0|J)|0,c=((tt=q+-1|0)+(0|l[t+212>>2])|0)/(0|q)|0,h=(et=0|l[d+(X<<4)>>2])+e|0,u=(it=0|l[d+(X<<4)+4>>2])+e|0,0|(0|(nt=0|l[t+220>>2]))%(de<<u|0)){if((0|nt)!=(0|o)){U=G,W=j,ht=X,pt=ft,i=149;continue}if(!((K<<e|0)%(1<<u|0)|0)){U=G,W=j,ht=X,pt=ft,i=149;continue}}if(0|(0|(rt=0|l[t+216>>2]))%(n<<h|0)){if((0|rt)!=(0|i)){U=G,W=j,ht=X,pt=ft,i=149;continue}if(!((Q<<e|0)%(1<<h|0)|0)){U=G,W=j,ht=X,pt=ft,i=149;continue}}if(ot=0|l[d+(X<<4)+8>>2]){if(!((0|K)==(0|c)|((0|Q)==(0|s)?1:0==(0|l[d+(X<<4)+12>>2])))){i=143;break}U=G,W=j,ht=X,pt=ft,i=149}else U=G,W=j,ht=X,pt=ft,i=149}}143!=(0|i)?151!=(0|i)||(L=0|l[t+228>>2],L=(D=0|l[(_=t+220|0)>>2])+L-((0|D)%(0|L)|0)|0,l[_>>2]=L,_=F,D=dt,i=130):(at=((($+rt|0)/(0|J)|0)>>et)-(Q>>et)+(0|C((((tt+nt|0)/(0|q)|0)>>it)-(K>>it)|0,ot))|0,l[t+32>>2]=at,at=0|l[t+64>>2],l[(V=t+36|0)>>2]=at,N=G,st=ft,i=144)}if(146==(0|i)){if(i=0,lt=0|C(0|l[t+8>>2],at),lt=(lt=(lt=(0|C(0|l[t+12>>2],0|l[t+28>>2]))+lt|0)+(0|C(0|l[t+16>>2],st))|0)+(0|C(0|l[t+20>>2],0|l[t+32>>2]))|0,lt=(0|l[t+4>>2])+(lt<<1)|0,0|a[lt>>1]){z=N,H=V,ct=at,ut=st,i=148;continue}break}152!=(0|i)||(Z=D+1|0,l[t+24>>2]=Z,i=121)}return 153==(0|i)?0|fe:(a[lt>>1]=1,0|(t=1));default:return 0|(t=0)}return 0}function Xe(t){t|=0;var e=0,i=0;return(e=0|Ut(1,44))?(r[(i=e+40|0)>>0]=-2&r[i>>0]|0!=(0|t),t=0|Ut(1,4),l[e+20>>2]=t,0|t?0|(i=e):(jt(e),0|(i=0))):0|(e=0)}function Je(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0;if(f=w,w=w+1200|0,u=f,p=0|l[l[20+(t|=0)>>2]>>2],m=0|l[(d=p+16|0)>>2]){s=p+20|0,c=8+(0|l[t+32>>2])|0,h=88+(0|l[t+28>>2])|0,o=t+24|0,a=0==(0|e),n=0==(0|i),r=e+-1|0,U=0,p=m;do{if(y=0|l[s>>2],b=0|l[c>>2],v=0|l[(N=y+(52*U|0)+16|0)>>2],b){if(v){m=0|l[h>>2],_=.0625*+((0|l[(0|l[24+(0|l[o>>2])>>2])+(52*U|0)+24>>2])>>>0),t=0;do{g=0|C(v,t),i=0;do{z=3*(g+i|0)|0,l[u+(120*t|0)+(12*i|0)>>2]=~~(+(0|l[m+(z<<2)>>2])*_),l[u+(120*t|0)+(12*i|0)+4>>2]=~~(+(0|l[m+(z+1<<2)>>2])*_),l[u+(120*t|0)+(12*i|0)+8>>2]=~~(+(0|l[m+(z+2<<2)>>2])*_),i=i+1|0}while(i>>>0<v>>>0);t=t+1|0}while(t>>>0<b>>>0);z=9}}else z=9;if(9==(0|z)&&(z=0,v)){G=y+(52*U|0)+24|0,F=0,p=v;do{if(D=0|l[G>>2],t=0|l[(O=D+(136*F|0)+24|0)>>2]){B=D+(136*F|0)+16|0,R=0,i=0|l[(L=D+(136*F|0)+20|0)>>2],p=0|l[B>>2];do{if(0|C(i,p)){k=D+(136*F|0)+28+(36*R|0)+20|0,I=u+(120*e|0)+(12*F|0)+(R<<2)|0,P=u+(120*r|0)+(12*F|0)+(R<<2)|0,T=0;do{p=0|l[k>>2],E=0|C(0|l[p+(40*T|0)+20>>2],0|l[p+(40*T|0)+16>>2]);t:do{if(0|E){if(M=p+(40*T|0)+24|0,y=0|l[I>>2],a)for(p=0;;)if(i=0|l[M>>2],m=0|l[i+(52*p|0)+4>>2],t=(0|y)>(0|(t=(0|l[(0|l[24+(0|l[o>>2])>>2])+(52*U|0)+24>>2])-(0|l[i+(52*p|0)+28>>2])|0))?y-t|0:0,l[(g=i+(52*p|0)+44|0)>>2]=0,t=0==(0|t)?0:(3*t|0)-2|0,l[m>>2]=t,0|t&&(S=0|l[i+(52*p|0)>>2],l[m+4>>2]=l[(0|l[i+(52*p|0)+8>>2])+(24*(t+-1|0)|0)>>2],l[m+16>>2]=S,!n)&&(l[g>>2]=t),(p=p+1|0)>>>0>=E>>>0)break t;A=y-(S=0|l[P>>2])|0,b=0;do{i=(t=0|l[M>>2])+(52*b|0)|0,v=0|l[t+(52*b|0)+4>>2],p=A+(S-(x=(0|l[(0|l[24+(0|l[o>>2])>>2])+(52*U|0)+24>>2])-(0|l[t+(52*b|0)+28>>2])|0))|0,p=(0|S)>(0|x)?A:(0|p)>0?p:0,p=(y=(g=0==(0|(m=0|l[(x=t+(52*b|0)+44|0)>>2])))?0==(0|p)?0:(3*p|0)-2|0:(3*p|0)+m|0)-m|0,l[v+(24*e|0)>>2]=p;do{if(0|p){if(t=0|l[t+(52*b|0)+8>>2],p=0|l[t+(24*(y+-1|0)|0)>>2],g?t=0|l[i>>2]:(g=0|l[t+(24*(m+-1|0)|0)>>2],t=(0|l[i>>2])+g|0,p=p-g|0),l[v+(24*e|0)+4>>2]=p,l[v+(24*e|0)+16>>2]=t,n)break;l[x>>2]=y}}while(0);b=b+1|0}while(b>>>0<E>>>0)}}while(0);T=T+1|0,p=0|l[B>>2],i=0|l[L>>2]}while(T>>>0<(0|C(i,p))>>>0);t=0|l[O>>2]}R=R+1|0}while(R>>>0<t>>>0);p=0|l[N>>2]}F=F+1|0}while(F>>>0<p>>>0);p=0|l[d>>2]}U=U+1|0}while(U>>>0<p>>>0);w=f}else w=f}function Qe(t,e,i,n){e|=0,i=+i,n|=0;var r,o,a,s,c,h=0,u=0,d=0,f=0,p=0,m=0,_=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0;if(t=0|l[l[20+(t|=0)>>2]>>2],g[(s=t+40+(e<<3)|0)>>3]=0,h=0|l[(c=t+16|0)>>2]){o=t+20|0,a=0==(0|e),r=0==(0|n),L=0,t=h;do{if(n=0|l[o>>2],h=0|l[(B=n+(52*L|0)+16|0)>>2]){R=n+(52*L|0)+24|0,P=0,t=h;do{if(k=0|l[R>>2],n=0|l[(I=k+(136*P|0)+24|0)>>2]){E=k+(136*P|0)+16|0,M=0,h=0|l[(T=k+(136*P|0)+20|0)>>2],t=0|l[E>>2];do{if(0|C(h,t)){S=k+(136*P|0)+28+(36*M|0)+20|0,A=0;do{if(n=0|l[S>>2],x=0|C(0|l[n+(40*A|0)+20>>2],0|l[n+(40*A|0)+16>>2])){b=n+(40*A|0)+24|0,y=0;do{if(m=(p=0|l[b>>2])+(52*y|0)|0,v=0|l[p+(52*y|0)+4>>2],w=p+(52*y|0)+44|0,a?(l[w>>2]=0,_=0):_=0|l[w>>2],_>>>0<(d=0|l[p+(52*y|0)+48>>2])>>>0){f=0|l[p+(52*y|0)+8>>2],t=_,h=_;do{n=0|l[f+(24*h|0)>>2],t?(D=t+-1|0,u=+g[f+(24*h|0)+8>>3]-+g[f+(24*D|0)+8>>3],n=n-(0|l[f+(24*D|0)>>2])|0):u=+g[f+(24*h|0)+8>>3],h=h+1|0,t=(n=n?i-u/+(n>>>0)<2.220446049250313e-16:0!=u)?h:t}while(h>>>0<d>>>0);d=t}else d=_;D=d-_|0,l[v+(24*e|0)>>2]=D,D?(n=0|l[p+(52*y|0)+8>>2],t=0|l[n+(24*(h=d+-1|0)|0)>>2],_?(D=0|l[n+(24*(_=_+-1|0)|0)>>2],l[v+(24*e|0)+16>>2]=(0|l[m>>2])+D,u=+g[n+(24*h|0)+8>>3]-+g[n+(24*_|0)+8>>3],t=t-D|0):(l[v+(24*e|0)+16>>2]=l[m>>2],u=+g[n+(24*h|0)+8>>3]),l[v+(24*e|0)+4>>2]=t,g[v+(24*e|0)+8>>3]=u,g[s>>3]=u+ +g[s>>3],r||(l[w>>2]=d)):g[v+(24*e|0)+8>>3]=0,y=y+1|0}while(y>>>0<x>>>0);h=0|l[T>>2],t=0|l[E>>2]}A=A+1|0}while(A>>>0<(0|C(h,t))>>>0);n=0|l[I>>2]}M=M+1|0}while(M>>>0<n>>>0);t=0|l[B>>2]}P=P+1|0}while(P>>>0<t>>>0);t=0|l[c>>2]}L=L+1|0}while(L>>>0<t>>>0)}}function qe(t,e,i,n,o){e|=0,i|=0,n|=0,o|=0;var s,c,h,u,d,f,p=0,_=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0;if(f=w,w=w+800|0,u=f,d=0|l[28+(t|=0)>>2],c=0|l[l[t+20>>2]>>2],h=0|l[t+32>>2],l[(s=c+24|0)>>2]=0,q=0|l[c+16>>2]){K=t+24|0,Q=0|l[c+20>>2],J=0,b=1.7976931348623157e308,v=0,y=0,p=0;do{if(l[(Y=Q+(52*J|0)+48|0)>>2]=0,X=0|l[Q+(52*J|0)+16>>2]){Z=0|l[Q+(52*J|0)+24>>2],j=0,_=0;do{if(U=0|l[Z+(136*j|0)+24>>2]){V=0==(0|(H=0|C(0|l[Z+(136*j|0)+20>>2],0|l[Z+(136*j|0)+16>>2]))),z=0;do{if(!V){N=0|l[Z+(136*j|0)+28+(36*z|0)+20>>2],G=0;do{if(O=0|C(0|l[N+(40*G|0)+20>>2],0|l[N+(40*G|0)+16>>2])){F=N+(40*G|0)+24|0,D=0;do{if(B=0|l[F>>2],I=0|l[B+(52*D|0)+48>>2]){R=8+(P=0|l[B+(52*D|0)+8>>2])|0,E=0;do{M=0|l[P+(24*E|0)>>2],E?(tt=E+-1|0,x=+g[P+(24*E|0)+8>>3]-+g[P+(24*tt|0)+8>>3],M=M-(0|l[P+(24*tt|0)>>2])|0):x=+g[R>>3],M&&(b=(W=x/+(0|M))<b?W:b,v=W>v?W:v),E=E+1|0}while(E>>>0<I>>>0)}p=(tt=0|C((0|l[B+(52*D|0)+24>>2])-(0|l[B+(52*D|0)+16>>2])|0,(0|l[B+(52*D|0)+20>>2])-(0|l[B+(52*D|0)+12>>2])|0))+p|0,l[s>>2]=p,_=tt+_|0,l[Y>>2]=_,D=D+1|0}while(D>>>0<O>>>0)}G=G+1|0}while(G>>>0<H>>>0)}z=z+1|0}while(z>>>0<U>>>0)}j=j+1|0}while(j>>>0<X>>>0)}else _=0;y+=(W=+(1<<l[(0|l[24+(0|l[K>>2])>>2])+(52*J|0)+24>>2]|0)-1)*W*+(0|_),J=J+1|0}while(J>>>0<q>>>0);W=b}else W=1.7976931348623157e308,v=0,y=0,p=0;if(V=0!=(0|o)){if(q=0|l[o+88>>2],K=0|l[t+36>>2],l[q+(592*K|0)+552>>2]=p,g[q+(592*K|0)+560>>3]=+g[c+32>>3],tt=0|zt(l[(p=h+8|0)>>2]<<3),l[q+(592*K|0)>>2]=tt,!tt)return w=f,0|(tt=0)}else p=h+8|0;if(!(0|l[p>>2]))return w=f,0|(tt=1);for(D=c+32|0,O=d+93|0,F=o+88|0,G=t+36|0,N=c+40|0,z=t+24|0,U=t+8|0,H=t+16|0,B=0;;){if(I=(K=(S=+m[h+20+(B<<2)>>2])>0)&(I=~~+k(+S)>>>0)>>>0<n>>>0?I:n,S=+m[h+5184+(B<<2)>>2],L=+g[D>>3]-y/+T(10,+S/10),0==(1&(tt=0|r[O>>0]))|1^K&&!(0!=(4&tt)&S>0))b=W;else{if(!(R=0|Ji(0|l[z>>2],d))){p=0,$=56;break}if(P=B+1|0,M=u+(B+-1<<3)|0,E=c+40+(B<<3)|0,B){_=0,b=0,A=v,S=W;do{Qe(t,B,x=.5*(S+A),0);do{if(4&r[O>>0]){if(((0|a[d>>1])-3&65535)>=4){if(+g[M>>3]+ +g[E>>3]<L){b=x,A=x;break}S=x,$=47;break}0|Zi(R,0|l[G>>2],c,P,e,i,I,o,0|l[U>>2],0|l[t>>2],0|l[H>>2],0)?+g[M>>3]+ +g[E>>3]<L?(b=x,A=x):(S=x,$=47):S=x}else 0|Zi(R,0|l[G>>2],c,P,e,i,I,o,0|l[U>>2],0|l[t>>2],0|l[H>>2],0)?(b=x,A=x,$=47):S=x}while(0);47==(0|$)&&($=0),_=_+1|0}while(128!=(0|_))}else{_=0,b=0,A=v,S=W;do{Qe(t,0,x=.5*(S+A),0);do{if(4&r[O>>0]){if(((0|a[d>>1])-3&65535)>=4){if(+g[N>>3]<L){b=x,A=x;break}S=x,$=39;break}0|Zi(R,0|l[G>>2],c,P,e,i,I,o,0|l[U>>2],0|l[t>>2],0|l[H>>2],0)?+g[N>>3]<L?(b=x,A=x):(S=x,$=39):S=x}else 0|Zi(R,0|l[G>>2],c,P,e,i,I,o,0|l[U>>2],0|l[t>>2],0|l[H>>2],0)?(b=x,A=x,$=39):S=x}while(0);39==(0|$)&&($=0),_=_+1|0}while(128!=(0|_))}Qi(R),b=0==b?x:b}if(V&&(g[(0|l[(0|l[F>>2])+(592*(0|l[G>>2])|0)>>2])+(B<<3)>>3]=b),Qe(t,B,b,1),b=B?+g[u+(B+-1<<3)>>3]+ +g[c+40+(B<<3)>>3]:+g[N>>3],g[u+(B<<3)>>3]=b,(B=B+1|0)>>>0>=(0|l[p>>2])>>>0){p=1,$=56;break}}return 56==(0|$)?(w=f,0|p):0}function Ke(t,e,i){e|=0,i|=0;var n,r=0,o=0;return l[24+(t|=0)>>2]=e,l[t+28>>2]=i,r=0|Ut(1,848),l[l[(n=t+20|0)>>2]>>2]=r,r?(o=0|Ut(0|l[(r=e+16|0)>>2],52),e=0|l[l[n>>2]>>2],l[e+20>>2]=o,o?(l[e+16>>2]=l[r>>2],l[t>>2]=l[i+84>>2],0|(o=1)):0|(o=0)):0|(i=0)}function $e(t){var e,i=0,n=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0;if(t|=0){i=0|l[(e=t+20|0)>>2];do{if(0|i){if(y=0==(1&r[t+40>>0])?3:4,n=0|l[i>>2]){if(i=0|l[(m=n+20|0)>>2],0|l[(p=n+16|0)>>2]){for(f=0;;){if(0|(n=0|l[(d=i+24|0)>>2])){if(u=((h=0|l[i+28>>2])>>>0)/136|0,h>>>0>135){for(h=0;;){if(0|(o=0|l[(c=n+48|0)>>2])){if(s=((a=0|l[n+52>>2])>>>0)/40|0,a>>>0>39){for(a=0;ui(0|l[(b=o+32|0)>>2]),l[b>>2]=0,ui(0|l[(b=o+36|0)>>2]),l[b>>2]=0,io[7&y](o),!((a=a+1|0)>>>0>=s>>>0);)o=o+40|0;o=0|l[c>>2]}jt(o),l[c>>2]=0}if(0|(o=0|l[(c=n+84|0)>>2])){if(s=((b=0|l[n+88>>2])>>>0)/40|0,b>>>0>39){for(a=0;ui(0|l[(b=o+32|0)>>2]),l[b>>2]=0,ui(0|l[(b=o+36|0)>>2]),l[b>>2]=0,io[7&y](o),!((a=a+1|0)>>>0>=s>>>0);)o=o+40|0;o=0|l[c>>2]}jt(o),l[c>>2]=0}if(0|(o=0|l[(c=n+120|0)>>2])){if(s=((b=0|l[n+124>>2])>>>0)/40|0,b>>>0>39){for(a=0;ui(0|l[(b=o+32|0)>>2]),l[b>>2]=0,ui(0|l[(b=o+36|0)>>2]),l[b>>2]=0,io[7&y](o),!((a=a+1|0)>>>0>=s>>>0);)o=o+40|0;o=0|l[c>>2]}jt(o),l[c>>2]=0}if((h=h+1|0)>>>0>=u>>>0)break;n=n+136|0}n=0|l[d>>2]}jt(n),l[d>>2]=0}if(0|l[i+36>>2]&&0|(g=0|l[(_=i+32|0)>>2])&&(Vt(g),l[_>>2]=0,l[_+4>>2]=0,l[_+8>>2]=0,l[_+12>>2]=0),(f=f+1|0)>>>0>=(0|l[p>>2])>>>0)break;i=i+52|0}i=0|l[m>>2]}if(jt(i),l[m>>2]=0,jt(0|l[l[e>>2]>>2]),i=0|l[e>>2],l[i>>2]=0,!i)break}jt(i),l[e>>2]=0}}while(0);jt(t)}}function ti(t){var e,i,n,r=0,o=0,a=0;r=0|l[(n=32+(t|=0)|0)>>2],i=0|l[(e=t+40|0)>>2];do{if(r){if(i>>>0<=(0|l[(o=t+44|0)>>2])>>>0)return 0|(a=1);if(0|l[t+36>>2]){if(Vt(r),r=0|Ht(0|l[e>>2]),l[n>>2]=r,0|r){l[o>>2]=l[e>>2];break}return l[o>>2]=0,l[e>>2]=0,l[t+36>>2]=0,0|(a=0)}a=4}else a=4}while(0);do{if(4==(0|a)){if(a=0|Ht(i),l[n>>2]=a,a){l[t+44>>2]=l[e>>2];break}return 0|(a=0)}}while(0);return l[t+36>>2]=1,0|(a=1)}function ei(t,e,i){return 0|ii(t|=0,e|=0,1,1,52,i|=0)}function ii(t,e,i,n,o,a){e|=0,i|=0,n=+n,o|=0,a|=0;var s,c,h,u,d,f,p,_,g,y,b,v,x,A,M,E,T,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0,et=0,it=0,nt=0,rt=0,ot=0,at=0,st=0,lt=0,ct=0,ht=0,ut=0,dt=0,ft=0,pt=0,_t=0,gt=0,yt=0,bt=0,vt=0,wt=0,xt=0,At=0,St=0,Mt=0,Et=0,Tt=0,kt=0,Ct=0,It=0,Pt=0,Rt=0,Bt=0,Lt=0,Dt=0,Ot=0,Ft=0,Gt=0,Nt=0,Zt=0,Yt=0,Xt=0,Jt=0,Qt=0,qt=0,Kt=0,$t=0,te=0,ee=0,ie=0;if(T=w,w=w+112|0,A=T+104|0,x=T+96|0,v=T+88|0,b=T+80|0,y=T+72|0,g=T+64|0,_=T+56|0,p=T+48|0,ee=T+40|0,E=T+32|0,M=T+24|0,P=0|l[28+(t|=0)>>2],f=0|l[l[t+20>>2]>>2],R=0|l[(0|l[P+76>>2])+(5640*e|0)+5584>>2],B=0|l[f+20>>2],I=0|l[t+24>>2],L=0|l[I+24>>2],k=0|l[P+24>>2],F=0|l[P+12>>2],D=(te=(0|C(F,(e>>>0)%(k>>>0)|0))+(0|l[P+4>>2])|0)>>>0>(D=0|l[I>>2])>>>0?te:D,l[f>>2]=D,te=0|br(0|F,0,0|te,0),F=(te|=0-S)>>>0<(F=0|l[I+8>>2])>>>0?te:F,l[(te=f+8|0)>>2]=F,!((0|D)>-1&(0|F)>(0|D)))return mt(a,1,19655,T),w=T,0|(ee=0);if(O=0|l[P+16>>2],k=(Kt=(0|C(O,(e>>>0)/(k>>>0)|0))+(0|l[P+8>>2])|0)>>>0>(k=0|l[I+4>>2])>>>0?Kt:k,l[(d=f+4|0)>>2]=k,Kt=0|br(0|O,0,0|Kt,0),O=(Kt|=0-S)>>>0<(O=0|l[I+12>>2])>>>0?Kt:O,l[(Kt=f+12|0)>>2]=O,!((0|k)>-1&(0|O)>(0|k)))return mt(a,1,19693,T+8|0),w=T,0|(ee=0);if(!(0|l[R+4>>2]))return mt(a,1,19731,T+16|0),w=T,0|(ee=0);if(!(0|l[(u=f+16|0)>>2]))return w=T,0|(ee=1);h=P+80|0,c=t+40|0,s=0==(0|i),e=0,qt=B,I=D,P=F,t=O;t:for(;;){if(l[L+36>>2]=0,Yt=(I+-1+(Jt=0|l[L>>2])|0)/(0|Jt)|0,l[qt>>2]=Yt,I=(k+-1+(Xt=0|l[L+4>>2])|0)/(0|Xt)|0,l[(Qt=qt+4|0)>>2]=I,P=(P+-1+Jt|0)/(0|Jt)|0,l[(Jt=qt+8|0)>>2]=P,k=(t+-1+Xt|0)/(0|Xt)|0,l[(Xt=qt+12|0)>>2]=k,P=P-Yt|0){if((4294967295/(P>>>0)|0)>>>0<(k=k-I|0)>>>0){$t=12;break}}else k=k-I|0;if((k=0|C(k,P))>>>0>1073741823){$t=14;break}I=k<<2,k=0|l[R+4>>2],l[(Yt=qt+16|0)>>2]=k,P=0|l[h>>2],l[qt+20>>2]=k>>>0<P>>>0?1:k-P|0,l[(P=qt+40|0)>>2]=I;do{if(1&r[c>>0]){if(i=0|l[(t=qt+32|0)>>2]){if(I>>>0<=(0|l[(B=qt+44|0)>>2])>>>0)break;if(0|l[(k=qt+36|0)>>2]){if(Vt(i),Zt=0|Ht(0|l[P>>2]),l[t>>2]=Zt,!Zt){$t=22;break t}l[B>>2]=l[P>>2]}else $t=19}else $t=19;if(19==(0|$t)){if($t=0,Zt=0|Ht(I),l[t>>2]=Zt,!Zt)break t;l[qt+44>>2]=l[P>>2],k=qt+36|0}l[k>>2]=1,k=0|l[Yt>>2]}}while(0);if(P=136*k|0,k=0|l[(t=qt+24|0)>>2]){if(P>>>0>(0|l[(I=qt+28|0)>>2])>>>0){if(!(k=0|Wt(k,P))){$t=31;break}l[t>>2]=k,Ir(k+(Zt=0|l[I>>2])|0,0,P-Zt|0),l[I>>2]=P}}else{if(k=0|zt(P),l[t>>2]=k,!k){e=0,$t=100;break}l[qt+28>>2]=P,Ir(0|k,0,0|P)}if(Zt=0==(0|l[R+20>>2])?7:8,0|(k=0|l[Yt>>2]))for(Ot=R+8|0,Ft=R+12|0,Gt=L+24|0,Nt=R+804|0,Dt=0,Lt=0|l[t>>2],O=R+28|0;;){if(kt=k,k=k+-1|0,Bt=0|l[qt>>2],Bt=0|Mr(0|(Bt=0|br(0|(Pt=0|br(0|(Ct=0|Tr(1,0,0|k)),0|(It=S),-1,-1)),0|(Rt=S),0|Bt,((0|Bt)<0)<<31>>31|0)),0|S,0|k),l[Lt>>2]=Bt,Mt=0|Mr(0|(Mt=0|br(0|Pt,0|Rt,0|(Mt=0|l[Qt>>2]),((0|Mt)<0)<<31>>31|0)),0|S,0|k),l[Lt+4>>2]=Mt,I=0|Mr(0|(I=0|br(0|Pt,0|Rt,0|(I=0|l[Jt>>2]),((0|I)<0)<<31>>31|0)),0|S,0|k),l[Lt+8>>2]=I,Et=0|Mr(0|(Et=0|br(0|Pt,0|Rt,0|(Et=0|l[Xt>>2]),((0|Et)<0)<<31>>31|0)),0|S,0|k),l[Lt+12>>2]=Et,D=Bt>>(i=0|l[R+812+(Dt<<2)>>2])<<i,B=Mt>>(t=0|l[R+944+(Dt<<2)>>2])<<t,Tt=0|Mr(0|(Tt=0|br(0|(Tt=0|br(0|(Tt=0|Tr(1,0,0|i)),0|S,-1,-1)),0|S,0|I,((0|I)<0)<<31>>31|0)),0|S,0|i),P=0|Mr(0|(P=0|br(0|(P=0|br(0|(P=0|Tr(1,0,0|t)),0|S,-1,-1)),0|S,0|Et,((0|Et)<0)<<31>>31|0)),0|S,0|t),Tt=(Tt<<i)-D>>i,I=(0|Bt)==(0|I)?0:Tt,l[(Bt=Lt+16|0)>>2]=I,P=(0|Mt)==(0|Et)?0:(P<<t)-B>>t,l[Lt+20>>2]=P,0|I&&(4294967295/(Tt>>>0)|0)>>>0<P>>>0){$t=37;break t}if((Mt=0|C(P,I))>>>0>107374182){$t=39;break t}for(Et=40*Mt|0,(Tt=0==(0|Dt))?I=1:(D=0|Er(0|(D=0|br(0|D,((0|D)<0)<<31>>31|0,1,0)),0|S,1),B=0|Er(0|(B=0|br(0|B,((0|B)<0)<<31>>31|0,1,0)),0|S,1),t=t+-1|0,i=i+-1|0,I=3),l[(St=Lt+24|0)>>2]=I,st=(st=0|l[Ot>>2])>>>0<i>>>0?st:i,lt=(lt=0|l[Ft>>2])>>>0<t>>>0?lt:t,ct=0!=(0|Mt),ht=0==(0|Mt),ut=1<<i,dt=1<<t,ft=0|br(0|(ft=0|Tr(1,0,0|st)),0|S,-1,-1),pt=S,_t=0|br(0|(_t=0|Tr(1,0,0|lt)),0|S,-1,-1),gt=S,yt=1<<st,bt=1<<lt,xt=0|br(0|(vt=0|Tr(1,0,0|kt)),0|(wt=S),-1,-1),At=S,ot=0,at=Lt+28|0;;){if(Tt?(I=0|Mr(0|(I=0|br(0|Pt,0|Rt,0|(I=0|l[qt>>2]),((0|I)<0)<<31>>31|0)),0|S,0|k),P=0|Mr(0|(P=0|br(0|Pt,0|Rt,0|(P=0|l[Qt>>2]),((0|P)<0)<<31>>31|0)),0|S,0|k),F=0|Mr(0|(F=0|br(0|Pt,0|Rt,0|(F=0|l[Jt>>2]),((0|F)<0)<<31>>31|0)),0|S,0|k),V=0,G=N=0|l[Xt>>2],N=((0|N)<0)<<31>>31,z=Ct,U=It,H=k):(V=ot+1|0,I=0|l[qt>>2],I=0|Mr(0|(I=0|br(0|(U=0|vr(0|xt,0|At,0|(U=0|Tr(1&V|0,0,0|k)),0|S)),0|(z=S),0|I,((0|I)<0)<<31>>31|0)),0|S,0|kt),P=0|l[Qt>>2],P=0|Mr(0|(P=0|br(0|(F=0|vr(0|xt,0|At,0|(N=0|Tr(V>>>1|0,0,0|k)),0|(G=S))),0|S,0|P,((0|P)<0)<<31>>31|0)),0|S,0|kt),F=0|Mr(0|(F=0|br(0|U,0|z,0|(F=0|l[Jt>>2]),((0|F)<0)<<31>>31|0)),0|S,0|kt),G=0|vr(0|(z=0|l[Xt>>2]),((0|z)<0)<<31>>31|0,0|N,0|G),N=S,z=vt,U=wt,H=kt),l[at+16>>2]=V,l[at>>2]=I,l[(rt=at+4|0)>>2]=P,l[(nt=at+8|0)>>2]=F,F=0|Mr(0|(F=0|br(0|(F=0|br(0|G,0|N,-1,-1)),0|S,0|z,0|U)),0|S,0|H),l[(it=at+12|0)>>2]=F,F=0|Xr[15&Zt](V),ie=.00048828125*+(0|l[O+4>>2])+1,ie=+dr(1,(0|l[Gt>>2])+F-(0|l[O>>2])|0)*ie*n,m[at+32>>2]=ie,l[at+28>>2]=(0|l[O>>2])-1+(0|l[Nt>>2]),ct&0==(0|(P=0|l[(F=at+20|0)>>2]))){if(I=0|zt(Et),l[F>>2]=I,!I){$t=48;break t}Ir(0|I,0,0|Et),I=at+24|0,$t=54}else if((0|l[(I=at+24|0)>>2])>>>0<Et>>>0){if(!(P=0|Wt(P,Et))){$t=53;break t}l[F>>2]=P,Ir(P+($t=0|l[I>>2])|0,0,Et-$t|0),$t=54}if(54==(0|$t)&&($t=0,l[I>>2]=Et),!ht)for(et=0,Z=0|l[F>>2];;){X=(q=(((et>>>0)%((Y=0|l[Bt>>2])>>>0)|0)<<i)+D|0)+ut|0,J=(Y=(((et>>>0)/(Y>>>0)|0)<<t)+B|0)+dt|0,Q=(0|q)>(0|(Q=0|l[at>>2]))?q:Q,l[Z>>2]=Q,q=(0|Y)>(0|(q=0|l[rt>>2]))?Y:q,l[(Y=Z+4|0)>>2]=q,F=(0|X)<(0|(F=0|l[nt>>2]))?X:F,l[(X=Z+8|0)>>2]=F,P=(0|J)<(0|(P=0|l[it>>2]))?J:P,l[(J=Z+12|0)>>2]=P,Q=Q>>st<<st,q=q>>lt<<lt,F=0|Mr(0|(F=0|br(0|ft,0|pt,0|F,((0|F)<0)<<31>>31|0)),0|S,0|st),P=0|Mr(0|(P=0|br(0|_t,0|gt,0|P,((0|P)<0)<<31>>31|0)),0|S,0|lt),F=(F<<st)-Q>>st,l[(K=Z+16|0)>>2]=F,P=(P<<lt)-q>>lt,l[(z=Z+20|0)>>2]=P,$=0|C(F,P),N=0|C($,o),G=0|l[(tt=Z+24|0)>>2];do{if(0==(0|G)&0!=(0|$)){if(I=0|zt(N),l[tt>>2]=I,!I){e=0,$t=100;break t}Ir(0|I,0,0|N),I=Z+28|0,$t=64}else{if(N>>>0<=(0|l[(I=Z+28|0)>>2])>>>0)break;if(!(P=0|Wt(G,N))){$t=63;break t}l[tt>>2]=P,Ir(P+($t=0|l[I>>2])|0,0,N-$t|0),$t=64}}while(0);if(64==(0|$t)&&($t=0,l[I>>2]=N,F=0|l[K>>2],P=0|l[z>>2]),I=(I=0|l[(G=Z+32|0)>>2])?0|hi(I,F,P,a):0|li(F,P,a),l[G>>2]=I,I||mt(a,2,19944,x),P=0|l[(G=Z+36|0)>>2],F=0|l[K>>2],I=0|l[z>>2],I=P?0|hi(P,F,I,a):0|li(F,I,a),l[G>>2]=I,I||mt(a,2,19966,A),0|$){j=0;do{V=(U=(((j>>>0)%((H=0|l[K>>2])>>>0)|0)<<st)+Q|0)+yt|0,W=(H=(((j>>>0)/(H>>>0)|0)<<lt)+q|0)+bt|0;do{if(s){if(z=0|l[tt>>2],0|l[(I=z+(56*j|0)|0)>>2]){F=0|l[(P=z+(56*j|0)+32|0)>>2],N=44+(G=I=z+(56*j|0)+8|0)|0;do{l[G>>2]=0,G=G+4|0}while((0|G)<(0|N));l[P>>2]=F}else{if(N=0|zt(8192),l[I>>2]=N,!N){e=0,$t=100;break t}if(l[z+(56*j|0)+32>>2]=8192,N=0|Ut(10,32),l[z+(56*j|0)+4>>2]=N,!N){e=0,$t=100;break t}l[z+(56*j|0)+52>>2]=10,I=z+(56*j|0)+8|0}N=0|l[Z>>2],l[I>>2]=(0|U)>(0|N)?U:N,U=0|l[Y>>2],l[z+(56*j|0)+12>>2]=(0|H)>(0|U)?H:U,H=0|l[X>>2],l[z+(56*j|0)+16>>2]=(0|V)<(0|H)?V:H,V=0|l[J>>2],l[z+(56*j|0)+20>>2]=(0|W)<(0|V)?W:V}else{if(P=0|l[tt>>2],0==(0|l[(I=P+(52*j|0)+4|0)>>2])&&(z=0|Ut(100,24),l[I>>2]=z,0==(0|z))){e=0,$t=100;break t}if(0==(0|l[(I=P+(52*j|0)+8|0)>>2])&&(z=0|Ut(100,24),l[I>>2]=z,0==(0|z))){e=0,$t=100;break t}if(F=(0|U)>(0|(F=0|l[Z>>2]))?U:F,l[P+(52*j|0)+12>>2]=F,H=(0|H)>(0|(G=0|l[Y>>2]))?H:G,l[P+(52*j|0)+16>>2]=H,G=(0|V)<(0|(G=0|l[X>>2]))?V:G,l[P+(52*j|0)+20>>2]=G,W=(0|W)<(0|(V=0|l[J>>2]))?W:V,l[P+(52*j|0)+24>>2]=W,(F=0|C(W-H|0,G-F<<2))>>>0<=(0|l[(G=P+(52*j|0)+36|0)>>2])>>>0)break;if(0|(I=0|l[(P=P+(52*j|0)|0)>>2])&&jt(I+-1|0),I=0|zt(1|F),l[P>>2]=I,!I){$t=87;break t}l[G>>2]=F,r[I>>0]=0,l[P>>2]=1+(0|l[P>>2])}}while(0);j=j+1|0}while(j>>>0<$>>>0)}if((et=et+1|0)>>>0>=Mt>>>0)break;Z=Z+40|0}if(O=O+8|0,(ot=ot+1|0)>>>0>=(0|l[St>>2])>>>0)break;at=at+36|0}if((Dt=Dt+1|0)>>>0>=(0|l[Yt>>2])>>>0)break;Lt=Lt+136|0}if((e=e+1|0)>>>0>=(0|l[u>>2])>>>0){e=1,$t=100;break}R=R+1080|0,qt=qt+52|0,L=L+52|0,I=0|l[f>>2],k=0|l[d>>2],P=0|l[te>>2],t=0|l[Kt>>2]}switch(0|$t){case 12:return mt(a,1,19770,M),w=T,0|(ee=0);case 14:return mt(a,1,19770,E),w=T,0|(ee=0);case 22:l[B>>2]=0,l[P>>2]=0,l[k>>2]=0;break;case 31:return mt(a,1,19803,p),jt(0|l[t>>2]),l[t>>2]=0,l[I>>2]=0,w=T,0|(ee=0);case 37:return mt(a,1,19770,_),w=T,0|(ee=0);case 39:return mt(a,1,19770,g),w=T,0|(ee=0);case 48:return mt(a,1,19843,y),w=T,0|(ee=0);case 53:return mt(a,1,19843,b),jt(0|l[F>>2]),l[F>>2]=0,l[I>>2]=0,w=T,0|(ee=0);case 63:return jt(0|l[tt>>2]),l[tt>>2]=0,l[I>>2]=0,mt(a,1,19886,v),w=T,0|(ee=0);case 87:return l[G>>2]=0,w=T,0|(ee=0);case 100:return w=T,0|e}return mt(a,1,19770,ee),w=T,0|(ee=0)}function ni(t,e,i,n,o,a){e|=0,i|=0,n|=0,o|=0,a|=0;var s,c,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0;if(c=w,w=w+16|0,s=c,!(0|l[8+(t|=0)>>2])){if(l[t+36>>2]=e,h=0|l[76+(0|l[(x=t+28|0)>>2])>>2],l[(S=t+32|0)>>2]=h+(5640*e|0),v=t+20|0,!(A=0==(0|a))){if(u=0|l[20+(0|l[l[v>>2]>>2])>>2],m=0|l[h+(5640*e|0)+5584>>2],0|l[(_=u+16|0)>>2]){f=0|l[u+24>>2],p=0|l[(h=a+88|0)>>2],u=0,d=0;do{b=f+(136*d|0)+16|0,l[p+(592*e|0)+20+(d<<2)>>2]=l[b>>2],y=f+(136*d|0)+20|0,l[p+(592*e|0)+152+(d<<2)>>2]=l[y>>2],u=(0|C(0|l[y>>2],0|l[b>>2]))+u|0,l[p+(592*e|0)+284+(d<<2)>>2]=l[m+812+(d<<2)>>2],l[p+(592*e|0)+416+(d<<2)>>2]=l[m+944+(d<<2)>>2],d=d+1|0}while(d>>>0<(0|l[_>>2])>>>0)}else u=0,h=a+88|0;if(b=0|Ut(0|C(0|C(0|l[a+52>>2],u),0|l[a+56>>2]),32),l[(0|l[h>>2])+(592*e|0)+548>>2]=b,!b)return w=c,0|(a=0)}if(h=0|l[l[v>>2]>>2],0|l[(b=h+16|0)>>2])for(p=0|l[S>>2],e=0,g=u=0|l[h+20>>2],y=0|l[p+5584>>2];;){if(m=0|l[g+32>>2],h=0!=(0|(_=0|C((0|l[g+12>>2])-(0|l[g+4>>2])|0,(0|l[g+8>>2])-(0|l[g>>2])|0))),1==(0|l[y+20>>2])){if(h)for(f=y+1076|0,d=0,h=m;l[h>>2]=(0|l[h>>2])-(0|l[f>>2]),(0|(d=d+1|0))!=(0|_);)h=h+4|0}else if(h)for(f=y+1076|0,h=m,d=0;l[h>>2]=(0|l[h>>2])-(0|l[f>>2])<<11,(0|(d=d+1|0))!=(0|_);)h=h+4|0;if((e=e+1|0)>>>0>=(h=0|l[b>>2])>>>0)break;g=g+52|0,y=y+1080|0}else u=0|l[h+20>>2],p=0|l[S>>2],h=0;m=0|C((0|l[u+12>>2])-(0|l[u+4>>2])|0,(0|l[u+8>>2])-(0|l[u>>2])|0);t:do{switch(0|l[p+16>>2]){case 0:break;case 2:if(0|l[p+5608>>2]){if(!(f=0|zt(h<<2)))return w=c,0|(a=0);if(h=0|l[b>>2])for(d=0;l[f+(d<<2)>>2]=l[u+32>>2],(0|(d=d+1|0))!=(0|h);)u=u+52|0;else h=0;if(b=0==(0|De(0|l[5608+(0|l[S>>2])>>2],m,f,h,0|l[32+(0|l[24+(0|l[t+24>>2])>>2])>>2])),jt(f),b)return w=c,0|(a=0)}break;default:if(d=0|l[u+32>>2],f=0|l[u+84>>2],h=0|l[u+136>>2],0|l[20+(0|l[p+5584>>2])>>2]){Pe(d,f,h,m);break t}Be(d,f,h,m);break t}}while(0);f=16+(h=0|l[l[v>>2]>>2])|0;t:do{if(0|l[f>>2]){d=0|l[5584+(0|l[S>>2])>>2],h=0|l[h+20>>2],u=0;e:for(;;){switch(0|l[d+20>>2]){case 1:if(!(0|Ti(h))){h=0,u=53;break e}break;case 0:if(!(0|Ri(h))){h=0,u=53;break e}}if((u=u+1|0)>>>0>=(0|l[f>>2])>>>0)break t;d=d+1080|0,h=h+52|0}if(53==(0|u))return w=c,0|h}}while(0);if(d=0|l[S>>2],!(f=0|zi(1)))return w=c,0|(a=0);do{if(1==(0|l[d+16>>2])){if(0|l[20+(0|l[d+5584>>2])>>2]){h=3,u=8;break}h=3,u=32;break}h=0|l[16+(0|l[t+24>>2])>>2],u=0|l[d+5600>>2]}while(0);if(v=0==(0|ji(f,0|l[l[v>>2]>>2],d,u,h)),Ui(f),v)return w=c,0|(a=0);if(h=0|l[x>>2],l[s>>2]=0,A||(l[a+12>>2]=0),5&r[h+93>>0]){if(!(0|qe(t,i,s,o,a)))return w=c,0|(a=0)}else if(0|l[8+(0|l[S>>2])>>2]){h=0;do{Je(t,h,1),h=h+1|0}while(h>>>0<(0|l[8+(0|l[S>>2])>>2])>>>0)}}return 0|a&&(l[a+12>>2]=1),(h=0|Ji(0|l[t+24>>2],0|l[t+28>>2]))?(a=0!=(0|Zi(h,0|l[t+36>>2],0|l[l[t+20>>2]>>2],0|l[8+(0|l[t+32>>2])>>2],i,n,o,a,0|l[t+4>>2],0|l[t>>2],0|l[t+16>>2],1)),Qi(h),w=c,0|(a&=1)):(w=c,0|(a=0))}function ri(t,e,i,n,r,o){e|=0,i|=0,n|=0,r|=0,o|=0;var a,s,c=0,h=0,u=0,d=0,f=0,p=0,_=0,g=0,y=0,b=0,v=0;if(s=w,w=w+16|0,d=s+8|0,u=s,c=s+12|0,l[(h=36+(t|=0)|0)>>2]=n,g=0|l[t+28>>2],l[(a=t+32|0)>>2]=(0|l[g+76>>2])+(5640*n|0),l[c>>2]=0,!(n=0|Ji(0|l[(y=t+24|0)>>2],g)))return w=s,0|(v=0);if(f=t+20|0,g=0==(0|function(t,e,i,n,r,o,a,s){e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0;var c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0;if(K=w,w=w+112|0,q=K+64|0,Y=K+32|0,Z=K,W=K+96|0,j=K+92|0,c=0|l[(t|=0)>>2],V=0|l[(G=t+4|0)>>2],a=0|l[V+76>>2],N=a+(5640*e|0)|0,H=1+(0|l[(z=a+(5640*e|0)+420|0)>>2])|0,!(V=0|Ge(c,V,e)))return w=K,0|($=0);U=c+16|0,F=a+(5640*e|0)+12|0,O=i+20|0,L=c+24|0,B=V,t=o,a=n,R=0;t:for(;;){if(-1==(0|l[B+80>>2])){$=4;break}if(!(D=0|zt(l[U>>2]<<2))){$=6;break}if(Ir(0|D,1,l[U>>2]<<2|0),0|Ye(B))for(T=B+24|0,k=B+28|0,I=B+36|0,P=B+32|0,E=a;;){if((0|l[F>>2])>>>0>(0|l[I>>2])>>>0)if(a=0|l[O>>2],e=0|l[T>>2],(0|l[k>>2])>>>0<(0|l[a+(52*e|0)+20>>2])>>>0){if(l[D+(e<<2)>>2]=0,M=0|l[G>>2],l[j>>2]=0,!(0|Xi(M,a,N,B,W,E,j,t,s))){$=45;break t}if(a=0|l[j>>2],0|l[W>>2]){S=t-a|0,M=E+a|0,l[j>>2]=0,e=0|l[(0|l[O>>2])+(52*(0|l[T>>2])|0)+24>>2],i=0|l[k>>2],o=0|l[(x=e+(136*i|0)+24|0)>>2];e:do{if(o){A=E+t|0,c=0,v=e+(136*i|0)+28|0,e=M,i=o;i:for(;;){if(o=0|l[v+20>>2],h=0|l[P>>2],(0|l[v+8>>2])!=(0|l[v>>2])&&(0|l[v+12>>2])!=(0|l[v+4>>2])&&0!=(0|(Q=0|C(0|l[o+(40*h|0)+20>>2],0|l[o+(40*h|0)+16>>2])))){for(i=0,b=0|l[o+(40*h|0)+24>>2];;){if(0|l[(g=b+40|0)>>2]){o=0|l[(y=b+44|0)>>2],h=0|l[b+4>>2];do{if(o){if((0|l[h+((u=o+-1|0)<<5)+8>>2])!=(0|l[h+(u<<5)+20>>2])){h=h+(u<<5)|0;break}l[y>>2]=o+1,h=h+(o<<5)|0}else l[y>>2]=1,l[b+36>>2]=0}while(0);if(m=b+36|0,_=b+32|0,p=e,((o=0|l[(f=h+28|0)>>2])+p|0)>>>0<p>>>0|(e+o|0)>>>0>A>>>0){e=o;break i}for(u=o,d=0|l[m>>2],p=f;;){if((f=u+d|0)>>>0<d>>>0){$=29;break t}if(o=0|l[b>>2],f>>>0>(0|l[_>>2])>>>0){if(!(o=0|Wt(o,f))){$=33;break t}d=0|l[m>>2],u=0|l[p>>2],l[_>>2]=u+d,l[b>>2]=o}if(Cr(o+d|0,0|e,0|u),(u=0|l[(o=h+8|0)>>2])?d=0|l[m>>2]:(l[h>>2]=b,d=0|l[m>>2],l[h+4>>2]=d),tt=0|l[p>>2],e=e+tt|0,p=0|l[h+24>>2],f=p+u|0,l[o>>2]=f,p=(0|l[g>>2])-p|0,l[g>>2]=p,l[h+12>>2]=f,d=tt+d|0,l[m>>2]=d,l[(f=h+16|0)>>2]=(0|l[f>>2])+tt,!p)break;if(l[y>>2]=1+(0|l[y>>2]),tt=e,((o=0|l[(p=h+60|0)>>2])+tt|0)>>>0<tt>>>0|(e+o|0)>>>0>A>>>0){e=o;break i}h=h+32|0,u=o}l[b+48>>2]=l[y>>2]}if(!((i=i+1|0)>>>0<Q>>>0))break;b=b+56|0}i=0|l[x>>2]}if(!((c=c+1|0)>>>0<i>>>0)){$=43;break e}v=v+36|0}A=0|l[P>>2],M=0|l[k>>2],tt=0|l[T>>2],l[Z>>2]=e,l[Z+4>>2]=S,l[Z+8>>2]=i,l[Z+12>>2]=A,l[Z+16>>2]=c,l[Z+20>>2]=M,l[Z+24>>2]=tt,mt(s,2,21892,Z),e=0}else e=M,$=43}while(0);43==(0|$)&&($=0,e=e-M|0,l[j>>2]=e),a=e+a|0}tt=0|l[T>>2],S=0|l[k>>2],e=(0|l[L>>2])+(52*tt|0)+36|0,M=0|l[e>>2],l[e>>2]=S>>>0>M>>>0?S:M,e=a,a=tt}else $=47;else a=0|l[O>>2],$=47;if(47==(0|$)){if($=0,tt=0|l[G>>2],l[j>>2]=0,!(0|Xi(tt,a,N,B,W,E,j,t,s)))break t;if(e=0|l[j>>2],0|l[W>>2]){if(v=t-e|0,A=0|l[T>>2],a=0|l[(0|l[O>>2])+(52*A|0)+24>>2],x=0|l[k>>2],l[j>>2]=0,y=0|l[a+(136*x|0)+24>>2]){for(b=0|l[P>>2],c=0,g=a+(136*x|0)+28|0,a=0;;){if(i=0|l[g+20>>2],(0|l[g+8>>2])!=(0|l[g>>2])&&(0|l[g+12>>2])!=(0|l[g+4>>2])&&0!=(0|(X=0|C(0|l[i+(40*b|0)+20>>2],0|l[i+(40*b|0)+16>>2]))))for(_=0|l[i+(40*b|0)+24>>2],i=0,f=a;;){if(d=0|l[(p=_+40|0)>>2]){h=0|l[(m=_+44|0)>>2],a=0|l[_+4>>2];do{if(h){if(u=h+1|0,(0|l[a+((o=h+-1|0)<<5)+8>>2])!=(0|l[a+(o<<5)+20>>2])){o=a+(o<<5)|0,u=h;break}l[m>>2]=u,o=a+(h<<5)|0}else l[m>>2]=1,l[_+36>>2]=0,o=a,u=1}while(0);if(a=0|l[o+28>>2],(h=a+f|0)>>>0<f>>>0|h>>>0>v>>>0){$=67;break t}for(f=o;tt=0|l[f+24>>2],l[(M=f+8|0)>>2]=(0|l[M>>2])+tt,d=d-tt|0;){if(u=u+1|0,l[m>>2]=u,a=0|l[f+60>>2],(o=a+h|0)>>>0<h>>>0|o>>>0>v>>>0){$=68;break t}f=f+32|0,h=o}l[p>>2]=0,a=h}else a=f;if(!((i=i+1|0)>>>0<X>>>0))break;_=_+56|0,f=a}if(!((c=c+1|0)>>>0<y>>>0))break;g=g+36|0}l[j>>2]=a}else a=0;e=a+e|0,a=A}else a=0|l[T>>2]}if(0|l[D+(a<<2)>>2]&&(J=(0|l[L>>2])+(52*a|0)+36|0,0==(0|l[J>>2]))&&(l[J>>2]=(0|l[(0|l[O>>2])+(52*a|0)+20>>2])-1),a=E+e|0,t=t-e|0,!(0|Ye(B)))break;E=a}if(jt(D),(R=R+1|0)>>>0>(0|l[z>>2])>>>0){$=79;break}B=B+232|0}if(4==(0|$))return Ue(V,H),w=K,0|(tt=0);if(6==(0|$))return Ue(V,H),w=K,0|(tt=0);if(29==(0|$))Q=0|l[P>>2],q=0|l[k>>2],tt=0|l[T>>2],l[Y>>2]=u,l[Y+4>>2]=d,l[Y+8>>2]=~u,l[Y+12>>2]=i,l[Y+16>>2]=Q,l[Y+20>>2]=c,l[Y+24>>2]=q,l[Y+28>>2]=tt,mt(s,1,21977,Y),$=45;else if(33==(0|$))jt(0|l[b>>2]),l[b>>2]=0,l[_>>2]=0,$=45;else if(67==(0|$))l[j>>2]=f,$=69;else if(68==(0|$))l[j>>2]=h,l[p>>2]=d,$=69;else if(79==(0|$))return Ue(V,H),l[r>>2]=a-n,w=K,0|(tt=1);return 45==(0|$)?(Ue(V,H),jt(D),w=K,0|(tt=0)):(69==(0|$)&&(l[q>>2]=a,l[q+4>>2]=v,l[q+8>>2]=i,l[q+12>>2]=b,l[q+16>>2]=c,l[q+20>>2]=x,l[q+24>>2]=A,mt(s,1,22076,q)),Ue(V,H),jt(D),w=K,0|(tt=0))}(n,0|l[h>>2],0|l[l[f>>2]>>2],e,c,i,r,o)),Qi(n),g)return w=s,0|(v=0);if(n=0|l[l[f>>2]>>2],i=0|l[5584+(0|l[a>>2])>>2],t=0|l[n+20>>2],!(c=0|zi(0)))return w=s,0|(v=0);r=n+16|0;t:do{if(0|l[r>>2]){for(e=0,n=i;0|Hi(c,t,n);){if((e=e+1|0)>>>0>=(0|l[r>>2])>>>0)break t;t=t+52|0,n=n+1080|0}return Ui(c),w=s,0|(v=0)}}while(0);Ui(c),c=16+(n=0|l[l[f>>2]>>2])|0;do{if(0|l[c>>2]){for(r=0|l[5584+(0|l[a>>2])>>2],n=0|l[n+20>>2],t=0,e=0|l[24+(0|l[y>>2])>>2];;){if(i=1+(0|l[e+36>>2])|0,1==(0|l[r+20>>2])){if(!(0|Ci(n,i))){n=0,t=47;break}}else if(!(0|Di(n,i))){n=0,t=47;break}if((t=t+1|0)>>>0>=(0|l[c>>2])>>>0){t=14;break}r=r+1080|0,n=n+52|0,e=e+52|0}if(14==(0|t)){n=0|l[l[f>>2]>>2];break}if(47==(0|t))return w=s,0|n}}while(0);i=0|l[a>>2],t=0|l[n+20>>2],e=0|l[i+16>>2];do{if(0|e){if(h=0|C((0|l[t+12>>2])-(0|l[t+4>>2])|0,(0|l[t+8>>2])-(0|l[t>>2])|0),(n=0|l[(c=n+16|0)>>2])>>>0<=2){l[d>>2]=n,mt(o,1,20049,d);break}if((0|C((0|l[t+64>>2])-(0|l[t+56>>2])|0,(0|l[t+60>>2])-(0|l[t+52>>2])|0))>=(0|h)&&(0|C((0|l[t+116>>2])-(0|l[t+108>>2])|0,(0|l[t+112>>2])-(0|l[t+104>>2])|0))>=(0|h)){if(2!=(0|e)){if(n=0|l[t+32>>2],1==(0|l[20+(0|l[i+5584>>2])>>2])){Re(n,0|l[t+84>>2],0|l[t+136>>2],h);break}Le(n,0|l[t+84>>2],0|l[t+136>>2],h);break}if(!(0|l[(r=i+5604|0)>>2]))break;if(!(i=0|zt(n<<2)))return w=s,0|(v=0);if(n=0|l[c>>2])for(e=0;l[i+(e<<2)>>2]=l[t+32>>2],(0|(e=e+1|0))!=(0|n);)t=t+52|0;else n=0;if(g=0==(0|Oe(0|l[r>>2],h,i,n,0|l[32+(0|l[24+(0|l[y>>2])>>2])>>2])),jt(i),!g)break;return w=s,0|(n=0)}return mt(o,1,19988,u),w=s,0|(v=0)}}while(0);if(n=0|l[l[f>>2]>>2],!(0|l[(g=n+16|0)>>2]))return w=s,0|(v=1);for(_=0,p=0|l[n+20>>2],f=0|l[5584+(0|l[a>>2])>>2],h=0|l[24+(0|l[y>>2])>>2];;){if(d=0|l[p+24>>2],u=0|l[h+36>>2],o=(0|l[d+(136*u|0)+8>>2])-(0|l[d+(136*u|0)>>2])|0,u=(0|l[d+(136*u|0)+12>>2])-(0|l[d+(136*u|0)+4>>2])|0,d=(0|l[p+8>>2])-(0|l[p>>2])|0,n=0|l[h+24>>2],0|l[h+32>>2]?(n=c=1<<n+-1,c=0-c|0):(n=1<<n,c=0),r=n+-1|0,t=0|l[p+32>>2],n=0!=(0|u),1==(0|l[f+20>>2])){if(n&&(v=f+1076|0,0|o))for(n=0;;){for(e=0,i=t;y=(0|l[v>>2])+(0|l[i>>2])|0,l[i>>2]=(0|y)<(0|c)?c:(0|y)>(0|r)?r:y,(0|(e=e+1|0))!=(0|o);)i=i+4|0;if((0|(n=n+1|0))==(0|u))break;t=t+(d<<2)|0}}else if(n&&(b=f+1076|0,0|o))for(i=0;;){for(n=0,e=t;y=0|fr(+m[e>>2]),y=(0|l[b>>2])+y|0,l[e>>2]=(0|y)<(0|c)?c:(0|y)>(0|r)?r:y,(0|(n=n+1|0))!=(0|o);)e=e+4|0;if((0|(i=i+1|0))==(0|u))break;t=t+(d<<2)|0}if((_=_+1|0)>>>0>=(0|l[g>>2])>>>0){n=1;break}p=p+52|0,f=f+1080|0,h=h+52|0}return w=s,0|n}function oi(t,e,i){e|=0,i|=0;var n=0,o=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0;if(n=0|l[(g=24+(t|=0)|0)>>2],u=0==(0|(c=0|l[n+16>>2])))return 0|(g=1);for(d=0|l[n+24>>2],n=h=0|l[20+(0|l[l[t+20>>2]>>2])>>2],t=d,o=0,s=0;m=((m=0|l[t+24>>2])>>>3)+(0!=(7&m|0)&1)|0,_=(0|l[n+24>>2])+(136*(0|l[n+20>>2])|0)-136|0,o=(0|C(0|C(3==(0|m)?4:m,(0|l[_+8>>2])-(0|l[_>>2])|0),(0|l[_+12>>2])-(0|l[_+4>>2])|0))+o|0,(0|(s=s+1|0))!=(0|c);)n=n+52|0,t=t+52|0;if((n=o>>>0>i>>>0)|u)return 0|(g=1&(1^n));for(_=0;;){u=0|l[d+24>>2],p=0|l[h+24>>2],c=0|l[d+36>>2],f=(o=0|l[p+(136*c|0)+8>>2])-(s=0|l[p+(136*c|0)>>2])|0,p=(i=0|l[p+(136*c|0)+12>>2])-(c=0|l[p+(136*c|0)+4>>2])|0,m=(0|l[h+8>>2])-(0|l[h>>2])|0,u=(u>>>3)+(0!=(7&u|0)&1)|0;t:do{switch(1073741823&(3==(0|u)?4:u)|0){case 1:if(t=0|l[h+32>>2],n=0==(0|p)|0==(0|f),0|l[d+32>>2]){if(n)break t;for(u=o+(0|C(i+-1-c|0,f))-s|0,n=t,t=e,o=0;;){for(s=0,i=n,c=t;r[c>>0]=l[i>>2],(0|(s=s+1|0))!=(0|f);)i=i+4|0,c=c+1|0;if((0|(o=o+1|0))==(0|p))break;n=n+(m<<2)|0,t=t+f|0}e=e+u|0;break t}if(n)break t;for(u=o+(0|C(i+-1-c|0,f))-s|0,c=0,o=e;;){for(n=0,s=t,i=o;r[i>>0]=l[s>>2],(0|(n=n+1|0))!=(0|f);)s=s+4|0,i=i+1|0;if((0|(c=c+1|0))==(0|p))break;t=t+(m<<2)|0,o=o+f|0}e=e+u|0;break t;case 2:if(n=0|l[h+32>>2],t=0==(0|p)|0==(0|f),0|l[d+32>>2]){if(t)break t;for(c=e+((0|C(i+-1-c|0,(u=o<<1)-(s<<=1)|0))+u-s)|0,s=0;;){for(t=e,o=n,i=0;a[t>>1]=l[o>>2],(0|(i=i+1|0))!=(0|f);)t=t+2|0,o=o+4|0;if((0|(s=s+1|0))==(0|p)){e=c;break}e=e+(f<<1)|0,n=n+(m<<2)|0}}else{if(t)break t;for(c=e+((0|C(i+-1-c|0,(u=o<<1)-(o=s<<1)|0))+u-o)|0,o=0;;){for(t=n,s=0,i=e;a[i>>1]=l[t>>2],(0|(s=s+1|0))!=(0|f);)t=t+4|0,i=i+2|0;if((0|(o=o+1|0))==(0|p)){e=c;break}n=n+(m<<2)|0,e=e+(f<<1)|0}}break;case 4:if(!(0==(0|p)|0==(0|f)))for(c=e+((0|C(i+-1-c|0,(u=o<<2)-(n=s<<2)|0))+u-n)|0,n=0|l[h+32>>2],s=0;;){for(t=e,o=n,i=0;l[t>>2]=l[o>>2],(0|(i=i+1|0))!=(0|f);)t=t+4|0,o=o+4|0;if((0|(s=s+1|0))==(0|p)){e=c;break}e=e+(f<<2)|0,n=n+(m<<2)|0}}}while(0);if((_=_+1|0)>>>0>=(0|l[16+(0|l[g>>2])>>2])>>>0){e=1;break}h=h+52|0,d=d+52|0}return 0|e}function ai(t){var e=0,i=0,n=0,r=0,o=0;if(e=0|l[24+(t|=0)>>2],!(r=0|l[e+16>>2]))return 0|(r=0);for(n=0|l[20+(0|l[l[t+20>>2]>>2])>>2],e=0|l[e+24>>2],t=0,i=0;o=((o=0|l[e+24>>2])>>>3)+(0!=(7&o|0)&1)|0,t=(0|C(0|C((0|l[n+12>>2])-(0|l[n+4>>2])|0,(0|l[n+8>>2])-(0|l[n>>2])|0),3==(0|o)?4:o))+t|0,!((i=i+1|0)>>>0>=r>>>0);)n=n+52|0,e=e+52|0;return 0|t}function si(t,e,i){e|=0,i|=0;var n,o,s=0,c=0,u=0,f=0,p=0,m=0,_=0;if(n=0|l[24+(t|=0)>>2],m=0==(0|(p=0|l[(o=n+16|0)>>2])))s=0;else for(c=0|l[20+(0|l[l[t+20>>2]>>2])>>2],u=0|l[n+24>>2],s=0,f=0;_=((_=0|l[u+24>>2])>>>3)+(0!=(7&_|0)&1)|0,s=(0|C(0|C((0|l[c+12>>2])-(0|l[c+4>>2])|0,(0|l[c+8>>2])-(0|l[c>>2])|0),3==(0|_)?4:_))+s|0,(0|(f=f+1|0))!=(0|p);)c=c+52|0,u=u+52|0;if((s=(0|s)!=(0|i))|m)return 0|(_=1&(1^s));for(t=0|l[20+(0|l[l[t+20>>2]>>2])>>2],i=0|l[n+24>>2],m=0;;){_=0|l[i+24>>2],c=(0|l[t+8>>2])-(0|l[t>>2])|0,u=(0|l[t+12>>2])-(0|l[t+4>>2])|0,p=0|C(u,c),_=(_>>>3)+(0!=(7&_|0)&1)|0;t:do{switch(1073741823&(3==(0|_)?4:_)|0){case 1:if(c=0|l[t+32>>2],s=0!=(0|p),0|l[i+32>>2]){if(!s)break t;for(s=c,c=e,u=0;l[s>>2]=r[c>>0],(0|(u=u+1|0))!=(0|p);)s=s+4|0,c=c+1|0;e=e+p|0;break t}if(!s)break t;for(u=0,s=c,c=e;l[s>>2]=h[c>>0],(0|(u=u+1|0))!=(0|p);)s=s+4|0,c=c+1|0;e=e+p|0;break t;case 2:if(s=0|l[t+32>>2],f=0!=(0|p),0|l[i+32>>2]){if(!f)break t;for(u=e+(0|C(u<<1,c))|0,c=0;;){if(l[s>>2]=a[e>>1],(0|(c=c+1|0))==(0|p)){e=u;break}e=e+2|0,s=s+4|0}}else{if(!f)break t;for(u=e+(0|C(u<<1,c))|0,c=0;;){if(l[s>>2]=d[e>>1],(0|(c=c+1|0))==(0|p)){e=u;break}e=e+2|0,s=s+4|0}}break;case 4:if(p)for(u=e+(0|C(u<<2,c))|0,c=0|l[t+32>>2],s=0;;){if(l[c>>2]=l[e>>2],(0|(s=s+1|0))==(0|p)){e=u;break}c=c+4|0,e=e+4|0}}}while(0);if((m=m+1|0)>>>0>=(0|l[o>>2])>>>0){e=1;break}t=t+52|0,i=i+52|0}return 0|e}function li(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0;if(o=w,w=w+288|0,u=o+16|0,c=o+8|0,r=o+152|0,b=o+24|0,!(n=0|Ut(1,20)))return mt(i,1,20123,o),w=o,0|(b=0);for(l[n>>2]=t,l[(d=n+4|0)>>2]=e,l[r>>2]=t,l[b>>2]=e,l[(h=n+8|0)>>2]=0,y=0,s=0;g=0|C(e,t),t=(t+1|0)/2|0,l[r+((a=y+1|0)<<2)>>2]=t,e=(e+1|0)/2|0,l[b+(a<<2)>>2]=e,s=s+g|0,!(g>>>0<=1);)y=a;if(l[h>>2]=s,!s)return jt(n),mt(i,2,20161,c),w=o,0|(b=0);if(e=0|Ut(s,16),l[n+12>>2]=e,!e)return mt(i,1,20211,u),jt(n),w=o,0|(b=0);if(g=0|l[h>>2],l[n+16>>2]=g<<4,t=e+((0|C(0|l[d>>2],0|l[n>>2]))<<4)|0,y){_=0,s=t,a=t,t=e;do{p=0|l[b+(_<<2)>>2];t:do{if((0|p)>0){if((0|(m=0|l[r+(_<<2)>>2]))<=0)for(h=p+-1|0,i=0;;){if(c=(f=0!=(1&i|0)|(0|i)==(0|h))?a:s,s=f?a:s+(m<<4)|0,(0|(i=i+1|0))>=(0|p)){a=c;break t}a=c}d=(m+2+((0|(d=~m))>-3?d:-3)|0)>>>1,f=p+-1|0,u=0;do{for(h=a+16|0,i=m;;){if(l[t>>2]=a,c=t+16|0,1==(0|i)){t=c;break}if(l[c>>2]=a,t=t+32|0,!((0|i)>2))break;i=i+-2|0,a=a+16|0}h=h+(d<<4)|0,a=(i=0!=(1&u|0)|(0|u)==(0|f))?h:s,s=i?h:s+(m<<4)|0,u=u+1|0}while((0|u)<(0|p))}}while(0);_=_+1|0}while((0|_)!=(0|y))}else t=e;if(l[t>>2]=0,!g)return w=o,0|(b=n);for(t=0;l[e+4>>2]=999,l[e+8>>2]=0,l[e+12>>2]=0,(0|(t=t+1|0))!=(0|g);)e=e+16|0;return w=o,0|n}function ci(t){var e,i=0;if((t|=0)&&(e=0|l[t+8>>2]))for(i=0,t=0|l[t+12>>2];l[t+4>>2]=999,l[t+8>>2]=0,l[t+12>>2]=0,!((i=i+1|0)>>>0>=e>>>0);)t=t+16|0}function hi(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0;if(o=w,w=w+272|0,f=o,r=o+136|0,y=o+8|0,!(t|=0))return w=o,0|(y=0);if(d=t+4|0,(0|l[t>>2])==(0|e)&&(0|l[d>>2])==(0|i))a=t+8|0;else{for(l[t>>2]=e,l[d>>2]=i,l[r>>2]=e,l[y>>2]=i,l[(a=t+8|0)>>2]=0,g=0,s=i,c=e,u=0;_=0|C(s,c),c=(c+1|0)/2|0,l[r+((h=g+1|0)<<2)>>2]=c,s=(s+1|0)/2|0,l[y+(h<<2)>>2]=s,u=u+_|0,!(_>>>0<=1);)g=h;if(l[a>>2]=u,!u)return 0|(s=0|l[(a=t+12|0)>>2])&&(jt(s),l[a>>2]=0),jt(t),w=o,0|(y=0);c=u<<4,h=t+16|0,u=t+12|0;do{if(c>>>0>(0|l[h>>2])>>>0){if(0|(s=0|Wt(0|l[u>>2],c))){l[u>>2]=s,Ir(s+(i=0|l[h>>2])|0,0,c-i|0),l[h>>2]=c,i=0|l[d>>2],e=0|l[t>>2];break}return mt(n,1,20255,f),0|(a=0|l[u>>2])&&(jt(a),l[u>>2]=0),jt(t),w=o,0|(y=0)}}while(0);if(e=(s=0|l[u>>2])+((0|C(i,e))<<4)|0,g){i=e,_=0;do{p=0|l[y+(_<<2)>>2];t:do{if((0|p)>0){if((0|(m=0|l[r+(_<<2)>>2]))<=0)for(u=p+-1|0,h=0;;){if(c=(f=0!=(1&h|0)|(0|h)==(0|u))?e:i+(m<<4)|0,e=f?e:i,(0|(h=h+1|0))>=(0|p)){i=c;break t}i=c}for(d=(m+2+((0|(d=~m))>-3?d:-3)|0)>>>1,f=p+-1|0,n=0;;){for(u=e+16|0,h=m;;){if(l[s>>2]=e,c=s+16|0,1==(0|h)){s=c;break}if(l[c>>2]=e,s=s+32|0,!((0|h)>2))break;h=h+-2|0,e=e+16|0}if(e=u+(d<<4)|0,c=(u=0!=(1&n|0)|(0|n)==(0|f))?e:i+(m<<4)|0,e=u?e:i,(0|(n=n+1|0))>=(0|p)){i=c;break}i=c}}}while(0);_=_+1|0}while((0|_)!=(0|g))}l[s>>2]=0}if(!(e=0|l[a>>2]))return w=o,0|(y=t);for(a=0,s=0|l[t+12>>2];l[s+4>>2]=999,l[s+8>>2]=0,l[s+12>>2]=0,(0|(a=a+1|0))!=(0|e);)s=s+16|0;return w=o,0|t}function ui(t){var e,i;(t|=0)&&(0|(i=0|l[(e=t+12|0)>>2])&&(jt(i),l[e>>2]=0),jt(t))}function di(t,e,i){if(e|=0,i|=0,t=(0|l[12+(t|=0)>>2])+(e<<4)|0)for(;;){if((0|l[(e=t+4|0)>>2])<=(0|i)){t=4;break}if(l[e>>2]=i,!(t=0|l[t>>2])){t=4;break}}}function fi(t,e,i,n){t|=0,i|=0,n|=0;var r,o,a=0,s=0,c=0;if(o=w,w=w+128|0,r=o,i=(0|l[12+(e|=0)>>2])+(i<<4)|0,e=0|l[i>>2])for(a=0,s=e;;){if(c=a+1|0,l[r+(a<<2)>>2]=i,!(e=0|l[s>>2])){e=0,i=s;break}i=s,a=c,s=e}else e=0,c=0;for(;;){(0|e)>(0|(a=0|l[(s=i+8|0)>>2]))?l[s>>2]=e:e=a;t:do{if((0|e)<(0|n)){for(a=i+4|0;!((0|e)>=(0|l[a>>2]));)if(Si(t,0,1),(0|(e=e+1|0))>=(0|n))break t;0|l[(i=i+12|0)>>2]||(Si(t,1,1),l[i>>2]=1)}}while(0);if(l[s>>2]=e,!c)break;i=0|l[r+((s=c+-1|0)<<2)>>2],c=s}w=o}function pi(t,e,i,n){t|=0,i|=0,n|=0;var r,o,a=0,s=0,c=0;if(o=w,w=w+128|0,r=o,e=(0|l[12+(e|=0)>>2])+(i<<4)|0,i=0|l[e>>2])for(a=0;;){if(s=a+1|0,l[r+(a<<2)>>2]=e,!(e=0|l[i>>2])){a=0,e=i;break}c=i,a=s,i=e,e=c}else a=0,s=0;for(;;){(0|a)>(0|(i=0|l[(c=e+8|0)>>2]))&&(l[c>>2]=a,i=a),a=e+4|0;t:do{if((0|i)<(0|n)){for(e=i;;){if((0|e)>=(0|l[a>>2]))break t;if(0|Mi(t,1))break;if((0|(e=e+1|0))>=(0|n))break t}l[a>>2]=e}else e=i}while(0);if(l[c>>2]=e,!s)break;a=e,e=0|l[r+((c=s+-1|0)<<2)>>2],s=c}return w=o,(0|l[a>>2])<(0|n)|0}function mi(){var t=0,e=0;return(t=0|Ut(1,12))?(l[t+4>>2]=10,e=0|Ut(10,4),l[t+8>>2]=e,0|e?0|(e=t):(jt(t),0|(e=0))):0|(t=0)}function _i(t){var e;(t|=0)&&(0|(e=0|l[t+8>>2])&&jt(e),jt(t))}function gi(t,e,i){e|=0,i|=0;var n,r,o,a=0,s=0;o=w,w=w+16|0,r=o,s=0|l[(n=4+(t|=0)|0)>>2],a=0|l[t>>2];do{if((0|s)==(0|a)){if(s=s+10|0,l[n>>2]=s,0|(s=0|Wt(0|l[(a=t+8|0)>>2],s<<2))){l[a>>2]=s,a=0|l[t>>2];break}return jt(0|l[a>>2]),l[n>>2]=0,l[t>>2]=0,mt(i,1,20303,r),w=o,0|(e=0)}s=0|l[t+8>>2]}while(0);return l[s+(a<<2)>>2]=e,l[t>>2]=a+1,w=o,0|(e=1)}function yi(t){return 0|l[(t|=0)>>2]}function bi(t){return 0|l[8+(t|=0)>>2]}function vi(t){l[(t|=0)>>2]=0}function wi(){return 0|zt(20)}function xi(t){(t|=0)&&jt(t)}function Ai(t){return(0|l[8+(t|=0)>>2])-(0|l[t>>2])|0}function Si(t,e,i){t|=0,e|=0;var n,o,a,s,c=0,h=0,u=0,d=0;if(i|=0){a=t+12|0,s=t+8|0,n=t+4|0,u=i+-1|0,t=0|l[(o=t+16|0)>>2];do{d=e>>>u&1,t||(t=(c=0|l[a>>2])<<8&65280,l[a>>2]=t,t=65280==(0|t)?7:8,l[o>>2]=t,h=0|l[s>>2],(0|l[n>>2])>>>0>h>>>0&&(l[s>>2]=h+1,r[h>>0]=c,t=0|l[o>>2])),t=t+-1|0,l[o>>2]=t,l[a>>2]=l[a>>2]|d<<t,u=u+-1|0}while(u>>>0<i>>>0)}}function Mi(t,e){t|=0;var i,n,r,o=0,a=0,s=0,c=0,u=0;if(!(e|=0))return 0|(u=0);n=t+16|0,r=t+12|0,u=t+8|0,i=t+4|0,c=e+-1|0,t=0,o=0|l[r>>2],a=0|l[n>>2];do{a||(o=o<<8&65280,l[r>>2]=o,a=65280==(0|o)?7:8,l[n>>2]=a,s=0|l[u>>2],(0|l[i>>2])>>>0>s>>>0&&(l[u>>2]=s+1,o=0|o|h[s>>0],l[r>>2]=o)),a=a+-1|0,l[n>>2]=a,t|=(o>>>a&1)<<c,c=c+-1|0}while(c>>>0<e>>>0);return 0|t}function Ei(t){var e=0,i=0,n=0,r=0,o=0;e=0|l[(o=12+(t|=0)|0)>>2];do{if(255==(255&e|0)){if(r=e<<8&65280,l[o>>2]=r,l[(e=t+16|0)>>2]=65280==(0|r)?7:8,n=0|l[(i=t+8|0)>>2],(0|l[t+4>>2])>>>0>n>>>0){l[i>>2]=n+1,l[o>>2]=0|r|h[n>>0];break}return 0|(o=0)}e=t+16|0}while(0);return l[e>>2]=0,0|(o=1)}function Ti(t){return 0|ki(t|=0,1)}function ki(t,e){e|=0;var i,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0;if(M=(0|l[8+(t|=0)>>2])-(0|l[t>>2])|0,n=(s=0|l[t+16>>2])-1|0,i=0|l[t+32>>2],a=(t=0|l[t+24>>2])+(136*n|0)|0,o=0==(0|n))t=0;else{r=0;do{A=t,t=t+136|0,r=(S=r>>>0<(S=(0|l[A+144>>2])-(0|l[t>>2])|0)>>>0?S:r)>>>0<(A=(0|l[A+148>>2])-(0|l[A+140>>2])|0)>>>0?A:S,n=n+-1|0}while(0!=(0|n));t=r<<2}if(!(0==(0|t)|0!=(0|(S=0|zt(t)))))return 0|(M=0);if(!o)for(A=S+4|0,b=s+-2|0;;){h=a,a=a+-136|0,x=0|l[h>>2],y=(0|l[h+8>>2])-x|0,d=0|l[h+4>>2],v=(0|l[h+12>>2])-d|0,w=(0|l[h+-128>>2])-(0|l[a>>2])|0,x&=1,d&=1,f=v-(h=(0|l[h+-124>>2])-(0|l[h+-132>>2])|0)|0,g=(0|y)>0;t:do{if(g){if(c=0==(0|h),p=0==(0|f),m=A+(0-d<<2)|0,_=0|C(h,M),u=S+(d<<2)|0,(0|v)>0)for(s=0;;){o=i+(s<<2)|0,t=0;do{r=o+((0|C(t,M))<<2)|0,l[S+(t<<2)>>2]=l[r>>2],t=t+1|0}while((0|t)!=(0|v));if(oo[3&e](S,f,h,d),!c)for(t=o,n=h,r=u;n=n+-1|0,l[t>>2]=l[r>>2],n;)t=t+(M<<2)|0,r=r+8|0;if(!p)for(t=o+(_<<2)|0,n=f,r=m;n=n+-1|0,l[t>>2]=l[r>>2],n;)t=t+(M<<2)|0,r=r+8|0;if((0|(s=s+1|0))==(0|y))break t}if(c)for(t=0;;){if(oo[3&e](S,f,0,d),!p)for(n=i+(t<<2)+(_<<2)|0,r=f,o=m;r=r+-1|0,l[n>>2]=l[o>>2],r;)n=n+(M<<2)|0,o=o+8|0;if((0|(t=t+1|0))==(0|y))break t}else s=0;do{for(o=i+(s<<2)|0,oo[3&e](S,f,h,d),t=o,n=h,r=u;n=n+-1|0,l[t>>2]=l[r>>2],n;)t=t+(M<<2)|0,r=r+8|0;if(!p)for(t=o+(_<<2)|0,n=f,r=m;n=n+-1|0,l[t>>2]=l[r>>2],n;)t=t+(M<<2)|0,r=r+8|0;s=s+1|0}while((0|s)!=(0|y))}}while(0);u=y-w|0;t:do{if((0|v)>0){if(c=(0|w)>0,h=S+(x<<2)|0,d=(0|u)>0,f=A+(0-x<<2)|0,g)for(s=0;;){o=i+((0|C(s,M))<<2)|0,t=0;do{l[S+(t<<2)>>2]=l[o+(t<<2)>>2],t=t+1|0}while((0|t)!=(0|y));if(oo[3&e](S,u,w,x),c)for(t=o,n=0,r=h;l[t>>2]=l[r>>2],(0|(n=n+1|0))!=(0|w);)t=t+4|0,r=r+8|0;if(d)for(t=o+(w<<2)|0,n=0,r=f;l[t>>2]=l[r>>2],(0|(n=n+1|0))!=(0|u);)t=t+4|0,r=r+8|0;if((0|(s=s+1|0))==(0|v))break t}if(c)s=0;else for(t=0;;){if(oo[3&e](S,u,w,x),d)for(n=i+((0|C(t,M))<<2)+(w<<2)|0,r=0,o=f;l[n>>2]=l[o>>2],(0|(r=r+1|0))!=(0|u);)n=n+4|0,o=o+8|0;if((0|(t=t+1|0))==(0|v))break t}do{for(o=i+((0|C(s,M))<<2)|0,oo[3&e](S,u,w,x),t=o,n=0,r=h;l[t>>2]=l[r>>2],(0|(n=n+1|0))!=(0|w);)t=t+4|0,r=r+8|0;if(d)for(t=o+(w<<2)|0,n=0,r=f;l[t>>2]=l[r>>2],(0|(n=n+1|0))!=(0|u);)t=t+4|0,r=r+8|0;s=s+1|0}while((0|s)!=(0|v))}}while(0);if(!b)break;b=b+-1|0}return jt(S),0|(M=1)}function Ci(t,e){e|=0;var i,n,r,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0;if(r=w,w=w+32|0,n=r+16|0,B=r,h=0|l[24+(t|=0)>>2],c=(0|l[h+8>>2])-(0|l[h>>2])|0,u=(0|l[h+12>>2])-(0|l[h+4>>2])|0,i=(0|l[t+8>>2])-(0|l[t>>2])|0,1==(0|e))return w=r,0|(B=1);if(s=0==(0|(d=e+-1|0)))e=0;else{e=h,o=0,a=d;do{P=e,e=e+136|0,o=(R=o>>>0<(R=(0|l[P+144>>2])-(0|l[e>>2])|0)>>>0?R:o)>>>0<(P=(0|l[P+148>>2])-(0|l[P+140>>2])|0)>>>0?P:R,a=a+-1|0}while(0!=(0|a));e=o<<2}if(R=0|Ht(e),l[n>>2]=R,!R)return w=r,0|(B=0);if(l[B>>2]=R,!s){A=t+32|0,S=n+8|0,M=B+8|0,E=n+4|0,T=n+12|0,k=B+4|0,I=B+12|0,P=R+4|0;do{if(x=0|l[A>>2],y=h,h=h+136|0,l[S>>2]=c,l[M>>2]=u,o=0|l[h>>2],_=c,c=(0|l[y+144>>2])-o|0,e=0|l[(g=y+140|0)>>2],v=u,u=(0|l[y+148>>2])-e|0,y=c-_|0,l[E>>2]=y,o=(0|o)%2|0,l[T>>2]=o,!(b=0==(0|u))){for(f=c<<2,p=0==(0|_),m=0==(0|y),e=0;;){if(t=x+((0|C(e,i))<<2)|0,p)a=0;else{for(o=R+(o<<2)|0,a=t,s=_;s=s+-1|0,l[o>>2]=l[a>>2],s;)o=o+8|0,a=a+4|0;o=0|l[T>>2],a=_}if(!m)for(s=P+(0-o<<2)|0,o=t+(a<<2)|0,a=y;a=a+-1|0,l[s>>2]=l[o>>2],a;)s=s+8|0,o=o+4|0;if(Ii(n),Cr(0|t,0|R,0|f),(0|(e=e+1|0))==(0|u))break;o=0|l[T>>2]}e=0|l[g>>2]}m=u-v|0,l[k>>2]=m,o=(0|e)%2|0,l[I>>2]=o;t:do{if(0|c){if(f=0==(0|v),p=0==(0|m),b)for(e=0;;){if(t=x+(e<<2)|0,f)a=0;else{for(o=R+(o<<2)|0,a=t,s=v;s=s+-1|0,l[o>>2]=l[a>>2],s;)o=o+8|0,a=a+(i<<2)|0;o=0|l[I>>2],a=v}if(!p)for(s=P+(0-o<<2)|0,o=t+((0|C(a,i))<<2)|0,a=m;a=a+-1|0,l[s>>2]=l[o>>2],a;)s=s+8|0,o=o+(i<<2)|0;if(Ii(B),(0|(e=e+1|0))==(0|c))break t;o=0|l[I>>2]}else e=0;for(;;){if(t=x+(e<<2)|0,f)a=0;else{for(o=R+(o<<2)|0,a=t,s=v;s=s+-1|0,l[o>>2]=l[a>>2],s;)o=o+8|0,a=a+(i<<2)|0;o=0|l[I>>2],a=v}if(!p)for(s=P+(0-o<<2)|0,o=t+((0|C(a,i))<<2)|0,a=m;a=a+-1|0,l[s>>2]=l[o>>2],a;)s=s+8|0,o=o+(i<<2)|0;Ii(B),o=0;do{b=x+((0|C(o,i))+e<<2)|0,l[b>>2]=l[R+(o<<2)>>2],o=o+1|0}while((0|o)!=(0|u));if((0|(e=e+1|0))==(0|c))break t;o=0|l[I>>2]}}}while(0);d=d+-1|0}while(0!=(0|d))}return Vt(R),w=r,0|(B=1)}function Ii(t){var e,i,n,r=0,o=0,a=0;if(e=0|l[(t|=0)>>2],i=0|l[t+4>>2],n=0|l[t+8>>2],0|l[t+12>>2])if(1==(0|i)&0==(0|n))l[e>>2]=(0|l[e>>2])/2|0;else{if((0|n)>0){r=i+-1|0,t=0;do{o=t,t=t+1|0,l[(a=e+((o<<1|1)<<2)|0)>>2]=(0|l[a>>2])-(2+(0|l[e+(((0|o)>=(0|i)?r:o)<<1<<2)>>2])+(0|l[e+(((0|t)>=(0|i)?r:t)<<1<<2)>>2])>>2)}while((0|t)!=(0|n))}if(!((0|i)<=0)){r=n+-1|0,t=0;do{l[(a=e+(t<<1<<2)|0)>>2]=((0|l[e+(((0|t)<1?1:(((0|t)>(0|n)?n:t)<<1)-1|0)<<2)>>2])+(0|l[e+((((0|t)>=(0|n)?r:t)<<1|1)<<2)>>2])>>1)+(0|l[a>>2]),t=t+1|0}while((0|t)!=(0|i))}}else{if(!((o=(0|i)>0)|(0|n)>1))return;if((0|n)>0){r=i+-1|0,t=0;do{l[(a=e+(t<<1<<2)|0)>>2]=(0|l[a>>2])-(2+(0|l[e+(((0|t)<1?1:(((0|t)>(0|i)?i:t)<<1)-1|0)<<2)>>2])+(0|l[e+((((0|t)>=(0|i)?r:t)<<1|1)<<2)>>2])>>2),t=t+1|0}while((0|t)!=(0|n))}if(!o)return;r=n+-1|0,t=0;do{o=t,t=t+1|0,l[(a=e+((o<<1|1)<<2)|0)>>2]=((0|l[e+(((0|t)>=(0|n)?r:t)<<1<<2)>>2])+(0|l[e+(((0|o)>=(0|n)?r:o)<<1<<2)>>2])>>1)+(0|l[a>>2])}while((0|t)!=(0|i))}}function Pi(t,e){return+ +g[56+(80*(e|=0)|0)+((t|=0)<<3)>>3]}function Ri(t){return 0|ki(t|=0,2)}function Bi(t,e){return+ +g[376+(80*(e|=0)|0)+((t|=0)<<3)>>3]}function Li(t,e){e|=0;var i,n,r,o,a=0,s=0,c=0,h=0,u=0,d=0,f=0;if(n=(3*(0|l[(i=4+(t|=0)|0)>>2])|0)-2|0){r=t+20|0,o=t+24|0,f=0;do{if(f?(s=1+(((c=f+-1|0)>>>0)%3|0)|0,c=1+((c>>>0)/3|0)|0):(s=0,c=0),h=0==(0|s)|0==(0|l[r>>2])?0:(s+-1|0)>>>0<2?1:2,a=0|l[o>>2]?+(1<<h|0)/+g[376+(80*s|0)+((0|l[i>>2])+~c<<3)>>3]:1,u=h+e|0,(0|(d=~~+M(8192*a)))>1){for(s=d,h=0;;){if(!(s>>>0>3)){s=d,c=0;break}s>>>=1,h=h+1|0}for(;s>>>0>3;)s>>>=1,c=c+1|0;c=10-c|0,s=h+-12|0}else c=11,s=-13;l[t+28+(f<<3)+4>>2]=2047&((0|c)<0?d>>0-c:d<<c),l[t+28+(f<<3)>>2]=u-s,f=f+1|0}while((0|f)!=(0|n))}}function Di(t,e){e|=0;var i,n,r,o,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0;if(o=w,w=w+32|0,r=o+16|0,j=o,f=0|l[24+(t|=0)>>2],h=0|l[f+8>>2],u=0|l[f>>2],g=0|l[f+12>>2],y=0|l[f+4>>2],n=(m=0|l[(i=t+8|0)>>2])-(_=0|l[t>>2])|0,c=0==(0|(d=e+-1|0)))e=80;else{e=f,a=0,s=d;do{H=e,e=e+136|0,a=(V=a>>>0<(V=(0|l[H+144>>2])-(0|l[e>>2])|0)>>>0?V:a)>>>0<(H=(0|l[H+148>>2])-(0|l[H+140>>2])|0)>>>0?H:V,s=s+-1|0}while(0!=(0|s));e=80+(a<<4)|0}if(p=0|Ht(e),l[r>>2]=p,!p)return w=o,0|(j=0);l[j>>2]=p;t:do{if(c)e=p;else for(I=t+32|0,P=t+12|0,R=t+4|0,B=r+8|0,L=j+8|0,D=r+4|0,O=r+12|0,F=n<<2,G=n<<1,N=3*n|0,z=j+4|0,U=j+12|0,H=m-_<<2,V=_-m<<2,b=h-u|0,a=d,e=p,s=p,h=m,c=_,S=g-y|0,g=p;;){M=0|l[I>>2],c=0|C((0|l[P>>2])-(0|l[R>>2])|0,h-c|0),l[B>>2]=b,l[L>>2]=S,E=f+136|0,T=(y=0|l[f+144>>2])-(v=0|l[E>>2])|0,k=(u=0|l[f+148>>2])-(h=0|l[(_=f+140|0)>>2])|0,l[D>>2]=T-b,l[O>>2]=(0|v)%2|0;do{if((0|k)>3){if(m=M+(F<<2)+((0|C(H,p=(u+4+((0|(p=h+-1-u|0))>-8?p:-8)-h|0)>>>2))<<2)|0,p=0|C(V,p),!((0|T)>0)){for(h=k,u=c,d=M;Oi(r,d,n,u),Fi(r),(0|h)>7;)h=h+-4|0,u=u-F|0,d=d+(F<<2)|0;c=V+c+p|0,u=m;break}for(h=k,u=c,d=M;;){Oi(r,d,n,u),Fi(r),f=T;do{A=f,l[d+((f=f+-1|0)<<2)>>2]=l[g+(f<<4)>>2],l[d+(f+n<<2)>>2]=l[g+(f<<4)+4>>2],l[d+(f+G<<2)>>2]=l[g+(f<<4)+8>>2],l[d+(f+N<<2)>>2]=l[g+(f<<4)+12>>2]}while((0|A)>1);if(!((0|h)>7))break;h=h+-4|0,u=u-F|0,d=d+(F<<2)|0}c=V+c+p|0,u=m}else u=M}while(0);e:do{if(3&k){if(Oi(r,u,n,c),Fi(r),c=T+-1|0,(0|T)<=0){m=k-S|0,l[z>>2]=m,p=(0|l[_>>2])%2|0,l[U>>2]=p,_=M;break}switch(h=0|l[r>>2],3&k){case 3:for(e=c;;){if(l[u+(e+G<<2)>>2]=l[h+(e<<4)+8>>2],l[u+(e+n<<2)>>2]=l[h+(e<<4)+4>>2],l[u+(e<<2)>>2]=l[h+(e<<4)>>2],!((0|e)>0)){e=h,A=h,W=22;break}e=e+-1|0}break;case 2:for(e=c;;){if(l[u+(e+n<<2)>>2]=l[h+(e<<4)+4>>2],l[u+(e<<2)>>2]=l[h+(e<<4)>>2],!((0|e)>0)){e=h,A=h,W=22;break}e=e+-1|0}break;case 1:for(e=c;;){if(l[u+(e<<2)>>2]=l[h+(e<<4)>>2],!((0|e)>0)){e=h,A=h,W=22;break}e=e+-1|0}break;default:e=h,A=h,W=22;break e}}else A=g,W=22}while(0);do{if(22==(0|W))if(W=0,x=k-S|0,l[z>>2]=x,b=(0|l[_>>2])%2|0,l[U>>2]=b,(0|T)>3){if(y=y+4+((0|(g=v+-1-y|0))>-8?g:-8)-v&-4,!k){for(p=(0|S)>0,m=0|C(S,n),_=0-b|0,g=(0|x)>0,d=M,f=T;;){if(h=(s=0|l[j>>2])+(b<<4)|0,p){c=0;do{v=h+(c<<1<<4)|0,u=d+((0|C(c,n))<<2)|0,l[v>>2]=l[u>>2],l[v+4>>2]=l[u+4>>2],l[v+8>>2]=l[u+8>>2],l[v+12>>2]=l[u+12>>2],c=c+1|0}while((0|c)!=(0|S))}if(h=d+(m<<2)|0,u=s+16+(_<<4)|0,g){c=0;do{v=u+(c<<1<<4)|0,Z=h+((0|C(c,n))<<2)|0,l[v>>2]=l[Z>>2],l[v+4>>2]=l[Z+4>>2],l[v+8>>2]=l[Z+8>>2],l[v+12>>2]=l[Z+12>>2],c=c+1|0}while((0|c)!=(0|x))}if(Fi(j),!((0|f)>7))break;d=d+16|0,f=f+-4|0}_=M+16+(y<<2)|0,p=b,m=x,g=A;break}for(p=(0|(f=0|l[L>>2]))>0,m=0|C(f,n),_=0-b|0,g=(0|x)>0,u=M,d=T;;){if(h=s+(b<<4)|0,p){c=0;do{Z=h+(c<<1<<4)|0,S=u+((0|C(c,n))<<2)|0,l[Z>>2]=l[S>>2],l[Z+4>>2]=l[S+4>>2],l[Z+8>>2]=l[S+8>>2],l[Z+12>>2]=l[S+12>>2],c=c+1|0}while((0|c)!=(0|f))}if(h=u+(m<<2)|0,c=s+16+(_<<4)|0,g){s=0;do{Z=c+(s<<1<<4)|0,S=h+((0|C(s,n))<<2)|0,l[Z>>2]=l[S>>2],l[Z+4>>2]=l[S+4>>2],l[Z+8>>2]=l[S+8>>2],l[Z+12>>2]=l[S+12>>2],s=s+1|0}while((0|s)!=(0|x))}Fi(j),c=0;do{Z=u+((0|C(c,n))<<2)|0,S=(s=0|l[j>>2])+(c<<4)|0,l[Z>>2]=l[S>>2],l[Z+4>>2]=l[S+4>>2],l[Z+8>>2]=l[S+8>>2],l[Z+12>>2]=l[S+12>>2],c=c+1|0}while((0|c)!=(0|k));if(!((0|d)>7))break;u=u+16|0,d=d+-4|0}_=M+16+(y<<2)|0,p=b,m=x,g=A}else _=M,p=b,m=x,g=A}while(0);if(d=3&T){if(c=(f=0|l[j>>2])+(p<<4)|0,(0|(h=0|l[L>>2]))>0){u=d<<2,s=0;do{Cr(c+(s<<1<<4)|0,_+((0|C(s,n))<<2)|0,0|u),s=s+1|0}while((0|s)!=(0|h))}if(u=_+((0|C(h,n))<<2)|0,c=f+16+(0-p<<4)|0,(0|m)>0){h=d<<2,s=0;do{Cr(c+(s<<1<<4)|0,u+((0|C(s,n))<<2)|0,0|h),s=s+1|0}while((0|s)!=(0|m))}if(Fi(j),k){c=d<<2,s=0;do{Cr(_+((0|C(s,n))<<2)|0,f+(s<<4)|0,0|c),s=s+1|0}while((0|s)!=(0|k));s=f}else s=f}if(!(a=a+-1|0))break t;b=T,f=E,h=0|l[i>>2],c=0|l[t>>2],S=k}}while(0);return Vt(e),w=o,0|(Z=1)}function Oi(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0;if(u=(d=0|l[(t|=0)>>2])+((r=0|l[t+12>>2])<<4)|0,o=0|l[t+8>>2],a=3*i|0,c=d+16+(0-r<<4)|0,s=0|l[t+4>>2],(o+a|0)<(0|n)&&0==(15&e|0)&&0==(15&(u|i)|0)){if((0|o)>0){t=0;do{l[d+(r<<4)+((u=t<<3)<<2)>>2]=l[e+(t<<2)>>2],g=t+i|0,l[d+(r<<4)+((1|u)<<2)>>2]=l[e+(g<<2)>>2],g=g+i|0,l[d+(r<<4)+((2|u)<<2)>>2]=l[e+(g<<2)>>2],l[d+(r<<4)+((3|u)<<2)>>2]=l[e+(g+i<<2)>>2],t=t+1|0}while((0|t)!=(0|o))}}else h=2;if(2==(0|h)&&(0|o)>0){t=0;do{l[d+(r<<4)+((h=t<<3)<<2)>>2]=l[e+(t<<2)>>2],(0|(u=t+i|0))<(0|n)&&(l[d+(r<<4)+((1|h)<<2)>>2]=l[e+(u<<2)>>2],(0|(f=u+i|0))<(0|n))&&(l[d+(r<<4)+((2|h)<<2)>>2]=l[e+(f<<2)>>2],(0|(p=f+i|0))<(0|n))&&(l[d+(r<<4)+((3|h)<<2)>>2]=l[e+(p<<2)>>2]),t=t+1|0}while((0|t)!=(0|o))}if(d=e+(o<<2)|0,(s+a|0)<(0|(e=n-o|0))&&0==(15&d|0)&&0==(15&(c|i)|0)){if(!((0|s)>0))return;t=0;do{l[c+((g=t<<3)<<2)>>2]=l[d+(t<<2)>>2],_=t+i|0,l[c+((1|g)<<2)>>2]=l[d+(_<<2)>>2],_=_+i|0,l[c+((2|g)<<2)>>2]=l[d+(_<<2)>>2],l[c+((3|g)<<2)>>2]=l[d+(_+i<<2)>>2],t=t+1|0}while((0|t)!=(0|s))}else if((0|s)>0){t=0;do{l[c+((h=t<<3)<<2)>>2]=l[d+(t<<2)>>2],(0|(u=t+i|0))<(0|e)&&(l[c+((1|h)<<2)>>2]=l[d+(u<<2)>>2],(0|(m=u+i|0))<(0|e))&&(l[c+((2|h)<<2)>>2]=l[d+(m<<2)>>2],(0|(_=m+i|0))<(0|e))&&(l[c+((3|h)<<2)>>2]=l[d+(_<<2)>>2]),t=t+1|0}while((0|t)!=(0|s))}}function Fi(t){t|=0;var e=0,i=0,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0;do{if(0|l[t+12>>2]){if((0|(n=0|l[t+8>>2]))<=0){if((0|l[t+4>>2])>1){r=1,a=0,o=0|l[t>>2];break}return}i=0,e=1,s=7}else{if(n=0|l[t+8>>2],(0|l[t+4>>2])>0){if(e=0|l[t>>2],(0|n)>0){r=0,i=1,o=e,s=9;break}r=0,a=1,o=e;break}if(!((0|n)>1))return;i=1,e=0,s=7}}while(0);if(7==(0|s)&&(r=e,o=0|l[t>>2],s=9),9==(0|s)){e=0;do{f=o+(r<<4)+((s=e<<3)<<2)|0,d=+m[(u=o+(r<<4)+((1|s)<<2)|0)>>2],h=+m[(a=o+(r<<4)+((2|s)<<2)|0)>>2],c=+m[(s=o+(r<<4)+((3|s)<<2)|0)>>2],m[f>>2]=1.2301740646362305*+m[f>>2],m[u>>2]=1.2301740646362305*d,m[a>>2]=1.2301740646362305*h,m[s>>2]=1.2301740646362305*c,e=e+1|0}while((0|e)!=(0|n));a=i}if((0|(i=0|l[t+4>>2]))>0){e=0;do{s=o+(a<<4)+((f=e<<3)<<2)|0,c=+m[(t=o+(a<<4)+((1|f)<<2)|0)>>2],h=+m[(u=o+(a<<4)+((2|f)<<2)|0)>>2],d=+m[(f=o+(a<<4)+((3|f)<<2)|0)>>2],m[s>>2]=1.625732421875*+m[s>>2],m[t>>2]=1.625732421875*c,m[u>>2]=1.625732421875*h,m[f>>2]=1.625732421875*d,e=e+1|0}while((0|e)!=(0|i))}Gi(e=o+(a<<4)|0,o=16+(t=o+(r<<4)|0)|0,n,s=(0|n)<(0|(s=i-r|0))?n:s,-.4435068666934967),Gi(t,u=e+16|0,i,f=(0|i)<(0|(f=n-a|0))?i:f,-.8829110860824585),Gi(e,o,n,s,.05298011749982834),Gi(t,u,i,f,1.5861343145370483)}function Gi(t,e,i,n,r){t|=0,e|=0,i|=0,r=+r;var o=0,a=0,s=0,l=0,c=0,h=0,u=0,d=0,f=0,p=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0;if((0|(n|=0))>0){for(u=(d=n<<1)-2|0,c=e,h=0,a=+m[t>>2],s=+m[t+4>>2],l=+m[t+8>>2],o=+m[t+12>>2];x=c+-16|0,w=+m[(b=c+-12|0)>>2],y=+m[(_=c+-8|0)>>2],p=+m[(t=c+-4|0)>>2],A=a,a=+m[c>>2],v=s,s=+m[c+4>>2],g=l,l=+m[c+8>>2],f=o,o=+m[c+12>>2],m[x>>2]=+m[x>>2]+(A+a)*r,m[b>>2]=w+(v+s)*r,m[_>>2]=y+(g+l)*r,m[t>>2]=p+(f+o)*r,(0|(h=h+1|0))!=(0|n);)c=c+32|0;t=e+(u<<4)|0,e=e+(d<<4)|0}if(!((0|n)>=(0|i)))for(a=(o=r+r)*+m[t>>2],s=o*+m[t+4>>2],l=o*+m[t+8>>2],o*=+m[t+12>>2];d=e+-16|0,v=+m[(_=e+-12|0)>>2],w=+m[(b=e+-8|0)>>2],A=+m[(x=e+-4|0)>>2],m[d>>2]=a+ +m[d>>2],m[_>>2]=s+v,m[b>>2]=l+w,m[x>>2]=o+A,(0|(n=n+1|0))!=(0|i);)e=e+32|0}function Ni(t,e,i){t|=0,e|=0;var n,r,o,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0;if(r=(i|=0)<<2,!(o=0|zt(i<<4)))return 0|(M=0);if(M=o+r|0,Ir(0|o,0,0|r),x=i+-1|0,!(n=0==(0|i)))for(a=o,s=0;l[a>>2]=s,(0|(s=s+1|0))!=(0|i);)a=a+4|0;t:do{if(0|x){for(_=1,g=t,y=0,a=0,b=o,w=i;v=g+(y<<2)|0,y>>>0<i>>>0;){for(s=v,c=0,h=y;a=(S=(p=(p=+m[s>>2])>0?p:-p)>c)?h:a,c=S?p:c,(0|(h=h+1|0))!=(0|i);)s=s+(i<<2)|0;if(0==c)break;if((0|a)!=(0|y)&&(S=b+(a<<2)+(0-y<<2)|0,A=0|l[b>>2],l[b>>2]=l[S>>2],l[S>>2]=A,Cr(0|M,0|(S=g+((0|C(a-y|0,i))<<2)|0),0|r),Cr(0|S,0|g,0|r),Cr(0|g,0|M,0|r)),c=+m[v>>2],_>>>0<i>>>0)for(h=v+(i<<2)|0,d=_;;){p=+m[h>>2]/c,m[h>>2]=p,s=_,u=h,f=v;do{f=f+4|0,m[(u=u+4|0)>>2]=+m[u>>2]-p*+m[f>>2],s=s+1|0}while((0|s)!=(0|i));if((0|(d=d+1|0))==(0|i))break;h=h+(w<<2)+(y<<2)|0}if((y=y+1|0)>>>0>=x>>>0)break t;_=_+1|0,g=g+(i<<2)|0,b=b+4|0,w=w+-1|0}return jt(o),0|(M=0)}}while(0);if(A=M+(i<<2)|0,S=M+(i<<1<<2)|0,!n)for(b=A+(i<<2)|0,v=S+(i<<2)|0,w=t+((0|C(i,i))<<2)+-4|0,x=~i,y=0;;){for(Ir(0|M,0,0|r),m[M+(y<<2)>>2]=1,u=o,d=t,f=S,_=0,g=1;;){if(_)for(a=d,s=S,c=0,h=1;c+=+m[a>>2]*+m[s>>2],(0|(h=h+1|0))!=(0|g);)a=a+4|0,s=s+4|0;else c=0;if(m[f>>2]=+m[M+(l[u>>2]<<2)>>2]-c,(0|(_=_+1|0))==(0|i)){u=i,d=w,f=b,_=v;break}u=u+4|0,d=d+(i<<2)|0,f=f+4|0,g=g+1|0}for(;;){if(_=_+-4|0,p=+m[d>>2],u>>>0<i>>>0)for(a=d,s=f,c=0,h=u;c+=+m[(a=a+4|0)>>2]*+m[s>>2],(0|(h=h+1|0))!=(0|i);)s=s+4|0;else c=0;if(u=u+-1|0,m[(f=f+-4|0)>>2]=(+m[_>>2]-c)/p,!u){a=e,s=0;break}d=d+(x<<2)|0}for(;l[a>>2]=l[A+(s<<2)>>2],(0|(s=s+1|0))!=(0|i);)a=a+(i<<2)|0;if((0|(y=y+1|0))==(0|i))break;e=e+4|0}return jt(o),0|(M=1)}function zi(t){t|=0;var e=0,i=0,n=0,r=0,o=0,a=0;return(o=0|Ut(1,44))?(a=0|zt(104),l[o>>2]=a,a?(a=0|zt(28),l[(e=o+4|0)>>2]=a,0|a?(l[o+40>>2]=t,0|(a=o)):(qi(0|l[o>>2]),l[o>>2]=0,fn(0|l[e>>2]),l[e>>2]=0,0==(0|l[o+40>>2])&&0|(r=0|l[(n=o+8|0)>>2])&&(Vt(r),l[n>>2]=0),0|(i=0|l[(e=o+12|0)>>2])&&(Vt(i),l[e>>2]=0),jt(o),0|(a=0))):(qi(0),l[o>>2]=0,fn(0|l[(a=o+4|0)>>2]),l[a>>2]=0,0==(0|l[o+40>>2])&&0|(i=0|l[(e=o+8|0)>>2])&&(Vt(i),l[e>>2]=0),0|(i=0|l[(e=o+12|0)>>2])&&(Vt(i),l[e>>2]=0),jt(o),0|(a=0))):0|(o=0)}function Ui(t){var e,i=0,n=0;(t|=0)&&(qi(0|l[t>>2]),l[t>>2]=0,fn(0|l[(e=t+4|0)>>2]),l[e>>2]=0,0==(0|l[t+40>>2])&&0|(n=0|l[(i=t+8|0)>>2])&&(Vt(n),l[i>>2]=0),0|(n=0|l[(i=t+12|0)>>2])&&(Vt(n),l[i>>2]=0),jt(t))}function Hi(t,e,i){t|=0,i|=0;var n,r,o,s,c,u,f,p,_,g,y,b,v=0,w=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0,et=0,it=0,nt=0,rt=0,ot=0,at=0,st=0,lt=0,ct=0,ht=0,ut=0,dt=0,ft=0,pt=0,mt=0,_t=0,gt=0,yt=0,bt=0,vt=0,wt=0,xt=0,At=0,St=0,Mt=0,Et=0,Tt=0,kt=0;if(b=(0|l[8+(e|=0)>>2])-(0|l[e>>2])|0,!(v=0|l[(Tt=e+20|0)>>2]))return 0|(Tt=1);c=e+24|0,u=i+808|0,f=i+16|0,p=t+4|0,_=t+8|0,g=t+16|0,y=t+20|0,s=i+20|0,n=e+32|0,r=t+12|0,o=t+32|0,Mt=0,i=v;t:for(;;){if(At=0|l[c>>2],e=0|l[(St=At+(136*Mt|0)+24|0)>>2]){vt=At+(136*Mt|0)+16|0,xt=Mt+-1|0,bt=0,v=0|l[(wt=At+(136*Mt|0)+20|0)>>2],i=0|l[vt>>2];do{if(0|C(v,i)){pt=At+(136*Mt|0)+28+(36*bt|0)+20|0,mt=At+(136*Mt|0)+28+(36*bt|0)+16|0,_t=At+(136*Mt|0)+28+(36*bt|0)|0,gt=At+(136*Mt|0)+28+(36*bt|0)+4|0,yt=At+(136*Mt|0)+28+(36*bt|0)+32|0,ft=0;do{if(ut=(e=0|l[pt>>2])+(40*ft|0)+16|0,0|C(0|l[(dt=e+(40*ft|0)+20|0)>>2],0|l[ut>>2])){ht=e+(40*ft|0)+24|0,ct=0;do{if(i=0|l[ht>>2],it=0|l[mt>>2],v=0|l[u>>2],e=0|l[f>>2],nt=0|l[p>>2],rt=0|l[t>>2],ot=i+(56*ct|0)+8|0,lt=i+(56*ct|0)+12|0,!(0|Vi(t,(0|l[i+(56*ct|0)+16>>2])-(0|l[ot>>2])|0,(0|l[i+(56*ct|0)+20>>2])-(0|l[lt>>2])|0))){i=0,W=219;break t}if(w=0|l[(at=i+(56*ct|0)+24|0)>>2],an(rt),sn(rt,18,0,46),sn(rt,17,0,3),sn(rt,0,0,4),0|l[(st=i+(56*ct|0)+48|0)>>2]){q=i+(56*ct|0)+4|0,K=0!=(1&e|0),$=0==(2&e|0),tt=0==(8&e|0),et=it<<8,Q=0==(32&e|0),J=0,e=2,i=w+v|0;do{x=0|l[q>>2],X=K&(e>>>0<2?(0|i)<=((0|l[at>>2])-4|0):0),v=0|l[x+(J<<5)>>2];e:do{if(v){if(v=(0|l[v>>2])+(0|l[x+(J<<5)+4>>2])|0,w=0|l[x+(J<<5)+16>>2],X)pn(nt,v,w);else if(!(0|un(rt,v,w))){i=0,W=219;break t}if((0|i)>0&0!=(0|l[(Z=x+(J<<5)+12|0)>>2]))for(Y=$|X,j=0;;){i:do{switch(0|e){case 0:if(X){if(L=1<<i,L|=L>>1,!(v=0|l[y>>2]))break i;for(B=0-L|0,R=0,w=0|l[g>>2];;){if(P=R,R=R+4|0,w){k=-4==(0|P),I=3|P,T=0;do{n:do{if(!k)if(tt){v=P;do{if(v>>>0>=(0|l[y>>2])>>>0)break n;S=v,v=v+1|0,A=(w=0|l[r>>2])+(1+(x=(0|C(0|l[o>>2],v))+T|0)<<1)|0,S=(0|l[_>>2])+((0|C(0|l[g>>2],S))+T<<2)|0,M=0|l[p>>2],0!=(255&(W=0|a[A>>1])|0)&0==(20480&W|0)&&(0|mn(M)&&(V=0|mn(M),l[S>>2]=0|V?B:L,H=A+(0-(W=0|l[o>>2])<<1)|0,W=A+(W<<1)|0,a[(U=H+-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=w+(x<<1)|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[A>>1]=4096|a[A>>1],a[(H=A+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]),a[A>>1]=16384|a[A>>1])}while(v>>>0<R>>>0)}else{v=P;do{if(v>>>0>=(w=0|l[y>>2])>>>0)break n;V=v,v=v+1|0,S=(x=0|l[r>>2])+(1+(A=(0|C(0|l[o>>2],v))+T|0)<<1)|0,M=(0|l[_>>2])+((0|C(0|l[g>>2],V))+T<<2)|0,E=0|l[p>>2],W=0|a[S>>1],0!=(255&(W=(0|V)==(0|I)|(0|V)==(w+-1|0)?-1095&W:W)|0)&0==(20480&W|0)&&(0|mn(E)&&(V=0|mn(E),l[M>>2]=0|V?B:L,H=S+(0-(W=0|l[o>>2])<<1)|0,W=S+(W<<1)|0,a[(U=H+-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=x+(A<<1)|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[S>>1]=4096|a[S>>1],a[(H=S+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]),a[S>>1]=16384|a[S>>1])}while(v>>>0<R>>>0)}}while(0);T=T+1|0,w=0|l[g>>2]}while(T>>>0<w>>>0);v=0|l[y>>2]}else w=0;if(R>>>0>=v>>>0){W=187;break i}}}if(!tt){if(D=1<<i,D|=D>>1,!(v=0|l[y>>2])){W=187;break i}for(O=0-D|0,L=0,x=w=0|l[g>>2];;){if(B=L,L=L+4|0,w){for(P=-4==(0|B),R=3|B,I=0;;){if(P)v=x;else{A=B;do{if(A>>>0>=(v=0|l[y>>2])>>>0)break;W=A,A=A+1|0,E=(S=0|l[r>>2])+(1+(M=(0|C(0|l[o>>2],A))+I|0)<<1)|0,T=(0|l[_>>2])+((0|C(0|l[g>>2],W))+I<<2)|0,k=0|l[t>>2],w=0|a[E>>1],0!=(0|(w=255&(v=(0|W)==(0|R)|(0|W)==(v+-1|0)?-1095&w:w)))&0==(20480&v|0)&&(l[(x=k+100|0)>>2]=k+24+(h[20356+(w|et)>>0]<<2),0|dn(k)&&(V=v>>>4&255,l[x>>2]=k+24+(h[21380+V>>0]<<2),V=(W=0|dn(k))^h[21636+V>>0],l[T>>2]=0|V?O:D,H=E+(0-(W=0|l[o>>2])<<1)|0,W=E+(W<<1)|0,a[(U=H+-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=S+(M<<1)|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[E>>1]=4096|a[E>>1],a[(H=E+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]),a[E>>1]=16384|a[E>>1])}while(A>>>0<L>>>0);v=0|l[g>>2]}if((I=I+1|0)>>>0>=v>>>0)break;x=v}x=v,w=v,v=0|l[y>>2]}else w=0;if(L>>>0>=v>>>0){W=187;break i}}}if(w=0|l[_>>2],v=2+(0|l[r>>2])|0,L=1<<i,L|=L>>1,(A=0|l[y>>2])>>>0>3){B=0-L|0,M=0,S=x=0|l[g>>2];do{if(x){R=0,x=S;do{k=w+(R<<2)|0,I=v+(R<<1)+((A=0|l[o>>2])<<1)|0,T=0|l[t>>2],0!=(0|(E=255&(S=0|a[I>>1])))&0==(20480&S|0)&&(l[(x=T+100|0)>>2]=T+24+(h[20356+(E|et)>>0]<<2),0|dn(T)?(V=S>>>4&255,l[x>>2]=T+24+(h[21380+V>>0]<<2),V=(A=0|dn(T))^h[21636+V>>0],l[k>>2]=0|V?B:L,W=I+((A=0|l[o>>2])<<1)|0,a[(U=(H=I+(0-A<<1)|0)-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=I+-2|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[I>>1]=4096|a[I>>1],a[(H=I+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]):A=0|l[o>>2],a[I>>1]=16384|a[I>>1],x=0|l[g>>2],T=0|l[t>>2]),k=k+(x<<2)|0,0!=(0|(E=255&(S=0|a[(I=I+(A<<1)|0)>>1])))&0==(20480&S|0)&&(l[(x=T+100|0)>>2]=T+24+(h[20356+(E|et)>>0]<<2),0|dn(T)?(V=S>>>4&255,l[x>>2]=T+24+(h[21380+V>>0]<<2),V=(A=0|dn(T))^h[21636+V>>0],l[k>>2]=0|V?B:L,W=I+((A=0|l[o>>2])<<1)|0,a[(U=(H=I+(0-A<<1)|0)-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=I+-2|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[I>>1]=4096|a[I>>1],a[(H=I+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]):A=0|l[o>>2],a[I>>1]=16384|a[I>>1],x=0|l[g>>2],T=0|l[t>>2]),P=k+(x<<2)|0,0!=(0|(E=255&(S=0|a[(I=I+(A<<1)|0)>>1])))&0==(20480&S|0)?(l[(x=T+100|0)>>2]=T+24+(h[20356+(E|et)>>0]<<2),0|dn(T)?(V=S>>>4&255,l[x>>2]=T+24+(h[21380+V>>0]<<2),V=(A=0|dn(T))^h[21636+V>>0],l[P>>2]=0|V?B:L,W=I+((A=0|l[o>>2])<<1)|0,a[(U=(H=I+(0-A<<1)|0)-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=I+-2|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[I>>1]=4096|a[I>>1],a[(H=I+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]):A=0|l[o>>2],a[I>>1]=16384|a[I>>1],x=0|l[g>>2],k=0|l[t>>2]):k=T,T=P+(x<<2)|0,0!=(0|(E=255&(S=0|a[(A=I+(A<<1)|0)>>1])))&0==(20480&S|0)&&(l[(x=k+100|0)>>2]=k+24+(h[20356+(E|et)>>0]<<2),0|dn(k)&&(V=S>>>4&255,l[x>>2]=k+24+(h[21380+V>>0]<<2),V=(W=0|dn(k))^h[21636+V>>0],l[T>>2]=0|V?B:L,H=A+(0-(W=0|l[o>>2])<<1)|0,W=A+(W<<1)|0,a[(U=H+-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=A+-2|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[A>>1]=4096|a[A>>1],a[(H=A+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]),a[A>>1]=16384|a[A>>1],x=0|l[g>>2]),R=R+1|0}while(R>>>0<x>>>0);S=x,A=0|l[y>>2]}else x=0;w=w+(x<<2<<2)|0,v=v+(l[o>>2]<<2<<1)|0,M=M+4|0}while(M>>>0<(-4&A)>>>0);x=S}else M=0,x=0|l[g>>2];if(!x){W=187;break i}B=0-L|0,R=0;do{if(M>>>0<A>>>0)for(k=M,I=v+(R<<1)|0,P=w+(R<<2)|0;I=I+(l[o>>2]<<1)|0,S=0|l[t>>2],0!=(0|(T=255&(E=0|a[I>>1])))&0==(20480&E|0)&&(l[(x=S+100|0)>>2]=S+24+(h[20356+(T|et)>>0]<<2),0|dn(S)&&(V=E>>>4&255,l[x>>2]=S+24+(h[21380+V>>0]<<2),V=(W=0|dn(S))^h[21636+V>>0],l[P>>2]=0|V?B:L,H=I+(0-(W=0|l[o>>2])<<1)|0,W=I+(W<<1)|0,a[(U=H+-2|0)>>1]=2|a[U>>1],a[H>>1]=a[H>>1]|a[3160+(V<<1)>>1],a[(H=H+2|0)>>1]=4|a[H>>1],a[(H=I+-2|0)>>1]=a[H>>1]|a[3160+(V+2<<1)>>1],a[I>>1]=4096|a[I>>1],a[(H=I+2|0)>>1]=a[H>>1]|a[3160+(V+4<<1)>>1],a[(H=W+-2|0)>>1]=1|a[H>>1],a[W>>1]=a[W>>1]|a[3160+(V+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1]),a[I>>1]=16384|a[I>>1],x=0|l[g>>2],A=0|l[y>>2]),!((k=k+1|0)>>>0>=A>>>0);)P=P+(x<<2)|0;R=R+1|0}while(R>>>0<x>>>0);W=187;break;case 1:if(X){if(k=0-(T=1<<i>>1)|0,!(v=0|l[y>>2]))break i;for(E=0,x=w=0|l[g>>2];;){M=E,E=E+4|0;do{if(w){if(-4==(0|M)){A=x,w=x;break}S=0;do{w=S,S=S+1|0,v=M;do{if(v>>>0>=(0|l[y>>2])>>>0)break;A=v,v=v+1|0,x=(0|l[r>>2])+((0|C(0|l[o>>2],v))+S<<1)|0,A=(0|l[_>>2])+((0|C(0|l[g>>2],A))+w<<2)|0,4096==(20480&a[x>>1])&&(V=(V=0!=(0|mn(0|l[p>>2])))?T:k,W=0|l[A>>2],l[A>>2]=((0|W)<0?0-V|0:V)+W,a[x>>1]=8192|a[x>>1])}while(v>>>0<E>>>0);v=0|l[g>>2]}while(S>>>0<v>>>0);A=v,w=v,v=0|l[y>>2]}else A=x,w=0}while(0);if(E>>>0>=v>>>0){W=187;break i}x=A}}if(!tt){if(R=0-(P=1<<i>>1)|0,!(v=0|l[y>>2])){W=187;break i}for(I=0,A=w=0|l[g>>2];;){k=I,I=I+4|0;do{if(w){if(T=3|k,-4==(0|k)){x=A,w=A;break}E=0;do{x=E,E=E+1|0,w=k;do{if(w>>>0>=(v=0|l[y>>2])>>>0)break;V=w,w=w+1|0,S=(0|l[r>>2])+((0|C(0|l[o>>2],w))+E<<1)|0,M=(0|l[_>>2])+((0|C(0|l[g>>2],V))+x<<2)|0,A=0|l[t>>2],W=0|a[S>>1],4096==(20480&(v=(0|V)==(0|T)|(0|V)==(v+-1|0)?-1095&W:W)|0)&&(l[A+100>>2]=A+24+((8192&v|0?16:255&v|0?15:14)<<2),V=(V=0!=(0|dn(A)))?P:R,W=0|l[M>>2],l[M>>2]=((0|W)<0?0-V|0:V)+W,a[S>>1]=8192|a[S>>1])}while(w>>>0<I>>>0);v=0|l[g>>2]}while(E>>>0<v>>>0);x=v,w=v,v=0|l[y>>2]}else x=A,w=0}while(0);if(I>>>0>=v>>>0){W=187;break i}A=x}}if(w=0|l[_>>2],v=2+(0|l[r>>2])|0,B=0-(R=1<<i>>1)|0,A=0|l[y>>2],x=0|l[g>>2],A>>>0>3){M=0,S=x;do{if(x){P=0,x=S;do{T=w+(P<<2)|0,k=v+(P<<1)+((E=0|l[o>>2])<<1)|0,A=0|l[t>>2],4096==(20480&(S=0|a[k>>1])|0)&&(l[A+100>>2]=A+24+((8192&S|0?16:255&S|0?15:14)<<2),x=(x=0!=(0|dn(A)))?R:B,A=0|l[T>>2],l[T>>2]=((0|A)<0?0-x|0:x)+A,a[k>>1]=8192|a[k>>1],A=0|l[t>>2],x=0|l[g>>2],E=0|l[o>>2]),T=T+(x<<2)|0,4096==(20480&(S=0|a[(k=k+(E<<1)|0)>>1])|0)&&(l[A+100>>2]=A+24+((8192&S|0?16:255&S|0?15:14)<<2),x=(x=0!=(0|dn(A)))?R:B,A=0|l[T>>2],l[T>>2]=((0|A)<0?0-x|0:x)+A,a[k>>1]=8192|a[k>>1],A=0|l[t>>2],x=0|l[g>>2],E=0|l[o>>2]),I=T+(x<<2)|0,4096==(20480&(S=0|a[(k=k+(E<<1)|0)>>1])|0)?(l[A+100>>2]=A+24+((8192&S|0?16:255&S|0?15:14)<<2),x=(x=0!=(0|dn(A)))?R:B,T=0|l[I>>2],l[I>>2]=((0|T)<0?0-x|0:x)+T,a[k>>1]=8192|a[k>>1],T=0|l[t>>2],x=0|l[g>>2],A=0|l[o>>2]):(T=A,A=E),E=I+(x<<2)|0,4096==(20480&(S=0|a[(A=k+(A<<1)|0)>>1])|0)&&(l[T+100>>2]=T+24+((8192&S|0?16:255&S|0?15:14)<<2),W=(W=0!=(0|dn(T)))?R:B,x=0|l[E>>2],l[E>>2]=((0|x)<0?0-W|0:W)+x,a[A>>1]=8192|a[A>>1],x=0|l[g>>2]),P=P+1|0}while(P>>>0<x>>>0);S=x,A=0|l[y>>2]}else x=0;w=w+(x<<2<<2)|0,v=v+(l[o>>2]<<2<<1)|0,M=M+4|0}while(M>>>0<(-4&A)>>>0);x=S}else M=0;if(!x){W=187;break i}P=0;do{if(M>>>0<A>>>0)for(T=M,k=v+(P<<1)|0,I=w+(P<<2)|0;k=k+(l[o>>2]<<1)|0,S=0|l[t>>2],4096==(20480&(E=0|a[k>>1])|0)&&(l[S+100>>2]=S+24+((8192&E|0?16:255&E|0?15:14)<<2),A=(A=0!=(0|dn(S)))?R:B,x=0|l[I>>2],l[I>>2]=((0|x)<0?0-A|0:A)+x,a[k>>1]=8192|a[k>>1],x=0|l[g>>2],A=0|l[y>>2]),!((T=T+1|0)>>>0>=A>>>0);)I=I+(x<<2)|0;P=P+1|0}while(P>>>0<x>>>0);W=187;break;case 2:H=0|l[t>>2],V=1<<i,V|=V>>1;do{if(tt){if(x=0|l[_>>2],w=2+(0|l[r>>2])|0,(v=0|l[y>>2])>>>0>3)for(B=H+92|0,L=H+100|0,D=H+96|0,O=0-V|0,A=w,M=0,S=W=0|l[g>>2],w=W;;){if(S){I=1+(k=1|M)|0,P=3|M,R=k+3|0,T=0;do{w=x+(T<<2)|0,S=A+(T<<1)|0,W=0|l[r>>2],v=0|l[o>>2],T=T+1|0,z=W+((0|C(v,k))+T<<1)|0,N=W+((0|C(v,I))+T<<1)|0,U=W+((0|C(v,P))+T<<1)|0,W=W+((0|C(v,R))+T<<1)|0;n:do{if(20735&(a[N>>1]|a[z>>1]|a[U>>1]|a[W>>1]))Wi(t,U=S+(v<<1)|0,w,it,V),W=w+(l[g>>2]<<2)|0,Wi(t,U=U+(l[o>>2]<<1)|0,W,it,V),W=W+(l[g>>2]<<2)|0,Wi(t,U=U+(l[o>>2]<<1)|0,W,it,V),Wi(t,U+(l[o>>2]<<1)|0,W+(l[g>>2]<<2)|0,it,V);else{if(l[L>>2]=B,!(0|dn(H)))break;if(l[L>>2]=D,(E=0|(E=(0|dn(H))<<1)|dn(H))>>>0>=4)break;for(w=w+((0|C(0|l[g>>2],E))<<2)|0,v=S+((0|C(0|l[o>>2],E))<<1)|0,S=E;;){if(S>>>0>=(0|l[y>>2])>>>0)break n;if(v=v+(l[o>>2]<<1)|0,(0|S)==(0|E)?(W=0|l[t>>2],U=(0|d[v>>1])>>>4&255,l[W+100>>2]=W+24+(h[21380+U>>0]<<2),U=(W=0|dn(W))^h[21636+U>>0],l[w>>2]=0|U?O:V,z=v+(0-(W=0|l[o>>2])<<1)|0,W=v+(W<<1)|0,a[(N=z+-2|0)>>1]=2|a[N>>1],a[z>>1]=a[z>>1]|a[3160+(U<<1)>>1],a[(z=z+2|0)>>1]=4|a[z>>1],a[(z=v+-2|0)>>1]=a[z>>1]|a[3160+(U+2<<1)>>1],a[v>>1]=4096|a[v>>1],a[(z=v+2|0)>>1]=a[z>>1]|a[3160+(U+4<<1)>>1],a[(z=W+-2|0)>>1]=1|a[z>>1],a[W>>1]=a[W>>1]|a[3160+(U+6<<1)>>1],a[(W=W+2|0)>>1]=8|a[W>>1],a[v>>1]=-16385&a[v>>1]):Wi(t,v,w,it,V),(S=S+1|0)>>>0>=4)break;w=w+(l[g>>2]<<2)|0}}}while(0);w=0|l[g>>2]}while(T>>>0<w>>>0);S=w,v=0|l[y>>2]}else S=0;if(x=x+(S<<2<<2)|0,A=A+(l[o>>2]<<2<<1)|0,(M=M+4|0)>>>0>=(-4&v)>>>0){k=A,T=x;break}}else k=w,T=x,M=0,w=0|l[g>>2];if(!w)break;E=0;do{if(M>>>0<v>>>0)for(x=k+(E<<1)|0,A=T+(E<<2)|0,S=M;Wi(t,x=x+(l[o>>2]<<1)|0,A,it,V),w=0|l[g>>2],!((S=S+1|0)>>>0>=(v=0|l[y>>2])>>>0);)A=A+(w<<2)|0;E=E+1|0}while(E>>>0<w>>>0)}else{if(!(v=0|l[y>>2]))break;G=H+92|0,N=H+100|0,z=H+96|0,U=0-V|0,x=0,w=0|l[g>>2];do{if(w)for(B=3|x,D=1+(L=1|x)|0,O=L+3|0,F=x+4|0,R=0;;){do{if(B>>>0<v>>>0){if(v=0|l[r>>2],w=0|l[o>>2],A=R+1|0,P=v+((0|C(w,L))+A<<1)|0,20735&a[P>>1]){v=0,P=0,W=152;break}if(P=v+((0|C(w,D))+A<<1)|0,20735&a[P>>1]){v=0,P=0,W=152;break}if(P=v+((0|C(w,B))+A<<1)|0,20735&a[P>>1]){v=0,P=0,W=152;break}if(P=v+((0|C(w,O))+A<<1)|0,20665&a[P>>1]){v=0,P=0,W=152;break}if(l[N>>2]=G,!(0|dn(H)))break;l[N>>2]=z,v=0|(v=(0|dn(H))<<1)|dn(H),P=1,W=152}else v=0,P=0,W=152}while(0);n:do{if(152==(0|W)){if(W=0,!((S=v+x|0)>>>0<F>>>0))break;A=S;do{if(A>>>0>=(v=0|l[y>>2])>>>0)break n;kt=A,A=A+1|0,T=(M=0|l[r>>2])+(1+(E=(0|C(0|l[o>>2],A))+R|0)<<1)|0,k=(0|l[_>>2])+((0|C(0|l[g>>2],kt))+R<<2)|0,I=0|l[t>>2],w=0|a[T>>1],w=(0|kt)==(0|B)|(0|kt)==(v+-1|0)?-1095&w:w;do{if(P&(0|kt)==(0|S))v=I+100|0,W=158;else{if(20480&w|0)break;l[(v=I+100|0)>>2]=I+24+(h[20356+(255&w|et)>>0]<<2),0|dn(I)&&(W=158)}}while(0);158==(0|W)&&(W=0,kt=w>>>4&255,l[v>>2]=I+24+(h[21380+kt>>0]<<2),I=0|dn(I),I^=h[21636+kt>>0],l[k>>2]=0|I?U:V,k=T+(0-(kt=0|l[o>>2])<<1)|0,kt=T+(kt<<1)|0,a[(w=k+-2|0)>>1]=2|a[w>>1],a[k>>1]=a[k>>1]|a[3160+(I<<1)>>1],a[(k=k+2|0)>>1]=4|a[k>>1],a[(k=M+(E<<1)|0)>>1]=a[k>>1]|a[3160+(I+2<<1)>>1],a[T>>1]=4096|a[T>>1],a[(k=T+2|0)>>1]=a[k>>1]|a[3160+(I+4<<1)>>1],a[(k=kt+-2|0)>>1]=1|a[k>>1],a[kt>>1]=a[kt>>1]|a[3160+(I+6<<1)>>1],a[(kt=kt+2|0)>>1]=8|a[kt>>1]),a[T>>1]=-16385&a[T>>1]}while(A>>>0<F>>>0)}}while(0);if(R=R+1|0,w=0|l[g>>2],v=0|l[y>>2],R>>>0>=w>>>0){x=F;break}}else x=x+4|0,w=0}while(x>>>0<v>>>0)}}while(0);if(Q){W=187;break i}l[H+100>>2]=H+96,dn(H),dn(H),dn(H),dn(H),W=187;break;default:W=187}}while(0);do{if(187==(0|W)){if(W=0,Y)break;an(rt),sn(rt,18,0,46),sn(rt,17,0,3),sn(rt,0,0,4)}}while(0);if(i=i+((kt=3==(0|(e=e+1|0)))<<31>>31)|0,e=kt?0:e,j=j+1|0,!((0|i)>0&&j>>>0<(0|l[Z>>2])>>>0))break e}}}while(0);J=J+1|0}while(J>>>0<(0|l[st>>2])>>>0)}if(i=(0|l[ot>>2])-(0|l[_t>>2])|0,e=(0|l[lt>>2])-(0|l[gt>>2])|0,1&(v=0|l[mt>>2])&&(kt=0|l[c>>2],i=(0|l[kt+(136*xt|0)+8>>2])+i-(0|l[kt+(136*xt|0)>>2])|0),2&v&&(kt=0|l[c>>2],e=(0|l[kt+(136*xt|0)+12>>2])+e-(0|l[kt+(136*xt|0)+4>>2])|0),E=0|l[_>>2],T=0|l[g>>2],k=0|l[y>>2],0|(v=0|l[u>>2])&&(Et=1<<v,!(0==(0|k)|0==(0|T)))){v=0;do{x=0|C(v,T),w=0;do{(0|(M=(0|(S=0|l[(A=E+(w+x<<2)|0)>>2]))>-1?S:0-S|0))>=(0|Et)&&(kt=M>>l[u>>2],l[A>>2]=(0|S)<0?0-kt|0:kt),w=w+1|0}while((0|w)!=(0|T));v=v+1|0}while((0|v)!=(0|k))}if(A=(0|l[n>>2])+((0|C(e,b))+i<<2)|0,i=0==(0|k)|0==(0|T),1==(0|l[s>>2])){if(!i){i=0;do{v=0|C(i,T),w=0|C(i,b),e=0;do{l[A+(e+w<<2)>>2]=(0|l[E+(e+v<<2)>>2])/2|0,e=e+1|0}while((0|e)!=(0|T));i=i+1|0}while((0|i)!=(0|k))}}else if(!i)for(e=E,w=0;;){for(i=A,v=e,x=0;m[i>>2]=+m[yt>>2]*+(0|l[v>>2]),(0|(x=x+1|0))!=(0|T);)i=i+4|0,v=v+4|0;if((0|(w=w+1|0))==(0|k))break;A=A+(b<<2)|0,e=e+(T<<2)|0}ct=ct+1|0}while(ct>>>0<(0|C(0|l[dt>>2],0|l[ut>>2]))>>>0);v=0|l[wt>>2],i=0|l[vt>>2]}ft=ft+1|0}while(ft>>>0<(0|C(v,i))>>>0);e=0|l[St>>2]}bt=bt+1|0}while(bt>>>0<e>>>0);i=0|l[Tt>>2]}if((Mt=Mt+1|0)>>>0>=i>>>0){i=1,W=219;break}}return 219==(0|W)?0|i:0}function Vi(t,e,i){t|=0;var n,r=0,o=0,a=0,s=0;if(s=0|C(i|=0,e|=0),!(0|l[t+40>>2])){o=t+24|0,r=t+8|0;do{if(s>>>0>(0|l[o>>2])>>>0){if(Vt(0|l[r>>2]),a=0|Ht(s<<2),l[r>>2]=a,a){l[o>>2]=s,o=a,r=a;break}return 0|(i=0)}o=r=0|l[r>>2]}while(0);0|o&&Ir(0|r,0,s<<2|0)}a=e+2|0,l[t+32>>2]=a,a=0|C(i+2|0,a),s=t+28|0,r=0|l[(n=t+12|0)>>2];do{if(a>>>0>(0|l[s>>2])>>>0){if(Vt(r),r=0|Ht(o=a<<1),l[n>>2]=r,r){l[s>>2]=a;break}return 0|(i=0)}o=a<<1}while(0);return Ir(0|r,0,0|o),l[t+16>>2]=e,l[t+20>>2]=i,0|(i=1)}function Wi(t,e,i,n,r){e|=0,i|=0,n|=0,r|=0;var o,s=0,c=0;return s=0|l[(t|=0)>>2],20480&(c=0|a[e>>1])|0?(c=0|a[e>>1],c&=-16385,void(a[e>>1]=c)):(l[(o=s+100|0)>>2]=s+24+(h[20356+(255&c|n<<8)>>0]<<2),0|dn(s)?(c=c>>>4&255,l[o>>2]=s+24+(h[21380+c>>0]<<2),s=0|dn(s),s^=h[21636+c>>0],l[i>>2]=0|s?0-r|0:r,r=e+(0-(c=0|l[t+32>>2])<<1)|0,c=e+(c<<1)|0,a[(n=r+-2|0)>>1]=2|a[n>>1],a[r>>1]=a[r>>1]|a[3160+(s<<1)>>1],a[(r=r+2|0)>>1]=4|a[r>>1],a[(r=e+-2|0)>>1]=a[r>>1]|a[3160+(s+2<<1)>>1],a[e>>1]=4096|a[e>>1],a[(r=e+2|0)>>1]=a[r>>1]|a[3160+(s+4<<1)>>1],a[(r=c+-2|0)>>1]=1|a[r>>1],a[c>>1]=a[c>>1]|a[3160+(s+6<<1)>>1],a[(c=c+2|0)>>1]=8|a[c>>1],c=0|a[e>>1],c&=-16385,void(a[e>>1]=c)):(c=0|a[e>>1],c&=-16385,void(a[e>>1]=c)))}function ji(t,e,i,n,o){t|=0,i|=0,n|=0,o|=0;var s,c,u,d,f,p,_,y,b,v,w=0,x=0,A=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0,Q=0,q=0,K=0,$=0,tt=0,et=0,it=0,nt=0,rt=0,ot=0,at=0,st=0,lt=0,ct=0,ht=0,ut=0,dt=0,ft=0,pt=0,mt=0,_t=0,gt=0,yt=0,bt=0,vt=0,wt=0,xt=0,At=0,St=0,Mt=0,Et=0,Tt=0,kt=0,Ct=0,It=0,Pt=0,Rt=0,Bt=0,Lt=0,Dt=0,Ot=0,Ft=0,Gt=0,Nt=0,zt=0,Ut=0,Ht=0,Vt=0,Wt=0,jt=0,Zt=0,Yt=0,Xt=0,Jt=0,Qt=0,qt=0,Kt=0;if(g[(v=32+(e|=0)|0)>>3]=0,!(w=0|l[(qt=e+16|0)>>2]))return 0|(qt=1);b=e+20|0,s=i+5584|0,c=t+16|0,u=t+20|0,d=t+8|0,f=t+36|0,p=0!=(0|n),_=t+12|0,y=t+32|0,Qt=0,e=w;t:for(;;){if(i=0|l[b>>2],w=0|l[s>>2],Xt=(0|l[i+(52*Qt|0)+8>>2])-(0|l[i+(52*Qt|0)>>2])|0,x=0|l[(Jt=i+(52*Qt|0)+16|0)>>2]){Yt=i+(52*Qt|0)+24|0,jt=i+(52*Qt|0)+32|0,Zt=w+(1080*Qt|0)+20|0,Ht=w+(1080*Qt|0)+16|0,Wt=p&Qt>>>0<o>>>0,Vt=n+(Qt<<3)|0,Ut=0,e=x;do{if(Gt=0|l[Yt>>2],i=0|l[(Nt=Gt+(136*Ut|0)+24|0)>>2]){Lt=Gt+(136*Ut|0)+16|0,Ot=~Ut,Ft=Ut+-1|0,Bt=0,w=0|l[(Dt=Gt+(136*Ut|0)+20|0)>>2],e=0|l[Lt>>2];do{if(Rt=Gt+(136*Ut|0)+28+(36*Bt|0)+32|0,0|C(w,e)){Tt=Gt+(136*Ut|0)+28+(36*Bt|0)+20|0,kt=Gt+(136*Ut|0)+28+(36*Bt|0)|0,Ct=Gt+(136*Ut|0)+28+(36*Bt|0)+4|0,It=Gt+(136*Ut|0)+28+(36*Bt|0)+16|0,Pt=((0|(Et=67108864/(0|~~+M(8192*+m[Rt>>2]))|0))<0)<<31>>31,Mt=0;do{if(At=(i=0|l[Tt>>2])+(40*Mt|0)+16|0,0|C(0|l[(St=i+(40*Mt|0)+20|0)>>2],0|l[At>>2])){xt=i+(40*Mt|0)+24|0,wt=0;do{if(vt=0|l[xt>>2],e=(x=0|l[vt+(52*wt|0)+12>>2])-(0|l[kt>>2])|0,i=(A=0|l[vt+(52*wt|0)+16>>2])-(0|l[Ct>>2])|0,1&(w=0|l[It>>2])&&(bt=0|l[Yt>>2],e=(0|l[bt+(136*Ft|0)+8>>2])+e-(0|l[bt+(136*Ft|0)>>2])|0),2&w&&(bt=0|l[Yt>>2],i=(0|l[bt+(136*Ft|0)+12>>2])+i-(0|l[bt+(136*Ft|0)+4>>2])|0),!(0|Vi(t,(0|l[vt+(52*wt|0)+20>>2])-x|0,(0|l[vt+(52*wt|0)+24>>2])-A|0))){e=0,zt=163;break t}A=0|l[c>>2],E=0|l[u>>2],I=(0|l[jt>>2])+((0|C(i,Xt))+e<<2)|0,l[d>>2]=I,l[f>>2]=Xt,e=0|l[Zt>>2],i=0!=(0|E);do{if(1==(0|e))if(i){if(!A){zt=27;break}for(e=0,i=0;;){for(w=0,x=e;l[(zt=I+(x<<2)|0)>>2]=l[zt>>2]<<6,(0|(w=w+1|0))!=(0|A);)x=x+1|0;if((0|(i=i+1|0))==(0|E)){zt=27;break}e=Xt+e|0}}else e=1;else if(i){if(!A){zt=27;break}for(e=0,w=0;;){for(i=0,x=w;bt=0|Er(0|(bt=0|br(0|(bt=0|yr(0|(bt=0|l[(zt=I+(x<<2)|0)>>2]),((0|bt)<0)<<31>>31|0,0|Et,0|Pt)),0|S,4096,0)),0|S,18),l[zt>>2]=bt,(0|(i=i+1|0))!=(0|A);)x=x+1|0;if((0|(e=e+1|0))==(0|E)){zt=27;break}w=Xt+w|0}}}while(0);27==(0|zt)&&(zt=0,e=0|l[Zt>>2]),mt=0|l[It>>2],_t=(0|l[Jt>>2])+Ot|0,gt=+m[Rt>>2],yt=0|l[Ht>>2],bt=0|l[t>>2],E=0|l[c>>2];do{if(E){if(!(T=0|l[u>>2])){i=0;break}A=0|l[f>>2],x=0,w=0;do{i=0;do{pt=I+((0|C(i,A))+x<<2)|0,w=(0|w)>(0|(pt=(0|(pt=0|l[pt>>2]))>-1?pt:0-pt|0))?w:pt,i=i+1|0}while((0|i)!=(0|T));x=x+1|0}while((0|x)!=(0|E));if(!w){i=0;break}if((0|w)>1)for(i=0;i=i+1|0,w>>>0>3;)w>>>=1;else i=0;i=i+-5|0}else i=0}while(0);l[(ft=vt+(52*wt|0)+28|0)>>2]=i,i=i+-1|0,an(bt),sn(bt,18,0,46),sn(bt,17,0,3),sn(bt,0,0,4),$i(bt,0|l[(pt=vt+(52*wt|0)|0)>>2]);e:do{if((0|i)>-1)for(ut=vt+(52*wt|0)+8|0,dt=0!=(0|(it=1&yt)),nt=1==(0|e),rt=0==(4&yt|0),it=0==(0|it),ot=0==(2&yt|0),at=0!=(0|(lt=8&yt)),st=mt<<8,ct=0==(32&yt|0),ht=1^(lt=0==(0|lt)),e=0,tt=2,w=0,et=0;;){$=0|l[ut>>2],W=dt&(tt>>>0<2?(0|i)<((0|l[ft>>2])-4|0):0);i:do{switch(0|tt){case 0:if(H=1<<i+6,!(x=0|l[u>>2])){w=0;break i}V=0==(0|i)?3176:3432,U=0,w=0,A=E=0|l[c>>2];do{if(z=U,U=U+4|0,A){for(G=-4==(0|z),N=3|z,F=0;;){if(G)A=E;else{O=z;do{if(O>>>0>=(x=0|l[u>>2])>>>0)break;K=O,O=O+1|0,D=(R=0|l[_>>2])+(1+(B=(0|C(0|l[y>>2],O))+F|0)<<1)|0,T=(0|l[d>>2])+((0|C(0|l[f>>2],K))+F<<2)|0,L=0|l[t>>2],I=0|a[D>>1],0!=(0|(x=255&(I=at&((0|K)==(0|N)|(0|K)==(x+-1|0))?-1095&I:I)))&0==(20480&I|0)&&(E=1&(A=0!=(((0|(A=0|l[T>>2]))<0?0-A|0:A)&H|0)),l[(P=L+100|0)>>2]=L+24+(h[20356+(x|st)>>0]<<2),W?rn(L,E):tn(L,E),A&&(A=(x=0|l[T>>2])>>>31,w=w+(0|a[V+((((0|x)<0?0-x|0:x)>>>i&127)<<1)>>1])|0,x=I>>>4&255,l[P>>2]=L+24+(h[21380+x>>0]<<2),W?rn(L,A):tn(L,A^h[21636+x>>0]),q=D+(0-(K=0|l[y>>2])<<1)|0,K=D+(K<<1)|0,a[(Q=q+-2|0)>>1]=2|a[Q>>1],a[q>>1]=a[q>>1]|a[3160+(A<<1)>>1],a[(q=q+2|0)>>1]=4|a[q>>1],a[(q=R+(B<<1)|0)>>1]=a[q>>1]|a[3160+((2|A)<<1)>>1],a[D>>1]=4096|a[D>>1],a[(q=D+2|0)>>1]=a[q>>1]|a[3160+((4|A)<<1)>>1],a[(q=K+-2|0)>>1]=1|a[q>>1],a[K>>1]=a[K>>1]|a[3160+((6|A)<<1)>>1],a[(K=K+2|0)>>1]=8|a[K>>1]),a[D>>1]=16384|a[D>>1])}while(O>>>0<U>>>0);A=0|l[c>>2]}if((F=F+1|0)>>>0>=A>>>0)break;E=A}x=0|l[u>>2],E=A}else A=0}while(U>>>0<x>>>0);break;case 1:if(F=1<<i+6,!(x=0|l[u>>2])){w=0;break i}G=0==(0|i)?3688:3944,O=0,w=0,A=0|l[c>>2];do{if(D=O,O=O+4|0,A){B=-4==(0|D),L=3|D,R=0;do{P=R,R=R+1|0;n:do{if(!B)if(lt)if(W){I=D;do{if(I>>>0>=(0|l[u>>2])>>>0)break n;x=I,I=I+1|0,E=(0|l[_>>2])+((0|C(0|l[y>>2],I))+R<<1)|0,A=0|l[t>>2],4096==(20480&(T=0|a[E>>1])|0)&&(K=(0|l[d>>2])+((0|C(0|l[f>>2],x))+P<<2)|0,K=0|l[K>>2],w=w+(0|a[G+(((K=(0|K)<0?0-K|0:K)>>>i&127)<<1)>>1])|0,l[A+100>>2]=A+24+((8192&T|0?16:255&T|0?15:14)<<2),rn(A,0!=(K&F|0)&1),a[E>>1]=8192|a[E>>1])}while(I>>>0<O>>>0)}else{I=D;do{if(I>>>0>=(0|l[u>>2])>>>0)break n;x=I,I=I+1|0,E=(0|l[_>>2])+((0|C(0|l[y>>2],I))+R<<1)|0,A=0|l[t>>2],4096==(20480&(T=0|a[E>>1])|0)&&(K=(0|l[d>>2])+((0|C(0|l[f>>2],x))+P<<2)|0,K=0|l[K>>2],w=w+(0|a[G+(((K=(0|K)<0?0-K|0:K)>>>i&127)<<1)>>1])|0,l[A+100>>2]=A+24+((8192&T|0?16:255&T|0?15:14)<<2),tn(A,0!=(K&F|0)&1),a[E>>1]=8192|a[E>>1])}while(I>>>0<O>>>0)}else if(W){I=D;do{if(I>>>0>=(x=0|l[u>>2])>>>0)break n;A=I,I=I+1|0,T=(0|l[_>>2])+((0|C(0|l[y>>2],I))+R<<1)|0,E=0|l[t>>2],K=0|a[T>>1],4096==(20480&(x=(0|A)==(0|L)|(0|A)==(x+-1|0)?-1095&K:K)|0)&&(K=(0|l[d>>2])+((0|C(0|l[f>>2],A))+P<<2)|0,K=0|l[K>>2],w=w+(0|a[G+(((K=(0|K)<0?0-K|0:K)>>>i&127)<<1)>>1])|0,l[E+100>>2]=E+24+((8192&x|0?16:255&x|0?15:14)<<2),rn(E,0!=(K&F|0)&1),a[T>>1]=8192|a[T>>1])}while(I>>>0<O>>>0)}else{I=D;do{if(I>>>0>=(x=0|l[u>>2])>>>0)break n;A=I,I=I+1|0,T=(0|l[_>>2])+((0|C(0|l[y>>2],I))+R<<1)|0,E=0|l[t>>2],K=0|a[T>>1],4096==(20480&(x=(0|A)==(0|L)|(0|A)==(x+-1|0)?-1095&K:K)|0)&&(K=(0|l[d>>2])+((0|C(0|l[f>>2],A))+P<<2)|0,K=0|l[K>>2],w=w+(0|a[G+(((K=(0|K)<0?0-K|0:K)>>>i&127)<<1)>>1])|0,l[E+100>>2]=E+24+((8192&x|0?16:255&x|0?15:14)<<2),tn(E,0!=(K&F|0)&1),a[T>>1]=8192|a[T>>1])}while(I>>>0<O>>>0)}}while(0);A=0|l[c>>2]}while(R>>>0<A>>>0);x=0|l[u>>2]}else A=0}while(O>>>0<x>>>0);break;case 2:if(Y=0|l[t>>2],X=1<<i+6,x=0|l[u>>2]){J=Y+92|0,Q=Y+100|0,q=Y+96|0,K=0==(0|i)?3176:3432,E=0,w=0,A=0|l[c>>2];do{if(A)for(N=3|E,U=1+(z=1|E)|0,H=z+3|0,Z=E+4|0,V=E+1|0,W=E+2|0,j=E+3|0,G=0;;){do{if(N>>>0<x>>>0){if(x=0|l[_>>2],A=0|l[y>>2],T=G+1|0,I=x+((0|C(A,z))+T<<1)|0,I=0|a[I>>1],lt){if(D=x+((0|C(A,U))+T<<1)|0,O=x+((0|C(A,N))+T<<1)|0,F=x+((0|C(A,H))+T<<1)|0,20735&(a[D>>1]|I|a[O>>1]|a[F>>1])){F=0,x=0,zt=105;break}}else{if(20735&I){F=0,x=0,zt=105;break}if(F=x+((0|C(A,U))+T<<1)|0,20735&a[F>>1]){F=0,x=0,zt=105;break}if(F=x+((0|C(A,N))+T<<1)|0,20735&a[F>>1]){F=0,x=0,zt=105;break}if(F=x+((0|C(A,H))+T<<1)|0,20665&a[F>>1]){F=0,x=0,zt=105;break}}x=0|l[d>>2],A=0|l[f>>2],F=x+((0|C(A,E))+G<<2)|0,F=0|l[F>>2];do{if(((0|F)<0?0-F|0:F)&X)x=0;else{if(F=x+((0|C(A,V))+G<<2)|0,((0|(F=0|l[F>>2]))<0?0-F|0:F)&X|0){x=1;break}if(F=x+((0|C(A,W))+G<<2)|0,((0|(F=0|l[F>>2]))<0?0-F|0:F)&X|0){x=2;break}x=x+((0|C(A,j))+G<<2)|0,x=0==(((0|(x=0|l[x>>2]))<0?0-x|0:x)&X|0)?4:3}}while(0);if(l[Q>>2]=J,tn(Y,4!=(0|x)&1),4==(0|x))break;l[Q>>2]=q,tn(Y,x>>>1),tn(Y,1&x),F=1,zt=105}else F=0,x=0,zt=105}while(0);n:do{if(105==(0|zt)){if(zt=0,!((O=x+E|0)>>>0<Z>>>0))break;D=O;do{if(D>>>0>=(x=0|l[u>>2])>>>0)break n;Kt=D,D=D+1|0,L=(I=0|l[_>>2])+(1+(P=(0|C(0|l[y>>2],D))+G|0)<<1)|0,R=(0|l[d>>2])+((0|C(0|l[f>>2],Kt))+G<<2)|0,B=0|l[t>>2],A=0|a[L>>1],T=((0|Kt)==(0|N)|(0|Kt)==(x+-1|0))&ht?-1095&A:A;do{if(F&(0|Kt)==(0|O))x=B+100|0,zt=111;else{if(20480&A|0)break;l[(x=B+100|0)>>2]=B+24+(h[20356+(255&T|st)>>0]<<2),tn(B,1&(Kt=0!=(((0|(Kt=0|l[R>>2]))<0?0-Kt|0:Kt)&X|0))),Kt&&(zt=111)}}while(0);111==(0|zt)&&(zt=0,R=0|l[R>>2],w=w+(0|a[K+((((0|R)<0?0-R|0:R)>>>i&127)<<1)>>1])|0,Kt=T>>>4&255,l[x>>2]=B+24+(h[21380+Kt>>0]<<2),tn(B,(R>>>=31)^h[21636+Kt>>0]),B=L+(0-(Kt=0|l[y>>2])<<1)|0,Kt=L+(Kt<<1)|0,a[(T=B+-2|0)>>1]=2|a[T>>1],a[B>>1]=a[B>>1]|a[3160+(R<<1)>>1],a[(B=B+2|0)>>1]=4|a[B>>1],a[(B=I+(P<<1)|0)>>1]=a[B>>1]|a[3160+((2|R)<<1)>>1],a[L>>1]=4096|a[L>>1],a[(B=L+2|0)>>1]=a[B>>1]|a[3160+((4|R)<<1)>>1],a[(B=Kt+-2|0)>>1]=1|a[B>>1],a[Kt>>1]=a[Kt>>1]|a[3160+((6|R)<<1)>>1],a[(Kt=Kt+2|0)>>1]=8|a[Kt>>1]),a[L>>1]=-16385&a[L>>1]}while(D>>>0<Z>>>0)}}while(0);if(G=G+1|0,A=0|l[c>>2],x=0|l[u>>2],G>>>0>=A>>>0){E=Z;break}}else E=E+4|0,A=0}while(E>>>0<x>>>0)}else w=0;if(ct)break i;hn(bt)}}while(0);k=(Wt?+g[Vt>>3]:1)*(k=nt?+Pi(_t,mt):+Bi(_t,mt))*gt*+(1<<i|0),et+=k*=k*+(0|w)*.0001220703125,g[v>>3]=+g[v>>3]+k;do{if(rt)zt=127;else{if((0|i)<1&2==(0|tt)){zt=127;break}en(bt),A=1|r[(x=$+(24*e|0)+20|0)>>0],r[x>>0]=A,x=1}}while(0);do{if(127==(0|zt)){if(130==(0|(zt=0!=(0|tt)&(0|i)<(0|(x=(0|l[ft>>2])-4|0))?it?131:130:it|2!=(0|tt)|(0|i)!=(0|x)?131:130))){zt=0,en(bt),A=1|r[(x=$+(24*e|0)+20|0)>>0],r[x>>0]=A,x=1;break}if(131==(0|zt)){zt=0,A=-2&r[(x=$+(24*e|0)+20|0)>>0],r[x>>0]=A,x=3;break}}}while(0);tt=(Kt=3==(0|(K=tt+1|0)))?0:K,i=i+(Kt<<31>>31)|0;do{if((0|i)>0&0!=(1&A)){if(dt&(tt>>>0<2?(0|i)<((0|l[ft>>2])-4|0):0)){nn(bt);break}ln(bt);break}}while(0);if(g[$+(24*e|0)+8>>3]=et,Kt=(0|Ki(bt))+x|0,l[$+(24*e|0)>>2]=Kt,ot||on(bt),e=e+1|0,(0|i)<=-1)break e}else e=0}while(0);do{if(16&yt)cn(bt);else{if(1&yt|0)break;en(bt)}}while(0);if(l[(T=vt+(52*wt|0)+48|0)>>2]=e,0|e){A=vt+(52*wt|0)+8|0,x=0;do{E=0|l[A>>2],(Kt=0|l[(i=E+(24*x|0)|0)>>2])>>>0>(0|Ki(bt))>>>0?(e=0|Ki(bt),l[i>>2]=e):e=0|l[i>>2];do{if(e>>>0>1){if(w=e+-1|0,-1!=(0|r[(0|l[pt>>2])+w>>0]))break;l[i>>2]=w,e=w}}while(0);i=x?0|l[(0|l[A>>2])+(24*(x+-1|0)|0)>>2]:0,l[E+(24*x|0)+16>>2]=e-i,x=x+1|0}while(x>>>0<(0|l[T>>2])>>>0)}wt=wt+1|0}while(wt>>>0<(0|C(0|l[St>>2],0|l[At>>2]))>>>0);w=0|l[Dt>>2],e=0|l[Lt>>2]}Mt=Mt+1|0}while(Mt>>>0<(0|C(w,e))>>>0);i=0|l[Nt>>2]}Bt=Bt+1|0}while(Bt>>>0<i>>>0);e=0|l[Jt>>2]}Ut=Ut+1|0}while(Ut>>>0<e>>>0);e=0|l[qt>>2]}if((Qt=Qt+1|0)>>>0>=e>>>0){e=1,zt=163;break}}return 163==(0|zt)?0|e:0}function Zi(t,e,i,n,r,o,s,c,u,d,f,p){t|=0,e|=0,i|=0,n|=0,r|=0,o|=0,s|=0,c|=0,u|=0,d|=0,f|=0,p|=0;var m,_,g,y,b,v=0,x=0,A=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=0;if(b=w,w=w+16|0,l[(g=b)>>2]=0,v=0|l[t>>2],P=0|l[t+4>>2],m=(t=0|l[P+76>>2])+(5640*e|0)|0,x=4==(0|a[P>>1])?2:1,M=0|l[(A=P+80|0)>>2]?0|l[v+16>>2]:1,y=1+(0|l[t+(5640*e|0)+420>>2])|0,!(_=0|He(v,P,e,p)))return w=b,0|(o=0);l[o>>2]=0;t:do{if(p){if(We(_,P,e,f,u,d,p),I=_+(232*f|0)|0,-1==(0|l[_+(232*f|0)+80>>2]))return Ue(_,y),w=b,0|(o=0);k=_+(232*f|0)+36|0,C=i+840|0,d=c+12|0,E=c+8|0,T=c+88|0,M=P+93|0,A=t+(5640*e|0)+5636|0;e:do{if(c)for(;;){do{if(!(0|Ye(I)))break t}while((0|l[k>>2])>>>0>=n>>>0);if(l[g>>2]=0,!(0|Yi(e,i,m,I,r,g,s,c)))break e;if(r=r+(x=0|l[g>>2])|0,s=s-x|0,l[o>>2]=(0|l[o>>2])+x,0|l[d>>2]){v=0|l[T>>2],u=(f=0|l[v+(592*e|0)+548>>2])+((t=0|l[E>>2])<<5)|0;do{if(t){if(1&((0|h[A>>0])>>>2|(0|h[M>>0])>>>3)&&!(0==(0|(R=0|l[(B=u)>>2]))&0==(0|(B=0|l[B+4>>2])))){v=R,p=B;break}v=0|br(0|l[(v=f+(t+-1<<5)+16|0)>>2],0|l[v+4>>2],1,0),p=S}else v=p=1+(0|l[v+(592*e|0)+12>>2])|0,p=((0|p)<0)<<31>>31}while(0);l[u>>2]=v,l[u+4>>2]=p,x=0|br(0|(p=0|br(0|v,0|p,-1,-1)),0|(u=S),0|x,0),l[(P=f+(t<<5)+16|0)>>2]=x,l[P+4>>2]=S,x=0|br(0|p,0|u,0|l[(x=P=f+(t<<5)+8|0)>>2],0|l[x+4>>2]),l[P>>2]=x,l[P+4>>2]=S}else t=0|l[E>>2];l[E>>2]=t+1,l[C>>2]=1+(0|l[C>>2])}else for(;;){do{if(!(0|Ye(I)))break t}while((0|l[k>>2])>>>0>=n>>>0);if(l[g>>2]=0,!(0|Yi(e,i,m,I,r,g,s,0)))break e;c=0|l[g>>2],l[o>>2]=(0|l[o>>2])+c,l[C>>2]=1+(0|l[C>>2]),s=s-c|0,r=r+c|0}}while(0);return Ue(_,y),w=b,0|(o=0)}if(0|M){p=0;e:for(;;){for(t=0,u=0,f=_;;){if(We(_,P,e,u,p,d,0),-1==(0|l[f+80>>2])){r=9;break e}v=f+36|0;i:for(;;){do{if(!(0|Ye(f)))break i}while((0|l[v>>2])>>>0>=n>>>0);if(l[g>>2]=0,!(0|Yi(e,i,m,f,r,g,s,c))){r=13;break e}B=0|l[g>>2],l[o>>2]=(0|l[o>>2])+B,t=B+t|0,s=s-B|0,r=r+B|0}if(0!=(0|(B=0|l[A>>2]))&t>>>0>B>>>0){r=17;break e}if((u=u+1|0)>>>0>=x>>>0)break;f=f+232|0}if((p=p+1|0)>>>0>=M>>>0)break t}if(9==(0|r))return Ue(_,y),w=b,0|(o=0);if(13==(0|r))return Ue(_,y),w=b,0|(o=0);if(17==(0|r))return Ue(_,y),w=b,0|(o=0)}}while(0);return Ue(_,y),w=b,0|(o=1)}function Yi(t,e,i,n,o,a,s,c){t|=0,e|=0,i|=0,o|=0,a|=0,s|=0,c|=0;var h,u,d,f,p=0,m=0,_=0,y=0,b=0,v=0,w=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0;if(A=0|l[28+(n|=0)>>2],d=0|l[n+32>>2],f=0|l[n+36>>2],x=0|l[(0|l[e+20>>2])+(52*(0|l[n+24>>2])|0)+24>>2],2&l[i>>2]?(r[o>>0]=-1,r[o+1>>0]=-111,r[o+2>>0]=0,r[o+3>>0]=4,O=e+840|0,r[o+4>>0]=(0|l[O>>2])>>>8,r[o+5>>0]=l[O>>2],s=s+-6|0,O=o+6|0):O=o,0==(0|f)&&0|l[(w=x+(136*A|0)+24|0)>>2])for(_=0,y=x+(136*A|0)+28|0;;){if(n=0|l[y+20>>2],ci(0|l[n+(40*d|0)+32>>2]),ci(0|l[(b=n+(40*d|0)+36|0)>>2]),0|(v=0|C(0|l[n+(40*d|0)+20>>2],0|l[n+(40*d|0)+16>>2]))){e=n+(40*d|0)+24|0,m=y+28|0,n=0;do{F=0|l[e>>2],l[F+(52*n|0)+40>>2]=0,di(0|l[b>>2],n,(0|l[m>>2])-(0|l[F+(52*n|0)+28>>2])|0),n=n+1|0}while((0|n)!=(0|v))}if((_=_+1|0)>>>0>=(0|l[w>>2])>>>0)break;y=y+36|0}if(!(h=0|wi()))return 0|(a=0);if(function(t,e,i){e|=0,i|=0,l[(t|=0)>>2]=e,l[t+4>>2]=e+i,l[t+8>>2]=e,l[t+12>>2]=0,l[t+16>>2]=8}(h,O,s),Si(h,1,1),u=x+(136*A|0)+28|0,0|l[(F=x+(136*A|0)+24|0)>>2])for(L=f+1|0,R=0,B=u;;){if(b=(y=0|l[B+20>>2])+(40*d|0)+24|0,!(m=0==(0|(D=0|C(0|l[y+(40*d|0)+20>>2],0|l[y+(40*d|0)+16>>2]))))){for(_=y+(40*d|0)+32|0,n=0|l[b>>2],e=0;0==(0|l[n+40>>2])&&0|l[(0|l[n+4>>2])+(24*f|0)>>2]&&di(0|l[_>>2],e,f),(0|(e=e+1|0))!=(0|D);)n=n+52|0;if(!m)for(P=y+(40*d|0)+32|0,I=y+(40*d|0)+36|0,E=0|l[b>>2],T=0;;){if(n=(0|l[E+4>>2])+(24*f|0)|0,0|l[(k=E+40|0)>>2]?Si(h,0!=(0|l[n>>2])&1,1):fi(h,0|l[P>>2],T,L),0|(e=0|l[n>>2])){0|l[k>>2]||(l[E+32>>2]=3,fi(h,0|l[I>>2],T,999),e=0|l[n>>2]);t:do{switch(0|e){case 1:Si(h,0,1);break;case 2:Si(h,2,2);break;default:if(e>>>0<6){Si(h,e+-3|12,4);break t}if(e>>>0<37){Si(h,e+-6|480,9);break t}e>>>0<165&&Si(h,e+-37|65408,16)}}while(0);if(S=E+8|0,(_=0|l[k>>2])>>>0<(M=(e=0|l[n>>2])+_|0)>>>0){for(A=E+32|0,x=_+-1+e|0,w=_,m=0,e=0,y=0,v=(0|l[S>>2])+(24*_|0)|0;;){if(_=e+1|0,m=(0|l[v+16>>2])+m|0,0!=(1&r[v+20>>0])|(0|w)==(0|x)){if((0|m)>1)for(e=0;;){if(e=e+1|0,!(m>>>0>3)){m=e;break}m>>>=1}else m=0;if(b=0|l[A>>2],(0|_)>1)for(e=0;e=e+1|0,_>>>0>3;)_>>>=1;else e=0;b=m+1-b-e|0,m=0,_=0,y=(0|y)>(0|b)?y:b}if((0|(w=w+1|0))==(0|M))break;e=_,v=v+24|0}if((0|y)>0)for(e=y;;){if(Si(h,1,1),!((0|e)>1)){e=y;break}e=e+-1|0}else e=y}else m=0,_=0,e=0;if(Si(h,0,1),l[(w=E+32|0)>>2]=(0|l[w>>2])+e,(e=0|l[k>>2])>>>0<M>>>0)for(v=e,b=(0|l[S>>2])+(24*e|0)|0,e=_;;){if(e=e+1|0,m=(0|l[b+16>>2])+m|0,0!=(1&r[b+20>>0])||(0|v)==((0|l[k>>2])-1+(0|l[n>>2])|0)){if(y=0|l[w>>2],(0|e)>1)for(_=0;;){if(_=_+1|0,!(e>>>0>3)){e=_;break}e>>>=1}else e=0;Si(h,m,e+y|0),m=0,e=0}if((0|(v=v+1|0))==(0|M))break;b=b+24|0}}if((0|(T=T+1|0))==(0|D))break;E=E+52|0}}if((R=R+1|0)>>>0>=(0|l[F>>2])>>>0)break;B=B+36|0}if(!(0|function(t){var e,i,n,o,a=0,s=0;return s=(a=0|l[(i=12+(t|=0)|0)>>2])<<8&65280,l[i>>2]=s,l[(o=t+16|0)>>2]=65280==(0|s)?7:8,e=0|l[(s=t+8|0)>>2],(0|l[(n=t+4|0)>>2])>>>0<=e>>>0?0|(s=0):(l[s>>2]=e+1,r[e>>0]=a,7!=(0|l[o>>2])?0|(s=1):(t=(a=0|l[i>>2])<<8&65280,l[i>>2]=t,l[o>>2]=65280==(0|t)?7:8,t=0|l[s>>2],(0|l[n>>2])>>>0<=t>>>0?0|(s=0):(l[s>>2]=t+1,r[t>>0]=a,0|(s=1))))}(h)))return xi(h),0|(a=0);n=O+(e=0|Ai(h))|0,e=s-e|0,xi(h),4&l[i>>2]&&(r[n>>0]=-1,r[n+1>>0]=-110,e=e+-2|0,n=n+2|0),(S=0!=(0|c))&&0|l[c+12>>2]&&(O=n-o|0,i=(0|l[(0|l[c+88>>2])+(592*t|0)+548>>2])+(l[c+8>>2]<<5)+8|0,l[i>>2]=O,l[i+4>>2]=((0|O)<0)<<31>>31);t:do{if(0|l[F>>2]){M=c+12|0,E=c+88|0,T=c+8|0,A=0,x=u;e:for(;;){m=0|l[x+20>>2],w=0|C(0|l[m+(40*d|0)+20>>2],0|l[m+(40*d|0)+16>>2]),m=0|l[m+(40*d|0)+24>>2];i:do{if(w){n:do{if(S)for(v=0;;){if(b=0|l[m+4>>2],0|l[(s=b+(24*f|0)|0)>>2])if((y=0|l[(_=b+(24*f|0)+4|0)>>2])>>>0>e>>>0)s=1;else{Cr(0|n,0|l[b+(24*f|0)+16>>2],0|y),l[(i=m+40|0)>>2]=(0|l[i>>2])+(0|l[s>>2]),n=n+(i=0|l[_>>2])|0,e=e-i|0;do{if(0|l[M>>2]){if(i=(0|l[(0|l[E>>2])+(592*t|0)+548>>2])+(l[T>>2]<<5)+24|0,p=+g[b+(24*f|0)+8>>3]+ +g[i>>3],g[i>>3]=p,!(+g[c>>3]<p))break;g[c>>3]=p}}while(0);s=0,m=m+52|0}else s=28,m=m+52|0;switch(31&s){case 28:case 0:break;default:break n}if((v=v+1|0)>>>0>=w>>>0){G=83;break i}}else for(v=0;;){switch(s=0|l[m+4>>2],0|l[(_=s+(24*f|0)|0)>>2]?(b=0|l[(y=s+(24*f|0)+4|0)>>2])>>>0>e>>>0?s=1:(Cr(0|n,0|l[s+(24*f|0)+16>>2],0|b),l[(i=m+40|0)>>2]=(0|l[i>>2])+(0|l[_>>2]),s=0,e=e-(i=0|l[y>>2])|0,n=n+i|0,m=m+52|0):(s=28,m=m+52|0),31&s){case 28:case 0:break;default:break n}if((v=v+1|0)>>>0>=w>>>0){G=83;break i}}}while(0);if(s){n=0;break e}s=x}else G=83}while(0);if(83==(0|G)&&(G=0,s=x+36|0),(A=A+1|0)>>>0>=(0|l[F>>2])>>>0)break t;x=s}return 0|n}}while(0);return l[a>>2]=n-o+(0|l[a>>2]),0|(a=1)}function Xi(t,e,i,n,o,a,s,c,h){t|=0,e|=0,i|=0,n|=0,o|=0,s|=0,c|=0,h|=0;var u,d,f,p,m,_,g,y,b,v,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0;v=w,w=w+64|0,g=v+48|0,y=v+40|0,D=v+32|0,L=v+24|0,R=v+16|0,P=v+8|0,I=v,B=v+56|0,U=a|=0,l[(b=v+52|0)>>2]=U,u=0|l[e+(52*(0|l[(_=n+24|0)>>2])|0)+24>>2],d=0|l[n+28>>2],m=n+36|0;t:do{if(0==(0|l[m>>2])&&(k=u+(136*d|0)+24|0,0|l[k>>2])){for(E=n+32|0,A=0,M=u+(136*d|0)+28|0;;){if((0|l[M+8>>2])!=(0|l[M>>2])&&(0|l[M+12>>2])!=(0|l[M+4>>2])){if(e=0|l[M+20>>2],(x=0|l[E>>2])>>>0>=(((0|l[M+24>>2])>>>0)/40|0)>>>0)break;if(ci(0|l[e+(40*x|0)+32>>2]),ci(0|l[e+(40*x|0)+36>>2]),0|(T=0|C(0|l[e+(40*x|0)+20>>2],0|l[e+(40*x|0)+16>>2])))for(S=0,e=0|l[e+(40*x|0)+24>>2];l[e+44>>2]=0,l[e+48>>2]=0,(0|(S=S+1|0))!=(0|T);)e=e+56|0}if((A=A+1|0)>>>0>=(0|l[k>>2])>>>0)break t;M=M+36|0}return mt(h,1,22161,I),w=v,0|(U=0)}}while(0);do{if(2&l[i>>2]){if(c>>>0<6){mt(h,2,22179,P),e=U;break}if(-1==(0|r[a>>0])&&-111==(0|r[a+1>>0])){e=a+6|0,l[b>>2]=e;break}mt(h,2,22221,R),e=U}else e=U}while(0);if(!(p=0|wi()))return w=v,0|(U=0);do{if(!(1&r[t+96>>0])){if(2&r[i+5636>>0]){z=N=i+5168|0,N=0|l[N>>2],B=i+5180|0;break}l[B>>2]=a+c-e,z=b,N=e;break}z=N=t+40|0,N=0|l[N>>2],B=t+44|0}while(0);if(function(t,e,i){e|=0,i|=0,l[(t|=0)>>2]=e,l[t+4>>2]=e+i,l[t+8>>2]=e,l[t+12>>2]=0,l[t+16>>2]=0}(p,N,0|l[B>>2]),!(0|Mi(p,1))){Ei(p),e=N+(0|Ai(p))|0,xi(p);do{if(4&l[i>>2]){if(((0|l[B>>2])-e+(0|l[z>>2])|0)>>>0<2){mt(h,2,22242,L),x=z;break}if(-1==(0|r[e>>0])&&-110==(0|r[e+1>>0])){e=e+2|0,x=z;break}mt(h,2,22284,D),x=z}else x=z}while(0);return h=e-(i=0|l[x>>2])|0,l[B>>2]=(0|l[B>>2])-h,l[z>>2]=i+h,l[o>>2]=0,l[s>>2]=(0|l[b>>2])-U,w=v,0|(U=1)}f=u+(136*d|0)+24|0;t:do{if(0|l[f>>2]){F=n+32|0,G=i+5584|0,D=0,e=u+(136*d|0)+28|0;e:for(;;){x=0|l[e+20>>2],A=0|l[F>>2];i:do{if((0|l[e+8>>2])!=(0|l[e>>2])&&(0|l[e+12>>2])!=(0|l[e+4>>2])){c=0|C(0|l[x+(40*A|0)+20>>2],0|l[x+(40*A|0)+16>>2]);n:do{if(0|c){t=x+(40*A|0)+32|0,n=x+(40*A|0)+36|0,L=e+28|0,a=0,x=0|l[x+(40*A|0)+24>>2];r:for(;;){A=0|l[(S=x+44|0)>>2]?0|Mi(p,1):0|pi(p,0|l[t>>2],a,1+(0|l[m>>2])|0);o:do{if(A){if(!(0|l[S>>2])){for(A=0;!(0|pi(p,0|l[n>>2],a,A));)A=A+1|0;l[x+24>>2]=1-A+(0|l[L>>2]),l[x+28>>2]=3}do{if(0|Mi(p,1)){if(!(0|Mi(p,1))){A=2;break}if(3!=(0|(A=0|Mi(p,2)))){A=A+3|0;break}if(31==(0|(A=0|Mi(p,5)))){A=37+(0|Mi(p,7))|0;break}A=A+6|0;break}A=1}while(0);for(l[(I=x+40|0)>>2]=A,A=0;0|Mi(p,1);)A=A+1|0;l[(R=x+28|0)>>2]=(0|l[R>>2])+A,T=0|l[S>>2];do{if(T){if(A=T+-1|0,S=0|l[(k=x+4|0)>>2],(0|l[S+(A<<5)+8>>2])!=(0|l[S+(A<<5)+20>>2]))break;E=0|l[(0|l[G>>2])+(1080*(0|l[_>>2])|0)+16>>2],A=0|l[(M=x+52|0)>>2];do{if((T+1|0)>>>0>A>>>0){if(A=A+10|0,l[M>>2]=A,A=0|Wt(S,A<<5)){l[k>>2]=A,S=A;break}jt(0|l[k>>2]),l[k>>2]=0,l[M>>2]=0,xi(p),A=1;break o}}while(0);l[(A=S+(T<<5)|0)>>2]=0,l[A+4>>2]=0,l[A+8>>2]=0,l[A+12>>2]=0,l[A+16>>2]=0,l[A+20>>2]=0,l[A+24>>2]=0,l[A+28>>2]=0;do{if(4&E)A=1;else{if(!(1&E)){A=109;break}A=1==(0|(A=0|l[A+-32+20>>2]))|10==(0|A)?2:1}}while(0);M=T,E=k,S=S+(T<<5)+20|0,O=77}else{E=0|l[(0|l[G>>2])+(1080*(0|l[_>>2])|0)+16>>2],A=x+52|0;do{if(!(0|l[A>>2])){if(l[A>>2]=10,M=0|Wt(0|l[(S=x+4|0)>>2],320)){l[S>>2]=M,A=M,S=M;break}jt(0|l[S>>2]),l[S>>2]=0,l[A>>2]=0,xi(p),A=1;break o}A=S=0|l[x+4>>2]}while(0);l[A>>2]=0,l[A+4>>2]=0,l[A+8>>2]=0,l[A+12>>2]=0,l[A+16>>2]=0,l[A+20>>2]=0,l[A+24>>2]=0,l[A+28>>2]=0,A=4&E?1:0==(1&E|0)?109:10,M=0,E=x+4|0,S=S+20|0,O=77}}while(0);for(77==(0|O)&&(l[S>>2]=A,A=M,k=E),P=x+52|0,E=0|l[I>>2],I=A;;){if(M=0|l[k>>2],A=(0|(A=(0|l[M+(I<<5)+20>>2])-(0|l[M+(I<<5)+8>>2])|0))<(0|E)?A:E,l[M+(I<<5)+24>>2]=A,M=0|l[R>>2],A>>>0>1)for(S=A,A=0;A=A+1|0,S>>>0>3;)S>>>=1;else A=0;if(O=0|Mi(p,A+M|0),S=0|l[k>>2],l[S+(I<<5)+28>>2]=O,(0|(E=E-(0|l[S+(I<<5)+24>>2])|0))<=0){O=90;break}if(T=I+1|0,M=0|l[(0|l[G>>2])+(1080*(0|l[_>>2])|0)+16>>2],(I+2|0)>>>0>(A=0|l[P>>2])>>>0){if(A=A+10|0,l[P>>2]=A,!(A=0|Wt(S,A<<5))){O=89;break}l[k>>2]=A,S=A}l[(O=S+(T<<5)|0)>>2]=0,l[O+4>>2]=0,l[O+8>>2]=0,l[O+12>>2]=0,l[O+16>>2]=0,l[O+20>>2]=0,l[O+24>>2]=0,l[O+28>>2]=0;do{if(4&M)A=1;else{if(!(1&M)){A=109;break}A=1==(0|(A=0|l[S+(I<<5)+20>>2]))|10==(0|A)?2:1}}while(0);l[S+(T<<5)+20>>2]=A,I=T}if(89==(0|O)){O=0,jt(0|l[k>>2]),l[k>>2]=0,l[P>>2]=0,xi(p),A=1;break}if(90==(0|O)){O=0,A=0,x=x+56|0;break}}else l[x+40>>2]=0,A=13,x=x+56|0}while(0);switch(15&A){case 13:case 0:break;default:break r}if((a=a+1|0)>>>0>=c>>>0)break n}if(A){e=0;break e}break i}}while(0);e=e+36|0}else O=39}while(0);if(39==(0|O)&&(O=0,e=e+36|0),(D=D+1|0)>>>0>=(0|l[f>>2])>>>0)break t}return w=v,0|e}}while(0);if(!(0|Ei(p)))return xi(p),w=v,0|(U=0);e=N+(0|Ai(p))|0,xi(p);do{if(4&l[i>>2]){if(((0|l[B>>2])-e+(0|l[z>>2])|0)>>>0<2){mt(h,2,22242,y),x=z;break}if(-1==(0|r[e>>0])&&-110==(0|r[e+1>>0])){e=e+2|0,x=z;break}mt(h,2,22284,g),x=z}else x=z}while(0);return h=e-(i=0|l[x>>2])|0,l[B>>2]=(0|l[B>>2])-h,l[z>>2]=i+h,l[o>>2]=1,l[s>>2]=(0|l[b>>2])-U,w=v,0|(U=1)}function Ji(t,e){t|=0,e|=0;var i=0;return(i=0|Ut(1,8))?(l[i>>2]=t,l[i+4>>2]=e,0|i):0|(i=0)}function Qi(t){(t|=0)&&jt(t)}function qi(t){(t|=0)&&jt(t)}function Ki(t){return(0|l[12+(t|=0)>>2])-(0|l[t+16>>2])|0}function $i(t,e){e|=0,l[100+(t|=0)>>2]=t+24,l[t+4>>2]=32768,l[t>>2]=0,l[t+12>>2]=e+-1,l[t+8>>2]=12,l[t+16>>2]=e}function tn(t,e){e|=0;var i,n=0,o=0,a=0,s=0,c=0,h=0,u=0;if(o=0|l[100+(t|=0)>>2],a=0|l[o>>2],u=(0|l[a+4>>2])==(0|e),n=0|l[a>>2],e=(0|l[(i=t+4|0)>>2])-n|0,l[i>>2]=e,u)if(32768&e|0)l[t>>2]=(0|l[t>>2])+n;else for(e>>>0<n>>>0?(l[i>>2]=n,e=n,u=t,n=0|l[t>>2]):(n=(0|l[t>>2])+n|0,l[t>>2]=n,u=t),l[o>>2]=l[a+8>>2],c=t+8|0,h=t+12|0,s=t+16|0,t=n,n=0|l[c>>2];;){if(e<<=1,l[i>>2]=e,o=t<<1,l[u>>2]=o,n=n+-1|0,l[c>>2]=n,!n){e=0|l[h>>2];do{if((0|e)!=((0|l[s>>2])-1|0)){if((n=0|r[e>>0])<<24>>24==-1){a=e+1|0,l[h>>2]=a,n=7,o=1048575,e=t>>>19&4095;break}if(!(134217728&o)){a=e+1|0,l[h>>2]=a,n=8,o=524287,e=t>>>18&8191;break}if(r[e>>0]=n+1<<24>>24,e=0|l[h>>2],-1==(0|r[e>>0])){t=134217727&l[u>>2],l[u>>2]=t,a=e+1|0,l[h>>2]=a,n=7,o=1048575,e=t>>>20;break}a=e+1|0,l[h>>2]=a,n=8,o=524287,e=(0|l[u>>2])>>>19;break}a=e+1|0,l[h>>2]=a,n=8,o=524287,e=t>>>18&8191}while(0);r[a>>0]=e,o=l[u>>2]&o,l[u>>2]=o,l[c>>2]=n,e=0|l[i>>2]}if(32768&e)break;t=o}else for(e>>>0<n>>>0?(n=(0|l[t>>2])+n|0,l[t>>2]=n,u=t):(l[i>>2]=n,e=n,u=t,n=0|l[t>>2]),l[o>>2]=l[a+12>>2],c=t+8|0,h=t+12|0,s=t+16|0,t=n,o=0|l[c>>2];;){if(e<<=1,l[i>>2]=e,n=t<<1,l[u>>2]=n,o=o+-1|0,l[c>>2]=o,!o){e=0|l[h>>2];do{if((0|e)!=((0|l[s>>2])-1|0)){if((o=0|r[e>>0])<<24>>24==-1){o=e+1|0,l[h>>2]=o,a=7,n=1048575,e=t>>>19&4095;break}if(!(134217728&n)){o=e+1|0,l[h>>2]=o,a=8,n=524287,e=t>>>18&8191;break}if(r[e>>0]=o+1<<24>>24,e=0|l[h>>2],-1==(0|r[e>>0])){t=134217727&l[u>>2],l[u>>2]=t,o=e+1|0,l[h>>2]=o,a=7,n=1048575,e=t>>>20;break}o=e+1|0,l[h>>2]=o,a=8,n=524287,e=(0|l[u>>2])>>>19;break}o=e+1|0,l[h>>2]=o,a=8,n=524287,e=t>>>18&8191}while(0);r[o>>0]=e,n=l[u>>2]&n,l[u>>2]=n,l[c>>2]=a,e=0|l[i>>2],o=a}if(32768&e)break;t=n}}function en(t){var e,i=0,n=0,o=0,a=0,s=0,c=0,h=0;e=8+(t|=0)|0,s=((s=65535|(h=0|l[t>>2]))>>>0<((0|l[t+4>>2])+h|0)>>>0?s:s+-32768|0)<<l[e>>2],l[t>>2]=s,i=0|l[(h=t+12|0)>>2],c=t+16|0;do{if((0|i)!=((0|l[c>>2])-1|0)){if((n=0|r[i>>0])<<24>>24==-1){a=i+1|0,l[h>>2]=a,n=7,o=1048575,i=s>>>20;break}if(!(134217728&s)){a=i+1|0,l[h>>2]=a,n=8,o=524287,i=s>>>19;break}if(r[i>>0]=n+1<<24>>24,i=0|l[h>>2],-1==(0|r[i>>0])){s=134217727&l[t>>2],l[t>>2]=s,a=i+1|0,l[h>>2]=a,n=7,o=1048575,i=s>>>20;break}a=i+1|0,l[h>>2]=a,n=8,o=524287,i=(0|l[t>>2])>>>19;break}a=i+1|0,l[h>>2]=a,n=8,o=524287,i=s>>>19}while(0);r[a>>0]=i,s=l[t>>2]&o,l[e>>2]=n,s<<=n,l[t>>2]=s,n=0|l[h>>2];do{if((0|n)!=((0|l[c>>2])-1|0)){if((i=0|r[n>>0])<<24>>24==-1){a=n+1|0,l[h>>2]=a,n=7,o=1048575,i=s>>>20;break}if(!(134217728&s)){a=n+1|0,l[h>>2]=a,n=8,o=524287,i=s>>>19;break}if(r[n>>0]=i+1<<24>>24,i=0|l[h>>2],-1==(0|r[i>>0])){c=134217727&l[t>>2],l[t>>2]=c,a=i+1|0,l[h>>2]=a,n=7,o=1048575,i=c>>>20;break}a=i+1|0,l[h>>2]=a,n=8,o=524287,i=(0|l[t>>2])>>>19;break}a=n+1|0,l[h>>2]=a,n=8,o=524287,i=s>>>19}while(0);r[a>>0]=i,l[t>>2]=l[t>>2]&o,l[e>>2]=n,i=0|l[h>>2],-1!=(0|r[i>>0])&&(l[h>>2]=i+1)}function nn(t){l[(t|=0)>>2]=0,l[t+8>>2]=8}function rn(t,e){e|=0;var i,n,o=0;o=(0|l[(i=8+(t|=0)|0)>>2])-1|0,l[i>>2]=o,e=(0|l[t>>2])+(e<<o)|0,l[t>>2]=e,0|o||(n=1+(0|l[(o=t+12|0)>>2])|0,l[o>>2]=n,r[n>>0]=e,l[i>>2]=8,l[i>>2]=-1==(0|r[l[o>>2]>>0])?7:8,l[t>>2]=0)}function on(t){l[28+(t|=0)>>2]=1156,l[t+32>>2]=1156,l[t+36>>2]=1156,l[t+40>>2]=1156,l[t+44>>2]=1156,l[t+48>>2]=1156,l[t+52>>2]=1156,l[t+56>>2]=1156,l[t+60>>2]=1156,l[t+64>>2]=1156,l[t+68>>2]=1156,l[t+72>>2]=1156,l[t+76>>2]=1156,l[t+80>>2]=1156,l[t+84>>2]=1156,l[t+88>>2]=1156,l[t+96>>2]=2628,l[t+92>>2]=1252,l[t+24>>2]=1284}function an(t){l[24+(t|=0)>>2]=1156,l[t+28>>2]=1156,l[t+32>>2]=1156,l[t+36>>2]=1156,l[t+40>>2]=1156,l[t+44>>2]=1156,l[t+48>>2]=1156,l[t+52>>2]=1156,l[t+56>>2]=1156,l[t+60>>2]=1156,l[t+64>>2]=1156,l[t+68>>2]=1156,l[t+72>>2]=1156,l[t+76>>2]=1156,l[t+80>>2]=1156,l[t+84>>2]=1156,l[t+88>>2]=1156,l[t+92>>2]=1156,l[t+96>>2]=1156}function sn(t,e,i,n){i|=0,n|=0,l[24+(t|=0)+((e|=0)<<2)>>2]=1156+((n<<1)+i<<4)}function ln(t){var e,i;l[100+(t|=0)>>2]=t+24,l[t+4>>2]=32768,l[t>>2]=0,l[(e=t+8|0)>>2]=12,t=(0|l[(i=t+12|0)>>2])-1|0,l[i>>2]=t,-1==(0|r[t>>0])&&(l[e>>2]=13)}function cn(t){var e,i=0,n=0,o=0,a=0,s=0,c=0,h=0,u=0;if((0|(i=12-(n=0|l[(e=8+(t|=0)|0)>>2])|0))>0){o=t+12|0,u=t+16|0,h=i,a=0|l[t>>2],i=n;do{c=a<<i,l[t>>2]=c,l[e>>2]=0,i=0|l[o>>2];do{if((0|i)!=((0|l[u>>2])-1|0)){if((n=0|r[i>>0])<<24>>24==-1){s=i+1|0,l[o>>2]=s,i=7,a=1048575,n=c>>>20;break}if(!(134217728&c)){s=i+1|0,l[o>>2]=s,i=8,a=524287,n=c>>>19;break}if(r[i>>0]=n+1<<24>>24,i=0|l[o>>2],-1==(0|r[i>>0])){n=134217727&l[t>>2],l[t>>2]=n,s=i+1|0,l[o>>2]=s,i=7,a=1048575,n>>>=20;break}s=i+1|0,l[o>>2]=s,i=8,a=524287,n=(0|l[t>>2])>>>19;break}s=i+1|0,l[o>>2]=s,i=8,a=524287,n=c>>>19}while(0);r[s>>0]=n,a=l[t>>2]&a,l[t>>2]=a,l[e>>2]=i,h=h-i|0}while((0|h)>0)}else o=t+12|0;if(i=0|l[o>>2],(n=0|r[i>>0])<<24>>24!=-1){do{if((0|i)!=((0|l[t+16>>2])-1|0)){if(!(134217728&(c=0|l[t>>2]))){s=i+1|0,l[o>>2]=s,n=t,o=8,a=524287,i=c>>>19;break}if(r[i>>0]=n+1<<24>>24,i=0|l[o>>2],-1==(0|r[i>>0])){u=134217727&l[t>>2],l[t>>2]=u,s=i+1|0,l[o>>2]=s,n=t,o=7,a=1048575,i=u>>>20;break}s=i+1|0,l[o>>2]=s,n=t,o=8,a=524287,i=(0|l[t>>2])>>>19;break}s=i+1|0,l[o>>2]=s,n=t,o=8,a=524287,i=(0|l[t>>2])>>>19}while(0);r[s>>0]=i,l[n>>2]=l[n>>2]&a,l[e>>2]=o}}function hn(t){l[100+(t|=0)>>2]=t+96,tn(t,1),tn(t,0),tn(t,1),tn(t,0)}function un(t,e,i){e|=0,i|=0;var n,o=0,a=0,s=0;l[100+(t|=0)>>2]=t+24,l[t+16>>2]=e,l[t+20>>2]=e+i,l[(n=t+12|0)>>2]=e;do{if(i){if(o=h[e>>0]<<16,l[t>>2]=o,a=e+1|0,s=1==(0|i)?255:0|h[a>>0],-1==(0|r[e>>0])){if(s>>>0>143){a=8,e=65280,i=t;break}e=9,i=7}else e=8,i=8;l[n>>2]=a,a=i,e=s<<e,i=t}else l[t>>2]=16711680,a=8,e=65280,o=16711680,i=t}while(0);return l[i>>2]=o+e<<7,l[t+8>>2]=a+-7,l[t+4>>2]=32768,1}function dn(t){var e=0,i=0,n=0,o=0,a=0,s=0,c=0,u=0,d=0,f=0,p=0,m=0;if(e=0|l[100+(t|=0)>>2],i=0|l[e>>2],o=0|l[i>>2],a=(0|l[(m=t+4|0)>>2])-o|0,l[m>>2]=a,(n=0|l[t>>2])>>>16>>>0<o>>>0){f=a>>>0<o>>>0,l[m>>2]=o,p=0|l[i+4>>2],l[e>>2]=l[(f?i+8|0:i+12|0)>>2],u=t+12|0,d=t+20|0,e=0|l[(c=t+8|0)>>2],i=n,s=o;do{if(!e){n=0|l[u>>2],e=0|l[d>>2];do{if((0|n)==(0|e))o=8,e=65280;else{if(a=(0|(o=n+1|0))==(0|e)?255:0|h[o>>0],-1==(0|r[n>>0])){if(a>>>0>143){o=8,e=65280;break}n=9,e=7}else n=8,e=8;l[u>>2]=o,o=e,e=a<<n}}while(0);i=i+e|0,l[t>>2]=i,l[c>>2]=o,e=o}s<<=1,l[m>>2]=s,i<<=1,l[t>>2]=i,e=e+-1|0,l[c>>2]=e}while(s>>>0<32768);return 0|(m=f?p:1-p|0)}if(n=n-(o<<16)|0,l[t>>2]=n,32768&a|0)return 0|(m=0|l[i+4>>2]);f=a>>>0<o>>>0,p=0|l[i+4>>2],l[e>>2]=l[(f?i+12|0:i+8|0)>>2],u=t+12|0,d=t+20|0,e=0|l[(c=t+8|0)>>2],i=n,s=a;do{if(!e){n=0|l[u>>2],e=0|l[d>>2];do{if((0|n)==(0|e))o=8,e=65280;else{if(a=(0|(o=n+1|0))==(0|e)?255:0|h[o>>0],-1==(0|r[n>>0])){if(a>>>0>143){o=8,e=65280;break}n=9,e=7}else n=8,e=8;l[u>>2]=o,o=e,e=a<<n}}while(0);i=i+e|0,l[t>>2]=i,l[c>>2]=o,e=o}s<<=1,l[m>>2]=s,i<<=1,l[t>>2]=i,e=e+-1|0,l[c>>2]=e}while(s>>>0<32768);return 0|(m=f?1-p|0:p)}function fn(t){(t|=0)&&jt(t)}function pn(t,e,i){e|=0,i|=0,l[20+(t|=0)>>2]=e,l[t+8>>2]=i,l[t+12>>2]=0,r[t>>0]=0,l[t+4>>2]=0}function mn(t){var e,i=0,n=0,o=0,a=0;i=0|l[(e=4+(t|=0)|0)>>2];do{if(i)n=i,i=0|r[t>>0];else{if(l[e>>2]=8,(0|(o=0|l[(i=t+12|0)>>2]))==(0|l[t+8>>2])){r[t>>0]=-1,n=8,i=-1;break}-1==(0|r[t>>0])?(l[e>>2]=7,n=7):n=8,a=0|r[(0|l[t+20>>2])+o>>0],r[t>>0]=a,l[i>>2]=o+1,i=a}}while(0);return a=n+-1|0,l[e>>2]=a,(255&i)>>>a&1|0}function _n(t){t|=0;var e,i=0,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0;e=w,w=w+16|0,m=e;do{if(t>>>0<245){if(t=(d=t>>>0<11?16:t+11&-8)>>>3,3&(n=(p=0|l[6184])>>>t)|0)return r=0|l[(n=8+(t=24776+((i=(1&n^1)+t|0)<<1<<2)|0)|0)>>2],(0|(a=0|l[(o=r+8|0)>>2]))==(0|t)?l[6184]=p&~(1<<i):(l[a+12>>2]=t,l[n>>2]=a),A=i<<3,l[r+4>>2]=3|A,l[(A=r+A+4|0)>>2]=1|l[A>>2],w=e,0|(A=o);if(d>>>0>(f=0|l[6186])>>>0){if(0|n)return i=((i=n<<t&((i=2<<t)|0-i))&0-i)-1|0,a=0|l[(t=8+(i=24776+((r=((n=(i>>>=c=i>>>12&16)>>>5&8)|c|(a=(i>>>=n)>>>2&4)|(t=(i>>>=a)>>>1&2)|(r=(i>>>=t)>>>1&1))+(i>>>r)|0)<<1<<2)|0)|0)>>2],(0|(n=0|l[(c=a+8|0)>>2]))==(0|i)?(t=p&~(1<<r),l[6184]=t):(l[n+12>>2]=i,l[t>>2]=n,t=p),s=(A=r<<3)-d|0,l[a+4>>2]=3|d,l[4+(o=a+d|0)>>2]=1|s,l[a+A>>2]=s,0|f&&(r=0|l[6189],n=24776+((i=f>>>3)<<1<<2)|0,t&(i=1<<i)?i=0|l[(t=n+8|0)>>2]:(l[6184]=t|i,i=n,t=n+8|0),l[t>>2]=r,l[i+12>>2]=r,l[r+8>>2]=i,l[r+12>>2]=n),l[6186]=s,l[6189]=o,w=e,0|(A=c);if(h=0|l[6185]){if(n=(h&0-h)-1|0,t=0|l[25040+(((s=(n>>>=c=n>>>12&16)>>>5&8)|c|(u=(n>>>=s)>>>2&4)|(r=(n>>>=u)>>>1&2)|(t=(n>>>=r)>>>1&1))+(n>>>t)<<2)>>2],n=(-8&l[t+4>>2])-d|0,r=0|l[t+16+((0==(0|l[t+16>>2])&1)<<2)>>2]){do{n=(u=(c=(-8&l[r+4>>2])-d|0)>>>0<n>>>0)?c:n,t=u?r:t,r=0|l[r+16+((0==(0|l[r+16>>2])&1)<<2)>>2]}while(0!=(0|r));u=t,s=n}else u=t,s=n;if((c=u+d|0)>>>0>u>>>0){o=0|l[u+24>>2],i=0|l[u+12>>2];do{if((0|i)==(0|u)){if(!(i=0|l[(t=u+20|0)>>2])&&!(i=0|l[(t=u+16|0)>>2])){n=0;break}for(;;)if(0|(r=0|l[(n=i+20|0)>>2]))i=r,t=n;else{if(!(r=0|l[(n=i+16|0)>>2]))break;i=r,t=n}l[t>>2]=0,n=i}else n=0|l[u+8>>2],l[n+12>>2]=i,l[i+8>>2]=n,n=i}while(0);do{if(0|o){if(i=0|l[u+28>>2],(0|u)==(0|l[(t=25040+(i<<2)|0)>>2])){if(l[t>>2]=n,!n){l[6185]=h&~(1<<i);break}}else if(l[o+16+(((0|l[o+16>>2])!=(0|u)&1)<<2)>>2]=n,!n)break;l[n+24>>2]=o,0|(i=0|l[u+16>>2])&&(l[n+16>>2]=i,l[i+24>>2]=n),0|(i=0|l[u+20>>2])&&(l[n+20>>2]=i,l[i+24>>2]=n)}}while(0);return s>>>0<16?(A=s+d|0,l[u+4>>2]=3|A,l[(A=u+A+4|0)>>2]=1|l[A>>2]):(l[u+4>>2]=3|d,l[c+4>>2]=1|s,l[c+s>>2]=s,0|f&&(r=0|l[6189],n=24776+((i=f>>>3)<<1<<2)|0,p&(i=1<<i)?i=0|l[(t=n+8|0)>>2]:(l[6184]=p|i,i=n,t=n+8|0),l[t>>2]=r,l[i+12>>2]=r,l[r+8>>2]=i,l[r+12>>2]=n),l[6186]=s,l[6189]=c),w=e,0|(A=u+8|0)}f=d}else f=d}else f=d}else if(t>>>0<=4294967231)if(d=-8&(t=t+11|0),u=0|l[6185]){r=0-d|0,h=(t>>>=8)?d>>>0>16777215?31:d>>>(7+(h=14-((f=(520192+(x=t<<(p=(t+1048320|0)>>>16&8))|0)>>>16&4)|p|(h=(245760+(x<<=f)|0)>>>16&2))+(x<<h>>>15)|0)|0)&1|h<<1:0,n=0|l[25040+(h<<2)>>2];t:do{if(n)for(t=0,c=n,s=d<<(31==(0|h)?0:25-(h>>>1)|0),n=0;;){if((o=(-8&l[c+4>>2])-d|0)>>>0<r>>>0){if(!o){r=0,n=c,t=c,x=61;break t}t=c,r=o}if(n=0==(0|(o=0|l[c+20>>2]))|(0|o)==(0|(c=0|l[c+16+(s>>>31<<2)>>2]))?n:o,o=0==(0|c)){x=57;break}s<<=1&(1^o)}else n=0,t=0,x=57}while(0);if(57==(0|x)){if(0==(0|n)&0==(0|t)){if(!(t=u&((t=2<<h)|0-t))){f=d;break}p=(t&0-t)-1|0,t=0,n=0|l[25040+(((s=(p>>>=c=p>>>12&16)>>>5&8)|c|(h=(p>>>=s)>>>2&4)|(f=(p>>>=h)>>>1&2)|(n=(p>>>=f)>>>1&1))+(p>>>n)<<2)>>2]}n?x=61:(c=t,s=r)}if(61==(0|x))for(;;){if(x=0,r=(p=(f=(-8&l[n+4>>2])-d|0)>>>0<r>>>0)?f:r,t=p?n:t,!(n=0|l[n+16+((0==(0|l[n+16>>2])&1)<<2)>>2])){c=t,s=r;break}x=61}if(0!=(0|c)&&s>>>0<((0|l[6186])-d|0)>>>0){if((a=c+d|0)>>>0<=c>>>0)return w=e,0|(A=0);o=0|l[c+24>>2],i=0|l[c+12>>2];do{if((0|i)==(0|c)){if(!(i=0|l[(t=c+20|0)>>2])&&!(i=0|l[(t=c+16|0)>>2])){i=0;break}for(;;)if(0|(r=0|l[(n=i+20|0)>>2]))i=r,t=n;else{if(!(r=0|l[(n=i+16|0)>>2]))break;i=r,t=n}l[t>>2]=0}else A=0|l[c+8>>2],l[A+12>>2]=i,l[i+8>>2]=A}while(0);do{if(o){if(t=0|l[c+28>>2],(0|c)==(0|l[(n=25040+(t<<2)|0)>>2])){if(l[n>>2]=i,!i){r=u&~(1<<t),l[6185]=r;break}}else if(l[o+16+(((0|l[o+16>>2])!=(0|c)&1)<<2)>>2]=i,!i){r=u;break}l[i+24>>2]=o,0|(t=0|l[c+16>>2])&&(l[i+16>>2]=t,l[t+24>>2]=i),(t=0|l[c+20>>2])?(l[i+20>>2]=t,l[t+24>>2]=i,r=u):r=u}else r=u}while(0);do{if(s>>>0>=16){if(l[c+4>>2]=3|d,l[a+4>>2]=1|s,l[a+s>>2]=s,i=s>>>3,s>>>0<256){n=24776+(i<<1<<2)|0,(t=0|l[6184])&(i=1<<i)?i=0|l[(t=n+8|0)>>2]:(l[6184]=t|i,i=n,t=n+8|0),l[t>>2]=a,l[i+12>>2]=a,l[a+8>>2]=i,l[a+12>>2]=n;break}if(n=25040+((i=(i=s>>>8)?s>>>0>16777215?31:s>>>(7+(i=14-((v=(520192+(A=i<<(x=(i+1048320|0)>>>16&8))|0)>>>16&4)|x|(i=(245760+(A<<=v)|0)>>>16&2))+(A<<i>>>15)|0)|0)&1|i<<1:0)<<2)|0,l[a+28>>2]=i,l[4+(t=a+16|0)>>2]=0,l[t>>2]=0,!(r&(t=1<<i))){l[6185]=r|t,l[n>>2]=a,l[a+24>>2]=n,l[a+12>>2]=a,l[a+8>>2]=a;break}for(t=s<<(31==(0|i)?0:25-(i>>>1)|0),n=0|l[n>>2];;){if((-8&l[n+4>>2]|0)==(0|s)){x=97;break}if(!(i=0|l[(r=n+16+(t>>>31<<2)|0)>>2])){x=96;break}t<<=1,n=i}if(96==(0|x)){l[r>>2]=a,l[a+24>>2]=n,l[a+12>>2]=a,l[a+8>>2]=a;break}if(97==(0|x)){A=0|l[(x=n+8|0)>>2],l[A+12>>2]=a,l[x>>2]=a,l[a+8>>2]=A,l[a+12>>2]=n,l[a+24>>2]=0;break}}else A=s+d|0,l[c+4>>2]=3|A,l[(A=c+A+4|0)>>2]=1|l[A>>2]}while(0);return w=e,0|(A=c+8|0)}f=d}else f=d;else f=-1}while(0);if((n=0|l[6186])>>>0>=f>>>0)return i=n-f|0,t=0|l[6189],i>>>0>15?(A=t+f|0,l[6189]=A,l[6186]=i,l[A+4>>2]=1|i,l[t+n>>2]=i,l[t+4>>2]=3|f):(l[6186]=0,l[6189]=0,l[t+4>>2]=3|n,l[(A=t+n+4|0)>>2]=1|l[A>>2]),w=e,0|(A=t+8|0);if((c=0|l[6187])>>>0>f>>>0)return v=c-f|0,l[6187]=v,x=(A=0|l[6190])+f|0,l[6190]=x,l[x+4>>2]=1|v,l[A+4>>2]=3|f,w=e,0|(A=A+8|0);if(0|l[6302]?t=0|l[6304]:(l[6304]=4096,l[6303]=4096,l[6305]=-1,l[6306]=-1,l[6307]=0,l[6295]=0,l[6302]=-16&m^1431655768,t=4096),h=f+48|0,(d=(s=t+(u=f+47|0)|0)&(o=0-t|0))>>>0<=f>>>0)return w=e,0|(A=0);if(0|(t=0|l[6294])&&(m=(p=0|l[6292])+d|0)>>>0<=p>>>0|m>>>0>t>>>0)return w=e,0|(A=0);t:do{if(4&l[6295])i=0,x=133;else{n=0|l[6190];e:do{if(n){for(r=25184;!((t=0|l[r>>2])>>>0<=n>>>0&&(t+(0|l[(y=r+4|0)>>2])|0)>>>0>n>>>0);){if(!(t=0|l[r+8>>2])){x=118;break e}r=t}if((i=s-c&o)>>>0<2147483647)if((0|(t=0|Br(0|i)))==((0|l[r>>2])+(0|l[y>>2])|0)){if(-1!=(0|t)){s=i,a=t,x=135;break t}}else r=t,x=126;else i=0}else x=118}while(0);do{if(118==(0|x))if(-1!=(0|(n=0|Br(0)))&&(i=n,g=(i=(0==((g=(_=0|l[6303])-1|0)&i|0)?0:(g+i&0-_)-i|0)+d|0)+(_=0|l[6292])|0,i>>>0>f>>>0&i>>>0<2147483647)){if(0|(y=0|l[6294])&&g>>>0<=_>>>0|g>>>0>y>>>0){i=0;break}if((0|(t=0|Br(0|i)))==(0|n)){s=i,a=n,x=135;break t}r=t,x=126}else i=0}while(0);do{if(126==(0|x)){if(n=0-i|0,!(h>>>0>i>>>0&i>>>0<2147483647&-1!=(0|r))){if(-1==(0|r)){i=0;break}s=i,a=r,x=135;break t}if((t=u-i+(t=0|l[6304])&0-t)>>>0>=2147483647){s=i,a=r,x=135;break t}if(-1==(0|Br(0|t))){Br(0|n),i=0;break}s=t+i|0,a=r,x=135;break t}}while(0);l[6295]=4|l[6295],x=133}}while(0);if(133==(0|x)&&d>>>0<2147483647&&!(-1==(0|(a=0|Br(0|d)))|1^(v=(b=(y=0|Br(0))-a|0)>>>0>(f+40|0)>>>0)|a>>>0<y>>>0&-1!=(0|a)&-1!=(0|y)^1)&&(s=v?b:i,x=135),135==(0|x)){i=(0|l[6292])+s|0,l[6292]=i,i>>>0>(0|l[6293])>>>0&&(l[6293]=i),h=0|l[6190];do{if(h){for(i=25184;;){if((0|a)==((t=0|l[i>>2])+(r=0|l[(n=i+4|0)>>2])|0)){x=143;break}if(!(o=0|l[i+8>>2]))break;i=o}if(143==(0|x)&&0==(8&l[i+12>>2]|0)&&a>>>0>h>>>0&t>>>0<=h>>>0){l[n>>2]=r+s,A=(0|l[6187])+s|0,x=h+(v=0==(7&(v=h+8|0)|0)?0:0-v&7)|0,v=A-v|0,l[6190]=x,l[6187]=v,l[x+4>>2]=1|v,l[h+A+4>>2]=40,l[6191]=l[6306];break}for(a>>>0<(0|l[6188])>>>0&&(l[6188]=a),t=a+s|0,i=25184;;){if((0|l[i>>2])==(0|t)){x=151;break}if(!(i=0|l[i+8>>2])){t=25184;break}}if(151==(0|x)){if(!(8&l[i+12>>2])){l[i>>2]=a,l[(d=i+4|0)>>2]=(0|l[d>>2])+s,u=(d=a+(0==(7&(d=a+8|0)|0)?0:0-d&7)|0)+f|0,c=(i=t+(0==(7&(i=t+8|0)|0)?0:0-i&7)|0)-d-f|0,l[d+4>>2]=3|f;do{if((0|h)!=(0|i)){if((0|l[6189])==(0|i)){A=(0|l[6186])+c|0,l[6186]=A,l[6189]=u,l[u+4>>2]=1|A,l[u+A>>2]=A;break}if(1==(3&(t=0|l[i+4>>2])|0)){s=-8&t,r=t>>>3;t:do{if(t>>>0<256){if(t=0|l[i+8>>2],(0|(n=0|l[i+12>>2]))==(0|t)){l[6184]=l[6184]&~(1<<r);break}l[t+12>>2]=n,l[n+8>>2]=t;break}a=0|l[i+24>>2],t=0|l[i+12>>2];do{if((0|t)==(0|i)){if(!(t=0|l[(n=4+(r=i+16|0)|0)>>2])){if(!(t=0|l[r>>2])){t=0;break}n=r}for(;;)if(0|(o=0|l[(r=t+20|0)>>2]))t=o,n=r;else{if(!(o=0|l[(r=t+16|0)>>2]))break;t=o,n=r}l[n>>2]=0}else A=0|l[i+8>>2],l[A+12>>2]=t,l[t+8>>2]=A}while(0);if(!a)break;r=25040+((n=0|l[i+28>>2])<<2)|0;do{if((0|l[r>>2])==(0|i)){if(l[r>>2]=t,0|t)break;l[6185]=l[6185]&~(1<<n);break t}if(l[a+16+(((0|l[a+16>>2])!=(0|i)&1)<<2)>>2]=t,!t)break t}while(0);if(l[t+24>>2]=a,0|(r=0|l[(n=i+16|0)>>2])&&(l[t+16>>2]=r,l[r+24>>2]=t),!(n=0|l[n+4>>2]))break;l[t+20>>2]=n,l[n+24>>2]=t}while(0);i=i+s|0,o=s+c|0}else o=c;if(l[(i=i+4|0)>>2]=-2&l[i>>2],l[u+4>>2]=1|o,l[u+o>>2]=o,i=o>>>3,o>>>0<256){n=24776+(i<<1<<2)|0,(t=0|l[6184])&(i=1<<i)?i=0|l[(t=n+8|0)>>2]:(l[6184]=t|i,i=n,t=n+8|0),l[t>>2]=u,l[i+12>>2]=u,l[u+8>>2]=i,l[u+12>>2]=n;break}i=o>>>8;do{if(i){if(o>>>0>16777215){i=31;break}i=o>>>(7+(i=14-((v=(520192+(A=i<<(x=(i+1048320|0)>>>16&8))|0)>>>16&4)|x|(i=(245760+(A<<=v)|0)>>>16&2))+(A<<i>>>15)|0)|0)&1|i<<1}else i=0}while(0);if(r=25040+(i<<2)|0,l[u+28>>2]=i,l[4+(t=u+16|0)>>2]=0,l[t>>2]=0,!((t=0|l[6185])&(n=1<<i))){l[6185]=t|n,l[r>>2]=u,l[u+24>>2]=r,l[u+12>>2]=u,l[u+8>>2]=u;break}for(t=o<<(31==(0|i)?0:25-(i>>>1)|0),n=0|l[r>>2];;){if((-8&l[n+4>>2]|0)==(0|o)){x=192;break}if(!(i=0|l[(r=n+16+(t>>>31<<2)|0)>>2])){x=191;break}t<<=1,n=i}if(191==(0|x)){l[r>>2]=u,l[u+24>>2]=n,l[u+12>>2]=u,l[u+8>>2]=u;break}if(192==(0|x)){A=0|l[(x=n+8|0)>>2],l[A+12>>2]=u,l[x>>2]=u,l[u+8>>2]=A,l[u+12>>2]=n,l[u+24>>2]=0;break}}else A=(0|l[6187])+c|0,l[6187]=A,l[6190]=u,l[u+4>>2]=1|A}while(0);return w=e,0|(A=d+8|0)}t=25184}for(;!((i=0|l[t>>2])>>>0<=h>>>0&&(A=i+(0|l[t+4>>2])|0)>>>0>h>>>0);)t=0|l[t+8>>2];i=(t=(t=(o=A+-47|0)+(0==(7&(t=o+8|0)|0)?0:0-t&7)|0)>>>0<(o=h+16|0)>>>0?h:t)+8|0,n=s+-40|0,x=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=n-v|0,l[6190]=x,l[6187]=v,l[x+4>>2]=1|v,l[a+n+4>>2]=40,l[6191]=l[6306],l[(n=t+4|0)>>2]=27,l[i>>2]=l[6296],l[i+4>>2]=l[6297],l[i+8>>2]=l[6298],l[i+12>>2]=l[6299],l[6296]=a,l[6297]=s,l[6299]=0,l[6298]=i,i=t+24|0;do{x=i,l[(i=i+4|0)>>2]=7}while((x+8|0)>>>0<A>>>0);if((0|t)!=(0|h)){if(a=t-h|0,l[n>>2]=-2&l[n>>2],l[h+4>>2]=1|a,l[t>>2]=a,i=a>>>3,a>>>0<256){n=24776+(i<<1<<2)|0,(t=0|l[6184])&(i=1<<i)?i=0|l[(t=n+8|0)>>2]:(l[6184]=t|i,i=n,t=n+8|0),l[t>>2]=h,l[i+12>>2]=h,l[h+8>>2]=i,l[h+12>>2]=n;break}if(r=25040+((n=(i=a>>>8)?a>>>0>16777215?31:a>>>(7+(n=14-((v=(520192+(A=i<<(x=(i+1048320|0)>>>16&8))|0)>>>16&4)|x|(n=(245760+(A<<=v)|0)>>>16&2))+(A<<n>>>15)|0)|0)&1|n<<1:0)<<2)|0,l[h+28>>2]=n,l[h+20>>2]=0,l[o>>2]=0,!((i=0|l[6185])&(t=1<<n))){l[6185]=i|t,l[r>>2]=h,l[h+24>>2]=r,l[h+12>>2]=h,l[h+8>>2]=h;break}for(t=a<<(31==(0|n)?0:25-(n>>>1)|0),n=0|l[r>>2];;){if((-8&l[n+4>>2]|0)==(0|a)){x=213;break}if(!(i=0|l[(r=n+16+(t>>>31<<2)|0)>>2])){x=212;break}t<<=1,n=i}if(212==(0|x)){l[r>>2]=h,l[h+24>>2]=n,l[h+12>>2]=h,l[h+8>>2]=h;break}if(213==(0|x)){A=0|l[(x=n+8|0)>>2],l[A+12>>2]=h,l[x>>2]=h,l[h+8>>2]=A,l[h+12>>2]=n,l[h+24>>2]=0;break}}}else 0==(0|(A=0|l[6188]))|a>>>0<A>>>0&&(l[6188]=a),l[6296]=a,l[6297]=s,l[6299]=0,l[6193]=l[6302],l[6192]=-1,l[6197]=24776,l[6196]=24776,l[6199]=24784,l[6198]=24784,l[6201]=24792,l[6200]=24792,l[6203]=24800,l[6202]=24800,l[6205]=24808,l[6204]=24808,l[6207]=24816,l[6206]=24816,l[6209]=24824,l[6208]=24824,l[6211]=24832,l[6210]=24832,l[6213]=24840,l[6212]=24840,l[6215]=24848,l[6214]=24848,l[6217]=24856,l[6216]=24856,l[6219]=24864,l[6218]=24864,l[6221]=24872,l[6220]=24872,l[6223]=24880,l[6222]=24880,l[6225]=24888,l[6224]=24888,l[6227]=24896,l[6226]=24896,l[6229]=24904,l[6228]=24904,l[6231]=24912,l[6230]=24912,l[6233]=24920,l[6232]=24920,l[6235]=24928,l[6234]=24928,l[6237]=24936,l[6236]=24936,l[6239]=24944,l[6238]=24944,l[6241]=24952,l[6240]=24952,l[6243]=24960,l[6242]=24960,l[6245]=24968,l[6244]=24968,l[6247]=24976,l[6246]=24976,l[6249]=24984,l[6248]=24984,l[6251]=24992,l[6250]=24992,l[6253]=25e3,l[6252]=25e3,l[6255]=25008,l[6254]=25008,l[6257]=25016,l[6256]=25016,l[6259]=25024,l[6258]=25024,A=s+-40|0,x=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=A-v|0,l[6190]=x,l[6187]=v,l[x+4>>2]=1|v,l[a+A+4>>2]=40,l[6191]=l[6306]}while(0);if((i=0|l[6187])>>>0>f>>>0)return v=i-f|0,l[6187]=v,x=(A=0|l[6190])+f|0,l[6190]=x,l[x+4>>2]=1|v,l[A+4>>2]=3|f,w=e,0|(A=A+8|0)}return l[(A=25296)>>2]=12,w=e,0|(A=0)}function gn(t){var e=0,i=0,n=0,r=0,o=0,a=0,s=0,c=0;if(t|=0){i=t+-8|0,r=0|l[6188],c=i+(e=-8&(t=0|l[t+-4>>2]))|0;do{if(1&t)s=i,a=i;else{if(n=0|l[i>>2],!(3&t))return;if(o=n+e|0,(a=i+(0-n)|0)>>>0<r>>>0)return;if((0|l[6189])==(0|a)){if(3!=(3&(e=0|l[(t=c+4|0)>>2])|0)){s=a,e=o;break}return l[6186]=o,l[t>>2]=-2&e,l[a+4>>2]=1|o,void(l[a+o>>2]=o)}if(i=n>>>3,n>>>0<256){if(t=0|l[a+8>>2],(0|(e=0|l[a+12>>2]))==(0|t)){l[6184]=l[6184]&~(1<<i),s=a,e=o;break}l[t+12>>2]=e,l[e+8>>2]=t,s=a,e=o;break}r=0|l[a+24>>2],t=0|l[a+12>>2];do{if((0|t)==(0|a)){if(!(t=0|l[(e=4+(i=a+16|0)|0)>>2])){if(!(t=0|l[i>>2])){t=0;break}e=i}for(;;)if(0|(n=0|l[(i=t+20|0)>>2]))t=n,e=i;else{if(!(n=0|l[(i=t+16|0)>>2]))break;t=n,e=i}l[e>>2]=0}else s=0|l[a+8>>2],l[s+12>>2]=t,l[t+8>>2]=s}while(0);if(r){if(e=0|l[a+28>>2],(0|l[(i=25040+(e<<2)|0)>>2])==(0|a)){if(l[i>>2]=t,!t){l[6185]=l[6185]&~(1<<e),s=a,e=o;break}}else if(l[r+16+(((0|l[r+16>>2])!=(0|a)&1)<<2)>>2]=t,!t){s=a,e=o;break}l[t+24>>2]=r,0|(i=0|l[(e=a+16|0)>>2])&&(l[t+16>>2]=i,l[i+24>>2]=t),(e=0|l[e+4>>2])?(l[t+20>>2]=e,l[e+24>>2]=t,s=a,e=o):(s=a,e=o)}else s=a,e=o}}while(0);if(!(a>>>0>=c>>>0)&&1&(n=0|l[(t=c+4|0)>>2])){if(2&n)l[t>>2]=-2&n,l[s+4>>2]=1|e,l[a+e>>2]=e,r=e;else{if((0|l[6190])==(0|c)){if(c=(0|l[6187])+e|0,l[6187]=c,l[6190]=s,l[s+4>>2]=1|c,(0|s)!=(0|l[6189]))return;return l[6189]=0,void(l[6186]=0)}if((0|l[6189])==(0|c))return c=(0|l[6186])+e|0,l[6186]=c,l[6189]=a,l[s+4>>2]=1|c,void(l[a+c>>2]=c);r=(-8&n)+e|0,i=n>>>3;do{if(n>>>0<256){if(e=0|l[c+8>>2],(0|(t=0|l[c+12>>2]))==(0|e)){l[6184]=l[6184]&~(1<<i);break}l[e+12>>2]=t,l[t+8>>2]=e;break}o=0|l[c+24>>2],t=0|l[c+12>>2];do{if((0|t)==(0|c)){if(!(t=0|l[(e=4+(i=c+16|0)|0)>>2])){if(!(t=0|l[i>>2])){i=0;break}e=i}for(;;)if(0|(n=0|l[(i=t+20|0)>>2]))t=n,e=i;else{if(!(n=0|l[(i=t+16|0)>>2]))break;t=n,e=i}l[e>>2]=0,i=t}else i=0|l[c+8>>2],l[i+12>>2]=t,l[t+8>>2]=i,i=t}while(0);if(0|o){if(t=0|l[c+28>>2],(0|l[(e=25040+(t<<2)|0)>>2])==(0|c)){if(l[e>>2]=i,!i){l[6185]=l[6185]&~(1<<t);break}}else if(l[o+16+(((0|l[o+16>>2])!=(0|c)&1)<<2)>>2]=i,!i)break;l[i+24>>2]=o,0|(e=0|l[(t=c+16|0)>>2])&&(l[i+16>>2]=e,l[e+24>>2]=i),0|(t=0|l[t+4>>2])&&(l[i+20>>2]=t,l[t+24>>2]=i)}}while(0);if(l[s+4>>2]=1|r,l[a+r>>2]=r,(0|s)==(0|l[6189]))return void(l[6186]=r)}if(t=r>>>3,r>>>0<256)return i=24776+(t<<1<<2)|0,(e=0|l[6184])&(t=1<<t)?t=0|l[(e=i+8|0)>>2]:(l[6184]=e|t,t=i,e=i+8|0),l[e>>2]=s,l[t+12>>2]=s,l[s+8>>2]=t,void(l[s+12>>2]=i);n=25040+((t=(t=r>>>8)?r>>>0>16777215?31:r>>>(7+(t=14-((o=(520192+(c=t<<(a=(t+1048320|0)>>>16&8))|0)>>>16&4)|a|(t=(245760+(c<<=o)|0)>>>16&2))+(c<<t>>>15)|0)|0)&1|t<<1:0)<<2)|0,l[s+28>>2]=t,l[s+20>>2]=0,l[s+16>>2]=0,e=0|l[6185],i=1<<t;do{if(e&i){for(e=r<<(31==(0|t)?0:25-(t>>>1)|0),i=0|l[n>>2];;){if((-8&l[i+4>>2]|0)==(0|r)){t=73;break}if(!(t=0|l[(n=i+16+(e>>>31<<2)|0)>>2])){t=72;break}e<<=1,i=t}if(72==(0|t)){l[n>>2]=s,l[s+24>>2]=i,l[s+12>>2]=s,l[s+8>>2]=s;break}if(73==(0|t)){c=0|l[(a=i+8|0)>>2],l[c+12>>2]=s,l[a>>2]=s,l[s+8>>2]=c,l[s+12>>2]=i,l[s+24>>2]=0;break}}else l[6185]=e|i,l[n>>2]=s,l[s+24>>2]=n,l[s+12>>2]=s,l[s+8>>2]=s}while(0);if(c=(0|l[6192])-1|0,l[6192]=c,!c){for(t=25192;t=0|l[t>>2];)t=t+8|0;l[6192]=-1}}}}function yn(t,e){var i=0,n=0,r=0,o=0,a=0,s=0;s=(t|=0)+(e|=0)|0,i=0|l[t+4>>2];do{if(1&i)a=t;else{if(r=0|l[t>>2],!(3&i))return;if(a=t+(0-r)|0,e=r+e|0,(0|l[6189])==(0|a)){if(3!=(3&(i=0|l[(t=s+4|0)>>2])|0))break;return l[6186]=e,l[t>>2]=-2&i,l[a+4>>2]=1|e,void(l[s>>2]=e)}if(n=r>>>3,r>>>0<256){if(t=0|l[a+8>>2],(0|(i=0|l[a+12>>2]))==(0|t)){l[6184]=l[6184]&~(1<<n);break}l[t+12>>2]=i,l[i+8>>2]=t;break}o=0|l[a+24>>2],t=0|l[a+12>>2];do{if((0|t)==(0|a)){if(!(t=0|l[(i=4+(n=a+16|0)|0)>>2])){if(!(t=0|l[n>>2])){t=0;break}i=n}for(;;)if(0|(r=0|l[(n=t+20|0)>>2]))t=r,i=n;else{if(!(r=0|l[(n=t+16|0)>>2]))break;t=r,i=n}l[i>>2]=0}else r=0|l[a+8>>2],l[r+12>>2]=t,l[t+8>>2]=r}while(0);if(o){if(i=0|l[a+28>>2],(0|l[(n=25040+(i<<2)|0)>>2])==(0|a)){if(l[n>>2]=t,!t){l[6185]=l[6185]&~(1<<i);break}}else if(l[o+16+(((0|l[o+16>>2])!=(0|a)&1)<<2)>>2]=t,!t)break;l[t+24>>2]=o,0|(n=0|l[(i=a+16|0)>>2])&&(l[t+16>>2]=n,l[n+24>>2]=t),(i=0|l[i+4>>2])&&(l[t+20>>2]=i,l[i+24>>2]=t)}}}while(0);if(2&(n=0|l[(t=s+4|0)>>2]))l[t>>2]=-2&n,l[a+4>>2]=1|e,l[a+e>>2]=e,r=e;else{if((0|l[6190])==(0|s)){if(s=(0|l[6187])+e|0,l[6187]=s,l[6190]=a,l[a+4>>2]=1|s,(0|a)!=(0|l[6189]))return;return l[6189]=0,void(l[6186]=0)}if((0|l[6189])==(0|s))return s=(0|l[6186])+e|0,l[6186]=s,l[6189]=a,l[a+4>>2]=1|s,void(l[a+s>>2]=s);r=(-8&n)+e|0,i=n>>>3;do{if(n>>>0<256){if(t=0|l[s+8>>2],(0|(e=0|l[s+12>>2]))==(0|t)){l[6184]=l[6184]&~(1<<i);break}l[t+12>>2]=e,l[e+8>>2]=t;break}o=0|l[s+24>>2],e=0|l[s+12>>2];do{if((0|e)==(0|s)){if(!(e=0|l[(t=4+(i=s+16|0)|0)>>2])){if(!(e=0|l[i>>2])){i=0;break}t=i}for(;;)if(0|(n=0|l[(i=e+20|0)>>2]))e=n,t=i;else{if(!(n=0|l[(i=e+16|0)>>2]))break;e=n,t=i}l[t>>2]=0,i=e}else i=0|l[s+8>>2],l[i+12>>2]=e,l[e+8>>2]=i,i=e}while(0);if(0|o){if(e=0|l[s+28>>2],(0|l[(t=25040+(e<<2)|0)>>2])==(0|s)){if(l[t>>2]=i,!i){l[6185]=l[6185]&~(1<<e);break}}else if(l[o+16+(((0|l[o+16>>2])!=(0|s)&1)<<2)>>2]=i,!i)break;l[i+24>>2]=o,0|(t=0|l[(e=s+16|0)>>2])&&(l[i+16>>2]=t,l[t+24>>2]=i),0|(e=0|l[e+4>>2])&&(l[i+20>>2]=e,l[e+24>>2]=i)}}while(0);if(l[a+4>>2]=1|r,l[a+r>>2]=r,(0|a)==(0|l[6189]))return void(l[6186]=r)}if(e=r>>>3,r>>>0<256)return i=24776+(e<<1<<2)|0,(t=0|l[6184])&(e=1<<e)?e=0|l[(t=i+8|0)>>2]:(l[6184]=t|e,e=i,t=i+8|0),l[t>>2]=a,l[e+12>>2]=a,l[a+8>>2]=e,void(l[a+12>>2]=i);if(e=(e=r>>>8)?r>>>0>16777215?31:r>>>(7+(e=14-((n=(520192+(s=e<<(o=(e+1048320|0)>>>16&8))|0)>>>16&4)|o|(e=(245760+(s<<=n)|0)>>>16&2))+(s<<e>>>15)|0)|0)&1|e<<1:0,n=25040+(e<<2)|0,l[a+28>>2]=e,l[a+20>>2]=0,l[a+16>>2]=0,!((t=0|l[6185])&(i=1<<e)))return l[6185]=t|i,l[n>>2]=a,l[a+24>>2]=n,l[a+12>>2]=a,void(l[a+8>>2]=a);for(t=r<<(31==(0|e)?0:25-(e>>>1)|0),i=0|l[n>>2];;){if((-8&l[i+4>>2]|0)==(0|r)){e=69;break}if(!(e=0|l[(n=i+16+(t>>>31<<2)|0)>>2])){e=68;break}t<<=1,i=e}return 68==(0|e)?(l[n>>2]=a,l[a+24>>2]=i,l[a+12>>2]=a,void(l[a+8>>2]=a)):69==(0|e)?(s=0|l[(o=i+8|0)>>2],l[s+12>>2]=a,l[o>>2]=a,l[a+8>>2]=s,l[a+12>>2]=i,void(l[a+24>>2]=0)):void 0}function bn(t,e){e|=0;var i,n=0,r=0,o=0,a=0,s=0;if((t=(t|=0)>>>0>16?t:16)+-1&t)for(n=16;;){if(!(n>>>0<t>>>0)){t=n;break}n<<=1}if((-64-t|0)>>>0<=e>>>0)return l[(a=25296)>>2]=12,0|(a=0);if(!(n=0|_n(12+(i=e>>>0<11?16:e+11&-8)+t|0)))return 0|(a=0);o=n+-8|0;do{if(t+-1&n){if(e=(r=((r=(n+t+-1&0-t)-8|0)-(e=o)|0)>>>0>15?r:r+t|0)-e|0,n=(-8&(s=0|l[(t=n+-4|0)>>2]))-e|0,3&s){l[(s=r+4|0)>>2]=n|1&l[s>>2]|2,l[(n=r+n+4|0)>>2]=1|l[n>>2],l[t>>2]=e|1&l[t>>2]|2,l[s>>2]=1|l[s>>2],yn(o,e),t=r,e=r;break}l[r>>2]=(0|l[o>>2])+e,l[r+4>>2]=n,t=r,e=r;break}t=o,e=o}while(0);return 3&(n=0|l[(t=t+4|0)>>2])|0&&(a=-8&n)>>>0>(i+16|0)>>>0&&(s=a-i|0,o=e+i|0,l[t>>2]=i|1&n|2,l[o+4>>2]=3|s,l[(a=e+a+4|0)>>2]=1|l[a>>2],yn(o,s)),0|(s=e+8|0)}function vn(t,e,i){t|=0,e|=0,i|=0;var n=0;do{if(8!=(0|e)){if(0!=(3&e|0)|0==(0|(n=e>>>2)))return 0|(t=22);if(n+1073741823&n|0)return 0|(t=22);if((-64-e|0)>>>0<i>>>0)return 0|(t=12);e=0|bn(e>>>0>16?e:16,i);break}e=0|_n(i)}while(0);return e?(l[t>>2]=e,0|(t=0)):0|(t=12)}function wn(t,e,i){e|=0,i|=0;var n,r,o,a,s,c=0,h=0,u=0,d=0,f=0,p=0;s=w,w=w+48|0,a=s+16|0,u=s,h=s+32|0,c=0|l[(r=28+(t|=0)|0)>>2],l[h>>2]=c,c=(0|l[(o=t+20|0)>>2])-c|0,l[h+4>>2]=c,l[h+8>>2]=e,l[h+12>>2]=i,c=c+i|0,n=t+60|0,l[u>>2]=l[n>>2],l[u+4>>2]=h,l[u+8>>2]=2,u=0|xn(0|N(146,0|u));t:do{if((0|c)!=(0|u)){for(e=2;!((0|u)<0);)if(c=c-u|0,h=(f=u>>>0>(p=0|l[h+4>>2])>>>0)?h+8|0:h,e=e+(f<<31>>31)|0,p=u-(f?p:0)|0,l[h>>2]=(0|l[h>>2])+p,l[(f=h+4|0)>>2]=(0|l[f>>2])-p,l[a>>2]=l[n>>2],l[a+4>>2]=h,l[a+8>>2]=e,(0|c)==(0|(u=0|xn(0|N(146,0|a))))){d=3;break t}l[t+16>>2]=0,l[r>>2]=0,l[o>>2]=0,l[t>>2]=32|l[t>>2],i=2==(0|e)?0:i-(0|l[h+4>>2])|0}else d=3}while(0);return 3==(0|d)&&(p=0|l[t+44>>2],l[t+16>>2]=p+(0|l[t+48>>2]),l[r>>2]=p,l[o>>2]=p),w=s,0|i}function xn(t){return(t|=0)>>>0>4294963200&&(l[6324]=0-t,t=-1),0|t}function An(t,e){e|=0;var i=0,n=0;if(i=0|r[(t|=0)>>0],n=0|r[e>>0],i<<24>>24==0||i<<24>>24!=n<<24>>24)t=n;else{do{e=e+1|0,i=0|r[(t=t+1|0)>>0],n=0|r[e>>0]}while(i<<24>>24!=0&&i<<24>>24==n<<24>>24);t=n}return(255&i)-(255&t)|0}function Sn(t){var e,i=0,n=0;e=t|=0;t:do{if(3&e)for(i=e;;){if(!(0|r[t>>0])){t=i;break t}if(!(3&(i=t=t+1|0))){n=4;break}}else n=4}while(0);if(4==(0|n)){for(;!((-2139062144&(i=0|l[t>>2])^-2139062144)&i+-16843009);)t=t+4|0;if((255&i)<<24>>24)do{t=t+1|0}while(0!=(0|r[t>>0]))}return t-e|0}function Mn(t,e){var i;return e|=0,((0|En(t|=0,1,i=0|Sn(t),e))!=(0|i))<<31>>31|0}function En(t,e,i,n){t|=0,n|=0;var r,o=0;return r=0|C(i|=0,e|=0),i=0==(0|e)?0:i,(0|l[n+76>>2])>-1?(o=0==(0|Cn()),t=0|Rn(t,r,n),o||kn()):t=0|Rn(t,r,n),(0|t)!=(0|r)&&(i=(t>>>0)/(e>>>0)|0),0|i}function Tn(t){var e=0;0|l[68+(t|=0)>>2]&&(e=0|l[t+116>>2],t=t+112|0,0|e&&(l[e+112>>2]=l[t>>2]),t=0|l[t>>2],l[(t=t?t+116|0:3024)>>2]=e)}function kn(t){}function Cn(t){return 0}function In(t,e){t|=0;var i,n,o,a=0,s=0,c=0,u=0;o=w,w=w+16|0,n=255&(e|=0),r[(i=o)>>0]=n,(c=0|l[(s=t+16|0)>>2])?u=4:0|Pn(t)?a=-1:(c=0|l[s>>2],u=4);do{if(4==(0|u)){if((s=0|l[(u=t+20|0)>>2])>>>0<c>>>0&&(0|(a=255&e))!=(0|r[t+75>>0])){l[u>>2]=s+1,r[s>>0]=n;break}a=1==(0|Qr[63&l[t+36>>2]](t,i,1))?0|h[i>>0]:-1}}while(0);return w=o,0|a}function Pn(t){var e=0,i=0;return i=0|r[(e=74+(t|=0)|0)>>0],r[e>>0]=i+255|i,8&(e=0|l[t>>2])?(l[t>>2]=32|e,t=-1):(l[t+8>>2]=0,l[t+4>>2]=0,i=0|l[t+44>>2],l[t+28>>2]=i,l[t+20>>2]=i,l[t+16>>2]=i+(0|l[t+48>>2]),t=0),0|t}function Rn(t,e,i){t|=0,e|=0;var n=0,o=0,a=0,s=0,c=0;(o=0|l[(n=16+(i|=0)|0)>>2])?a=5:0|Pn(i)?n=0:(o=0|l[n>>2],a=5);t:do{if(5==(0|a)){if(n=s=0|l[(c=i+20|0)>>2],(o-s|0)>>>0<e>>>0){n=0|Qr[63&l[i+36>>2]](i,t,e);break}e:do{if((0|r[i+75>>0])>-1){for(s=e;;){if(!s){a=0,o=t;break e}if(10==(0|r[t+(o=s+-1|0)>>0]))break;s=o}if((n=0|Qr[63&l[i+36>>2]](i,t,s))>>>0<s>>>0)break t;a=s,o=t+s|0,e=e-s|0,n=0|l[c>>2]}else a=0,o=t}while(0);Cr(0|n,0|o,0|e),l[c>>2]=(0|l[c>>2])+e,n=a+e|0}}while(0);return 0|n}function Bn(t,e,i){e|=0,i|=0;var n,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0;n=1794895138+(0|l[(t|=0)>>2])|0,s=0|Ln(0|l[t+8>>2],n),o=0|Ln(0|l[t+12>>2],n),a=0|Ln(0|l[t+16>>2],n);t:do{if(s>>>0<e>>>2>>>0&&(p=e-(s<<2)|0,o>>>0<p>>>0&a>>>0<p>>>0)&&0==(3&(a|o)|0)){for(p=o>>>2,f=a>>>2,d=0;;){if(o=0|Ln(0|l[t+((a=(c=(u=d+(h=s>>>1)|0)<<1)+p|0)<<2)>>2],n),!((a=0|Ln(0|l[t+(a+1<<2)>>2],n))>>>0<e>>>0&o>>>0<(e-a|0)>>>0)){o=0;break t}if(0|r[t+(a+o)>>0]){o=0;break t}if(!(o=0|An(i,t+a|0)))break;if(o=(0|o)<0,1==(0|s)){o=0;break t}d=o?d:u,s=o?h:s-h|0}a=0|Ln(0|l[t+((o=c+f|0)<<2)>>2],n),o=(o=0|Ln(0|l[t+(o+1<<2)>>2],n))>>>0<e>>>0&a>>>0<(e-o|0)>>>0&&0==(0|r[t+(o+a)>>0])?t+o|0:0}else o=0}while(0);return 0|o}function Ln(t,e){var i;return e|=0,i=0|kr(0|(t|=0)),0|(0==(0|e)?t:i)}function Dn(t,e){t|=0;var i,n,o,a=0,s=0;return o=w,w=w+48|0,n=o+32|0,i=o+16|0,a=o,0|On(22305,0|r[(e|=0)>>0],4)?(s=0|function(t){var e=0,i=0,n=0;return i=0==(0|Fn(t|=0,43)),e=0|r[t>>0],i=i?e<<24>>24!=114&1:2,n=0==(0|Fn(t,120)),i=n?i:128|i,t=(t=0==(0|Fn(t,101)))?i:524288|i,t=e<<24>>24==114?t:64|t,t=e<<24>>24==119?512|t:t,0|(e<<24>>24==97?1024|t:t)}(e),l[a>>2]=t,l[a+4>>2]=32768|s,l[a+8>>2]=438,(0|(a=0|xn(0|U(5,0|a))))>=0?(524288&s|0&&(l[i>>2]=a,l[i+4>>2]=2,l[i+8>>2]=1,z(221,0|i)),(t=0|function(t,e){t|=0;var i=0,n=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0;if(f=w,w=w+64|0,d=f+40|0,h=f+24|0,c=f+16|0,o=f,u=f+56|0,0|On(22305,(n=0|r[(e|=0)>>0])<<24>>24,4))if(i=0|_n(1156)){s=(a=i)+124|0;do{l[a>>2]=0,a=a+4|0}while((0|a)<(0|s));0|Fn(e,43)||(l[i>>2]=n<<24>>24==114?8:4),0|Fn(e,101)&&(l[o>>2]=t,l[o+4>>2]=2,l[o+8>>2]=1,z(221,0|o),n=0|r[e>>0]),n<<24>>24==97?(l[c>>2]=t,l[c+4>>2]=3,1024&(n=0|z(221,0|c))||(l[h>>2]=t,l[h+4>>2]=4,l[h+8>>2]=1024|n,z(221,0|h)),e=128|l[i>>2],l[i>>2]=e):e=0|l[i>>2],l[i+60>>2]=t,l[i+44>>2]=i+132,l[i+48>>2]=1024,r[(n=i+75|0)>>0]=-1,0==(8&e|0)&&(l[d>>2]=t,l[d+4>>2]=21523,l[d+8>>2]=u,0==(0|H(54,0|d)))&&(r[n>>0]=10),l[i+32>>2]=62,l[i+36>>2]=61,l[i+40>>2]=2,l[i+12>>2]=1,0|l[6309]||(l[i+76>>2]=-1),function(t){t|=0;var e=0,i=0;e=0|Gn(),l[t+56>>2]=l[e>>2],0|(i=0|l[e>>2])&&(l[i+52>>2]=t),l[e>>2]=t,Nn()}(i)}else i=0;else l[(i=25296)>>2]=22,i=0;return w=f,0|i}(a,e))||(l[n>>2]=a,V(6,0|n),t=0)):t=0):(l[(t=25296)>>2]=22,t=0),w=o,0|t}function On(t,e,i){t|=0;var n=0,o=0,a=0,s=0;a=255&(e|=0),n=0!=(0|(i|=0));t:do{if(n&0!=(3&t|0))for(o=255&e;;){if((0|r[t>>0])==o<<24>>24){s=6;break t}if(!((n=0!=(0|(i=i+-1|0)))&0!=(3&(t=t+1|0)|0))){s=5;break}}else s=5}while(0);5==(0|s)&&(n?s=6:i=0);t:do{if(6==(0|s)&&(o=255&e,(0|r[t>>0])!=o<<24>>24)){n=0|C(a,16843009);e:do{if(i>>>0>3){for(;!((-2139062144&(a=l[t>>2]^n)^-2139062144)&a+-16843009|0);)if(t=t+4|0,(i=i+-4|0)>>>0<=3){s=11;break e}}else s=11}while(0);if(11==(0|s)&&!i){i=0;break}for(;;){if((0|r[t>>0])==o<<24>>24)break t;if(t=t+1|0,!(i=i+-1|0)){i=0;break}}}}while(0);return 0|(0|i?t:0)}function Fn(t,e){return t=0|function(t,e){t|=0;var i=0,n=0,o=0;n=255&(e|=0);t:do{if(n){if(3&t){i=255&e;do{if((o=0|r[t>>0])<<24>>24==0||o<<24>>24==i<<24>>24)break t;t=t+1|0}while(0!=(3&t|0))}n=0|C(n,16843009),i=0|l[t>>2];e:do{if(!((-2139062144&i^-2139062144)&i+-16843009))do{if((-2139062144&(o=i^n)^-2139062144)&o+-16843009|0)break e;i=0|l[(t=t+4|0)>>2]}while(!((-2139062144&i^-2139062144)&i+-16843009|0))}while(0);for(i=255&e;(o=0|r[t>>0])<<24>>24!=0&&o<<24>>24!=i<<24>>24;)t=t+1|0}else t=t+(0|Sn(t))|0}while(0);return 0|t}(t|=0,e|=0),0|((0|r[t>>0])==(255&e)<<24>>24?t:0)}function Gn(){return D(25300),25308}function Nn(){W(25300)}function zn(t){var e,i=0,n=0,r=0,o=0;return o=(0|l[76+(t|=0)>>2])>-1?0|Cn():0,Tn(t),(e=0!=(1&l[t>>2]|0))||(r=0|Gn(),i=t+56|0,0|(n=0|l[t+52>>2])&&(l[n+56>>2]=l[i>>2]),0|(i=0|l[i>>2])&&(l[i+52>>2]=n),(0|l[r>>2])==(0|t)&&(l[r>>2]=i),Nn()),i=0|function t(e){e|=0;var i=0,n=0;do{if(e){if((0|l[e+76>>2])<=-1){i=0|Un(e);break}n=0==(0|Cn()),i=0|Un(e),n||kn()}else{if(i=0|l[697]?0|t(0|l[697]):0,e=0|Gn(),e=0|l[e>>2])do{n=(0|l[e+76>>2])>-1?0|Cn():0,(0|l[e+20>>2])>>>0>(0|l[e+28>>2])>>>0&&(i=0|Un(e)|i),0|n&&kn(),e=0|l[e+56>>2]}while(0!=(0|e));Nn()}}while(0);return 0|i}(t),i=0|Xr[15&l[t+12>>2]](t)|i,0|(n=0|l[t+92>>2])&&gn(n),e?0|o&&kn():gn(t),0|i}function Un(t){var e,i,n=0,r=0,o=0,a=0;return i=28+(t|=0)|0,(0|l[(e=t+20|0)>>2])>>>0>(0|l[i>>2])>>>0&&(Qr[63&l[t+36>>2]](t,0,0),0==(0|l[e>>2]))?t=-1:((r=0|l[(n=t+4|0)>>2])>>>0<(a=0|l[(o=t+8|0)>>2])>>>0&&Qr[63&l[t+40>>2]](t,r-a|0,1),l[t+16>>2]=0,l[i>>2]=0,l[e>>2]=0,l[o>>2]=0,l[n>>2]=0,t=0),0|t}function Hn(t){var e=0,i=0;return i=0|r[(e=74+(t|=0)|0)>>0],r[e>>0]=i+255|i,i=t+28|0,(0|l[(e=t+20|0)>>2])>>>0>(0|l[i>>2])>>>0&&Qr[63&l[t+36>>2]](t,0,0),l[t+16>>2]=0,l[i>>2]=0,l[e>>2]=0,4&(e=0|l[t>>2])?(l[t>>2]=32|e,e=-1):(i=(0|l[t+44>>2])+(0|l[t+48>>2])|0,l[t+8>>2]=i,l[t+4>>2]=i,e=e<<27>>31),0|e}function Vn(t,e,i){return 0|function(t,e,i){e|=0,i|=0;var n=0;return(0|l[76+(t|=0)>>2])>-1?(n=0==(0|Cn()),e=0|sr(t,e,i),n||kn()):e=0|sr(t,e,i),0|e}(t|=0,e|=0,i|=0)}function Wn(t,e,i){var n,r;return t|=0,e|=0,i|=0,n=w,w=w+16|0,l[(r=n)>>2]=i,i=0|jn(t,e,r),w=n,0|i}function jn(t,e,i){t|=0,e|=0,i|=0;var n,o,a,s,c,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0;c=w,w=w+224|0,n=c+120|0,a=c,s=c+136|0,u=40+(h=o=c+80|0)|0;do{l[h>>2]=0,h=h+4|0}while((0|h)<(0|u));return l[n>>2]=l[i>>2],(0|Zn(0,e,n,a,o))<0?i=-1:(g=(0|l[t+76>>2])>-1?0|Cn():0,_=32&(i=0|l[t>>2]),(0|r[t+74>>0])<1&&(l[t>>2]=-33&i),0|l[(h=t+48|0)>>2]?i=0|Zn(t,e,n,a,o):(d=0|l[(u=t+44|0)>>2],l[u>>2]=s,l[(f=t+28|0)>>2]=s,l[(p=t+20|0)>>2]=s,l[h>>2]=80,l[(m=t+16|0)>>2]=s+80,i=0|Zn(t,e,n,a,o),d&&(Qr[63&l[t+36>>2]](t,0,0),i=0==(0|l[p>>2])?-1:i,l[u>>2]=d,l[h>>2]=0,l[m>>2]=0,l[f>>2]=0,l[p>>2]=0)),h=0|l[t>>2],l[t>>2]=h|_,0|g&&kn(),i=0==(32&h|0)?i:-1),w=c,0|i}function Zn(t,e,i,n,o){t|=0,e|=0,i|=0,n|=0,o|=0;var s,c,h,u,d,f,p,m,_,y=0,b=0,v=0,x=0,A=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=0;_=w,w=w+64|0,f=_,B=_+24|0,p=_+8|0,m=_+20|0,l[(d=_+16|0)>>2]=e,s=0!=(0|t),h=c=B+40|0,B=B+39|0,u=p+4|0,b=0,y=0,M=0;t:for(;;){do{if((0|y)>-1){if((0|b)>(2147483647-y|0)){l[(y=25296)>>2]=75,y=-1;break}y=b+y|0;break}}while(0);if(!((b=0|r[e>>0])<<24>>24)){R=86;break}v=e;e:for(;;){switch(b<<24>>24){case 37:b=v,R=9;break e;case 0:b=v;break e}P=v+1|0,l[d>>2]=P,b=0|r[P>>0],v=P}e:do{if(9==(0|R))for(;;){if(R=0,37!=(0|r[v+1>>0]))break e;if(b=b+1|0,v=v+2|0,l[d>>2]=v,37!=(0|r[v>>0]))break;R=9}}while(0);if(b=b-e|0,s&&Yn(t,e,b),0|b)e=v;else{if((b=(0|r[(x=v+1|0)>>0])-48|0)>>>0<10?(C=(P=36==(0|r[v+2>>0]))?b:-1,M=P?1:M,x=P?v+3|0:x):C=-1,l[d>>2]=x,(P=((b=0|r[x>>0])<<24>>24)-32|0)>>>0>31|0==(1<<P&75913|0))v=0;else{v=0;do{v|=1<<(b<<24>>24)-32,x=x+1|0,l[d>>2]=x,P=((b=0|r[x>>0])<<24>>24)-32|0}while(!(P>>>0>31|0==(1<<P&75913|0)))}if(b<<24>>24==42){if((b=(0|r[(A=x+1|0)>>0])-48|0)>>>0<10&&36==(0|r[x+2>>0]))l[o+(b<<2)>>2]=10,b=0|l[n+((0|r[A>>0])-48<<3)>>2],M=1,x=x+3|0;else{if(0|M){y=-1;break}s?(M=3+(0|l[i>>2])&-4,b=0|l[M>>2],l[i>>2]=M+4,M=0,x=A):(b=0,M=0,x=A)}l[d>>2]=x,b=(I=(0|b)<0)?0-b|0:b,I=I?8192|v:v}else{if((0|(b=0|Xn(d)))<0){y=-1;break}I=v,x=0|l[d>>2]}do{if(46==(0|r[x>>0])){if(42!=(0|r[x+1>>0])){l[d>>2]=x+1,v=0|Xn(d),x=0|l[d>>2];break}if((v=(0|r[(A=x+2|0)>>0])-48|0)>>>0<10&&36==(0|r[x+3>>0])){l[o+(v<<2)>>2]=10,v=0|l[n+((0|r[A>>0])-48<<3)>>2],x=x+4|0,l[d>>2]=x;break}if(0|M){y=-1;break t}s?(P=3+(0|l[i>>2])&-4,v=0|l[P>>2],l[i>>2]=P+4):v=0,l[d>>2]=A,x=A}else v=-1}while(0);for(k=0;;){if(((0|r[x>>0])-65|0)>>>0>57){y=-1;break t}if(P=x+1|0,l[d>>2]=P,!(((E=255&(A=0|r[(0|r[x>>0])-65+(22309+(58*k|0))>>0]))-1|0)>>>0<8))break;k=E,x=P}if(!(A<<24>>24)){y=-1;break}T=(0|C)>-1;do{if(A<<24>>24==19){if(T){y=-1;break t}R=48}else{if(T){l[o+(C<<2)>>2]=E,C=0|l[4+(T=n+(C<<3)|0)>>2],l[(R=f)>>2]=l[T>>2],l[R+4>>2]=C,R=48;break}if(!s){y=0;break t}Jn(f,E,i)}}while(0);if(48!=(0|R)||(R=0,s)){x=0!=(0|k)&3==(15&(x=0|r[x>>0])|0)?-33&x:x,C=-65537&I,I=0==(8192&I|0)?I:C;e:do{switch(0|x){case 110:switch((255&k)<<24>>24){case 0:case 1:l[l[f>>2]>>2]=y,b=0,e=P;continue t;case 2:b=0|l[f>>2],l[b>>2]=y,l[b+4>>2]=((0|y)<0)<<31>>31,b=0,e=P;continue t;case 3:a[l[f>>2]>>1]=y,b=0,e=P;continue t;case 4:r[l[f>>2]>>0]=y,b=0,e=P;continue t;case 6:l[l[f>>2]>>2]=y,b=0,e=P;continue t;case 7:b=0|l[f>>2],l[b>>2]=y,l[b+4>>2]=((0|y)<0)<<31>>31,b=0,e=P;continue t;default:b=0,e=P;continue t}case 112:x=120,v=v>>>0>8?v:8,e=8|I,R=60;break;case 88:case 120:e=I,R=60;break;case 111:A=0,E=22773,v=0==(8&I|0)|(0|v)>(0|(k=h-(T=0|qn(e=0|l[(x=f)>>2],x=0|l[x+4>>2],c))|0))?v:k+1|0,k=I,R=66;break;case 105:case 100:if(e=0|l[(x=f)>>2],(0|(x=0|l[x+4>>2]))<0){e=0|vr(0,0,0|e,0|x),x=S,l[(A=f)>>2]=e,l[A+4>>2]=x,A=1,E=22773,R=65;break e}A=0!=(2049&I|0)&1,E=0==(2048&I|0)?0==(1&I|0)?22773:22775:22774,R=65;break e;case 117:A=0,E=22773,e=0|l[(x=f)>>2],x=0|l[x+4>>2],R=65;break;case 99:r[B>>0]=l[f>>2],e=B,A=0,E=22773,T=c,x=1,v=C;break;case 109:x=0|$n(0|l[(x=25296)>>2]),R=70;break;case 115:x=0|(x=0|l[f>>2])?x:22783,R=70;break;case 67:l[p>>2]=l[f>>2],l[u>>2]=0,l[f>>2]=p,T=-1,x=p,R=74;break;case 83:e=0|l[f>>2],v?(T=v,x=e,R=74):(tr(t,32,b,0,I),e=0,R=83);break;case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:b=0|ir(t,+g[f>>3],b,v,I,x),e=P;continue t;default:A=0,E=22773,T=c,x=v,v=I}}while(0);e:do{if(60==(0|R))T=0|Qn(C=0|l[(I=f)>>2],I=0|l[I+4>>2],c,32&x),A=(E=0==(8&e|0)|0==(0|C)&0==(0|I))?0:2,E=E?22773:22773+(x>>4)|0,k=e,e=C,x=I,R=66;else if(65==(0|R))T=0|Kn(e,x,c),k=I,R=66;else if(70==(0|R))R=0,e=x,A=0,E=22773,T=(k=0==(0|(I=0|On(x,0,v))))?x+v|0:I,x=k?v:I-x|0,v=C;else if(74==(0|R)){for(R=0,E=x,e=0,v=0;(A=0|l[E>>2])&&!((0|(v=0|er(m,A)))<0|v>>>0>(T-e|0)>>>0)&&T>>>0>(e=v+e|0)>>>0;)E=E+4|0;if((0|v)<0){y=-1;break t}if(tr(t,32,b,e,I),e)for(A=0;;){if(!(v=0|l[x>>2])){R=83;break e}if((0|(A=(v=0|er(m,v))+A|0))>(0|e)){R=83;break e}if(Yn(t,m,v),A>>>0>=e>>>0){R=83;break}x=x+4|0}else e=0,R=83}}while(0);if(66==(0|R))R=0,I=0!=(0|v)|(x=0!=(0|e)|0!=(0|x)),x=h-T+(1&(1^x))|0,e=I?T:c,T=c,x=I?(0|v)>(0|x)?v:x:v,v=(0|v)>-1?-65537&k:k;else if(83==(0|R)){R=0,tr(t,32,b,e,8192^I),b=(0|b)>(0|e)?b:e,e=P;continue}tr(t,32,b=(0|b)<(0|(I=(k=(0|x)<(0|(C=T-e|0))?C:x)+A|0))?I:b,I,v),Yn(t,E,A),tr(t,48,b,I,65536^v),tr(t,48,k,C,0),Yn(t,e,C),tr(t,32,b,I,8192^v),e=P}else b=0,e=P}}t:do{if(86==(0|R)&&!t)if(M){for(y=1;e=0|l[o+(y<<2)>>2];){if(Jn(n+(y<<3)|0,e,i),e=y+1|0,!((0|y)<9)){y=e;break}y=e}if((0|y)<10)for(;;){if(0|l[o+(y<<2)>>2]){y=-1;break t}if(!((0|y)<9)){y=1;break}y=y+1|0}else y=1}else y=0}while(0);return w=_,0|y}function Yn(t,e,i){e|=0,i|=0,32&l[(t|=0)>>2]||Rn(e,i,t)}function Xn(t){var e=0,i=0,n=0;if(i=0|l[(t|=0)>>2],(n=(0|r[i>>0])-48|0)>>>0<10){e=0;do{e=n+(10*e|0)|0,i=i+1|0,l[t>>2]=i,n=(0|r[i>>0])-48|0}while(n>>>0<10)}else e=0;return 0|e}function Jn(t,e,i){t|=0,e|=0,i|=0;var n=0,r=0,o=0;t:do{if(e>>>0<=20)switch(0|e){case 9:n=3+(0|l[i>>2])&-4,e=0|l[n>>2],l[i>>2]=n+4,l[t>>2]=e;break t;case 10:n=3+(0|l[i>>2])&-4,e=0|l[n>>2],l[i>>2]=n+4,l[(n=t)>>2]=e,l[n+4>>2]=((0|e)<0)<<31>>31;break t;case 11:n=3+(0|l[i>>2])&-4,e=0|l[n>>2],l[i>>2]=n+4,l[(n=t)>>2]=e,l[n+4>>2]=0;break t;case 12:n=7+(0|l[i>>2])&-8,r=0|l[(e=n)>>2],e=0|l[e+4>>2],l[i>>2]=n+8,l[(n=t)>>2]=r,l[n+4>>2]=e;break t;case 13:r=3+(0|l[i>>2])&-4,n=0|l[r>>2],l[i>>2]=r+4,n=(65535&n)<<16>>16,l[(r=t)>>2]=n,l[r+4>>2]=((0|n)<0)<<31>>31;break t;case 14:r=3+(0|l[i>>2])&-4,n=0|l[r>>2],l[i>>2]=r+4,l[(r=t)>>2]=65535&n,l[r+4>>2]=0;break t;case 15:r=3+(0|l[i>>2])&-4,n=0|l[r>>2],l[i>>2]=r+4,n=(255&n)<<24>>24,l[(r=t)>>2]=n,l[r+4>>2]=((0|n)<0)<<31>>31;break t;case 16:r=3+(0|l[i>>2])&-4,n=0|l[r>>2],l[i>>2]=r+4,l[(r=t)>>2]=255&n,l[r+4>>2]=0;break t;case 17:case 18:r=7+(0|l[i>>2])&-8,o=+g[r>>3],l[i>>2]=r+8,g[t>>3]=o;break t;default:break t}}while(0)}function Qn(t,e,i,n){if(i|=0,n|=0,!(0==(0|(t|=0))&0==(0|(e|=0))))do{r[(i=i+-1|0)>>0]=0|h[22825+(15&t)>>0]|n,t=0|Er(0|t,0|e,4),e=S}while(!(0==(0|t)&0==(0|e)));return 0|i}function qn(t,e,i){if(i|=0,!(0==(0|(t|=0))&0==(0|(e|=0))))do{r[(i=i+-1|0)>>0]=7&t|48,t=0|Er(0|t,0|e,3),e=S}while(!(0==(0|t)&0==(0|e)));return 0|i}function Kn(t,e,i){i|=0;var n=0;if((e|=0)>>>0>0|0==(0|e)&(t|=0)>>>0>4294967295){for(;n=0|Sr(0|t,0|e,10,0),r[(i=i+-1|0)>>0]=255&n|48,n=t,t=0|Ar(0|t,0|e,10,0),e>>>0>9|9==(0|e)&n>>>0>4294967295;)e=S;e=t}else e=t;if(e)for(;r[(i=i+-1|0)>>0]=48|(e>>>0)%10,!(e>>>0<10);)e=(e>>>0)/10|0;return 0|i}function $n(t){return 0|ar(t|=0,0|l[745])}function tr(t,e,i,n,r){var o,a;if(t|=0,e|=0,a=w,w=w+256|0,o=a,(0|(i|=0))>(0|(n|=0))&0==(73728&(r|=0)|0)){if(Ir(0|o,0|e,0|((r=i-n|0)>>>0<256?r:256)),r>>>0>255){e=i-n|0;do{Yn(t,o,256),r=r+-256|0}while(r>>>0>255);r=255&e}Yn(t,o,r)}w=a}function er(t,e){return e|=0,0|(t=(t|=0)?0|or(t,e):0)}function ir(t,e,i,n,o,a){t|=0,e=+e,i|=0,n|=0,o|=0,a|=0;var s,c=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0;s=w,w=w+560|0,d=s+8|0,B=L=s+524|0,f=s+512|0,l[(v=s)>>2]=0,R=f+12|0,nr(e),(0|S)<0?(e=-e,I=1,k=22790):(I=0!=(2049&o|0)&1,k=0==(2048&o|0)?0==(1&o|0)?22791:22796:22793),nr(e);do{if(!0&2146435072==(2146435072&S|0))L=0!=(32&a|0),tr(t,32,i,c=I+3|0,-65537&o),Yn(t,k,I),Yn(t,e!=e|!1?L?22817:22821:L?22809:22813,3),tr(t,32,i,c,8192^o);else{if((c=0!=(g=2*+rr(e,v)))&&(l[v>>2]=(0|l[v>>2])-1),97==(0|(A=32|a))){y=0==(0|(m=32&a))?k:k+9|0,_=2|I,c=12-n|0;do{if(!(n>>>0>11|0==(0|c))){e=8;do{c=c+-1|0,e*=16}while(0!=(0|c));if(45==(0|r[y>>0])){e=-(e+(-g-e));break}e=g+e-e;break}e=g}while(0);(0|(c=0|Kn(c=(0|(u=0|l[v>>2]))<0?0-u|0:u,((0|c)<0)<<31>>31,R)))==(0|R)&&(r[(c=f+11|0)>>0]=48),r[c+-1>>0]=43+(u>>31&2),r[(p=c+-2|0)>>0]=a+15,d=(0|n)<1,f=0==(8&o|0),c=L;do{P=~~e,u=c+1|0,r[c>>0]=m|h[22825+P>>0],e=16*(e-+(0|P)),1!=(u-B|0)||f&d&0==e?c=u:(r[u>>0]=46,c=c+2|0)}while(0!=e);0!=(0|n)&&(-2-B+c|0)<(0|n)?(u=c-B|0,c=n+2|0):u=c=c-B|0,tr(t,32,i,B=(R=R-p|0)+_+c|0,o),Yn(t,y,_),tr(t,48,i,B,65536^o),Yn(t,L,u),tr(t,48,c-u|0,0,0),Yn(t,p,R),tr(t,32,i,B,8192^o),c=B;break}u=(0|n)<0?6:n,c?(c=(0|l[v>>2])-28|0,l[v>>2]=c,e=268435456*g):(e=g,c=0|l[v>>2]),d=P=(0|c)<0?d:d+288|0;do{E=~~e>>>0,l[d>>2]=E,d=d+4|0,e=1e9*(e-+(E>>>0))}while(0!=e);if((0|c)>0)for(f=P,m=d;;){if(p=(0|c)<29?c:29,(c=m+-4|0)>>>0>=f>>>0){d=0;do{x=0|Sr(0|(M=0|br(0|(M=0|Tr(0|l[c>>2],0,0|p)),0|S,0|d,0)),0|(E=S),1e9,0),l[c>>2]=x,d=0|Ar(0|M,0|E,1e9,0),c=c+-4|0}while(c>>>0>=f>>>0);d&&(l[(f=f+-4|0)>>2]=d)}for(d=m;!(d>>>0<=f>>>0||0|l[(c=d+-4|0)>>2]);)d=c;if(c=(0|l[v>>2])-p|0,l[v>>2]=c,!((0|c)>0))break;m=d}else f=P;if((0|c)<0){n=1+((u+25|0)/9|0)|0,b=102==(0|A);do{if(y=(0|(y=0-c|0))<9?y:9,f>>>0<d>>>0){p=(1<<y)-1|0,m=1e9>>>y,_=0,c=f;do{E=0|l[c>>2],l[c>>2]=(E>>>y)+_,_=0|C(E&p,m),c=c+4|0}while(c>>>0<d>>>0);c=0==(0|l[f>>2])?f+4|0:f,_?(l[d>>2]=_,f=c,c=d+4|0):(f=c,c=d)}else f=0==(0|l[f>>2])?f+4|0:f,c=d;d=(c-(d=b?P:f)>>2|0)>(0|n)?d+(n<<2)|0:c,c=(0|l[v>>2])+y|0,l[v>>2]=c}while((0|c)<0);c=f,n=d}else c=f,n=d;if(E=P,c>>>0<n>>>0){if(d=9*(E-c>>2)|0,(p=0|l[c>>2])>>>0>=10){f=10;do{f=10*f|0,d=d+1|0}while(p>>>0>=f>>>0)}}else d=0;if(b=103==(0|A),x=0!=(0|u),(0|(f=u-(102!=(0|A)?d:0)+((x&b)<<31>>31)|0))<((9*(n-E>>2)|0)-9|0)){if(y=P+4+(((0|(f=f+9216|0))/9|0)-1024<<2)|0,(0|(f=(0|f)%9|0))<8)for(p=10;p=10*p|0,(0|f)<7;)f=f+1|0;else p=10;if((f=(y+4|0)==(0|n))&0==(0|(_=((m=0|l[y>>2])>>>0)%(p>>>0)|0)))f=y;else if(g=0==(1&((m>>>0)/(p>>>0)|0)|0)?9007199254740992:9007199254740994,e=_>>>0<(M=(0|p)/2|0)>>>0?.5:f&(0|_)==(0|M)?1:1.5,I&&(e=(M=45==(0|r[k>>0]))?-e:e,g=M?-g:g),f=m-_|0,l[y>>2]=f,g+e!=g){if(M=f+p|0,l[y>>2]=M,M>>>0>999999999)for(d=y;f=d+-4|0,l[d>>2]=0,f>>>0<c>>>0&&(l[(c=c+-4|0)>>2]=0),M=1+(0|l[f>>2])|0,l[f>>2]=M,M>>>0>999999999;)d=f;else f=y;if(d=9*(E-c>>2)|0,(m=0|l[c>>2])>>>0>=10){p=10;do{p=10*p|0,d=d+1|0}while(m>>>0>=p>>>0)}}else f=y;f=n>>>0>(f=f+4|0)>>>0?f:n,M=c}else f=n,M=c;for(A=f;;){if(A>>>0<=M>>>0){v=0;break}if(0|l[(c=A+-4|0)>>2]){v=1;break}A=c}n=0-d|0;do{if(b){if((0|(c=u+(1&(1^x))|0))>(0|d)&(0|d)>-5?(p=a+-1|0,u=c+-1-d|0):(p=a+-2|0,u=c+-1|0),!(c=8&o)){if(v&&0!=(0|(T=0|l[A+-4>>2])))if((T>>>0)%10|0)f=0;else{f=0,c=10;do{c=10*c|0,f=f+1|0}while(!(0|(T>>>0)%(c>>>0)))}else f=9;if(c=(9*(A-E>>2)|0)-9|0,102==(32|p)){u=(0|u)<(0|(y=(0|(y=c-f|0))>0?y:0))?u:y,y=0;break}u=(0|u)<(0|(y=(0|(y=c+d-f|0))>0?y:0))?u:y,y=0;break}y=c}else p=a,y=8&o}while(0);if(m=0!=(0|(b=u|y))&1,_=102==(32|p))x=0,c=(0|d)>0?d:0;else{if(((f=R)-(c=0|Kn(c=(0|d)<0?n:d,((0|c)<0)<<31>>31,R))|0)<2)do{r[(c=c+-1|0)>>0]=48}while((f-c|0)<2);r[c+-1>>0]=43+(d>>31&2),r[(c=c+-2|0)>>0]=p,x=c,c=f-c|0}if(tr(t,32,i,c=I+1+u+m+c|0,o),Yn(t,k,I),tr(t,48,i,c,65536^o),_){m=y=L+9|0,_=L+8|0,f=p=M>>>0>P>>>0?P:M;do{if(d=0|Kn(0|l[f>>2],0,y),(0|f)==(0|p))(0|d)==(0|y)&&(r[_>>0]=48,d=_);else if(d>>>0>L>>>0){Ir(0|L,48,d-B|0);do{d=d+-1|0}while(d>>>0>L>>>0)}Yn(t,d,m-d|0),f=f+4|0}while(f>>>0<=P>>>0);if(0|b&&Yn(t,22841,1),f>>>0<A>>>0&(0|u)>0)for(;;){if((d=0|Kn(0|l[f>>2],0,y))>>>0>L>>>0){Ir(0|L,48,d-B|0);do{d=d+-1|0}while(d>>>0>L>>>0)}if(Yn(t,d,(0|u)<9?u:9),d=u+-9|0,!((f=f+4|0)>>>0<A>>>0&(0|u)>9)){u=d;break}u=d}tr(t,48,u+9|0,9,0)}else{if(b=v?A:M+4|0,(0|u)>-1){y=0==(0|y),n=v=L+9|0,m=0-B|0,_=L+8|0,p=M;do{(0|(d=0|Kn(0|l[p>>2],0,v)))==(0|v)&&(r[_>>0]=48,d=_);do{if((0|p)==(0|M)){if(f=d+1|0,Yn(t,d,1),y&(0|u)<1){d=f;break}Yn(t,22841,1),d=f}else{if(d>>>0<=L>>>0)break;Ir(0|L,48,d+m|0);do{d=d+-1|0}while(d>>>0>L>>>0)}}while(0);Yn(t,d,(0|u)>(0|(B=n-d|0))?B:u),u=u-B|0,p=p+4|0}while(p>>>0<b>>>0&(0|u)>-1)}tr(t,48,u+18|0,18,0),Yn(t,x,R-x|0)}tr(t,32,i,c,8192^o)}}while(0);return w=s,0|((0|c)<(0|i)?i:c)}function nr(t){var e;return t=+t,g[v>>3]=t,e=0|l[v>>2],S=0|l[v+4>>2],0|e}function rr(t,e){return+ +function t(e,i){e=+e,i|=0;var n=0,r=0,o=0;switch(g[v>>3]=e,n=0|l[v>>2],r=0|l[v+4>>2],2047&(o=0|Er(0|n,0|r,52))){case 0:0!=e?(e=+t(0x10000000000000000*e,i),n=(0|l[i>>2])-64|0):n=0,l[i>>2]=n;break;case 2047:break;default:l[i>>2]=(2047&o)-1022,l[v>>2]=n,l[v+4>>2]=-2146435073&r|1071644672,e=+g[v>>3]}return+e}(t=+t,e|=0)}function or(t,e,i){t|=0,e|=0;do{if(t){if(e>>>0<128){r[t>>0]=e,t=1;break}if(!(0|l[l[745]>>2])){if(57216==(-128&e|0)){r[t>>0]=e,t=1;break}l[(t=25296)>>2]=84,t=-1;break}if(e>>>0<2048){r[t>>0]=e>>>6|192,r[t+1>>0]=63&e|128,t=2;break}if(e>>>0<55296|57344==(-8192&e|0)){r[t>>0]=e>>>12|224,r[t+1>>0]=e>>>6&63|128,r[t+2>>0]=63&e|128,t=3;break}if((e+-65536|0)>>>0<1048576){r[t>>0]=e>>>18|240,r[t+1>>0]=e>>>12&63|128,r[t+2>>0]=e>>>6&63|128,r[t+3>>0]=63&e|128,t=4;break}l[(t=25296)>>2]=84,t=-1;break}t=1}while(0);return 0|t}function ar(t,e){t|=0,e|=0;var i=0,n=0;for(n=0;;){if((0|h[22843+n>>0])==(0|t)){t=2;break}if(87==(0|(i=n+1|0))){i=22931,n=87,t=5;break}n=i}if(2==(0|t)&&(n?(i=22931,t=5):i=22931),5==(0|t))for(;;){do{t=i,i=i+1|0}while(0!=(0|r[t>>0]));if(!(n=n+-1|0))break;t=5}return 0|function(t,e){return 0|function(t,e){return t|=0,0|(0|(e=(e|=0)?0|Bn(0|l[e>>2],0|l[e+4>>2],t):0)?e:t)}(t|=0,e|=0)}(i,0|l[e+20>>2])}function sr(t,e,i){var n,r;return t|=0,e|=0,1==(0|(i|=0))&&(e=e-(0|l[t+8>>2])+(0|l[t+4>>2])|0),r=t+28|0,(0|l[(n=t+20|0)>>2])>>>0>(0|l[r>>2])>>>0&&(Qr[63&l[t+36>>2]](t,0,0),0==(0|l[n>>2]))?e=-1:(l[t+16>>2]=0,l[r>>2]=0,l[n>>2]=0,(0|Qr[63&l[t+40>>2]](t,e,i))<0?e=-1:(l[t+8>>2]=0,l[t+4>>2]=0,l[t>>2]=-17&l[t>>2],e=0)),0|e}function lr(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var o,a,s=0,c=0,h=0,u=0,d=0;a=w,w=w+128|0,s=a+124|0,h=3036,o=(c=d=a)+124|0;do{l[c>>2]=l[h>>2],c=c+4|0,h=h+4|0}while((0|c)<(0|o));return(e+-1|0)>>>0>2147483646?e?(l[(e=25296)>>2]=75,e=-1):(t=s,e=1,u=4):u=4,4==(0|u)&&(u=e>>>0>(u=-2-t|0)>>>0?u:e,l[d+48>>2]=u,l[(s=d+20|0)>>2]=t,l[d+44>>2]=t,e=t+u|0,l[(t=d+16|0)>>2]=e,l[d+28>>2]=e,e=0|jn(d,i,n),u&&(d=0|l[s>>2],r[d+(((0|d)==(0|l[t>>2]))<<31>>31)>>0]=0)),w=a,0|e}function cr(t,e){return hr(t|=0,e|=0),0|t}function hr(t,e){t|=0;var i=0,n=0;i=e|=0;t:do{if(3&(i^t))n=8;else{if(3&i)do{if(i=0|r[e>>0],r[t>>0]=i,!(i<<24>>24))break t;e=e+1|0,t=t+1|0}while(0!=(3&e|0));if(!((-2139062144&(i=0|l[e>>2])^-2139062144)&i+-16843009))for(n=t;e=e+4|0,t=n+4|0,l[n>>2]=i,!((-2139062144&(i=0|l[e>>2])^-2139062144)&i+-16843009|0);)n=t;n=8}}while(0);if(8==(0|n)&&(n=0|r[e>>0],r[t>>0]=n,n<<24>>24))do{t=t+1|0,n=0|r[(e=e+1|0)>>0],r[t>>0]=n}while(n<<24>>24!=0);return 0|t}function ur(t,e,i){var n,r;return t|=0,e|=0,i|=0,n=w,w=w+16|0,l[(r=n)>>2]=i,i=0|function(t,e,i){return 0|lr(t|=0,2147483647,e|=0,i|=0)}(t,e,r),w=n,0|i}function dr(t,e){return+ +function(t,e){t=+t;var i=0,n=0;return(0|(e|=0))<=1023?(0|e)<-1022&&(t*=2.2250738585072014e-308,i=e+2044|0,t=(n=(0|e)<-2044)?2.2250738585072014e-308*t:t,e=n?(0|i)>-1022?i:-1022:e+1022|0):(t*=8.98846567431158e307,n=e+-2046|0,t=(i=(0|e)>2046)?8.98846567431158e307*t:t,e=i?(0|n)<1023?n:1023:e+-1023|0),i=0|Tr(e+1023|0,0,52),n=S,l[v>>2]=i,l[v+4>>2]=n,+t*+g[v>>3]}(t=+t,e|=0)}function fr(t){return 0|~~+Rr(+(t=+t))}function pr(t,e,i,n){t|=0,n|=0;var o,a,s=0,c=0,h=0,u=0,d=0;o=0|C(i|=0,e|=0),i=0==(0|e)?0:i,u=(0|l[n+76>>2])>-1?0|Cn():0,c=0|r[(s=n+74|0)>>0],r[s>>0]=c+255|c,c=0|l[(s=n+4|0)>>2],h=(a=(0|l[n+8>>2])-c|0)>>>0<o>>>0?a:o,(0|a)>0?(Cr(0|t,0|c,0|h),l[s>>2]=c+h,s=o-h|0,t=t+h|0):s=o;t:do{if(s){for(h=n+32|0;!(0|Hn(n)||(1+(c=0|Qr[63&l[h>>2]](n,t,s))|0)>>>0<2);){if(!(s=s-c|0)){d=13;break t}t=t+c|0}0|u&&kn(),i=((o-s|0)>>>0)/(e>>>0)|0}else d=13}while(0);return 13==(0|d)&&u&&kn(),0|i}function mr(t,e){t|=0;var i=0,n=0,o=0,a=0,s=0,c=0,h=0;(0|l[76+(e|=0)>>2])>=0&&0!=(0|Cn())?(n=255&t,(0|(i=255&t))!=(0|r[e+75>>0])&&(c=0|l[(s=e+20|0)>>2])>>>0<(0|l[e+16>>2])>>>0?(l[s>>2]=c+1,r[c>>0]=n):i=0|In(e,t),kn()):h=3;do{if(3==(0|h)){if(n=255&t,(0|(i=255&t))!=(0|r[e+75>>0])&&(a=0|l[(o=e+20|0)>>2])>>>0<(0|l[e+16>>2])>>>0){l[o>>2]=a+1,r[a>>0]=n;break}i=0|In(e,t)}}while(0);return 0|i}function _r(t){t|=0;var e,i=0,n=0,o=0;e=0|l[665],o=(0|l[e+76>>2])>-1?0|Cn():0;do{if((0|Mn(t,e))<0)t=-1;else{if(10!=(0|r[e+75>>0])&&(n=0|l[(i=e+20|0)>>2])>>>0<(0|l[e+16>>2])>>>0){l[i>>2]=n+1,r[n>>0]=10,t=0;break}t=(0|In(e,10))>>31}}while(0);return 0|o&&kn(),0|t}function gr(t){var e=0;return e=128&l[(t|=0)>>2]&&(0|l[t+20>>2])>>>0>(0|l[t+28>>2])>>>0?2:1,(0|(e=0|Qr[63&l[t+40>>2]](t,0,e)))>=0&&(e=e-(0|l[t+8>>2])+(0|l[t+4>>2])+(0|l[t+20>>2])-(0|l[t+28>>2])|0),0|e}function yr(t,e,i,n){var r,o;return e|=0,n|=0,i=0|function(t,e){var i,n,r,o=0;return t=((i=0|C(o=65535&(e|=0),r=65535&(t|=0)))>>>16)+(0|C(o,n=t>>>16))|0,e=0|C(o=e>>>16,r),0|(S=(t>>>16)+(0|C(o,n))+(((65535&t)+e|0)>>>16)|0,t+e<<16|65535&i|0)}(r=t|=0,o=i|=0),t=S,0|(S=(0|C(e,o))+(0|C(n,r))+t|0&t,0|i)}function br(t,e,i,n){return 0|(S=(e|=0)+(n|=0)+((i=(t|=0)+(i|=0)>>>0)>>>0<t>>>0|0)>>>0,0|i)}function vr(t,e,i,n){return 0|(S=n=(e|=0)-(n|=0)-((i|=0)>>>0>(t|=0)>>>0|0)>>>0,t-i>>>0|0)}function wr(t){var e=0;return(0|(e=0|r[x+(255&(t|=0))>>0]))<8?0|e:(0|(e=0|r[x+(t>>8&255)>>0]))<8?e+8|0:(0|(e=0|r[x+(t>>16&255)>>0]))<8?e+16|0:24+(0|r[x+(t>>>24)>>0])|0}function xr(t,e,i,n,r){r|=0;var o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0;if(u=t|=0,a=i|=0,s=f=n|=0,!(h=c=e|=0))return o=0!=(0|r),s?o?(l[r>>2]=0|t,l[r+4>>2]=0&e,0|(S=f=0,r=0)):0|(S=f=0,r=0):(o&&(l[r>>2]=(u>>>0)%(a>>>0),l[r+4>>2]=0),0|(S=f=0,r=(u>>>0)/(a>>>0)>>>0));o=0==(0|s);do{if(a){if(!o){if((o=(0|I(0|s))-(0|I(0|h))|0)>>>0<=31){a=d=o+1|0,t=u>>>(d>>>0)&(e=o-31>>31)|h<<(s=31-o|0),e&=h>>>(d>>>0),o=0,s=u<<s;break}return r?(l[r>>2]=0|t,l[r+4>>2]=c|0&e,0|(S=f=0,r=0)):0|(S=f=0,r=0)}if((o=a-1|0)&a|0){a=s=33+(0|I(0|a))-(0|I(0|h))|0,t=(d=32-s|0)-1>>31&h>>>((p=s-32|0)>>>0)|(h<<d|u>>>(s>>>0))&(e=p>>31),e&=h>>>(s>>>0),o=u<<(m=64-s|0)&(c=d>>31),s=(h<<m|u>>>(p>>>0))&c|u<<d&s-33>>31;break}return 0|r&&(l[r>>2]=o&u,l[r+4>>2]=0),1==(0|a)?0|(S=p=c|0&e,m=0|t):(m=0|wr(0|a),0|(S=p=h>>>(m>>>0)|0,m=h<<32-m|u>>>(m>>>0)|0))}if(o)return 0|r&&(l[r>>2]=(h>>>0)%(a>>>0),l[r+4>>2]=0),0|(S=p=0,m=(h>>>0)/(a>>>0)>>>0);if(!u)return 0|r&&(l[r>>2]=0,l[r+4>>2]=(h>>>0)%(s>>>0)),0|(S=p=0,m=(h>>>0)/(s>>>0)>>>0);if(!((o=s-1|0)&s))return 0|r&&(l[r>>2]=0|t,l[r+4>>2]=o&h|0&e),p=0,m=h>>>((0|wr(0|s))>>>0),0|(S=p,m);if((o=(0|I(0|s))-(0|I(0|h))|0)>>>0<=30){a=e=o+1|0,t=h<<(s=31-o|0)|u>>>(e>>>0),e=h>>>(e>>>0),o=0,s=u<<s;break}return r?(l[r>>2]=0|t,l[r+4>>2]=c|0&e,0|(S=p=0,m=0)):0|(S=p=0,m=0)}while(0);if(a){h=0|br(0|(d=0|i),0|(u=f|0&n),-1,-1),i=S,c=s,s=0;do{n=c,c=o>>>31|c<<1,o=s|o<<1,vr(0|h,0|i,0|(n=t<<1|n>>>31|0),0|(f=t>>>31|e<<1|0)),s=1&(p=(m=S)>>31|((0|m)<0?-1:0)<<1),t=0|vr(0|n,0|f,p&d|0,(((0|m)<0?-1:0)>>31|((0|m)<0?-1:0)<<1)&u|0),e=S,a=a-1|0}while(0!=(0|a));h=c,c=0}else h=s,c=0,s=0;return a=0,0|r&&(l[r>>2]=t,l[r+4>>2]=e),0|(S=p=(0|o)>>>31|(h|a)<<1|0&(a<<1|o>>>31)|c,m=-2&(o<<1|0)|s)}function Ar(t,e,i,n){return 0|xr(t|=0,e|=0,i|=0,n|=0,0)}function Sr(t,e,i,n){var r,o;return o=w,w=w+16|0,xr(t|=0,e|=0,i|=0,n|=0,r=0|o),w=o,0|(S=0|l[r+4>>2],0|l[r>>2])}function Mr(t,e,i){return t|=0,e|=0,(0|(i|=0))<32?(S=e>>i,t>>>i|(e&(1<<i)-1)<<32-i):(S=(0|e)<0?-1:0,e>>i-32|0)}function Er(t,e,i){return t|=0,e|=0,(0|(i|=0))<32?(S=e>>>i,t>>>i|(e&(1<<i)-1)<<32-i):(S=0,e>>>i-32|0)}function Tr(t,e,i){return t|=0,e|=0,(0|(i|=0))<32?(S=e<<i|(t&(1<<i)-1<<32-i)>>>32-i,t<<i):(S=t<<i-32,0)}function kr(t){return(255&(t|=0))<<24|(t>>8&255)<<16|(t>>16&255)<<8|t>>>24|0}function Cr(t,e,i){t|=0,e|=0;var n,o,a=0;if((0|(i|=0))>=8192)return 0|j(0|t,0|e,0|i);if(o=0|t,n=t+i|0,(3&t)==(3&e)){for(;3&t;){if(!i)return 0|o;r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0,i=i-1|0}for(a=(i=-4&n|0)-64|0;(0|t)<=(0|a);)l[t>>2]=l[e>>2],l[t+4>>2]=l[e+4>>2],l[t+8>>2]=l[e+8>>2],l[t+12>>2]=l[e+12>>2],l[t+16>>2]=l[e+16>>2],l[t+20>>2]=l[e+20>>2],l[t+24>>2]=l[e+24>>2],l[t+28>>2]=l[e+28>>2],l[t+32>>2]=l[e+32>>2],l[t+36>>2]=l[e+36>>2],l[t+40>>2]=l[e+40>>2],l[t+44>>2]=l[e+44>>2],l[t+48>>2]=l[e+48>>2],l[t+52>>2]=l[e+52>>2],l[t+56>>2]=l[e+56>>2],l[t+60>>2]=l[e+60>>2],t=t+64|0,e=e+64|0;for(;(0|t)<(0|i);)l[t>>2]=l[e>>2],t=t+4|0,e=e+4|0}else for(i=n-4|0;(0|t)<(0|i);)r[t>>0]=0|r[e>>0],r[t+1>>0]=0|r[e+1>>0],r[t+2>>0]=0|r[e+2>>0],r[t+3>>0]=0|r[e+3>>0],t=t+4|0,e=e+4|0;for(;(0|t)<(0|n);)r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0;return 0|o}function Ir(t,e,i){e|=0;var n,o=0,a=0,s=0;if(n=(t|=0)+(i|=0)|0,e&=255,(0|i)>=67){for(;3&t;)r[t>>0]=e,t=t+1|0;for(a=(o=-4&n|0)-64|0,s=e|e<<8|e<<16|e<<24;(0|t)<=(0|a);)l[t>>2]=s,l[t+4>>2]=s,l[t+8>>2]=s,l[t+12>>2]=s,l[t+16>>2]=s,l[t+20>>2]=s,l[t+24>>2]=s,l[t+28>>2]=s,l[t+32>>2]=s,l[t+36>>2]=s,l[t+40>>2]=s,l[t+44>>2]=s,l[t+48>>2]=s,l[t+52>>2]=s,l[t+56>>2]=s,l[t+60>>2]=s,t=t+64|0;for(;(0|t)<(0|o);)l[t>>2]=s,t=t+4|0}for(;(0|t)<(0|n);)r[t>>0]=e,t=t+1|0;return n-i|0}function Pr(t){return(t=+t)>=0?+M(t+.5):+k(t-.5)}function Rr(t){return(t=+t)-+M(t)!=.5?+Pr(t):2*+Pr(t/2)}function Br(t){var e,i;return(0|(i=15+(t|=0)&-16|0))>0&(0|(t=(e=0|l[b>>2])+i|0))<(0|e)|(0|t)<0?(L(),O(12),-1):(l[b>>2]=t,(0|t)>(0|B())&&0==(0|R())?(l[b>>2]=e,O(12),-1):0|e)}function Lr(t){return P(0),0}function Dr(t){return P(1),0}function Or(t,e){return P(2),0}function Fr(t,e,i){return P(3),0}function Gr(t,e,i,n){return P(4),0}function Nr(t,e,i,n,r){return P(5),0}function zr(t,e,i,n,r,o){return P(6),0}function Ur(t,e,i,n,r,o,a){return P(7),0}function Hr(t,e,i,n,r,o,a,s,l,c,h){return P(8),0}function Vr(t){P(9)}function Wr(t,e){P(10)}function jr(t,e,i){P(11)}function Zr(t,e,i,n){P(12)}e._llvm_ceil_f32,e._llvm_floor_f32,e._llvm_floor_f64,e._llvm_pow_f64,e.flush_NO_FILESYSTEM;var Yr=[Lr,function(t){return 0},function(t){return+ +(((14*(0|l[5588+(t|=0)>>2])|0)-14|0)>>>0)},Lr],Xr=[Dr,function(t){var e,i;return e=w,w=w+16|0,i=e,t=0|function(t){return 0|(t|=0)}(0|l[60+(t|=0)>>2]),l[i>>2]=t,t=0|xn(0|V(6,0|i)),w=e,0|t},ue,de,function(t){return 0|ue(0|l[(t|=0)>>2])},function(t){return 0|de(0|l[(t|=0)>>2])},zn,function(t){return 0},function(t){return 0|(0==(0|(t|=0))?0:(t+-1|0)>>>0<2?1:2)},Dr,Dr,Dr,Dr,Dr,Dr,Dr],Jr=[Or,function(t,e){t|=0,e|=0;var i=0;return(i=0|Ut(1,22))?(it(i,22,4),it(i+4|0,1768449138,4),it(i+8|0,0|l[t+16>>2],4),it(i+12|0,0|l[t+12>>2],4),it(i+16|0,0|l[t+20>>2],2),it(i+18|0,0|l[t+24>>2],1),it(i+19|0,0|l[t+28>>2],1),it(i+20|0,0|l[t+32>>2],1),it(i+21|0,0|l[t+36>>2],1),l[e>>2]=22,0|i):0|(i=0)},function(t,e){e|=0;var i,n=0,r=0,o=0,a=0,s=0;switch(0|l[(n=40+(t|=0)|0)>>2]){case 1:a=15;break;case 2:a=11+(0|l[t+112>>2])|0;break;default:return 0|(s=0)}if(!(s=0|Ut(1,a)))return 0|(s=0);switch(it(s,a,4),it(s+4|0,1668246642,4),it(s+8|0,0|l[n>>2],1),it(s+9|0,0|l[t+52>>2],1),it(s+10|0,0|l[t+44>>2],1),i=s+11|0,0|l[n>>2]){case 1:it(i,0|l[t+48>>2],4);break;case 2:if(0|l[(o=t+112|0)>>2])for(r=t+108|0,n=i,t=0;it(n,0|h[(0|l[r>>2])+t>>0],1),!((t=t+1|0)>>>0>=(0|l[o>>2])>>>0);)n=n+1|0}return l[e>>2]=a,0|s},function(t,e){e|=0;var i,n,r,o=0,s=0,c=0;if(!(r=0|zt(n=10+(6*(0|d[4+(0|l[(i=116+(t|=0)|0)>>2])>>1])|0)|0)))return 0|(e=0);if(it(r,n,4),it(r+4|0,1667523942,4),it(r+8|0,0|d[4+(0|l[i>>2])>>1],2),t=0|l[i>>2],0|a[t+4>>1])for(s=r+10|0,c=0,o=0;it(s,0|d[(0|l[t>>2])+(6*o|0)>>1],2),it(s+2|0,0|d[(0|l[l[i>>2]>>2])+(6*o|0)+2>>1],2),it(s+4|0,0|d[(0|l[l[i>>2]>>2])+(6*o|0)+4>>1],2),o=c+1<<16>>16,t=0|l[i>>2],!((65535&o)>=(0|d[t+4>>1]));)s=s+6|0,c=o,o&=65535;return l[e>>2]=n,0|(e=r)},function(t,e){e|=0;var i,n,r=0,o=0,a=0;if(!(a=0|Ut(1,n=8+(0|l[(i=20+(t|=0)|0)>>2])|0)))return 0|(a=0);if(it(a,n,4),it(a+4|0,1651532643,4),0|l[i>>2])for(o=t+72|0,t=0,r=a+8|0;it(r,0|l[(0|l[o>>2])+(12*t|0)+8>>2],1),!((t=t+1|0)>>>0>=(0|l[i>>2])>>>0);)r=r+1|0;return l[e>>2]=n,0|a},Or,Or,Or],Qr=[Fr,function(t,e,i){e|=0,i|=0;var n,o=0;return n=w,w=w+32|0,o=n,l[36+(t|=0)>>2]=61,0==(64&l[t>>2]|0)&&(l[o>>2]=l[t+60>>2],l[o+4>>2]=21523,l[o+8>>2]=n+16,0|H(54,0|o))&&(r[t+75>>0]=-1),o=0|wn(t,e,i),w=n,0|o},function(t,e,i){var n,r,o;return t|=0,e|=0,i|=0,r=w,w=w+32|0,n=r+20|0,l[(o=r)>>2]=l[t+60>>2],l[o+4>>2]=0,l[o+8>>2]=e,l[o+12>>2]=n,l[o+16>>2]=i,(0|xn(0|F(140,0|o)))<0?(l[n>>2]=-1,t=-1):t=0|l[n>>2],w=r,0|t},function(t,e,i){var n,r;return e|=0,i|=0,Cr(0|(r=0|l[(n=20+(t|=0)|0)>>2]),0|e,0|(t=(t=(0|l[t+16>>2])-r|0)>>>0>i>>>0?i:t)),l[n>>2]=(0|l[n>>2])+t,0|i},function(t,e,i){return-1},function(t,e,i){return-1},function(t,e,i){return S=-1,-1},function(t,e,i){return 0},ge,we,function(t,e,i){return e|=0,i|=0,0|ge(0|l[(t|=0)>>2],e,i)},function(t,e,i){e|=0,i|=0;var n,r=0,o=0,a=0,s=0;if(!(0|gi(0|l[(r=8+(t|=0)|0)>>2],54,i)))return 0|(s=0);if(!(0|we(0|l[t>>2],e,i)))return 0|(s=0);if(n=0|yi(s=0|l[r>>2]),r=0|bi(s),n)for(o=r,r=1,a=0;r=r?0!=(0|Qr[63&l[o>>2]](t,e,i)):0,r&=1,(0|(a=a+1|0))!=(0|n);)o=o+4|0;else r=1;return vi(s),0|(s=r)},$t,_e,function(t,e,i){e|=0,i|=0;var n,r,o=0,a=0,s=0;if(!(0|gi(0|l[(o=8+(t|=0)|0)>>2],53,i)))return 0|(i=0);if(r=0|yi(n=0|l[o>>2]),o=0|bi(n),r){for(a=1,s=0;a=a?0!=(0|Qr[63&l[o>>2]](t,e,i)):0,(0|(s=s+1|0))!=(0|r);)o=o+4|0,a&=1;if(vi(n),!a)return 0|(i=0)}else vi(n);return 0|(i=0|$t(l[t>>2]))},function(t,e,i){return e|=0,i|=0,0|_e(0|l[(t|=0)>>2],e,i)},function(t,e,i){t|=0,e|=0;var n,r=0;return r=0|l[(n=4+(i|=0)|0)>>2],(i=(0|l[i>>2])+(0|l[i+8>>2])-r|0)?(Cr(0|t,0|r,0|(e=i>>>0>e>>>0?e:i)),l[n>>2]=(0|l[n>>2])+e,0|(r=e)):0|(r=-1)},function(t,e,i){t|=0,e|=0;var n,r,o=0,a=0,s=0,c=0;for(o=0|l[(c=4+(i|=0)|0)>>2],a=0|l[(n=i+8|0)>>2],r=o-(0|l[i>>2])|0,s=0==(0|a)?1:a;(s-r|0)>>>0<e>>>0;)s<<=1;if((0|s)!=(0|a)){if(!(o=0|zt(s)))return 0|(c=-1);0|(a=0|l[i>>2])&&(Cr(0|o,0|a,0|r),jt(0|l[i>>2])),l[i>>2]=o,o=o+r|0,l[c>>2]=o,l[n>>2]=s}return Cr(0|o,0|t,0|e),l[c>>2]=(0|l[c>>2])+e,0|(c=e)},function(t,e,i){t|=0,e|=0;var n,r,o=0,a=0;return a=0|l[(o=4+(i|=0)|0)>>2],n=((0|(i=(0|l[i>>2])+(0|l[i+8>>2])-a|0))<0)<<31>>31,i?(r=(0|n)>(0|e)|(0|n)==(0|e)&i>>>0>t>>>0,l[o>>2]=a+t,S=o=r?e:n,0|(a=r?t:i)):(S=o=-1,0|(a=-1))},function(t,e,i){var n;return t|=0,e|=0,n=0|l[8+(i|=0)>>2],l[i+4>>2]=(0|l[i>>2])+(0>(0|e)|0==(0|e)&n>>>0>t>>>0?t:n),1},function(t,e,i){return 0|(0|(i=0|pr(t|=0,1,e|=0,i|=0))?i:-1)},function(t,e,i){return 0|En(t|=0,1,e|=0,i|=0)},function(t,e,i){return e|=0,i=0==(0|Vn(i|=0,t|=0,1)),S=i?e:-1,0|(i?t:-1)},function(t,e,i){return 0==(0|Vn(i|=0,t|=0,0))|0},function(t,e,i){return 1},function(t,e,i){return 0==(0|l[8+(t|=0)>>2])&0!=(0|l[t+188>>2])&0!=(0|l[t+192>>2])&1|0},function(t,e,i){e|=0,i|=0;var n,o,s,c,h,u,d,f,p,m,_,g,y,b,v,x,A,M,E,T,k,C,I,P,R,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0,Z=0,Y=0,X=0,J=0;R=w,w=w+224|0,J=R+200|0,I=R+192|0,C=R+184|0,T=R+176|0,E=R+168|0,M=R+160|0,Z=R+152|0,A=R+144|0,x=R+136|0,b=R+128|0,y=R+120|0,g=R+112|0,_=R+104|0,m=R+96|0,p=R+88|0,f=R+80|0,d=R+72|0,u=R+64|0,h=R+56|0,c=R+48|0,s=R+40|0,v=R+32|0,U=R+24|0,z=R+16|0,N=R+8|0,k=R,B=R+216|0,L=R+212|0,n=R+208|0,o=R+204|0,l[(P=8+(t|=0)|0)>>2]=1;t:do{if(2==(0|lt(e,B,2,i))&&(nt(B,L,2),65359==(0|l[L>>2]))){l[P>>2]=2,G=0|br(0|(G=0|ht(e)),0|S,-2,-1),F=S,L=0|l[(X=t+196|0)>>2],l[L>>2]=G,l[L+4>>2]=F,l[(L=k)>>2]=G,l[L+4>>2]=F,mt(i,4,8053,k),L=0|l[X>>2],F=0|l[L>>2],B=0|l[(G=L+24|0)>>2],D=0|l[(O=L+32|0)>>2];do{if((B+1|0)>>>0>D>>>0){if(j=~~(+(D>>>0)+100)>>>0,l[O>>2]=j,L=0|Wt(0|l[(B=L+28|0)>>2],24*j|0)){l[B>>2]=L,B=0|l[G>>2];break}jt(0|l[B>>2]),l[B>>2]=0,l[O>>2]=0,l[G>>2]=0,mt(i,1,8090,N);break t}L=0|l[L+28>>2]}while(0);if(a[L+(24*B|0)>>1]=-177,W=0|Mr(0,0|F,32),l[(j=L+(24*B|0)+8|0)>>2]=W,l[j+4>>2]=S,l[L+(24*B|0)+16>>2]=2,l[G>>2]=B+1,2!=(0|lt(e,0|l[(j=t+16|0)>>2],2,i)))return mt(i,1,8150,U),w=R,0|(J=0);if(nt(0|l[j>>2],n,2),65424!=(0|(O=0|l[n>>2]))){W=t+20|0,D=0,L=0,B=0;e:do{if(O>>>0<65280){Y=14;break}for(F=784;!((N=0==(0|(G=0|l[F>>2])))|(0|G)==(0|O));)F=F+12|0;if(N){mt(i,2,8219,s),V=2;i:for(;;){for(;;){if(2!=(0|lt(e,0|l[j>>2],2,i))){Y=20;break e}if(nt(0|l[j>>2],k,2),(O=0|l[k>>2])>>>0>=65280){H=784;break}}for(;!(0==(0|(F=0|l[H>>2]))|(0|F)==(0|O));)H=H+12|0;if(!(l[H+4>>2]&l[P>>2])){Y=24;break e}if((0|F)>=65424){Y=99;break}switch(0|F){case 0:break;default:break i}V=V+2|0}if(99==(0|Y))switch(Y=0,0|F){case 65424:Y=26;break e}if(F=0|l[X>>2],z=(z=0|ht(e))-V|0,(1+(O=0|l[(U=F+24|0)>>2])|0)>>>0>(G=0|l[(N=F+32|0)>>2])>>>0){if(G=~~(+(G>>>0)+100)>>>0,l[N>>2]=G,!(F=0|Wt(0|l[(O=F+28|0)>>2],24*G|0))){Y=31;break}l[O>>2]=F,O=0|l[U>>2]}else F=0|l[F+28>>2];if(a[F+(24*O|0)>>1]=0,l[(N=F+(24*O|0)+8|0)>>2]=z,l[N+4>>2]=((0|z)<0)<<31>>31,l[F+(24*O|0)+16>>2]=V,l[U>>2]=O+1,F=0|l[H>>2],l[n>>2]=F,65424==(0|F))break;for(O=784;;){if(0==(0|(G=0|l[O>>2]))|(0|G)==(0|F)){N=O;break}O=O+12|0}}else N=F;if(B=65361==(0|G)?1:B,L=65362==(0|G)?1:L,D=65372==(0|G)?1:D,!(l[N+4>>2]&l[P>>2])){Y=37;break}if(2!=(0|lt(e,0|l[j>>2],2,i))){Y=39;break}if(nt(0|l[j>>2],o,2),F=(0|l[o>>2])-2|0,l[o>>2]=F,O=0|l[j>>2],F>>>0>(0|l[W>>2])>>>0){if(!(O=0|Wt(O,F))){Y=42;break}l[j>>2]=O,F=0|l[o>>2],l[W>>2]=F}if((0|(O=0|lt(e,O,F,i)))!=(0|l[o>>2])){Y=45;break}if(!(0|qr[63&l[N+8>>2]](t,0|l[j>>2],O,i))){Y=47;break}if(G=0|l[X>>2],z=0|l[N>>2],U=0|ht(e),U=-4-(H=0|l[o>>2])+U|0,H=H+4|0,(1+(O=0|l[(V=G+24|0)>>2])|0)>>>0>(F=0|l[(N=G+32|0)>>2])>>>0){if(F=~~(+(F>>>0)+100)>>>0,l[N>>2]=F,!(F=0|Wt(0|l[(O=G+28|0)>>2],24*F|0))){Y=52;break}l[O>>2]=F,O=0|l[V>>2]}else F=0|l[G+28>>2];if(a[F+(24*O|0)>>1]=z,l[(z=F+(24*O|0)+8|0)>>2]=U,l[z+4>>2]=((0|U)<0)<<31>>31,l[F+(24*O|0)+16>>2]=H,l[V>>2]=O+1,2!=(0|lt(e,0|l[j>>2],2,i))){Y=54;break}nt(0|l[j>>2],n,2),O=0|l[n>>2]}while(65424!=(0|O));switch(0|Y){case 14:return l[v>>2]=O,mt(i,1,8168,v),w=R,0|(J=0);case 20:mt(i,1,8150,c),Y=33;break;case 24:mt(i,1,8235,h),Y=33;break;case 26:l[n>>2]=65424;break;case 31:jt(0|l[O>>2]),l[O>>2]=0,l[N>>2]=0,l[U>>2]=0,mt(i,1,8090,u),Y=33;break;case 37:return mt(i,1,8235,f),w=R,0|(J=0);case 39:return mt(i,1,8150,p),w=R,0|(J=0);case 42:return jt(0|l[j>>2]),l[j>>2]=0,l[W>>2]=0,mt(i,1,8333,m),w=R,0|(J=0);case 45:return mt(i,1,8150,_),w=R,0|(J=0);case 47:return mt(i,1,8367,g),w=R,0|(J=0);case 52:return jt(0|l[O>>2]),l[O>>2]=0,l[N>>2]=0,l[V>>2]=0,mt(i,1,8090,y),w=R,0|(J=0);case 54:return mt(i,1,8150,b),w=R,0|(J=0)}if(33==(0|Y))return mt(i,1,8278,d),w=R,0|(J=0);if(0|B){if(!L)return mt(i,1,8472,A),w=R,0|(J=0);if(!D)return mt(i,1,8518,Z),w=R,0|(J=0);e:do{if(1&r[t+184>>0]){B=0|l[(W=t+120|0)>>2];do{if(B){U=t+124|0,N=0,L=0,z=0;i:for(;;){if(D=0|l[U>>2],F=0|l[D+(z<<3)>>2]){if(G=(D=0|l[D+(z<<3)+4>>2])-N|0,D=(O=N>>>0<D>>>0)?0:N-D|0,!(0==(0|G)|1^O)){for(B=O?F+N|0:F;;){if(G>>>0<4){Y=72;break i}if(nt(B,k,4),B=B+4|0,Z=G+-4|0,L=(O=0|l[k>>2])+L|0,D=(F=Z>>>0<O>>>0)?O-Z|0:D,!(G=F?0:Z-O|0))break;B=F?B:B+O|0}B=0|l[W>>2]}}else D=N;if((z=z+1|0)>>>0>=B>>>0)break;N=D}if(72==(0|Y)){mt(i,1,8564,M);break}D?mt(i,1,8595,E):Y=76}else L=0,Y=76}while(0);i:do{if(76==(0|Y)){if(D=0|zt(L),l[(U=t+144|0)>>2]=D,!D){mt(i,1,8618,T);break}l[(H=t+132|0)>>2]=L,O=0|l[W>>2],V=t+124|0;do{if(O){z=0,F=0,N=0,L=B=0|l[V>>2];n:for(;;){if(G=0|l[L+(z<<3)>>2]){L=0|l[L+(z<<3)+4>>2],B=(0|l[U>>2])+F|0;r:do{if(N>>>0<L>>>0){if(Cr(0|B,0|G,0|N),B=F+N|0,!(D=L-N|0)){D=0;break}for(L=G+N|0;;){if(D>>>0<4){Y=91;break n}if(nt(L,k,4),F=L+4|0,O=D+-4|0,L=0|l[k>>2],D=(0|l[U>>2])+B|0,O>>>0<L>>>0)break;if(Cr(0|D,0|F,0|L),B=(L=0|l[k>>2])+B|0,!(D=O-L|0)){D=0;break r}L=F+L|0}Cr(0|D,0|F,0|O),D=(0|l[k>>2])-O|0,B=O+B|0}else Cr(0|B,0|G,0|L),D=N-L|0,B=L+F|0}while(0);jt(0|l[(0|l[V>>2])+(z<<3)>>2]),L=0|l[V>>2],l[L+(z<<3)>>2]=0,l[L+(z<<3)+4>>2]=0,F=B,O=0|l[W>>2],B=L}else D=N;if((z=z+1|0)>>>0>=O>>>0){Y=93;break}N=D}if(91==(0|Y)){mt(i,1,8564,C);break i}if(93==(0|Y)){D=0|l[U>>2],L=0|l[H>>2];break}}else B=0|l[V>>2]}while(0);l[t+128>>2]=D,l[t+152>>2]=L,l[W>>2]=0,jt(B),l[V>>2]=0;break e}}while(0);return mt(i,1,8656,I),w=R,0|(J=0)}}while(0);return mt(i,4,8682,J),i=0|ht(e),J=8+(0|l[X>>2])|0,l[J>>2]=i+-2,l[J+4>>2]=0,l[P>>2]=8,w=R,0|(J=1)}}return mt(i,1,8426,x),w=R,0|(J=0)}}while(0);return mt(i,1,8126,z),w=R,0|(J=0)},function(t,e,i){e|=0,i|=0;var n,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0;u=w,w=w+16|0,h=u,s=0|l[80+(t|=0)>>2],c=t+88|0,n=0|C(0|l[t+112>>2],0|l[t+116>>2]),o=1080*(A=0|l[s+16>>2])|0,a=0|l[t+12>>2],A=0|C(A<<2,A);t:do{if(0|n){S=a+5604|0,M=a+5620|0,E=a+5612|0,T=a+5616|0,k=a+5632|0,I=a+5624|0,P=a+5584|0,v=0|l[t+164>>2],x=0;e:for(;;){if(R=0|l[(_=v+5584|0)>>2],Cr(0|v,0|a,5640),r[(e=v+5636|0)>>0]=-4&r[e>>0],l[v+5168>>2]=0,l[(e=v+5604|0)>>2]=0,l[(g=v+5620|0)>>2]=0,l[(B=v+5612|0)>>2]=0,l[(y=v+5632|0)>>2]=0,l[(b=v+5624|0)>>2]=0,l[_>>2]=R,0|l[S>>2]){if(d=0|zt(A),l[e>>2]=d,!d){e=0,d=25;break}Cr(0|d,0|l[S>>2],0|A)}if(d=0|zt(e=20*(0|l[M>>2])|0),l[B>>2]=d,!d){e=0,d=25;break}if(Cr(0|d,0|l[E>>2],0|e),0|(e=0|l[T>>2]))for(p=0|l[B>>2],m=0|l[E>>2],_=0;;){if(0|l[(f=m+12|0)>>2]){if(d=0|zt(0|l[(e=m+16|0)>>2]),l[p+12>>2]=d,!d){e=0,d=25;break e}Cr(0|d,0|l[f>>2],0|l[e>>2]),e=0|l[T>>2]}if(l[g>>2]=1+(0|l[g>>2]),(_=_+1|0)>>>0>=e>>>0)break;p=p+20|0,m=m+20|0}if(d=0|zt(e=20*(0|l[k>>2])|0),l[b>>2]=d,!d){e=0,d=25;break}if(Cr(0|d,0|l[I>>2],0|e),l[y>>2]=l[k>>2],0|(m=0|l[k>>2]))for(p=0|l[I>>2],d=0|l[b>>2],f=0;0|(e=0|l[p+8>>2])&&(l[d+8>>2]=(0|l[B>>2])+(20*((e-(0|l[E>>2])|0)/20|0)|0)),0|(e=0|l[p+12>>2])&&(l[d+12>>2]=(0|l[B>>2])+(20*((e-(0|l[E>>2])|0)/20|0)|0)),!((f=f+1|0)>>>0>=m>>>0);)p=p+20|0,d=d+20|0;if(Cr(0|R,0|l[P>>2],0|o),(x=x+1|0)>>>0>=n>>>0)break t;v=v+5640|0}if(25==(0|d))return w=u,0|e}}while(0);return d=0|Xe(1),l[(e=t+204|0)>>2]=d,d?0|Ke(d,s,c)?(w=u,0|(i=1)):($e(0|l[e>>2]),l[e>>2]=0,mt(i,1,8019,h),w=u,0|(i=0)):(w=u,0|(i=0))},function(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p,m,_,g,y,b,v=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0;if(b=w,w=w+80|0,p=b+32|0,m=b+24|0,I=b+16|0,k=b+8|0,y=b+60|0,c=b+56|0,h=b+52|0,u=b+48|0,d=b+44|0,f=b+40|0,n=b+36|0,l[(s=b+64|0)>>2]=1,!(v=0|zt(1e3)))return mt(i,1,14664,b),w=b,0|(I=0);for(_=t+116|0,g=t+112|0,r=t+204|0,o=t+84|0,a=t+8|0,T=0,x=1e3;;){if(!(0|ne(t,y,c,h,u,d,f,n,s,e,i))){x=5;break}if(!(0|l[s>>2])){x=17;break}if((E=0|l[c>>2])>>>0>x>>>0){if(!(x=0|Wt(v,E))){x=9;break}v=x,M=E}else M=x;if(!(0|re(t,A=0|l[y>>2],v,E,e,i))){x=11;break}if(x=A+1|0,E=0|C(0|l[g>>2],0|l[_>>2]),l[m>>2]=x,l[m+4>>2]=E,mt(i,4,14768,m),E=0|l[r>>2],!(0|pe(0|l[20+(0|l[l[E+20>>2]>>2])>>2],0|l[E+24>>2],v,0|l[24+(0|l[o>>2])>>2]))){x=13;break}if(l[p>>2]=x,mt(i,4,14798,p),0==(0|(E=0|ut(e)))&0==(0|S)&&64==(0|l[a>>2])){x=17;break}if((0|(T=T+1|0))==(0|C(0|l[g>>2],0|l[_>>2]))){x=17;break}x=M}return 5==(0|x)?(jt(v),w=b,0|(I=0)):9==(0|x)?(jt(v),I=0|C(0|l[g>>2],0|l[_>>2]),l[k>>2]=1+(0|l[y>>2]),l[k+4>>2]=I,mt(i,1,14699,k),w=b,0|(I=0)):11==(0|x)?(jt(v),k=0|C(0|l[g>>2],0|l[_>>2]),l[I>>2]=A+1,l[I+4>>2]=k,mt(i,1,14739,I),w=b,0|(I=0)):13==(0|x)?(jt(v),w=b,0|(I=0)):17==(0|x)?(jt(v),w=b,0|(I=1)):0},function(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p,m,_,g,y,b=0,v=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0;if(y=w,w=w+96|0,m=y+56|0,p=y+48|0,f=y+40|0,g=y+32|0,_=y+24|0,E=y+16|0,M=y+8|0,a=y+88|0,s=y+84|0,c=y+80|0,h=y+76|0,u=y+72|0,d=y+68|0,n=y+64|0,l[(o=y+92|0)>>2]=1,!(b=0|zt(1e3)))return mt(i,1,14941,y),w=y,0|(R=0);v=0|l[(r=t+196|0)>>2],x=0|l[v+40>>2];t:do{if(!x){x=0|C(0|l[t+116>>2],0|l[t+112>>2]),l[v+36>>2]=x,x=0|Ut(x,40),v=0|l[r>>2],l[v+40>>2]=x;e:do{if(0|x){if(0|l[v+36>>2]){A=0;do{if(l[x+(40*A|0)+28>>2]=100,l[x+(40*A|0)+20>>2]=0,P=0|Ut(100,24),v=0|l[r>>2],x=0|l[v+40>>2],l[x+(40*A|0)+24>>2]=P,A=A+1|0,!P)break e}while(A>>>0<(0|l[v+36>>2])>>>0)}if(v=0|l[t+60>>2],x){A=v,R=11;break t}break t}}while(0);return jt(b),w=y,0|(R=0)}A=0|l[t+60>>2],R=11}while(0);if(11==(0|R))if(0|l[x+16>>2]){if(0|l[x+(40*A|0)+4>>2]){if(P=0|l[x+(40*A|0)+16>>2],!(0|et(e,P=0|br(0|l[P>>2],0|l[P+4>>2],2,0),S,i)))return mt(i,1,14979,E),jt(b),w=y,0|(R=0)}else if(!(0|et(e,P=0|br(0|l[(P=t+64|0)>>2],0|l[P+4>>2],2,0),S,i)))return mt(i,1,14979,M),jt(b),w=y,0|(R=0);256==(0|l[(v=t+8|0)>>2])?(l[v>>2]=8,v=A):v=A}else v=A;t:do{if(0|ne(t,a,s,c,h,u,d,n,o,e,i)){for(E=t+116|0,T=t+112|0,k=t+204|0,I=t+84|0,P=v+1|0,x=1e3;0|l[o>>2];){if((A=0|l[s>>2])>>>0>x>>>0){if(!(x=0|Wt(b,A))){R=25;break}b=x,x=A}if(!(0|re(t,M=0|l[a>>2],b,A,e,i))){R=27;break}if(A=M+1|0,B=0|C(0|l[T>>2],0|l[E>>2]),l[g>>2]=A,l[g+4>>2]=B,mt(i,4,14768,g),B=0|l[k>>2],!(0|pe(0|l[20+(0|l[l[B+20>>2]>>2])>>2],0|l[B+24>>2],b,0|l[24+(0|l[I>>2])>>2]))){R=29;break}if(l[f>>2]=A,mt(i,4,14798,f),(0|M)==(0|v)){R=31;break}if(l[m>>2]=A,l[m+4>>2]=P,mt(i,2,15007,m),!(0|ne(t,a,s,c,h,u,d,n,o,e,i)))break t}return 25==(0|R)?(jt(b),B=0|C(0|l[T>>2],0|l[E>>2]),l[_>>2]=1+(0|l[a>>2]),l[_+4>>2]=B,mt(i,1,14699,_),w=y,0|(B=0)):27==(0|R)?(jt(b),w=y,0|(B=0)):29==(0|R)?(jt(b),w=y,0|(B=0)):31!=(0|R)||(B=8+(0|l[r>>2])|0,0|et(e,B=0|br(0|l[B>>2],0|l[B+4>>2],2,0),S,i))?(jt(b),w=y,0|(B=1)):(mt(i,1,14979,p),jt(b),w=y,0|(B=0))}}while(0);return jt(b),w=y,0|(B=0)},function(t,e,i){return e|=0,i|=0,it(0|l[(t=44+(t|=0)|0)>>2],65497,2),2!=(0|ct(e,0|l[t>>2],2,i))?0|(i=0):0|(i=0!=(0|function(t,e){e|=0;var i,n,r,o,a=0,s=0,c=0,h=0,u=0;o=w,w=w+16|0,r=o,a=0|l[(i=32+(t|=0)|0)>>2],l[(u=t+36|0)>>2]=a,s=0|l[(n=t+48|0)>>2];do{if(s){for(c=t+20|0;-1!=(0|(s=0|Qr[63&l[c>>2]](a,s,0|l[t>>2])));)if(a=(0|l[u>>2])+s|0,l[u>>2]=a,s=(0|l[n>>2])-s|0,l[n>>2]=s,!s){h=6;break}if(6==(0|h)){a=0|l[i>>2];break}return l[(u=t+68|0)>>2]=8|l[u>>2],mt(e,4,4360,r),w=o,0|(u=0)}}while(0);return l[u>>2]=a,w=o,0|(u=1)}(e,i))&1)},function(t,e,i){e|=0,i|=0;var n,r,o,a,s=0;return o=5*(0|l[32+(t|=0)>>2])|0,s=0|br(0|l[(s=t+16|0)>>2],0|l[s+4>>2],6,0),a=S,n=0|ht(e),r=S,0|ft(e,s,a,i)?(0|ct(e,0|l[t+24>>2],o,i))!=(0|o)?0|(s=0):0|(s=0!=(0|ft(e,n,r,i))&1):0|(s=0)},function(t,e,i){return e|=0,i|=0,(t=0|l[196+(t|=0)>>2])?(i=0|vr(0|(e=0|ht(e)),0|S,0|l[(i=t)>>2],0|l[i+4>>2]),l[(e=t+16|0)>>2]=i,l[e+4>>2]=S,1):1},function(t,e,i){return e|=0,i|=0,$e(0|l[(e=204+(t|=0)|0)>>2]),l[e>>2]=0,0|(i=0|l[(e=t+24|0)>>2])&&(jt(i),l[e>>2]=0,l[t+28>>2]=0),(e=0|l[(i=t+36|0)>>2])?(jt(e),l[i>>2]=0,l[(t=t+40|0)>>2]=0,1):(l[(t=t+40|0)>>2]=0,1)},function(t,e,i){return e|=0,i|=0,0|(i=0|l[(e=44+(t|=0)|0)>>2])&&(jt(i),l[e>>2]=0),l[t+48>>2]=0,1},function(t,e,i){return 1},function(t,e,i){var n,r;return e|=0,i|=0,r=w,w=w+32|0,n=0==(0|l[8+(t|=0)>>2])&0!=(0|l[t+188>>2])&0!=(0|l[t+192>>2])&1,(e=(0|l[4+(0|l[5584+(0|l[t+164>>2])>>2])>>2])-1|0)>>>0>31?(mt(i,1,16016,r),w=r,0|(i=0)):(e=1<<e,(0|l[t+100>>2])>>>0<e>>>0?(mt(i,1,16016,r+8|0),w=r,0|(i=0)):(0|l[t+104>>2])>>>0>=e>>>0?(w=r,0|(i=n)):(mt(i,1,16016,r+16|0),w=r,0|(i=0)))},function(t,e,i){e|=0,i|=0;var n,r=0,o=0,s=0,c=0;if((-32256&a[88+(t|=0)>>1])<<16>>16!=-32256)return 0|(c=1);if(!(n=0|C(0|l[t+112>>2],0|l[t+116>>2])))return 0|(c=1);for(c=t+80|0,o=0|l[t+164>>2],e=1,s=0;;){if(2==(0|l[o+16>>2])&&(e&=0!=(0|l[o+5608>>2]),r=0|l[16+(0|l[c>>2])>>2]))for(i=0,t=0|l[o+5584>>2];e=(1&l[t+20>>2]^1)&e,!((i=i+1|0)>>>0>=r>>>0);)t=t+1080|0;if((0|(s=s+1|0))==(0|n))break;o=o+5640|0}return 0|e},function(t,e,i){e|=0,i|=0;var n,r,o,a,s=0,c=0,h=0;if(r=88+(t|=0)|0,o=t+32|0,a=0|l[t+80>>2],n=0|C(0|l[t+116>>2],0|l[t+112>>2]),l[o>>2]=0,!n)return 1;for(t=0|l[t+164>>2],s=0;;){Ze(a,r,s),c=t+420|0,e=0,i=0;do{h=0|ve(r,e,s),l[o>>2]=(0|l[o>>2])+h,i=h+i|0,e=e+1|0}while(e>>>0<=(0|l[c>>2])>>>0);if(l[t+5588>>2]=i,(0|(s=s+1|0))==(0|n))break;t=t+5640|0}return 1},function(t,e,i){return e|=0,i|=0,it(t=0|l[44+(t|=0)>>2],65359,2),2==(0|ct(e,t,2,i))|0},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h=0,u=0,f=0,p=0;c=w,w=w+16|0,n=c,r=0|l[80+(t|=0)>>2],p=40+(o=3*(0|l[(s=r+16|0)>>2])|0)|0,f=0|l[r+24>>2],u=t+48|0,h=0|l[(a=t+44|0)>>2];do{if(p>>>0>(0|l[u>>2])>>>0){if(0|(h=0|Wt(h,p))){l[a>>2]=h,l[u>>2]=p;break}return jt(0|l[a>>2]),l[a>>2]=0,l[u>>2]=0,mt(i,1,15978,n),w=c,0|(p=0)}}while(0);if(it(h,65361,2),it(h+2|0,o+38|0,2),it(h+4|0,0|d[t+88>>1],2),it(h+6|0,0|l[r+8>>2],4),it(h+10|0,0|l[r+12>>2],4),it(h+14|0,0|l[r>>2],4),it(h+18|0,0|l[r+4>>2],4),it(h+22|0,0|l[t+100>>2],4),it(h+26|0,0|l[t+104>>2],4),it(h+30|0,0|l[t+92>>2],4),it(h+34|0,0|l[t+96>>2],4),it(h+38|0,0|l[s>>2],2),0|l[s>>2])for(h=h+40|0,u=0;it(h,(0|l[f+24>>2])-1+(l[f+32>>2]<<7)|0,1),it(h+1|0,0|l[f>>2],1),it(h+2|0,0|l[f+4>>2],1),!((u=u+1|0)>>>0>=(0|l[s>>2])>>>0);)f=f+52|0,h=h+3|0;return p=(0|ct(e,0|l[a>>2],p,i))==(0|p)&1,w=c,0|p},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p=0,m=0,_=0;f=w,w=w+32|0,_=f+16|0,d=f+8|0,o=f,a=f+20|0,c=0|l[(s=164+(t|=0)|0)>>2],u=0|l[(h=t+200|0)>>2],p=0|l[c+(5640*u|0)+5584>>2],r=9+(m=1&l[p>>2]?5+(0|l[p+4>>2])|0:5)|0,l[a>>2]=r,n=t+48|0,p=0|l[(t=t+44|0)>>2];do{if(r>>>0>(0|l[n>>2])>>>0){if(0|(p=0|Wt(p,r))){l[t>>2]=p,l[n>>2]=r;break}return jt(0|l[t>>2]),l[t>>2]=0,l[n>>2]=0,mt(i,1,15913,o),w=f,0|(_=0)}}while(0);return it(p,65362,2),it(p+2|0,m+7|0,2),it(p+4|0,0|l[c+(5640*u|0)>>2],1),it(p+5|0,0|l[c+(5640*u|0)+4>>2],1),it(p+6|0,0|l[c+(5640*u|0)+8>>2],2),it(p+8|0,0|l[c+(5640*u|0)+16>>2],1),l[a>>2]=m,0|Se(0|l[s>>2],0|l[h>>2],p+9|0,a,i)?0|l[a>>2]?(mt(i,1,15952,_),w=f,0|(_=0)):(_=(0|ct(e,0|l[t>>2],r,i))==(0|r)&1,w=f,0|_):(mt(i,1,15952,d),w=f,0|(_=0))},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d=0,f=0,p=0;u=w,w=w+32|0,p=u+16|0,h=u+8|0,o=u,s=u+20|0,c=200+(t|=0)|0,d=0|l[(0|l[(a=t+164|0)>>2])+(5640*(0|l[c>>2])|0)+5584>>2],d=1==(0|(f=0|l[d+24>>2]))?1:(3*(0|l[d+4>>2])|0)-2|0,r=4+(n=0==(0|f)?d+1|0:d<<1|1)|0,l[s>>2]=r,f=t+48|0,d=0|l[(t=t+44|0)>>2];do{if(r>>>0>(0|l[f>>2])>>>0){if(0|(d=0|Wt(d,r))){l[t>>2]=d,l[f>>2]=r;break}return jt(0|l[t>>2]),l[t>>2]=0,l[f>>2]=0,mt(i,1,15848,o),w=u,0|(p=0)}}while(0);return it(d,65372,2),it(d+2|0,n+2|0,2),l[s>>2]=n,0|Ae(0|l[a>>2],0|l[c>>2],0,d+4|0,s,i)?0|l[s>>2]?(mt(i,1,15887,p),w=u,0|(p=0)):(p=(0|ct(e,0|l[t>>2],r,i))==(0|r)&1,w=u,0|p):(mt(i,1,15887,h),w=u,0|(p=0))},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0;if(u=w,w=w+16|0,h=u,a=u+4|0,(d=0|l[16+(0|l[(s=80+(t|=0)|0)>>2])>>2])>>>0<=1)return w=u,0|(x=1);for(r=t+164|0,o=t+200|0,c=t+48|0,n=t+44|0,b=1,t=d;;){f=0|l[r>>2],m=0|l[o>>2],p=0|l[f+(5640*m|0)+5584>>2],_=0|l[p+(1080*b|0)>>2];t:do{if((0|l[p>>2])==(0|_)&&(v=0|l[p+4>>2],(0|v)==(0|l[p+(1080*b|0)+4>>2]))&&(0|l[p+8>>2])==(0|l[p+(1080*b|0)+8>>2])&&(0|l[p+12>>2])==(0|l[p+(1080*b|0)+12>>2])&&(0|l[p+16>>2])==(0|l[p+(1080*b|0)+16>>2])&&(0|l[p+20>>2])==(0|l[p+(1080*b|0)+20>>2])){if(v){d=0;do{if((0|l[p+812+(d<<2)>>2])!=(0|l[p+(1080*b|0)+812+(d<<2)>>2])){x=13;break t}if((0|l[p+944+(d<<2)>>2])!=(0|l[p+(1080*b|0)+944+(d<<2)>>2])){x=13;break t}d=d+1|0}while(d>>>0<v>>>0)}}else x=13}while(0);if(13==(0|x)){if(x=0,y=(d=1&_?5+(0|l[p+(1080*b|0)+4>>2])|0:5)+(t>>>0<257?6:7)|0,d=0|l[n>>2],y>>>0>(0|l[c>>2])>>>0){if(!(d=0|Wt(d,y))){x=17;break}l[n>>2]=d,l[c>>2]=y,g=0|l[r>>2],m=0|l[o>>2],p=0|l[g+(5640*m|0)+5584>>2],t=0|l[16+(0|l[s>>2])>>2],_=0|l[p+(1080*b|0)>>2]}else g=f;if(f=t>>>0<257?1:2,t=1&_?5+(0|l[p+(1080*b|0)+4>>2])|0:5,it(d,65363,2),it(d+2|0,f+3+t|0,2),it(_=d+4|0,b,f),it(_=_+f|0,0|l[(0|l[g+(5640*m|0)+5584>>2])+(1080*b|0)>>2],1),l[a>>2]=t,Se(0|l[r>>2],0|l[o>>2],_+1|0,a,i),(0|ct(e,0|l[n>>2],y,i))!=(0|y)){t=0,x=24;break}t=0|l[16+(0|l[s>>2])>>2]}if((b=b+1|0)>>>0>=t>>>0){t=1,x=24;break}}return 17==(0|x)?(jt(0|l[n>>2]),l[n>>2]=0,l[c>>2]=0,mt(i,1,15774,h),w=u,0|(x=0)):24==(0|x)?(w=u,0|t):0},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0;if(u=w,w=w+16|0,h=u,a=u+4|0,(d=0|l[16+(0|l[(s=80+(t|=0)|0)>>2])>>2])>>>0<=1)return w=u,0|(b=1);for(r=t+164|0,o=t+200|0,c=t+48|0,n=t+44|0,y=1,t=d;;){_=0|l[(0|l[r>>2])+(5640*(0|l[o>>2])|0)+5584>>2],p=0|l[_+24>>2],m=0|l[_+(1080*y|0)+24>>2];t:do{if((0|p)==(0|m)&&(0|l[_+804>>2])==(0|l[_+(1080*y|0)+804>>2])){if(1!=(0|p)){if(d=(g=3*(0|l[_+4>>2])|0)-2|0,(0|g)!=(3*(0|l[_+(1080*y|0)+4>>2])|0)){b=14;break}if(!d)break;f=d}else f=1;d=0;do{if((0|l[_+28+(d<<3)>>2])!=(0|l[_+(1080*y|0)+28+(d<<3)>>2])){b=14;break t}d=d+1|0}while(d>>>0<f>>>0);if(p){d=0;do{if((0|l[_+28+(d<<3)+4>>2])!=(0|l[_+(1080*y|0)+28+(d<<3)+4>>2])){b=14;break t}d=d+1|0}while(d>>>0<f>>>0)}}else b=14}while(0);if(14==(0|b)){if(b=0,d=1==(0|m)?1:(3*(0|l[_+(1080*y|0)+4>>2])|0)-2|0,g=5+(0==(0|m)?d+1|0:d<<1|1)+(t>>>0>256&1)|0,t=0|l[n>>2],g>>>0>(0|l[c>>2])>>>0){if(!(t=0|Wt(t,g))){b=18;break}l[n>>2]=t,l[c>>2]=g,d=0|l[(0|l[r>>2])+(5640*(0|l[o>>2])|0)+5584>>2],f=0|l[d+(1080*y|0)+24>>2],p=t}else f=m,d=_,p=t;if(t=1==(0|f)?1:(3*(0|l[d+(1080*y|0)+4>>2])|0)-2|0,d=0==(0|f)?t+1|0:t<<1|1,l[a>>2]=d+6,it(p,65373,2),t=p+2|0,(0|l[16+(0|l[s>>2])>>2])>>>0<257?(it(t,d+3|0,2),it(p+4|0,y,1),t=5):(it(t,d+4|0,2),it(p+4|0,y,2),t=6),l[a>>2]=d,Ae(0|l[r>>2],0|l[o>>2],y,p+t|0,a,i),(0|ct(e,0|l[n>>2],g,i))!=(0|g)){t=0,b=28;break}t=0|l[16+(0|l[s>>2])>>2]}if((y=y+1|0)>>>0>=t>>>0){t=1,b=28;break}}return 18==(0|b)?(jt(0|l[n>>2]),l[n>>2]=0,l[c>>2]=0,mt(i,1,15702,h),w=u,0|(b=0)):28==(0|b)?(w=u,0|t):0},function(t,e,i){e|=0,i|=0;var n,r,o,a,s=0,c=0,h=0;a=w,w=w+16|0,c=a,h=6+(o=5*(0|l[32+(t|=0)>>2])|0)|0,n=t+48|0,s=0|l[(r=t+44|0)>>2];do{if(h>>>0>(0|l[n>>2])>>>0){if(0|(s=0|Wt(s,h))){l[r>>2]=s,l[n>>2]=h;break}return jt(0|l[r>>2]),l[r>>2]=0,l[n>>2]=0,mt(i,1,15663,c),w=a,0|(h=0)}}while(0);return c=0|ht(e),l[(t=t+16|0)>>2]=c,l[t+4>>2]=S,it(s,65365,2),it(s+2|0,o+4|0,2),it(s+4|0,0,1),it(s+5|0,80,1),h=(0|ct(e,0|l[r>>2],h,i))==(0|h)&1,w=a,0|h},function(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a,s,c,h,u,d=0,f=0,p=0,m=0;u=w,w=w+16|0,o=u,l[(m=u+4|0)>>2]=0,f=0|l[(a=t+164|0)>>2],d=0|l[(s=t+200|0)>>2],p=0|l[16+(0|l[(r=t+80|0)>>2])>>2],h=4+(0|C(p>>>0<257?7:9,1+(0|l[f+(5640*d|0)+420>>2])|0))|0,n=t+48|0,t=0|l[(c=t+44|0)>>2];do{if(h>>>0>(0|l[n>>2])>>>0){if(0|(t=0|Wt(t,h))){l[c>>2]=t,l[n>>2]=h,p=0|l[16+(0|l[r>>2])>>2],f=0|l[a>>2],d=0|l[s>>2];break}return jt(0|l[c>>2]),l[c>>2]=0,l[n>>2]=0,mt(i,1,15624,o),w=u,0|(m=0)}}while(0);return be(p,f,d,t,m),m=(0|ct(e,0|l[c>>2],h,i))==(0|h)&1,w=u,0|m},function(t,e,i){e|=0,i|=0;var n,r,o=0,a=0,s=0,c=0,h=0,u=0;if(r=164+(t|=0)|0,a=0|l[(h=t+80|0)>>2],!(o=0|l[a+16>>2]))return 0|(h=1);for(n=t+44|0,s=0,c=0|l[5584+(0|l[r>>2])>>2],t=a;;){if(0|l[c+808>>2]){if(t=0|l[5584+(0|l[r>>2])>>2],a=6+(o=o>>>0<257?1:2)|0,it(u=0|l[n>>2],65374,2),it(u+2|0,4|o,2),it(u=u+4|0,s,o),it(o=u+o|0,0,1),it(o+1|0,0|l[t+(1080*s|0)+808>>2],1),(0|ct(e,0|l[n>>2],a,i))!=(0|a)){t=0,o=7;break}t=0|l[h>>2]}if((s=s+1|0)>>>0>=(o=0|l[t+16>>2])>>>0){t=1,o=7;break}c=c+1080|0}return 7==(0|o)?0|t:0},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c,h=0;c=w,w=w+16|0,o=c,h=6+(s=0|Sn(a=0|l[108+(t|=0)>>2]))|0,r=t+48|0,t=0|l[(n=t+44|0)>>2];do{if(h>>>0>(0|l[r>>2])>>>0){if(0|(t=0|Wt(t,h))){l[n>>2]=t,l[r>>2]=h;break}return jt(0|l[n>>2]),l[n>>2]=0,l[r>>2]=0,mt(i,1,15581,o),w=c,0|(h=0)}}while(0);return it(t,65380,2),it(t+2|0,s+4|0,2),it(t+4|0,1,2),Cr(t+6|0,0|a,0|s),h=(0|ct(e,0|l[n>>2],h,i))==(0|h)&1,w=c,0|h},function(t,e,i){e|=0,i|=0;var n,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0;u=w,w=w+32|0,c=u+24|0,a=u+16|0,v=u+8|0,f=u,p=0|l[80+(t|=0)>>2],g=6+(m=0|l[(_=p+16|0)>>2])|0,s=t+48|0,d=0|l[(h=t+44|0)>>2];do{if(g>>>0>(0|l[s>>2])>>>0){if(0|(d=0|Wt(d,g))){l[h>>2]=d,l[s>>2]=g;break}return jt(0|l[h>>2]),l[h>>2]=0,l[s>>2]=0,mt(i,1,15425,f),w=u,0|(i=0)}}while(0);if(it(d,65400,2),it(d+2|0,m+4|0,2),it(d+4|0,0|l[_>>2],2),0|l[_>>2])for(p=0|l[p+24>>2],d=d+6|0,f=0;it(d,(0|l[p+24>>2])-1|l[p+32>>2]<<7,1),!((f=f+1|0)>>>0>=(0|l[_>>2])>>>0);)p=p+52|0,d=d+1|0;if((0|ct(e,0|l[h>>2],g,i))!=(0|g))return w=u,0|(i=0);m=(b=0|l[(n=t+164|0)>>2])+(5640*(y=0|l[(o=t+200|0)>>2])|0)+5616|0;t:do{if(0|l[m>>2]){for(f=0|l[b+(5640*y|0)+5612>>2],p=0;;){if(t=10+(g=0|l[(_=f+16|0)>>2])|0,d=0|l[h>>2],t>>>0>(0|l[s>>2])>>>0){if(!(d=0|Wt(d,t)))break;l[h>>2]=d,l[s>>2]=t}if(it(d,65396,2),it(d+2|0,g+8|0,2),it(d+4|0,0,2),it(d+6|0,l[f+4>>2]<<8|255&l[f+8>>2]|l[f>>2]<<10,2),it(d+8|0,0,2),Cr(d+10|0,0|l[f+12>>2],0|l[_>>2]),(0|ct(e,0|l[h>>2],t,i))!=(0|t)){x=0,A=41;break}if((p=p+1|0)>>>0>=(0|l[m>>2])>>>0)break t;f=f+20|0}return 41==(0|A)?(w=u,0|x):(jt(0|l[h>>2]),l[h>>2]=0,l[s>>2]=0,mt(i,1,15464,v),w=u,0|(i=0))}}while(0);v=b+(5640*y|0)+5628|0;t:do{if(0|l[v>>2]){for(t=0|l[b+(5640*y|0)+5624>>2],y=0;;){if(_=(m=(f=0|l[(g=t+4|0)>>2])>>>0>255)?2:1,m=m?32768:0,b=19+(f=0|C(_,f<<1))|0,d=0|l[h>>2],b>>>0>(0|l[s>>2])>>>0){if(!(d=0|Wt(d,b)))break;l[h>>2]=d,l[s>>2]=b}if(it(d,65397,2),it(d+2|0,f+17|0,2),it(d+4|0,0,2),it(d+6|0,0|l[t>>2],1),it(d+7|0,0,2),it(d+9|0,1,2),it(d+11|0,1,1),it(d+12|0,l[g>>2]|m,2),d=d+14|0,0|l[g>>2]){p=0;do{it(d,p,_),d=d+_|0,p=p+1|0,f=0|l[g>>2]}while(p>>>0<f>>>0)}else f=0;if(it(d,f|m,2),d=d+2|0,0|l[g>>2]){f=0;do{it(d,f,_),d=d+_|0,f=f+1|0}while(f>>>0<(0|l[g>>2])>>>0);p=d}else p=d;if(d=(255&(1&r[t+16>>0]^1))<<16,(f=0|l[t+8>>2])&&(d=l[f+8>>2]|d),(f=0|l[t+12>>2])&&(d=l[f+8>>2]<<8|d),it(p,d,3),(0|ct(e,0|l[h>>2],b,i))!=(0|b)){x=0,A=41;break}if((y=y+1|0)>>>0>=(0|l[v>>2])>>>0)break t;t=t+20|0}return 41==(0|A)?(w=u,0|x):(jt(0|l[h>>2]),l[h>>2]=0,l[s>>2]=0,mt(i,1,15503,a),w=u,0|(i=0))}}while(0);_=0|l[n>>2],m=0|l[o>>2],t=5+(f=0|l[(g=_+(5640*m|0)+5628|0)>>2])|0,d=0|l[h>>2];do{if(t>>>0>(0|l[s>>2])>>>0){if(0|(d=0|Wt(d,t))){l[h>>2]=d,l[s>>2]=t;break}return jt(0|l[h>>2]),l[h>>2]=0,l[s>>2]=0,mt(i,1,15542,c),w=u,0|(i=0)}}while(0);if(it(d,65399,2),it(d+2|0,f+3|0,2),it(d+4|0,0|l[g>>2],1),0|l[g>>2])for(p=0,f=0|l[_+(5640*m|0)+5624>>2],d=d+5|0;it(d,0|l[f>>2],1),!((p=p+1|0)>>>0>=(0|l[g>>2])>>>0);)f=f+20|0,d=d+1|0;return i=(0|ct(e,0|l[h>>2],t,i))==(0|t)&1,w=u,0|i},function(t,e,i){return t|=0,i|=0,e=0|ht(e|=0),i=8+(0|l[t+196>>2])|0,l[i>>2]=e,l[i+4>>2]=S,1},function(t,e,i){var n,r;return t|=0,e|=0,i|=0,r=w,w=w+16|0,e=0|Xe(0),l[(n=t+204|0)>>2]=e,e?0|Ke(e,0|l[t+80>>2],t+88|0)?(w=r,0|(i=1)):($e(0|l[n>>2]),l[n>>2]=0,w=r,0|(i=0)):(mt(i,1,15385,r),w=r,0|(i=0))},function(t,e,i){e|=0,i|=0;var n,o,s,c,h,u,d=0,f=0,p=0,_=0,g=0,y=0,b=0,v=0,w=0,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0,U=0,H=0,V=0,W=0,j=0;if(n=0|l[(c=80+(t|=0)|0)>>2],f=0|l[(j=t+164|0)>>2],F=0|l[(W=n+24|0)>>2],d=0|l[F>>2],i=0|l[F+4>>2],s=n+16|0,F=0|C(0|l[F+24>>2],0|l[s>>2]),O=0|ht(e),e=0|l[(h=t+116|0)>>2],p=0|l[(u=t+112|0)>>2],o=(+(O>>>0)+4294967296*+(0|S))/+((0|C(p,e))>>>0),O=0==(8&r[t+181>>0])?1:2,0|e){for(M=t+92|0,T=t+100|0,P=t+96|0,R=t+104|0,B=n+4|0,L=n+8|0,D=n+12|0,I=+((0|C(d<<3,i))>>>0),w=0,d=p,i=p;;){if(v=w,w=w+1|0,i){y=0;do{if(k=+Yr[3&O](f),k/=+((g=0|l[f+8>>2])>>>0),A=0|l[M>>2],d=0|l[T>>2],i=(0|(_=(0|C(d,y))+A|0))>(0|(i=0|l[n>>2]))?_:i,_=0|l[P>>2],p=0|l[R>>2],e=(0|(x=(0|C(p,v))+_|0))>(0|(e=0|l[B>>2]))?x:e,d=(0|(A=(0|C(d,y=y+1|0))+A|0))<(0|(d=0|l[L>>2]))?A:d,p=(0|(_=(0|C(p,w))+_|0))<(0|(p=0|l[D>>2]))?_:p,(b=+m[(_=f+20|0)>>2])>0&&(E=+((0|C(0|C(d-i|0,F),p-e|0))>>>0)/(b*I)-k,m[_>>2]=E),g>>>0>1)for(b=+((0|C(0|C(d-i|0,F),p-e|0))>>>0),i=f+24|0,e=1;(E=+m[i>>2])>0&&(m[i>>2]=b/(E*I)-k),!((e=e+1|0)>>>0>=g>>>0);)i=i+4|0;f=f+5640|0,i=0|l[u>>2]}while(y>>>0<i>>>0);A=0|l[h>>2],x=i}else A=e,x=d,i=0;if(w>>>0>=A>>>0)break;d=x,e=A}if(0|A&&(z=o+2,0|x))for(y=0,i=0|l[j>>2];;){for(v=0,w=i,g=i+16|0;;){if((b=+m[(i=w+20|0)>>2])>0&&(I=b-o,m[i>>2]=I,I<30)&&(m[i>>2]=30),e=w+24|0,_=(i=0|l[w+8>>2])-1|0,f=(b=+m[e>>2])>0,_>>>0>1){p=g+(i<<2)|0,d=1,i=f;do{i&&(I=b-o,m[e>>2]=I,I<10+(H=+m[e+-4>>2]))&&(m[e>>2]=H+20),d=d+1|0,i=(b=+m[(e=e+4|0)>>2])>0}while((0|d)!=(0|_));i&&(G=p,N=b,V=25)}else f&&(G=e,N=b,V=25);if(25==(0|V)&&(V=0,I=N-z,m[G>>2]=I,I<10+(U=+m[G+-4>>2]))&&(m[G>>2]=U+20),w=w+5640|0,(v=v+1|0)>>>0>=x>>>0)break;g=g+5640|0}if((y=y+1|0)>>>0>=A>>>0)break;i=w}}if(f=0|l[s>>2]){for(p=(0|l[t+100>>2])-1|0,_=(0|l[t+104>>2])-1|0,d=0,i=0|l[W>>2],e=0;W=0|l[i>>2],V=0|l[i+4>>2],W=0|C(((_+V|0)>>>0)/(V>>>0)|0,((p+W|0)>>>0)/(W>>>0)|0),d=(0|C(W,0|l[i+24>>2]))+d|0,!((e=e+1|0)>>>0>=f>>>0);)i=i+52|0;T=~~(.1625*+(d>>>0))>>>0}else T=0;if(A=(v=0|l[16+(0|l[c>>2])>>2])-1|0,i=0|l[j>>2],w=0==(0|(M=0|C(0|l[h>>2],0|l[u>>2]))))f=0;else{for(e=0,d=0,f=i;e=e>>>0>(j=0|l[f+5588>>2])>>>0?e:j,(0|(d=d+1|0))!=(0|M);)f=f+5640|0;f=12*e|0}if(((0|a[(x=t+88|0)>>1])-3&65535)>=4){if(0==(0|v)|w)d=6,e=6;else{p=0,e=0;do{g=0|l[i+(5640*p|0)+5584>>2],_=0;do{e=e>>>0>(d=1&l[g+(1080*_|0)>>2]?5+(0|l[g+(1080*_|0)+4>>2])|0:5)>>>0?e:d,_=_+1|0}while((0|_)!=(0|v));p=p+1|0}while((0|p)!=(0|M));e=e+6|0,_=0,d=0;do{y=0|l[i+(5640*_|0)+5584>>2],g=0;do{d=d>>>0>(p=1&l[y+(1080*g|0)>>2]?5+(0|l[y+(1080*g|0)+4>>2])|0:5)>>>0?d:p,g=g+1|0}while((0|g)!=(0|v));_=_+1|0}while((0|_)!=(0|M));d=d+6|0}f=(0|C(d+e|0,A))+f|0}if(w)i=13;else{for(d=0,e=0;d=d>>>0>(j=0|l[i+420>>2])>>>0?d:j,(0|(e=e+1|0))!=(0|M);)i=i+5640|0;i=13+(9*d|0)|0}return j=f+T+i|0,l[t+40>>2]=j,j=0|zt(j),l[t+36>>2]=j,j?((0|a[x>>1])-3&65535)>=4?0|(t=1):(i=0|zt(5*(0|l[t+32>>2])|0),l[t+24>>2]=i,i?(l[t+28>>2]=i,0|(t=1)):0|(t=0)):0|(t=0)},function(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a,s,c,h,u,d,f,p,m,_,g,y,b,v,x,A=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=0,L=0,D=0;if(x=w,w=w+192|0,b=x+152|0,y=x+144|0,g=x+136|0,_=x+128|0,m=x+120|0,f=x+88|0,d=x+80|0,u=x+64|0,h=x+48|0,B=x+40|0,v=x+32|0,D=x+24|0,p=x+16|0,c=x+8|0,n=x+176|0,r=x+168|0,o=x+156|0,!(A=0|Ut(1,1024)))return mt(i,1,17104,x),w=x,0|(D=0);a=n+4|0,s=o+4|0,L=t+100|0,P=A,I=1024;t:for(;8==(0|lt(e,n,8,i));){e:for(;;){switch(nt(n,o,4),nt(a,s,4),0|l[o>>2]){case 0:if(A=0|ut(e),(0|(R=S))>0|0==(0|R)&A>>>0>4294967287){R=6;break t}l[o>>2]=A+8,T=8;break;case 1:if(8!=(0|lt(e,n,8,i))){R=12;break t}if(nt(n,r,4),0|l[r>>2]){R=10;break t}nt(a,o,4),T=16;break;default:T=8}if(1785737827==(0|(E=0|l[s>>2]))){R=14;break t}if(!(k=0|l[o>>2])){R=18;break t}if(k>>>0<T>>>0){R=20;break t}i:do{if((0|E)<1718909296){if((0|E)<1668112752){if((0|E)<1667523942){switch(0|E){case 1651532643:break;default:R=43;break i}M=1124,R=30;break}switch(0|E){case 1667523942:break;default:R=43;break i}M=1148,R=30;break}if((0|E)<1668246642){switch(0|E){case 1668112752:break;default:R=43;break i}M=1140,R=30;break}switch(0|E){case 1668246642:break;default:R=43;break i}M=1116,R=30;break}if((0|E)<1783636e3)if((0|E)<1768449138)switch(0|E){case 1718909296:R=27;break e;default:R=43;break i}else switch(0|E){case 1768449138:M=1108,R=30;break i;default:R=43;break i}if((0|E)<1785737832)switch(0|E){case 1783636e3:A=1084,R=29;break e;default:R=43;break i}if((0|E)<1885564018)switch(0|E){case 1785737832:R=28;break e;default:R=43;break i}switch(0|E){case 1885564018:break;default:R=43;break i}M=1132,R=30}while(0);if(30==(0|R)){if(R=0,A=k-T|0,l[h>>2]=E>>>24,l[h+4>>2]=E>>>16&255,l[h+8>>2]=E>>>8&255,l[h+12>>2]=255&E,mt(i,2,17288,h),4&l[L>>2]|0){C=M,E=A;break}if(C=0|l[s>>2],l[u>>2]=C>>>24,l[u+4>>2]=C>>>16&255,l[u+8>>2]=C>>>8&255,l[u+12>>2]=255&C,mt(i,2,17339,u),l[L>>2]=2147483647|l[L>>2],!((0|(C=0|dt(e,A,0,i)))==(0|A)&0==(0|S))){R=32;break t}}else if(43==(0|R)){if(R=0,A=k-T|0,!(1&(M=0|l[L>>2]))){R=44;break t}if(!(2&M)){R=46;break t}if(l[L>>2]=2147483647|M,!((0|(C=0|dt(e,A,0,i)))==(0|A)&0==(0|S))){R=49;break t}}if(8!=(0|lt(e,n,8,i)))break t}if(27==(0|R)?(A=1092,R=29):28==(0|R)&&(A=1100,R=29),29==(0|R)&&(R=0,C=A,E=k-T|0),k=0|ut(e),(0|(T=S))<0|0==(0|T)&k>>>0<E>>>0){R=34;break}if(E>>>0>I>>>0){if(!(A=0|Wt(P,E))){R=37;break}M=E}else A=P,M=I;if((0|lt(e,A,E,i))!=(0|E)){R=39;break}if(!(0|qr[63&l[C+4>>2]](t,A,E,i))){R=42;break}P=A,I=M}switch(0|R){case 6:mt(i,1,17154,c);break;case 10:mt(i,1,17154,p);break;case 12:break;case 14:return 4&(A=0|l[L>>2])?(l[L>>2]=8|A,jt(P),w=x,0|(D=1)):(mt(i,1,17196,D),jt(P),w=x,0|(D=0));case 18:return mt(i,1,17224,v),jt(P),w=x,0|(D=0);case 20:return l[B>>2]=k,l[B+4>>2]=E,mt(i,1,17262,B),jt(P),w=x,0|(D=0);case 32:return mt(i,1,17405,d),jt(P),w=x,0|(D=0);case 34:return B=0|l[o>>2],L=0|l[s>>2],D=0|ut(e),l[f>>2]=B,l[f+4>>2]=L>>>24,l[f+8>>2]=L>>>16&255,l[f+12>>2]=L>>>8&255,l[f+16>>2]=255&L,l[f+20>>2]=E,l[f+24>>2]=D,mt(i,1,17455,f),jt(P),w=x,0|(D=0);case 37:return jt(P),mt(i,1,17531,m),w=x,0|(D=0);case 39:return mt(i,1,17573,_),jt(A),w=x,0|(D=0);case 42:return jt(A),w=x,0|(D=0);case 44:return mt(i,1,17622,g),jt(P),w=x,0|(D=0);case 46:return mt(i,1,17692,y),jt(P),w=x,0|(D=0);case 49:return mt(i,1,17405,b),jt(P),w=x,0|(D=0)}return jt(P),w=x,0|(D=1)},function(t,e,i){t|=0,i|=0;var n,r,o,a,s=0;return a=w,w=w+32|0,it(n=a+24|0,s=0|vr(0|(r=0|ht(e|=0)),0|(o=S),0|l[(s=t=t+80|0)>>2],0|l[s+4>>2]),4),it(n+4|0,1785737827,4),0|ft(e,0|l[t>>2],0|l[t+4>>2],i)?8!=(0|ct(e,n,8,i))?(mt(i,1,19383,a+8|0),w=a,0|(s=0)):0|ft(e,r,o,i)?(w=a,0|(s=1)):(mt(i,1,19383,a+16|0),w=a,0|(s=0)):(mt(i,1,19383,a),w=a,0|(s=0))},function(t,e,i){e|=0,i|=0;var n,r=0,o=0;if(i=(0|l[(t|=0)>>2]?0==(l[t+104>>2]|l[t+100>>2]|0):0)&0!=(0|l[t+8>>2])&0!=(0|l[t+4>>2])&0!=(0|l[t+64>>2])&0!=(0|l[t+16>>2])&0!=(0|l[t+12>>2])&1,!(n=0|l[t+20>>2]))return o=i,t=(t=(t=0|l[(t=t+40|0)>>2])-1|0)>>>0<2,t&=1,e=0|pt(e),e&=o,0|(e&=t);o=0|l[t+72>>2],r=0;do{i&=(126&l[o+(12*r|0)+8>>2])>>>0<38,r=r+1|0}while(r>>>0<n>>>0);return t=(t=(t=0|l[(t=t+40|0)>>2])-1|0)>>>0<2,t&=1,e=0|pt(e),e&=i,0|(e&=t)},function(t,e,i){var n;return t|=0,e|=0,i|=0,t=w,w=w+16|0,it(n=t,12,4),it(n+4|0,1783636e3,4),it(n+8|0,218793738,4),i=12==(0|ct(e,n,12,i))&1,w=t,0|i},function(t,e,i){e|=0,i|=0;var n,r,o,a,s,c=0,h=0;if(s=w,w=w+16|0,h=s+8|0,!(a=0|Ut(1,o=16+(l[(r=64+(t|=0)|0)>>2]<<2)|0)))return mt(i,1,19500,s),w=s,0|(h=0);if(it(a,o,4),it(a+4|0,1718909296,4),it(a+8|0,0|l[t+56>>2],4),it(a+12|0,0|l[t+60>>2],4),n=a+16|0,0|l[r>>2]){c=t+68|0,t=0;do{it(n,0|l[(0|l[c>>2])+(t<<2)>>2],4),t=t+1|0}while(t>>>0<(0|l[r>>2])>>>0)}return(t=(0|ct(e,a,o,i))==(0|o))||mt(i,1,19539,h),jt(a),w=s,0|(h=1&t)},function(t,e,i){t|=0,e|=0,i|=0;var n,r,o,a,s,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0;s=w,w=w+80|0,a=s+16|0,o=s+8|0,r=s,n=s+72|0,u=48+(c=h=s+24|0)|0;do{l[c>>2]=0,c=c+4|0}while((0|c)<(0|u));for(255==(0|l[t+24>>2])?(l[h>>2]=1,c=3,u=2,d=1,f=4):(c=2,u=1,d=0,f=1),l[h+(12*d|0)>>2]=f,l[h+(12*u|0)>>2]=2,0|l[t+116>>2]?(l[h+(12*c|0)>>2]=3,m=c+1|0):m=c,it(n+4|0,1785737832,4),c=8,u=0,d=h;;){if(f=d+8|0,_=0|Jr[7&l[d>>2]](t,f),l[d+4>>2]=_,!_){p=7;break}if(c=(0|l[f>>2])+c|0,(0|(u=u+1|0))>=(0|m))break;d=d+12|0}if(7==(0|p)){for(mt(i,1,19414,r),u=0,c=h;;){if(0|(h=0|l[c+4>>2])&&jt(h),(0|(u=u+1|0))>=(0|m)){c=0;break}c=c+12|0}return w=s,0|c}it(n,c,4);t:do{if(8==(0|ct(e,n,8,i))){for(c=0,u=h;_=u+8|0,(0|(p=0|ct(e,0|l[u+4>>2],0|l[_>>2],i)))==(0|l[_>>2]);){if((0|(c=c+1|0))>=(0|m)){c=1;break t}u=u+12|0}mt(i,1,19457,a),c=0}else mt(i,1,19457,o),c=0}while(0);for(u=0;0|(d=0|l[h+4>>2])&&jt(d),!((0|(u=u+1|0))>=(0|m));)h=h+12|0;return w=s,0|c},function(t,e,i){var n;return t|=0,i|=0,n=0|ht(e|=0),l[(t=t+88|0)>>2]=n,l[t+4>>2]=S,24==(0|(i=0|dt(e,24,0,i)))&0==(0|S)&1|0},function(t,e,i){var n;return t|=0,i|=0,n=0|ht(e|=0),l[(t=t+80|0)>>2]=n,l[t+4>>2]=S,8==(0|(i=0|dt(e,8,0,i)))&0==(0|S)&1|0},wn,function(t,e,i){t|=0,e|=0,i|=0;var n,o,a,s=0,c=0,h=0,u=0;return o=w,w=w+32|0,s=o,l[(u=o+16|0)>>2]=e,c=u+4|0,a=0|l[(n=t+48|0)>>2],l[c>>2]=i-(0!=(0|a)&1),h=t+44|0,l[u+8>>2]=l[h>>2],l[u+12>>2]=a,l[s>>2]=l[t+60>>2],l[s+4>>2]=u,l[s+8>>2]=2,(0|(s=0|xn(0|G(145,0|s))))>=1?s>>>0>(u=0|l[c>>2])>>>0&&(c=0|l[h>>2],l[(h=t+4|0)>>2]=c,l[t+8>>2]=c+(s-u),0|l[n>>2]?(l[h>>2]=c+1,r[e+(i+-1)>>0]=0|r[c>>0],s=i):s=i):l[t>>2]=l[t>>2]|48&s^16,w=o,0|s},Fr],qr=[Gr,function(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var o,a,s,c,u,d,f,p,m,_,g,y=0,b=0,v=0,x=0,A=0,S=0,M=0,E=0,T=0;if(g=w,w=w+112|0,E=g+88|0,_=g+80|0,S=g+72|0,m=g+64|0,A=g+56|0,d=g+48|0,s=g+40|0,o=g+32|0,v=g+24|0,y=g+16|0,f=g+100|0,M=g+92|0,l[(p=g+96|0)>>2]=0,T=t+200|0,8!=(0|i))return mt(n,1,11669,g),mt(n,1,11669,g+8|0),w=g,0|(T=0);if(nt(e,T,2),nt(e+2|0,f,4),nt(e+6|0,M,1),nt(e+7|0,p,1),a=0|l[T>>2],e=0|l[t+112>>2],a>>>0>=(0|C(0|l[t+116>>2],e))>>>0)return l[y>>2]=a,mt(n,1,11695,y),w=g,0|(T=0);i=0|l[t+164>>2],u=(a>>>0)%(e>>>0)|0,c=(a>>>0)/(e>>>0)|0,e=0|l[f>>2];do{if((e+-1|0)>>>0<13){if(12==(0|e)){l[v>>2]=12,mt(n,2,11719,v),e=0|l[f>>2];break}return l[o>>2]=e,mt(n,1,11756,o),w=g,0|(T=0)}}while(0);e||(mt(n,4,11817,s),l[t+72>>2]=1),e=0|l[p>>2];do{if(e){if(b=e+((0|h[t+76>>0])>>>4&1)|0,l[p>>2]=b,((y=0|l[(i=i+(5640*a|0)+5588|0)>>2])-1|0)>>>0<(e=0|l[M>>2])>>>0)return l[d>>2]=e,l[d+4>>2]=y,mt(n,1,11928,d),l[t+72>>2]=1,w=g,0|(T=0);if(e>>>0<b>>>0){l[i>>2]=b,x=18;break}return l[A>>2]=e,l[A+4>>2]=b,mt(n,1,12027,A),l[t+72>>2]=1,w=g,0|(T=0)}0|(e=0|l[i+(5640*a|0)+5588>>2])&&(b=e,x=18)}while(0);if(18==(0|x)&&(0|b)==(1+(0|l[M>>2])|0)&&(r[(A=t+76|0)>>0]=1|r[A>>0]),l[t+24>>2]=0==(0|l[t+72>>2])?(0|l[f>>2])-12|0:0,l[t+8>>2]=16,e=-1==(0|(e=0|l[t+60>>2]))?u>>>0>=(0|l[t+28>>2])>>>0&&u>>>0<(0|l[t+36>>2])>>>0&&c>>>0>=(0|l[t+32>>2])>>>0?(c>>>0>=(0|l[t+40>>2])>>>0&1)<<2&255:4:((0|l[T>>2])!=(0|e)&1)<<2&255,r[(v=t+76|0)>>0]=-5&r[v>>0]|e,!(e=0|l[(v=t+196|0)>>2]))return w=g,0|(T=1);if(b=0|l[T>>2],e=0|l[e+40>>2],l[e+(40*b|0)>>2]=b,y=0|l[M>>2],l[e+(40*b|0)+12>>2]=y,0|(i=0|l[p>>2]))return l[e+(40*b|0)+4>>2]=i,l[e+(40*b|0)+8>>2]=i,(e=0|l[e+(40*b|0)+16>>2])?(e=0|Wt(e,24*i|0),i=(0|l[40+(0|l[v>>2])>>2])+(40*(0|l[T>>2])|0)+16|0,e?(l[i>>2]=e,w=g,0|(T=1)):(jt(0|l[i>>2]),l[(0|l[40+(0|l[v>>2])>>2])+(40*(0|l[T>>2])|0)+16>>2]=0,mt(n,1,12135,S),w=g,0|(T=0))):(E=0|Ut(i,24),l[(0|l[40+(0|l[v>>2])>>2])+(40*(0|l[T>>2])|0)+16>>2]=E,0|E?(w=g,0|(T=1)):(mt(n,1,12135,m),w=g,0|(T=0)));do{if(!(0|l[e+(40*b|0)+16>>2])){if(l[e+(40*b|0)+8>>2]=10,S=0|Ut(10,24),e=0|l[40+(0|l[v>>2])>>2],i=0|l[T>>2],l[e+(40*i|0)+16>>2]=S,0|S){b=i,y=0|l[M>>2];break}return l[e+(40*i|0)+8>>2]=0,mt(n,1,12135,_),w=g,0|(T=0)}}while(0);return y>>>0<(0|l[(i=e+(40*b|0)+8|0)>>2])>>>0?(w=g,0|(T=1)):(M=y+1|0,l[i>>2]=M,e=0|Wt(0|l[e+(40*b|0)+16>>2],24*M|0),i=(0|l[40+(0|l[v>>2])>>2])+(40*(0|l[T>>2])|0)+16|0,e?(l[i>>2]=e,w=g,0|(T=1)):(jt(0|l[i>>2]),M=0|l[40+(0|l[v>>2])>>2],T=0|l[T>>2],l[M+(40*T|0)+16>>2]=0,l[M+(40*T|0)+8>>2]=0,mt(n,1,12135,E),w=g,0|(T=0)))},function(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var o,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0,m=0,_=0,g=0;if(o=w,w=w+64|0,m=o+48|0,_=o+40|0,h=o+32|0,c=o+56|0,l[(f=o+52|0)>>2]=i,u=0|l[(g=t+80|0)>>2],d=16==(0|l[(p=t+8|0)>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],1&(s=0|r[(a=d+5636|0)>>0]))return mt(n,1,11436,o),w=o,0|(g=0);if(r[a>>0]=1|s,i>>>0<5)return mt(n,1,11500,o+8|0),w=o,0|(g=0);if(nt(e,d,1),(0|l[d>>2])>>>0>7)return mt(n,1,11526,o+16|0),w=o,0|(g=0);if(nt(e+1|0,c,1),c=0|l[c>>2],l[(a=d+4|0)>>2]=c,(0|c)>4&&(mt(n,1,11560,o+24|0),l[a>>2]=-1),nt(e+2|0,a=d+8|0,2),((a=0|l[a>>2])-1|0)>>>0>65534)return l[h>>2]=a,mt(n,1,11601,h),w=o,0|(g=0);if(h=0|l[t+172>>2],l[d+12>>2]=0==(0|h)?a:h,nt(e+4|0,d+16|0,1),h=e+5|0,l[f>>2]=i+-5,0|(c=0|l[u+16>>2])){e=1&l[d>>2],s=0|l[d+5584>>2],a=0;do{l[s+(1080*a|0)>>2]=e,a=a+1|0}while(a>>>0<c>>>0)}if(!(0|ie(t,0,h,f,n)))return mt(n,1,11500,_),w=o,0|(g=0);if(0|l[f>>2])return mt(n,1,11500,m),w=o,0|(g=0);if(a=16==(0|l[p>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],a=0|l[a+5584>>2],d=(s=0|l[(u=a+4|0)>>2])<<2,(0|l[16+(0|l[g>>2])>>2])>>>0<=1)return w=o,0|(g=1);if(t=a+8|0,n=a+12|0,f=a+16|0,p=a+20|0,m=a+812|0,_=a+944|0,l[a+1084>>2]=s,c=0|l[t>>2],l[a+1088>>2]=c,e=0|l[n>>2],l[a+1092>>2]=e,h=0|l[f>>2],l[a+1096>>2]=h,i=0|l[p>>2],l[a+1100>>2]=i,Cr(a+1892|0,0|m,0|d),Cr(a+2024|0,0|_,0|d),(0|l[16+(0|l[g>>2])>>2])>>>0<=2)return w=o,0|(g=1);if(l[a+2164>>2]=s,l[a+2168>>2]=c,l[a+2172>>2]=e,l[a+2176>>2]=h,l[a+2180>>2]=i,Cr(a+2972|0,0|m,0|d),Cr(a+3104|0,0|_,0|d),!((0|l[16+(0|l[g>>2])>>2])>>>0>3))return w=o,0|(g=1);for(s=3;;){if(c=0|l[t>>2],e=0|l[n>>2],h=0|l[f>>2],i=0|l[p>>2],l[a+3244>>2]=l[u>>2],l[a+3248>>2]=c,l[a+3252>>2]=e,l[a+3256>>2]=h,l[a+3260>>2]=i,Cr(a+4052|0,0|m,0|d),Cr(a+4184|0,0|_,0|d),(s=s+1|0)>>>0>=(0|l[16+(0|l[g>>2])>>2])>>>0){a=1;break}a=a+1080|0}return w=o,0|a},function(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r,o,a,s,c=0,h=0;return s=w,w=w+48|0,h=s+32|0,l[(a=s+28|0)>>2]=i,c=16==(0|l[t+8>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],o=16+(0|l[t+80>>2])|0,(r=(0|l[o>>2])>>>0<257?1:2)>>>0>=i>>>0?(mt(n,1,10929,s),w=s,0|(h=0)):(l[a>>2]=i+-1-r,nt(e,h,r),e=e+r|0,(i=0|l[h>>2])>>>0>=(0|l[o>>2])>>>0?(mt(n,1,10955,s+8|0),w=s,0|(h=0)):(nt(e,(0|l[c+5584>>2])+(1080*i|0)|0,1),0|ie(t,0|l[h>>2],e+1|0,a,n)?0|l[a>>2]?(mt(n,1,10929,s+24|0),w=s,0|(h=0)):(w=s,0|(h=1)):(mt(n,1,10929,s+16|0),w=s,0|(h=0))))},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c=0,h=0;return s=w,w=w+32|0,h=s+8|0,o=s+20|0,(2+(r=(a=0|l[16+(0|l[80+(t|=0)>>2])>>2])>>>0<257?1:2)|0)!=(0|i)?(mt(n,1,10846,s),w=s,0|(h=0)):(c=16==(0|l[t+8>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],nt(e,o,r),nt(i=e+r|0,s+16|0,1),(t=0|l[o>>2])>>>0<a>>>0?(nt(i+1|0,(0|l[c+5584>>2])+(1080*t|0)+808|0,1),w=s,0|(h=1)):(l[h>>2]=t,l[h+4>>2]=a,mt(n,1,10872,h),w=s,0|(h=0)))},function(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r,o=0,a=0;if(r=w,w=w+16|0,l[(o=r+12|0)>>2]=i,!(0|ee(t,0,e,o,n)))return mt(n,1,10820,r),w=r,0|(a=0);if(0|l[o>>2])return mt(n,1,10820,r+8|0),w=r,0|(a=0);if(e=16==(0|l[t+8>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],e=0|l[e+5584>>2],(0|l[16+(0|l[(n=t+80|0)>>2])>>2])>>>0<=1)return w=r,0|(a=1);for(o=e+24|0,t=e+804|0,a=e+28|0,i=1;;){if(l[e+1104>>2]=l[o>>2],l[e+1884>>2]=l[t>>2],Cr(e+1108|0,0|a,776),(i=i+1|0)>>>0>=(0|l[16+(0|l[n>>2])>>2])>>>0){e=1;break}e=e+1080|0}return w=r,0|e},function(t,e,i,n){t|=0,e|=0,i|=0,n|=0;var r,o,a,s,c,h,u=0,d=0,f=0,p=0;h=w,w=w+48|0,p=h+32|0,c=h+24|0,s=h+16|0,d=h+8|0,u=h,r=h+40|0,l[(a=h+36|0)>>2]=i,o=t+80|0;do{if((0|l[16+(0|l[o>>2])>>2])>>>0<257){if(0|i){nt(e,r,1),u=-1,f=1;break}return mt(n,1,10473,u),w=h,0|(p=0)}if(i>>>0>=2){nt(e,r,2),u=-2,f=2;break}return mt(n,1,10473,d),w=h,0|(p=0)}while(0);return l[a>>2]=u+i,(d=0|l[r>>2])>>>0>=(u=0|l[16+(0|l[o>>2])>>2])>>>0?(l[s>>2]=d,l[s+4>>2]=u,mt(n,1,10499,s),w=h,0|(p=0)):0|ee(t,d,e+f|0,a,n)?0|l[a>>2]?(mt(n,1,10473,p),w=h,0|(p=0)):(w=h,0|(p=1)):(mt(n,1,10473,c),w=h,0|(p=0))},function(t,e,i,n){e|=0,n|=0;var o,a,s,c,h=0,u=0,d=0,f=0,p=0,m=0;if(c=w,w=w+16|0,d=c+8|0,s=c+12|0,0!=(0|((i|=0)>>>0)%((h=5+((a=(m=0|l[16+(0|l[80+(t|=0)>>2])>>2])>>>0<257?1:2)<<1)|0)>>>0))|h>>>0>i>>>0)return mt(n,1,10429,c),w=c,0|(m=0);if(p=16==(0|l[t+8>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],(o=(f=4&(u=0|r[(t=p+5636|0)>>0])?1+(0|l[p+420>>2])|0:0)+((i>>>0)/(h>>>0)|0)|0)>>>0>31)return l[d>>2]=o,mt(n,1,10455,d),w=c,0|(m=0);if(r[t>>0]=4|u,f>>>0<o>>>0)for(u=p+8|0,t=e,i=f,h=p+424+(148*f|0)|0;nt(t,h,1),nt(t=t+1|0,h+4|0,a),nt(t=t+a|0,f=h+8|0,2),d=0|l[f>>2],e=0|l[u>>2],l[f>>2]=d>>>0<e>>>0?d:e,nt(t=t+2|0,h+12|0,1),nt(t=t+1|0,f=h+16|0,a),nt(t=t+a|0,s,1),l[h+36>>2]=l[s>>2],e=0|l[f>>2],l[f>>2]=e>>>0<m>>>0?e:m,!((i=i+1|0)>>>0>=o>>>0);)t=t+1|0,h=h+148|0;return l[p+420>>2]=o+-1,w=c,0|(m=1)},function(t,e,i,n){e|=0,i|=0,n|=0;var o,s,c,h,u,d,f,p,m,_,g,y,b,v,x=0,A=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0,G=0,N=0,z=0;if(v=w,w=w+160|0,z=v+144|0,O=v+136|0,b=v+128|0,y=v+120|0,D=v+112|0,L=v+104|0,p=v+96|0,f=v+80|0,s=v+72|0,o=v+64|0,P=v+56|0,B=v+48|0,R=v+32|0,E=v+24|0,M=v+16|0,x=v+152|0,u=v+148|0,G=0|l[80+(t|=0)>>2],N=t+88|0,i>>>0<36)return mt(n,1,9677,v),w=v,0|(n=0);if(I=((F=i+-36|0)>>>0)/3|0,0|(F>>>0)%3)return mt(n,1,9677,v+8|0),w=v,0|(n=0);if(nt(e,x,2),a[N>>1]=l[x>>2],nt(e+2|0,d=G+8|0,4),nt(e+6|0,g=G+12|0,4),nt(e+10|0,G,4),nt(e+14|0,k=G+4|0,4),nt(e+18|0,h=t+100|0,4),nt(e+22|0,_=t+104|0,4),nt(e+26|0,c=t+92|0,4),nt(e+30|0,m=t+96|0,4),nt(e+34|0,x,2),A=e+36|0,(i=0|l[x>>2])>>>0>=16385)return l[M>>2]=i,mt(n,1,9705,M),w=v,0|(n=0);if(i&=65535,l[(F=G+16|0)>>2]=i,(0|i)!=(0|I))return l[E>>2]=i,l[E+4>>2]=I,mt(n,1,9766,E),w=v,0|(n=0);if((E=0|l[G>>2])>>>0<(T=0|l[d>>2])>>>0){if((M=0|l[k>>2])>>>0<(e=0|l[g>>2])>>>0){if(x=0|l[h>>2],i=0|l[_>>2],x){if(i){if((4294967295/(T>>>0)|0)>>>0<e>>>0)return l[P>>2]=T,l[P+4>>2]=e,mt(n,1,10007,P),w=v,0|(n=0);if(R=0|br(0|(T=0|l[c>>2]),0,0|x,0),P=S,B=0|br(0|(k=0|l[m>>2]),0,0|i,0),T>>>0<=E>>>0&&k>>>0<=M>>>0&(0-P|R)>>>0>E>>>0&(0-S|B)>>>0>M>>>0){if(i=0|Ut(I,52),l[(I=G+24|0)>>2]=i,!i)return l[F>>2]=0,mt(n,1,10093,s),w=v,0|(n=0);t:do{if(0|l[F>>2]){for(T=t+168|0,E=i,M=0;;){if(nt(A,u,1),e=0|l[u>>2],l[(i=E+24|0)>>2]=1+(127&e),l[E+32>>2]=e>>>7,nt(A+1|0,u,1),l[E>>2]=l[u>>2],nt(A+2|0,u,1),e=0|l[u>>2],l[E+4>>2]=e,(e+-1|0)>>>0>254|((x=0|l[E>>2])-1|0)>>>0>254){i=26;break}if((e=0|l[i>>2])>>>0>38){i=28;break}if(l[E+36>>2]=0,l[E+40>>2]=l[T>>2],!((i=M+1|0)>>>0<(0|l[F>>2])>>>0))break t;E=E+52|0,A=A+3|0,M=i}return 26==(0|i)?(l[f>>2]=M,l[f+4>>2]=x,l[f+8>>2]=e,mt(n,1,10141,f)):28==(0|i)&&(l[p>>2]=M,l[p+4>>2]=e,mt(n,1,10246,p)),w=v,0|(n=0)}}while(0);if(T=0|l[c>>2],E=0|l[h>>2],A=((0|l[d>>2])-1-T+E|0)/(0|E)|0,l[t+112>>2]=A,M=0|l[m>>2],x=0|l[_>>2],i=((0|l[g>>2])-1-M+x|0)/(0|x)|0,l[t+116>>2]=i,!(0==(0|i)|0==(0|A))&&A>>>0<=(65535/(i>>>0)|0)>>>0){if(k=0|C(A,i),e=t+28|0,2&r[t+76>>0]?(l[e>>2]=(((0|l[e>>2])-T|0)>>>0)/(E>>>0)|0,l[(i=t+32|0)>>2]=(((0|l[i>>2])-M|0)>>>0)/(x>>>0)|0,l[(i=t+36|0)>>2]=((0|l[i>>2])-1-T+E|0)/(0|E)|0,e=i=t+40|0,i=((0|l[i>>2])-1-M+x|0)/(0|x)|0):(l[e>>2]=0,l[t+32>>2]=0,l[t+36>>2]=A,e=t+40|0),l[e>>2]=i,L=0|Ut(k,5640),l[(M=t+164|0)>>2]=L,!L)return mt(n,1,10093,D),w=v,0|(n=0);if(D=0|Ut(0|l[F>>2],1080),l[5584+(0|l[(A=t+12|0)>>2])>>2]=D,!(0|l[5584+(0|l[A>>2])>>2]))return mt(n,1,10093,y),w=v,0|(n=0);if(i=0|Ut(10,20),l[5612+(0|l[A>>2])>>2]=i,i=0|l[A>>2],!(0|l[i+5612>>2]))return mt(n,1,10093,b),w=v,0|(n=0);if(l[i+5620>>2]=10,i=0|Ut(10,20),l[5624+(0|l[A>>2])>>2]=i,i=0|l[A>>2],!(0|l[i+5624>>2]))return mt(n,1,10093,O),w=v,0|(n=0);if(l[i+5632>>2]=10,0|(x=0|l[F>>2])){e=0|l[I>>2],i=0;do{0|l[e+(52*i|0)+32>>2]||(l[(0|l[5584+(0|l[A>>2])>>2])+(1080*i|0)+1076>>2]=1<<(0|l[e+(52*i|0)+24>>2])-1),i=i+1|0}while(i>>>0<x>>>0)}t:do{if(0|k){if(i=0|l[M>>2],O=0|Ut(x,1080),l[i+5584>>2]=O,0|O)for(e=0;;){if((e=e+1|0)>>>0>=k>>>0)break t;if(O=0|Ut(0|l[F>>2],1080),l[i+11224>>2]=O,!O)break;i=i+5640|0}return mt(n,1,10093,z),w=v,0|(n=0)}}while(0);return l[t+8>>2]=4,function(t,e){t|=0;var i,n=0,r=0,o=0,a=0,s=0,c=0,h=0,u=0,d=0,f=0,p=0;if(n=0|l[4+(e|=0)>>2],r=0|l[t>>2],a=0|l[e+8>>2],s=0|l[t+4>>2],o=0|l[e+12>>2],u=(0|C((0|l[e+24>>2])-1|0,o))+n|0,c=0|l[e+16>>2],h=(0|C((0|l[e+28>>2])-1|0,c))+a|0,e=0|br(0|u,0,0|o,0),e|=0-S,o=0|l[t+8>>2],c=0|br(0|h,0,0|c,0),c|=0-S,h=0|l[t+12>>2],u=0|l[t+16>>2])for(i=(n>>>0>r>>>0?n:r)+-1|0,a=(a>>>0>s>>>0?a:s)+-1|0,o=(e>>>0<o>>>0?e:o)+-1|0,r=(c>>>0<h>>>0?c:h)+-1|0,n=0,e=0|l[t+24>>2];h=((i+(s=0|l[e>>2])|0)>>>0)/(s>>>0)|0,t=((a+(p=0|l[e+4>>2])|0)>>>0)/(p>>>0)|0,f=0|Tr(1,0,0|(c=0|l[e+40>>2])),d=S,s=0|Er(0|(s=0|br(0|(s=0|br((((o+s|0)>>>0)/(s>>>0)|0)-h|0,0,-1,-1)),0|S,0|f,0|d)),0|S,0|c),c=0|Er(0|(d=0|br(0|(p=0|br((((r+p|0)>>>0)/(p>>>0)|0)-t|0,0,-1,-1)),0|S,0|f,0|d)),0|S,0|c),l[e+8>>2]=s,l[e+12>>2]=c,l[e+16>>2]=h,l[e+20>>2]=t,!((n=n+1|0)>>>0>=u>>>0);)e=e+52|0}(G,N),w=v,0|(n=1)}return l[L>>2]=A,l[L+4>>2]=i,mt(n,1,10346,L),w=v,0|(n=0)}return mt(n,1,10049,o),w=v,0|(n=0)}i=0}return l[B>>2]=x,l[B+4>>2]=i,mt(n,1,9946,B),w=v,0|(n=0)}i=M}else e=0|l[g>>2],i=0|l[k>>2];return t=0|vr(0|T,0,0|E,0),G=S,N=0|vr(0|e,0,0|i,0),l[(z=R)>>2]=t,l[z+4>>2]=G,l[(z=R+8|0)>>2]=N,l[z+4>>2]=S,mt(n,1,9880,R),w=v,0|(n=0)},function(t,e,i,n){var r;return t|=0,e|=0,n|=0,r=w,w=w+32|0,t=r+12|0,(i|=0)>>>0<2?(mt(n,1,9651,r),w=r,0|(n=0)):(nt(e,r+16|0,1),nt(e+1|0,t,1),((i+-2|0)>>>0)%((2+((e=0|l[t>>2])>>>5&2)+(e>>>4&3)|0)>>>0)|0?(mt(n,1,9651,r+8|0),w=r,0|(n=0)):(w=r,0|(n=1)))},function(t,e,i,n){return t|=0,e|=0,n|=0,e=w,w=w+16|0,(i|=0)?t=1:(mt(n,1,9625,e),t=0),w=e,0|t},function(t,e,i,n){t|=0,e|=0,n|=0;var r,o,a,s,c=0;if(s=w,w=w+32|0,a=s+8|0,o=s+12|0,!(i|=0))return mt(n,1,9599,s),w=s,0|(n=0);if(nt(e,s+16|0,1),!(r=i+-1|0))return w=s,0|(n=1);c=0,t=e,i=0;do{nt(t=t+1|0,o,1),c=0==(128&(e=0|l[o>>2])|0)?0:(127&e|c)<<7,i=i+1|0}while((0|i)!=(0|r));return c?(mt(n,1,9599,a),w=s,0|(n=0)):(w=s,0|(n=1))},function(t,e,i,n){t|=0,e|=0,n|=0;var o,a,s,c,h,u,d=0,f=0,p=0;if(u=w,w=w+48|0,p=u+32|0,s=u+24|0,o=u+16|0,d=u+8|0,h=u+36|0,(i|=0)>>>0<2)return mt(n,1,9551,u),w=u,0|(p=0);r[(f=t+184|0)>>0]=1|r[f>>0],nt(e,h,1),f=e+1|0,c=i+-1|0,i=0|l[(a=t+124|0)>>2];do{if(!i){if(i=0|Ut(e=1+(0|l[h>>2])|0,8),l[a>>2]=i,0|i){l[t+120>>2]=e;break}return mt(n,1,8618,d),w=u,0|(p=0)}if(d=t+120|0,e=0|l[h>>2],(0|l[d>>2])>>>0<=e>>>0){if(0|(e=0|Wt(i,(t=e+1|0)<<3))){l[a>>2]=e,Ir(e+((i=0|l[d>>2])<<3)|0,0,t-i<<3|0),l[d>>2]=t,i=0|l[a>>2];break}return mt(n,1,8618,o),w=u,0|(p=0)}}while(0);return e=0|l[h>>2],0|l[i+(e<<3)>>2]?(l[s>>2]=e,mt(n,1,9577,s),w=u,0|(p=0)):(t=0|zt(c),i=0|l[a>>2],e=0|l[h>>2],l[i+(e<<3)>>2]=t,t?(l[i+(e<<3)+4>>2]=c,Cr(0|t,0|f,0|c),w=u,0|(p=1)):(mt(n,1,8618,p),w=u,0|(p=0)))},function(t,e,i,n){t|=0,e|=0,n|=0;var o,a,s,c,h,u,d,f,p=0,m=0,_=0;if(f=w,w=w+48|0,_=f+40|0,u=f+32|0,s=f+24|0,a=f+16|0,d=f+44|0,(i|=0)>>>0<2)return mt(n,1,9364,f),w=f,0|(_=0);if(1&r[t+184>>0])return mt(n,1,9390,f+8|0),w=f,0|(_=0);o=0|l[t+164>>2],p=0|l[t+200>>2],r[(m=o+(5640*p|0)+5636|0)>>0]=2|r[m>>0],nt(e,d,1),m=e+1|0,h=i+-1|0,e=0|l[(c=o+(5640*p|0)+5164|0)>>2];do{if(!e){if(e=0|Ut(t=1+(0|l[d>>2])|0,8),l[c>>2]=e,0|e){l[o+(5640*p|0)+5160>>2]=t;break}return mt(n,1,9491,a),w=f,0|(_=0)}if(p=o+(5640*p|0)+5160|0,t=0|l[d>>2],(0|l[p>>2])>>>0<=t>>>0){if(0|(t=0|Wt(e,(i=t+1|0)<<3))){l[c>>2]=t,Ir(t+((e=0|l[p>>2])<<3)|0,0,i-e<<3|0),l[p>>2]=i,e=0|l[c>>2];break}return mt(n,1,9491,s),w=f,0|(_=0)}}while(0);return t=0|l[d>>2],0|l[e+(t<<3)>>2]?(l[u>>2]=t,mt(n,1,9529,u),w=f,0|(_=0)):(i=0|zt(h),e=0|l[c>>2],t=0|l[d>>2],l[e+(t<<3)>>2]=i,i?(l[e+(t<<3)+4>>2]=h,Cr(0|i,0|m,0|h),w=f,0|(_=1)):(mt(n,1,9491,_),w=f,0|(_=0)))},function(t,e,i,n){return e|=0,i|=0,n|=0,e=w,w=w+16|0,(l[16+(0|l[80+(t|=0)>>2])>>2]<<2|0)==(0|i)?(w=e,0|(n=1)):(mt(n,1,9338,e),w=e,0|(n=0))},function(t,e,i,n){return 1},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0;if(u=w,w=w+48|0,g=u+40|0,h=u+32|0,o=u+24|0,c=u+44|0,m=16==(0|l[8+(t|=0)>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],i>>>0<2)return mt(n,1,9170,u),w=u,0|(g=0);if(nt(e,c,2),0|l[c>>2])return mt(n,2,9196,u+8|0),w=u,0|(g=1);if(i>>>0<7)return mt(n,1,9170,u+16|0),w=u,0|(g=0);nt(e+2|0,c,2),s=e+4|0,_=255&l[c>>2],d=0|l[(r=m+5612|0)>>2],t=0|l[(a=m+5616|0)>>2];t:do{if(t){f=d,p=0;do{if((0|l[f+8>>2])==(0|_))break t;f=f+20|0,p=p+1|0}while(p>>>0<t>>>0)}else f=d,p=0}while(0);if((0|p)==(0|t)){f=m+5620|0;do{if((0|t)==(0|l[f>>2])){if(t=t+10|0,l[f>>2]=t,0|(t=0|Wt(d,20*t|0))){l[r>>2]=t,Ir(t+(20*(d=0|l[a>>2])|0)|0,0,20*((0|l[f>>2])-d|0)|0),d=0|l[r>>2],t=0|l[a>>2];break}return jt(0|l[r>>2]),l[r>>2]=0,l[f>>2]=0,l[a>>2]=0,mt(n,1,9256,o),w=u,0|(g=0)}}while(0);l[a>>2]=t+1,f=d+(20*t|0)|0}return 0|(t=0|l[(p=f+12|0)>>2])&&(jt(t),l[p>>2]=0),l[f+8>>2]=_,_=0|l[c>>2],l[f+4>>2]=_>>>8&3,l[f>>2]=_>>>10&3,nt(s,c,2),0|l[c>>2]?(mt(n,2,9294,h),w=u,0|(g=1)):(d=0|zt(t=i+-6|0),l[p>>2]=d,d?(Cr(0|d,e+6|0,0|t),l[f+16>>2]=t,w=u,0|(g=1)):(mt(n,1,9170,g),w=u,0|(g=0)))},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s=0;if(a=w,w=w+32|0,r=a+16|0,s=a+12|0,(2+(o=0|l[16+(0|l[(t=80+(t|=0)|0)>>2])>>2])|0)!=(0|i))return mt(n,1,9144,a),w=a,0|(s=0);if(nt(e,r,2),(0|l[r>>2])!=(0|o))return mt(n,1,9144,a+8|0),w=a,0|(s=0);if(!o)return w=a,0|(s=1);for(n=0,i=e+2|0,t=0|l[24+(0|l[t>>2])>>2];;){if(nt(i,s,1),e=0|l[s>>2],l[t+32>>2]=e>>>7&1,l[t+24>>2]=1+(127&e),(0|(n=n+1|0))==(0|o)){t=1;break}i=i+1|0,t=t+52|0}return w=a,0|t},function(t,e,i,n){e|=0,i|=0,n|=0;var o,a,s,c,h,u,d,f,p,m,_,g,y,b,v,x=0,A=0,S=0,M=0,E=0,T=0,k=0,I=0,P=0,R=0,B=0,L=0,D=0,O=0,F=0;if(v=w,w=w+144|0,F=v+120|0,b=v+112|0,y=v+104|0,g=v+96|0,_=v+88|0,m=v+80|0,p=v+72|0,f=v+64|0,d=v+56|0,u=v+48|0,P=v+40|0,I=v+32|0,T=v+24|0,o=v+136|0,a=v+132|0,s=v+128|0,c=v+124|0,R=16==(0|l[8+(t|=0)>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],i>>>0<2)return mt(n,1,8804,v),w=v,0|(F=0);if(nt(e,o,2),0|l[o>>2])return mt(n,2,8830,v+8|0),w=v,0|(F=1);if(i>>>0<7)return mt(n,1,8804,v+16|0),w=v,0|(F=0);nt(e+2|0,a,1),k=e+3|0,x=0|l[(E=R+5624|0)>>2],t=0|l[(h=R+5628|0)>>2];t:do{if(t){M=0|l[a>>2],S=x,A=0;do{if((0|l[S>>2])==(0|M))break t;S=S+20|0,A=A+1|0}while(A>>>0<t>>>0)}else S=x,A=0}while(0);if((0|A)==(0|t)){A=R+5632|0;do{if((0|t)==(0|l[A>>2])){if(t=t+10|0,l[A>>2]=t,0|(t=0|Wt(x,20*t|0))){l[E>>2]=t,Ir(t+(20*(x=0|l[h>>2])|0)|0,0,20*((0|l[A>>2])-x|0)|0),x=0|l[E>>2],t=0|l[h>>2];break}return jt(0|l[E>>2]),l[E>>2]=0,l[A>>2]=0,l[h>>2]=0,mt(n,1,8876,T),w=v,0|(F=0)}}while(0);O=1,A=x+(20*t|0)|0}else O=0,A=S;if(l[A>>2]=l[a>>2],nt(k,o,2),0|l[o>>2])return mt(n,2,8830,I),w=v,0|(F=1);if(nt(e+5|0,s,2),(x=0|l[s>>2])>>>0>1)return mt(n,2,8914,P),w=v,0|(F=1);t=i+-7|0;t:do{if(x){B=A+4|0,L=A+16|0,D=A+8|0,i=A+12|0,P=R+5612|0,I=R+5616|0,T=e+7|0,k=0;e:for(;;){if(t>>>0<3){x=27;break}if(nt(T,o,1),1!=(0|l[o>>2])){x=29;break}if(nt(T+1|0,c,2),x=t+-3|0,M=1+((S=0|l[c>>2])>>>15)|0,S&=32767,l[B>>2]=S,x>>>0<(A=2+(0|C(M,S))|0)>>>0){x=31;break}if(t=T+3|0,E=x-A|0,S){x=0;do{if(nt(t,o,M),(0|l[o>>2])!=(0|x)){x=34;break e}t=t+M|0,x=x+1|0}while(x>>>0<(0|l[B>>2])>>>0)}if(nt(t,c,2),x=t+2|0,S=1+((A=0|l[c>>2])>>>15)|0,A&=32767,l[c>>2]=A,(0|A)!=(0|l[B>>2])){x=37;break}if(E>>>0<(t=3+(0|C(S,A))|0)>>>0){x=39;break}if(t=E-t|0,A){A=0;do{if(nt(x,o,S),(0|l[o>>2])!=(0|A)){x=42;break e}x=x+S|0,A=A+1|0}while(A>>>0<(0|l[B>>2])>>>0)}if(nt(x,o,3),T=x+3|0,S=0|l[o>>2],r[L>>0]=1&(S>>>16^1)|-2&r[L>>0],l[D>>2]=0,l[i>>2]=0,M=255&S,l[a>>2]=M,0|M){if(!(E=0|l[I>>2])){x=50;break}for(x=0|l[P>>2],A=0;(0|l[x+8>>2])!=(0|M);){if((A=A+1|0)>>>0>=E>>>0){x=50;break e}x=x+20|0}l[D>>2]=x}if(S=S>>>8&255,l[a>>2]=S,0|S){if(!(M=0|l[I>>2])){x=57;break}for(x=0|l[P>>2],A=0;(0|l[x+8>>2])!=(0|S);){if((A=A+1|0)>>>0>=M>>>0){x=57;break e}x=x+20|0}l[i>>2]=x}if((k=k+1|0)>>>0>=(0|l[s>>2])>>>0)break t}if(27==(0|x))return mt(n,1,8804,u),w=v,0|(F=0);if(29==(0|x))return mt(n,2,8958,d),w=v,0|(F=1);if(31==(0|x))return mt(n,1,8804,f),w=v,0|(F=0);if(34==(0|x))return mt(n,2,9024,p),w=v,0|(F=1);if(37==(0|x))return mt(n,2,9078,m),w=v,0|(F=1);if(39==(0|x))return mt(n,1,8804,_),w=v,0|(F=0);if(42==(0|x))return mt(n,2,9024,g),w=v,0|(F=1);if(50==(0|x))return mt(n,1,8804,y),w=v,0|(F=0);if(57==(0|x))return mt(n,1,8804,b),w=v,0|(F=0)}}while(0);return 0|t?(mt(n,1,8804,F),w=v,0|(F=0)):O?(l[h>>2]=1+(0|l[h>>2]),w=v,0|(F=1)):(w=v,0|(F=1))},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c,h,u,d=0,f=0,p=0,m=0,_=0,g=0;if(u=w,w=w+32|0,c=u+24|0,h=u+20|0,d=0|l[(g=80+(t|=0)|0)>>2],f=16==(0|l[t+8>>2])?(0|l[t+164>>2])+(5640*(0|l[t+200>>2])|0)|0:0|l[t+12>>2],!i)return mt(n,1,8723,u),w=u,0|(g=0);if(nt(e,h,1),(t=0|l[h>>2])>>>0>1)return mt(n,2,8749,u+8|0),w=u,0|(g=1);if((t+1|0)!=(0|i))return mt(n,2,8723,u+16|0),w=u,0|(g=0);if(s=f+5584|0,0|(d=0|l[d+16>>2]))for(i=0|l[s>>2],n=0;l[i+1076>>2]=0,!((n=n+1|0)>>>0>=d>>>0);)i=i+1080|0;if((i=0|l[(a=f+5604|0)>>2])&&(jt(i),l[a>>2]=0,t=0|l[h>>2]),!t)return w=u,0|(g=1);for(o=f+5624|0,r=f+5628|0,p=0;;){if(nt(e=e+1|0,c,1),t=0|l[g>>2],d=0|l[o>>2],0|l[r>>2]&&(0|l[d>>2])==(0|l[c>>2])&&(0|(m=0|l[d+4>>2]))==(0|l[(_=t+16|0)>>2])){if(0|(t=0|l[d+8>>2])){if(i=0|C(m,m),f=0|C(0|l[1036+(l[t>>2]<<2)>>2],i),(0|l[t+16>>2])!=(0|f)){t=0,i=32;break}if(n=0|zt(i<<2),l[a>>2]=n,!n){t=0,i=32;break}ro[15&l[1052+(l[t>>2]<<2)>>2]](0|l[t+12>>2],n,i)}if(0|(t=0|l[d+12>>2])){if(i=0|l[_>>2],f=0|C(i,0|l[1036+(l[t>>2]<<2)>>2]),(0|l[t+16>>2])!=(0|f)){t=0,i=32;break}if(!(f=0|zt(i<<2))){t=0,i=32;break}if(ro[15&l[1068+(l[t>>2]<<2)>>2]](0|l[t+12>>2],f,i),0|(d=0|l[_>>2]))for(t=f,i=0|l[s>>2],n=0;l[i+1076>>2]=l[t>>2],(0|(n=n+1|0))!=(0|d);)t=t+4|0,i=i+1080|0;jt(f)}}if((p=p+1|0)>>>0>=(0|l[h>>2])>>>0){t=1,i=32;break}}return 32==(0|i)?(w=u,0|t):0},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o=0;return r=w,w=w+32|0,o=r+20|0,0|l[(t=100+(t|=0)|0)>>2]?(mt(n,1,19251,r),w=r,0|(o=0)):4!=(0|i)?(mt(n,1,19305,r+8|0),w=r,0|(o=0)):(nt(e,o,4),218793738==(0|l[o>>2])?(l[t>>2]=1|l[t>>2],w=r,0|(o=1)):(mt(n,1,19339,r+16|0),w=r,0|(o=0)))},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s=0;if(a=w,w=w+32|0,o=a+24|0,1!=(0|l[(s=100+(t|=0)|0)>>2]))return mt(n,1,19132,a),w=a,0|(s=0);if(i>>>0<8)return mt(n,1,19182,a+8|0),w=a,0|(s=0);if(nt(e,t+56|0,4),nt(e+4|0,t+60|0,4),e=e+8|0,3&(i=i+-8|0)|0)return mt(n,1,19182,a+16|0),w=a,0|(s=0);if(i>>>=2,l[(r=t+64|0)>>2]=i,0|i){if(i=0|Ut(i,4),l[t+68>>2]=i,!i)return mt(n,1,19218,o),w=a,0|(s=0);if(0|l[r>>2])for(t=t+68|0,i=0;nt(e,(0|l[t>>2])+(i<<2)|0,4),!((i=i+1|0)>>>0>=(0|l[r>>2])>>>0);)e=e+4|0}return l[s>>2]=2|l[s>>2],w=a,0|(s=1)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c,h,u,d,f,p,m,_,g,y=0,b=0,v=0,x=0,A=0,S=0,M=0;if(g=w,w=w+96|0,f=g+72|0,d=g+64|0,u=g+56|0,h=g+48|0,M=g+40|0,_=g+32|0,m=g+24|0,p=g+16|0,c=g+8|0,o=g+80|0,a=g+76|0,!(2&l[(s=100+(t|=0)|0)>>2]))return mt(n,1,18800,g),w=g,0|(M=0);l[(r=t+104|0)>>2]=0;do{if(0|i){x=0;t:for(;;){if(i>>>0<8){v=6;break}switch(nt(e,o,4),y=0|l[o>>2],nt(e+4|0,o,4),S=0|l[o>>2],0|y){case 0:v=15;break t;case 1:if(i>>>0<16){v=9;break t}if(nt(e+8|0,a,4),0|l[a>>2]){v=11;break t}if(nt(e+12|0,o,4),!(y=0|l[o>>2])){v=13;break t}A=16;break;default:A=8}if(y>>>0<A>>>0){v=17;break}if(i>>>0<y>>>0){v=20;break}e:do{if((0|S)<1668246642){if((0|S)<1667523942){switch(0|S){case 1651532643:break;default:v=28;break e}b=1124,v=27;break}if((0|S)<1668112752){switch(0|S){case 1667523942:break;default:v=28;break e}b=1148,v=27;break}switch(0|S){case 1668112752:break;default:v=28;break e}b=1140,v=27;break}if((0|S)<1768449138){switch(0|S){case 1668246642:break;default:v=28;break e}b=1116,v=27;break}if((0|S)<1885564018)switch(0|S){case 1768449138:b=1108,v=27;break e;default:v=28;break e}switch(0|S){case 1885564018:break;default:v=28;break e}b=1132,v=27}while(0);if(27==(0|v)){if(!(0|qr[63&l[b+4>>2]](t,e+A|0,y-A|0,n))){e=0,v=33;break}}else 28==(0|v)&&(l[r>>2]=2147483647|l[r>>2]);if(x=1768449138==(0|S)?1:x,!(i=i-y|0)){v=30;break}e=e+y|0}if(6==(0|v))mt(n,1,18845,c);else if(9==(0|v))mt(n,1,18885,p);else if(11==(0|v))mt(n,1,17154,m);else if(13==(0|v))mt(n,1,17224,_);else if(15==(0|v))mt(n,1,17224,M);else if(17==(0|v))mt(n,1,18929,h);else{if(20==(0|v))return mt(n,1,19001,d),w=g,0|(M=0);if(30==(0|v)){if(!x)break;return l[s>>2]=4|l[s>>2],w=g,0|(M=1)}if(33==(0|v))return w=g,0|e}return mt(n,1,18958,u),w=g,0|(M=0)}}while(0);return mt(n,1,19073,f),w=g,0|(M=0)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a=0;return o=w,w=w+48|0,a=o+32|0,0|l[(r=72+(t|=0)|0)>>2]?(mt(n,2,18543,o),w=o,0|(a=1)):14!=(0|i)?(mt(n,1,18591,o+8|0),w=o,0|(a=0)):(nt(e,t+16|0,4),nt(e+4|0,t+12|0,4),nt(e+8|0,i=t+20|0,2),((i=0|l[i>>2])-1|0)>>>0>16383?(mt(n,1,18624,o+16|0),w=o,0|(a=0)):(i=0|Ut(i,12),l[r>>2]=i,i?(nt(e+10|0,t+24|0,1),nt(e+11|0,i=t+28|0,1),7!=(0|(i=0|l[i>>2]))&&(l[a>>2]=i,mt(n,4,18710,a)),nt(e+12|0,t+32|0,1),nt(e+13|0,t+36|0,1),w=o,0|(a=1)):(mt(n,1,18661,o+24|0),w=o,0|(a=0))))},function(t,e,i,n){t|=0,e|=0,n|=0;var o,a,s,c,h,u,d,f,p,m,_=0,g=0,y=0,b=0,v=0,x=0,A=0,S=0;if(m=w,w=w+96|0,y=m+48|0,a=m+40|0,x=m+32|0,v=m+24|0,b=m+16|0,A=m+80|0,o=m+76|0,h=m+72|0,s=m+68|0,u=m+64|0,c=m+60|0,d=m+56|0,f=m+52|0,(i|=0)>>>0<3)return mt(n,1,18186,m),w=m,0|(S=0);if(p=t+108|0,0|r[(S=t+124|0)>>0])return mt(n,4,18218,m+8|0),w=m,0|(S=1);switch(nt(e,g=t+40|0,1),nt(e+1|0,t+52|0,1),nt(e+2|0,t+44|0,1),_=e+3|0,0|(g=0|l[g>>2])){case 1:if(i>>>0<7)return l[b>>2]=i,mt(n,1,18327,b),w=m,0|(S=0);if(g=t+48|0,7!=(0|i)&&14!=(0|l[g>>2])&&(l[v>>2]=i,mt(n,2,18327,v)),nt(_,g,4),y=e+7|0,14==(0|l[g>>2])){if(!(A=0|zt(36)))return mt(n,1,18363,x),w=m,0|(S=0);switch(l[A>>2]=14,l[d>>2]=0,l[u>>2]=0,l[h>>2]=0,l[c>>2]=0,l[s>>2]=0,l[o>>2]=0,l[f>>2]=4470064,l[(_=A+4|0)>>2]=1145390592,0|i){case 35:nt(y,o,4),nt(e+11|0,h,4),nt(e+15|0,s,4),nt(e+19|0,u,4),nt(e+23|0,c,4),nt(e+27|0,d,4),nt(e+31|0,f,4),l[_>>2]=0,e=0|l[o>>2],x=0|l[s>>2],v=0|l[c>>2],b=0|l[h>>2],y=0|l[u>>2],g=0|l[d>>2],_=0|l[f>>2];break;case 7:e=0,x=0,v=0,b=0,y=0,g=0,_=4470064;break;default:l[a>>2]=i,mt(n,2,18393,a),e=0,x=0,v=0,b=0,y=0,g=0,_=4470064}l[A+8>>2]=e,l[A+16>>2]=x,l[A+24>>2]=v,l[A+12>>2]=b,l[A+20>>2]=y,l[A+28>>2]=g,l[A+32>>2]=_,l[p>>2]=A,l[t+112>>2]=0}return r[S>>0]=1,w=m,0|(S=1);case 2:if(y=i+-3|0,l[(g=t+112|0)>>2]=y,t=0|Ut(1,y),l[p>>2]=t,!t)return l[g>>2]=0,w=m,0|(S=0);if((0|i)>3)for(g=0;nt(_,A,1),r[(0|l[p>>2])+g>>0]=l[A>>2],(0|(g=g+1|0))!=(0|y);)_=_+1|0;return r[S>>0]=1,w=m,0|(S=1);default:return g>>>0<=2?(w=m,0|(S=1)):(l[y>>2]=g,mt(n,4,18437,y),w=m,0|(S=1))}return 0},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o=0,a=0,s=0;if(r=w,w=w+16|0,a=r,255!=(0|(o=0|l[24+(t|=0)>>2]))&&(l[a>>2]=o,mt(n,2,18040,a)),(0|l[(s=t+20|0)>>2])!=(0|i))return mt(n,1,18154,r+8|0),w=r,0|(s=0);if(!i)return w=r,0|(s=1);for(a=t+72|0,o=0;;){if(nt(e,(0|l[a>>2])+(12*o|0)+8|0,1),(o=o+1|0)>>>0>=(0|l[s>>2])>>>0){e=1;break}e=e+1|0}return w=r,0|e},function(t,e,i,n){e|=0,n|=0;var o,s,c,u,d,f=0,p=0,m=0,_=0,g=0;if(d=w,w=w+16|0,f=d,g=d+12|0,(i|=0)>>>0<3|0!=(0|l[(p=120+(t|=0)|0)>>2]))return w=d,0|(g=0);if(nt(e,g,2),((u=65535&(m=0|l[g>>2]))-1|0)>>>0>1023)return l[f>>2]=u,mt(n,1,17957,f),w=d,0|(g=0);if(nt(e+2|0,g,1),!(c=65535&l[g>>2]))return mt(n,1,17995,d+8|0),w=d,0|(g=0);if((c+3|0)>>>0>i>>>0)return w=d,0|(g=0);if(!(o=0|zt(0|C(u<<2,c))))return w=d,0|(g=0);if(!(s=0|zt(c)))return jt(o),w=d,0|(g=0);if(!(_=0|zt(c)))return jt(o),jt(s),w=d,0|(g=0);if(!(t=0|zt(20)))return jt(o),jt(s),jt(_),w=d,0|(g=0);l[t+4>>2]=_,l[t+8>>2]=s,l[t>>2]=o,a[t+16>>1]=m,r[t+18>>0]=l[g>>2],l[t+12>>2]=0,l[p>>2]=t,t=0,n=e+3|0,f=0;do{nt(n,g,1),n=n+1|0,r[s+f>>0]=1+(127&l[g>>2]),r[_+f>>0]=(0|l[g>>2])>>>7&1,f=65535&(t=t+1<<16>>16)}while(c>>>0>f>>>0);if(!u)return w=d,0|(g=1);_=e,m=0,f=o,t=n;t:for(;;){p=0,n=t,t=0;do{if((n-_+(t=(t=(7+(0|h[s+t>>0])|0)>>>3)>>>0<4?t:4)|0)>(0|i)){t=0,f=22;break t}nt(n,g,t),n=n+t|0,l[f>>2]=l[g>>2],f=f+4|0,t=65535&(p=p+1<<16>>16)}while(c>>>0>t>>>0);if(u>>>0<=(65535&(m=m+1<<16>>16))>>>0){t=1,f=22;break}t=n}return 22==(0|f)?(w=d,0|t):0},function(t,e,i,n){e|=0,i|=0,n|=0;var o,s,c,h=0,u=0;if(c=w,w=w+32|0,u=c+20|0,!(t=0|l[(s=120+(t|=0)|0)>>2]))return mt(n,1,17847,c),w=c,0|(u=0);if(0|l[t+12>>2])return mt(n,1,17893,c+8|0),w=c,0|(u=0);if((t=(o=255&(h=0|r[t+18>>0]))<<2)>>>0>i>>>0)return mt(n,1,17924,c+16|0),w=c,0|(u=0);if(!(i=0|zt(t)))return w=c,0|(u=0);if(h<<24>>24)for(t=e,h=0;nt(t,u,2),a[i+(h<<2)>>1]=l[u>>2],nt(t+2|0,u,1),r[i+(h<<2)+2>>0]=l[u>>2],nt(t+3|0,u,1),r[i+(h<<2)+3>>0]=l[u>>2],(0|(h=h+1|0))!=(0|o);)t=t+4|0;return l[12+(0|l[s>>2])>>2]=i,w=c,0|(u=1)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,s=0,c=0;if(o=w,w=w+32|0,c=o+20|0,0|l[(r=116+(t|=0)|0)>>2])return w=o,0|(c=0);if(i>>>0<2)return mt(n,1,17753,o),w=o,0|(c=0);if(nt(e,c,2),!(t=65535&(s=0|l[c>>2])))return mt(n,1,17786,o+8|0),w=o,0|(c=0);if((2+(6*t|0)|0)>>>0>i>>>0)return mt(n,1,17753,o+16|0),w=o,0|(c=0);if(!(s=0|zt(6*s|0)))return w=o,0|(c=0);if(t=0|zt(8),l[r>>2]=t,!t)return jt(s),w=o,0|(c=0);if(l[t>>2]=s,n=65535&l[c>>2],a[t+4>>1]=n,!(n<<16>>16))return w=o,0|(c=1);t=0;do{n=65535&t,nt(e+2|0,c,2),a[s+(6*n|0)>>1]=l[c>>2],nt(e+4|0,c,2),e=e+6|0,a[s+(6*n|0)+2>>1]=l[c>>2],nt(e,c,2),a[s+(6*n|0)+4>>1]=l[c>>2],t=t+1<<16>>16}while((65535&t)<(0|d[4+(0|l[r>>2])>>1]));return w=o,0|(e=1)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c=0,h=0,u=0,d=0,f=0,p=0,m=0;if(s=w,w=w+16|0,m=s+8|0,r=s,8&l[(a=68+(t|=0)|0)>>2]|0)return S=m=-1,w=s,0|(t=-1);c=0|l[(f=t+32|0)>>2],l[(o=t+36|0)>>2]=c,h=0|l[(u=t+48|0)>>2];do{if(h){for(d=t+20|0;-1!=(0|(h=0|Qr[63&l[d>>2]](c,h,0|l[t>>2])));)if(c=(0|l[o>>2])+h|0,l[o>>2]=c,h=(0|l[u>>2])-h|0,l[u>>2]=h,!h){p=6;break}if(6==(0|p)){c=0|l[f>>2];break}return l[a>>2]=8|l[a>>2],mt(n,4,4360,r),l[a>>2]=8|l[a>>2],l[u>>2]=0,S=m=-1,w=s,0|(t=-1)}}while(0);l[o>>2]=c;t:do{if((0|i)>0|0==(0|i)&e>>>0>0){for(f=t+24|0,h=0,c=0;!(-1==(0|(u=0|Qr[63&l[f>>2]](e,i,0|l[t>>2])))&-1==(0|(d=S)));)if(e=0|vr(0|e,0|i,0|u,0|d),i=S,h=0|br(0|u,0|d,0|h,0|c),c=S,!((0|i)>0|0==(0|i)&e>>>0>0))break t;return mt(n,4,4412,m),l[a>>2]=8|l[a>>2],m=0|br(0|l[(m=t=t+56|0)>>2],0|l[m+4>>2],0|h,0|c),l[t>>2]=m,l[t+4>>2]=S,S=m=(t=0!=(0|h)|0!=(0|c))?c:-1,w=s,0|(t=t?h:-1)}h=0,c=0}while(0);return t=0|br(0|l[(t=m=t+56|0)>>2],0|l[t+4>>2],0|h,0|c),l[m>>2]=t,l[m+4>>2]=S,S=m=c,w=s,0|(t=h)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a=0,s=0,c=0,h=0,u=0,d=0;if(o=w,w=w+16|0,d=o,(s=0|l[(a=48+(t|=0)|0)>>2])>>>0>=e>>>0)return l[(d=t+36|0)>>2]=(0|l[d>>2])+e,l[a>>2]=s-e,t=0|br(0|l[(t=d=t+56|0)>>2],0|l[t+4>>2],0|e,0|i),l[d>>2]=t,l[d+4>>2]=S,S=d=i,w=o,0|(t=e);if(4&l[(r=t+68|0)>>2]|0)return l[(d=t+36|0)>>2]=(0|l[d>>2])+s,l[a>>2]=0,d=0|br(0|l[(d=t=t+56|0)>>2],0|l[d+4>>2],0|s,0),l[t>>2]=d,l[t+4>>2]=S,S=d=(t=0!=(0|s))?0:-1,w=o,0|(t=t?s:-1);s?(l[t+36>>2]=l[t+32>>2],e=0|vr(0|e,0|i,0|s,0),l[a>>2]=0,a=0,i=S):(s=0,a=0);t:do{if((0|i)>0|0==(0|i)&e>>>0>0){for(u=t+24|0;!(-1==(0|(c=0|Qr[63&l[u>>2]](e,i,0|l[t>>2])))&-1==(0|(h=S)));)if(e=0|vr(0|e,0|i,0|c,0|h),i=S,s=0|br(0|c,0|h,0|s,0|a),a=S,!((0|i)>0|0==(0|i)&e>>>0>0))break t;return mt(n,4,4386,d),l[r>>2]=4|l[r>>2],d=0|br(0|l[(d=t=t+56|0)>>2],0|l[d+4>>2],0|s,0|a),l[t>>2]=d,l[t+4>>2]=S,S=d=(t=0!=(0|s)|0!=(0|a))?a:-1,w=o,0|(t=t?s:-1)}}while(0);return t=0|br(0|l[(t=d=t+56|0)>>2],0|l[t+4>>2],0|s,0|a),l[d>>2]=t,l[d+4>>2]=S,S=d=a,w=o,0|(t=s)},function(t,e,i,n){e|=0,i|=0,n|=0;var r,o,a,s,c=0,h=0,u=0,d=0,f=0;s=w,w=w+16|0,r=s,c=0|l[(o=32+(t|=0)|0)>>2],l[(a=t+36|0)>>2]=c,h=0|l[(f=t+48|0)>>2];do{if(h){for(u=t+20|0;-1!=(0|(h=0|Qr[63&l[u>>2]](c,h,0|l[t>>2])));)if(c=(0|l[a>>2])+h|0,l[a>>2]=c,h=(0|l[f>>2])-h|0,l[f>>2]=h,!h){d=6;break}if(6==(0|d)){h=t,c=0|l[o>>2];break}return l[(f=t+68|0)>>2]=8|l[f>>2],mt(n,4,4360,r),l[f>>2]=8|l[f>>2],w=s,0|(f=0)}h=t}while(0);return l[a>>2]=c,l[f>>2]=0,0|Qr[63&l[t+28>>2]](e,i,0|l[h>>2])?(l[(f=t+56|0)>>2]=e,l[f+4>>2]=i,w=s,0|(f=1)):(l[(f=t+68|0)>>2]=8|l[f>>2],w=s,0|(f=0))},et,xe,qt,function(t,e,i,n){e|=0,i|=0,n|=0;var r=0,o=0,a=0,s=0,c=0;if(!(0|gi(0|l[(r=4+(t|=0)|0)>>2],55,n)))return 0|(n=0);if(c=0|yi(s=0|l[r>>2]),r=0|bi(s),c){for(o=1,a=0;o=o?0!=(0|Qr[63&l[r>>2]](t,e,n)):0,(0|(a=a+1|0))!=(0|c);)r=r+4|0,o&=1;if(vi(s),!o)return 0|(n=0)}else vi(s);if(!(0|gi(0|l[(r=t+8|0)>>2],56,n)))return 0|(n=0);if(!(0|gi(0|l[r>>2],57,n)))return 0|(n=0);if(!(0|gi(0|l[r>>2],58,n)))return 0|(n=0);if(0|l[t+96>>2]&&0==(0|gi(0|l[r>>2],59,n)))return 0|(n=0);if(!(0|gi(0|l[r>>2],60,n)))return 0|(n=0);if(c=0|yi(s=0|l[r>>2]),r=0|bi(s),c){for(o=1,a=0;o=o?0!=(0|Qr[63&l[r>>2]](t,e,n)):0,(0|(a=a+1|0))!=(0|c);)r=r+4|0,o&=1;if(vi(s),!o)return 0|(n=0)}else vi(s);return 0|(n=0|xe(0|l[t>>2],e,i,n))},function(t,e,i,n){n|=0;var o,s,c,h,u,d,f,p=0,m=0,_=0,g=0,y=0,b=0,v=0,x=0,A=0;if(f=w,w=w+80|0,x=f+64|0,u=f+56|0,s=f+48|0,v=f+40|0,h=f+32|0,c=f+24|0,!(0!=(0|(t|=0))&0!=(0|(e|=0))&0!=(0|(i|=0))))return w=f,0|(e=0);if(((0|l[(d=i+16|0)>>2])-1|0)>>>0>16383)return mt(n,1,16630,f),w=f,0|(e=0);if(!(0|qt(0|l[t>>2],e,i,n)))return w=f,0|(e=0);if(l[t+56>>2]=1785737760,l[t+60>>2]=0,l[t+64>>2]=1,p=0|zt(4),l[t+68>>2]=p,!p)return mt(n,1,16699,f+8|0),w=f,0|(e=0);if(l[p>>2]=1785737760,b=0|l[d>>2],l[t+20>>2]=b,b=0|zt(12*b|0),l[t+72>>2]=b,!b)return mt(n,1,16699,f+16|0),w=f,0|(e=0);if(l[t+16>>2]=(0|l[i+12>>2])-(0|l[i+4>>2]),l[t+12>>2]=(0|l[i+8>>2])-(0|l[i>>2]),o=0|l[(A=i+24|0)>>2],m=0|l[o+24>>2],_=0|l[o+32>>2],l[(g=t+24|0)>>2]=m+-1+(_<<7),(y=0|l[d>>2])>>>0>1){p=1;do{(0|m)!=(0|l[o+(52*p|0)+24>>2])&&(l[g>>2]=255),p=p+1|0}while(p>>>0<y>>>0)}if(l[t+28>>2]=7,l[t+32>>2]=0,l[t+36>>2]=0,0|y&&(l[b+8>>2]=m+-1+(_<<7),1!=(0|y))){p=1;do{l[b+(12*p|0)+8>>2]=(0|l[o+(52*p|0)+24>>2])-1+(l[o+(52*p|0)+32>>2]<<7),p=p+1|0}while(p>>>0<y>>>0)}m=0|l[(p=i+32|0)>>2],_=t+40|0;t:do{if(m)l[_>>2]=2,l[t+48>>2]=0,l[t+112>>2]=m,y=0|Ut(1,m),l[t+108>>2]=y,Cr(0|y,0|l[i+28>>2],0|l[p>>2]),r[t+124>>0]=1,y=0|l[d>>2];else switch(l[_>>2]=1,0|l[i+20>>2]){case 1:l[t+48>>2]=16;break t;case 2:l[t+48>>2]=17;break t;case 3:l[t+48>>2]=18;break t;default:break t}}while(0);t:do{if(0|y){_=0|l[A>>2],g=0,p=0,m=0;do{p=p+(1&(1^(i=0==(0|a[_+(52*m|0)+48>>1]))))|0,g=i?g:m,m=m+1|0}while(m>>>0<y>>>0);switch(0|p){case 0:break t;case 1:break;default:mt(n,2,16995,s);break t}switch(0|l[t+48>>2]){case 18:case 16:p=3;break;case 17:p=1;break;default:mt(n,2,16745,c);break t}if(y>>>0<=p>>>0){mt(n,2,16819,h);break}if(g>>>0<p>>>0){mt(n,2,16912,v);break}if(v=0|zt(8),l[(m=t+116|0)>>2]=v,!v)return mt(n,1,17060,u),w=f,0|(e=0);if(g=0|zt(6*(0|l[d>>2])|0),m=0|l[m>>2],l[m>>2]=g,!g)return mt(n,1,17060,x),w=f,0|(e=0);_=0|l[d>>2],a[m+4>>1]=_,m=0;do{a[g+(6*m|0)>>1]=m,a[g+(6*m|0)+2>>1]=0,x=m,m=m+1|0,a[g+(6*x|0)+4>>1]=m}while((0|m)!=(0|p));if(p>>>0<_>>>0){m=0|l[A>>2];do{A=0==(0|a[m+(52*p|0)+48>>1]),a[g+(6*p|0)>>1]=p,a[g+(6*p|0)+2>>1]=A?-1:1,a[g+(6*p|0)+4>>1]=A<<31>>31,p=p+1|0}while(p>>>0<_>>>0)}}}while(0);return l[t+52>>2]=0,l[t+44>>2]=0,l[t+96>>2]=l[e+18692>>2],w=f,0|(e=1)},fe,te,function(t,e,i,n){t|=0,e|=0,n|=0;var r,o,a,s=0;if(a=w,w=w+16|0,!(i|=0))return w=a,0|(i=0);if(!(0|fe(0|l[t>>2],e,i,n)))return mt(n,1,16201,a),w=a,0|(i=0);if(0|l[t+128>>2])return w=a,0|(i=1);if(!(0|Ee(i,o=t+108|0,n)))return w=a,0|(i=0);switch(0|(e=0|l[t+48>>2])){case 16:l[i+20>>2]=1;break;case 17:l[i+20>>2]=2;break;case 18:l[i+20>>2]=3;break;case 24:l[i+20>>2]=4;break;default:l[i+20>>2]=12==(0|e)?5:-1}e=0|l[(r=t+120|0)>>2];do{if(0|e){if(0|l[e+12>>2]){Te(i,o);break}jt(0|l[e+4>>2]),jt(0|l[8+(0|l[r>>2])>>2]),jt(0|l[l[r>>2]>>2]),e=0|l[r>>2],(s=0|l[e+12>>2])&&(jt(s),e=0|l[r>>2]),jt(e),l[r>>2]=0}}while(0);return 0|l[t+116>>2]&&ke(i,o,n),(e=0|l[o>>2])?(l[i+28>>2]=e,l[i+32>>2]=l[t+112>>2],l[o>>2]=0,w=a,0|(i=1)):(w=a,0|(i=1))},function(t,e,i,n){t|=0,i|=0,n|=0;var r,o=0,a=0,s=0,c=0,h=0;if(!(0|gi(0|l[(c=8+(e|=0)|0)>>2],53,n)))return 0|(n=0);if(r=0|yi(h=0|l[e+4>>2]),o=0|bi(h),r){for(a=1,s=0;a=a?0!=(0|Qr[63&l[o>>2]](e,t,n)):0,(0|(s=s+1|0))!=(0|r);)o=o+4|0,a&=1;if(vi(h),!a)return 0|(n=0)}else vi(h);if(h=0|yi(c=0|l[c>>2]),o=0|bi(c),h){for(a=1,s=0;a=a?0!=(0|Qr[63&l[o>>2]](e,t,n)):0,(0|(s=s+1|0))!=(0|h);)o=o+4|0,a&=1;if(vi(c),!a)return 0|(n=0)}else vi(c);return 0|(n=0|te(t,0|l[e>>2],i,n))},Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr,Gr],Kr=[Nr,me,function(t,e,i,n,r){var o,a,s;if(t|=0,e|=0,n|=0,r|=0,s=w,w=w+16|0,!(i|=0))return w=s,0|(i=0);if(mt(n,2,19580,s),!(0|me(0|l[t>>2],e,i,n,r)))return mt(n,1,16201,s+8|0),w=s,0|(i=0);if(!(0|Ee(i,a=t+108|0,n)))return w=s,0|(i=0);switch(0|(e=0|l[t+48>>2])){case 16:l[i+20>>2]=1;break;case 17:l[i+20>>2]=2;break;case 18:l[i+20>>2]=3;break;case 24:l[i+20>>2]=4;break;default:l[i+20>>2]=12==(0|e)?5:-1}e=0|l[(o=t+120|0)>>2];do{if(0|e){if(0|l[e+12>>2]){Te(i,a);break}jt(0|l[e+4>>2]),jt(0|l[8+(0|l[o>>2])>>2]),jt(0|l[l[o>>2]>>2]),e=0|l[o>>2],(r=0|l[e+12>>2])&&(jt(r),e=0|l[o>>2]),jt(e),l[o>>2]=0}}while(0);return 0|l[t+116>>2]&&ke(i,a,n),(e=0|l[a>>2])?(l[i+28>>2]=e,l[i+32>>2]=l[t+112>>2],l[a>>2]=0,w=s,0|(i=1)):(w=s,0|(i=1))},Nr],$r=[zr,Me,function(t,e,i,n,r,o){return e|=0,i|=0,n|=0,r|=0,o|=0,0|Me(0|l[(t|=0)>>2],e,i,n,r,o)},re,function(t,e,i,n,r,o){return e|=0,i|=0,n|=0,r|=0,o|=0,0|re(0|l[(t|=0)>>2],e,i,n,r,o)},zr,zr,zr],to=[Ur,oe,function(t,e,i,n,r,o,a){return e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,0|oe(0|l[(t|=0)>>2],e,i,n,r,o,a)},Ur],eo=[Hr,ne,function(t,e,i,n,r,o,a,s,c,h,u){return e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,c|=0,h|=0,u|=0,0|ne(0|l[(t|=0)>>2],e,i,n,r,o,a,s,c,h,u)},Hr],io=[Vr,Xt,Ce,function(t){var e,i,n=0,r=0,o=0;if(n=0|l[(i=24+(t|=0)|0)>>2]){if(e=((o=0|l[t+28>>2])>>>0)/52|0,o>>>0>51){for(o=0;0|(t=0|l[n>>2])&&(jt(t+-1|0),l[n>>2]=0),0|(r=0|l[(t=n+4|0)>>2])&&(jt(r),l[t>>2]=0),0|(r=0|l[(t=n+8|0)>>2])&&(jt(r),l[t>>2]=0),!((o=o+1|0)>>>0>=e>>>0);)n=n+52|0;n=0|l[i>>2]}jt(n),l[i>>2]=0}},function(t){var e,i,n=0,r=0,o=0;if(n=0|l[(i=24+(t|=0)|0)>>2]){if(e=((o=0|l[t+28>>2])>>>0)/56|0,o>>>0>55){for(o=0;0|(t=0|l[n>>2])&&(jt(t),l[n>>2]=0),0|(r=0|l[(t=n+4|0)>>2])&&(jt(r),l[t>>2]=0),!((o=o+1|0)>>>0>=e>>>0);)n=n+56|0;n=0|l[i>>2]}jt(n),l[i>>2]=0}},Vr,Vr,Vr],no=[Wr,function(t,e){},function(t,e){},function(t,e){var i;t|=0,e|=0,e=w,w=w+16|0,l[(i=e)>>2]=t,function(t,e){t|=0,e|=0;var i=0,n=0;i=w,w=w+16|0,l[(n=i)>>2]=e,e=0|jn(0|l[665],t,n),w=i}(4200,i),w=e},function(t,e){},Zt,function(t,e){e|=0,Zt(0|l[(t|=0)>>2],e),r[t+124>>0]=0,l[t+128>>2]=1&l[e+8248>>2]},Wr],ro=[jr,function(t,e,i){t|=0,e|=0;var n=0;if(i|=0)for(n=0;it(e,~~+m[t>>2]>>>0,2),(0|(n=n+1|0))!=(0|i);)t=t+4|0,e=e+2|0},function(t,e,i){t|=0,e|=0;var n=0;if(i|=0)for(n=0;it(e,~~+m[t>>2]>>>0,4),(0|(n=n+1|0))!=(0|i);)t=t+4|0,e=e+4|0},function(t,e,i){t|=0,e|=0;var n=0;if(i|=0)for(n=0;at(e,+m[t>>2]),(0|(n=n+1|0))!=(0|i);)t=t+4|0,e=e+4|0},function(t,e,i){t|=0,e|=0;var n=0;if(i|=0)for(n=0;rt(e,+m[t>>2]),(0|(n=n+1|0))!=(0|i);)t=t+4|0,e=e+8|0},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;nt(t,n,2),m[e>>2]=+((0|l[n>>2])>>>0),(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+2|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;nt(t,n,4),m[e>>2]=+((0|l[n>>2])>>>0),(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+4|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;st(t,n),l[e>>2]=l[n>>2],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+4|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;ot(t,n),m[e>>2]=+g[n>>3],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+8|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;nt(t,n,2),l[e>>2]=l[n>>2],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+2|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;nt(t,n,4),l[e>>2]=l[n>>2],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+4|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;st(t,n),l[e>>2]=~~+m[n>>2],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+4|0;w=r}else w=r},function(t,e,i){t|=0,e|=0;var n,r,o=0;if(r=w,w=w+16|0,n=r,i|=0){for(o=0;ot(t,n),l[e>>2]=~~+g[n>>3],(0|(o=o+1|0))!=(0|i);)e=e+4|0,t=t+8|0;w=r}else w=r},se,function(t,e,i){e|=0,i|=0,se(0|l[(t|=0)>>2],e,i)},jr],oo=[Zr,function(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0;if(n|=0)if(1==(0|e)&0==(0|i))l[t>>2]=l[t>>2]<<1;else{if((0|e)>0){r=i+-1|0,n=0;do{l[(a=t+(n<<1<<2)|0)>>2]=(0|l[a>>2])-((0|l[t+(((0|n)<1?1:(((0|n)>(0|i)?i:n)<<1)-1|0)<<2)>>2])+(0|l[t+((((0|n)>=(0|i)?r:n)<<1|1)<<2)>>2])>>1),n=n+1|0}while((0|n)!=(0|e))}if(!((0|i)<=0)){r=e+-1|0,n=0;do{o=n,n=n+1|0,l[(a=t+((o<<1|1)<<2)|0)>>2]=(2+(0|l[t+(((0|o)>=(0|e)?r:o)<<1<<2)>>2])+(0|l[t+(((0|n)>=(0|e)?r:n)<<1<<2)>>2])>>2)+(0|l[a>>2])}while((0|n)!=(0|i))}}else{if(!((n=(0|e)>0)|(0|i)>1))return;if(n){r=i+-1|0,n=0;do{a=n,n=n+1|0,l[(o=t+((a<<1|1)<<2)|0)>>2]=(0|l[o>>2])-((0|l[t+(((0|n)>=(0|i)?r:n)<<1<<2)>>2])+(0|l[t+(((0|a)>=(0|i)?r:a)<<1<<2)>>2])>>1)}while((0|n)!=(0|e))}if((0|i)<=0)return;r=e+-1|0,n=0;do{l[(a=t+(n<<1<<2)|0)>>2]=(2+(0|l[t+(((0|n)<1?1:(((0|n)>(0|e)?e:n)<<1)-1|0)<<2)>>2])+(0|l[t+((((0|n)>=(0|e)?r:n)<<1|1)<<2)>>2])>>2)+(0|l[a>>2]),n=n+1|0}while((0|n)!=(0|i))}},function(t,e,i,n){t|=0,e|=0,i|=0;var r=0,o=0,a=0,s=0,c=0;if(n|=0){if(!((0|e)>1|(a=(0|i)>0)))return;if(o=(0|e)>0){r=i+-1|0,n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|n)<1?1:(((0|n)>(0|i)?i:n)<<1)-1|0)<<2)>>2])+(0|l[t+((((0|n)>=(0|i)?r:n)<<1|1)<<2)>>2])|0),((0|s)<0)<<31>>31|0,12993,0)),0|S,4096,0)),0|S,13),l[(c=t+(n<<1<<2)|0)>>2]=(0|l[c>>2])-s,n=n+1|0}while((0|n)!=(0|e))}if(a){r=e+-1|0,n=0;do{c=n,s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|(n=n+1|0))>=(0|e)?r:n)<<1<<2)>>2])+(0|l[t+(((0|c)>=(0|e)?r:c)<<1<<2)>>2])|0),((0|s)<0)<<31>>31|0,434,0)),0|S,4096,0)),0|S,13),l[(c=t+((c<<1|1)<<2)|0)>>2]=(0|l[c>>2])-s}while((0|n)!=(0|i))}if(o){r=i+-1|0,n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|n)<1?1:(((0|n)>(0|i)?i:n)<<1)-1|0)<<2)>>2])+(0|l[t+((((0|n)>=(0|i)?r:n)<<1|1)<<2)>>2])|0),((0|s)<0)<<31>>31|0,7233,0)),0|S,4096,0)),0|S,13),l[(c=t+(n<<1<<2)|0)>>2]=(0|l[c>>2])+s,n=n+1|0}while((0|n)!=(0|e))}if(a){r=e+-1|0,n=0;do{c=n,s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|(n=n+1|0))>=(0|e)?r:n)<<1<<2)>>2])+(0|l[t+(((0|c)>=(0|e)?r:c)<<1<<2)>>2])|0),((0|s)<0)<<31>>31|0,3633,0)),0|S,4096,0)),0|S,13),l[(c=t+((c<<1|1)<<2)|0)>>2]=(0|l[c>>2])+s}while((0|n)!=(0|i))}if(o){n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=0|l[(c=t+(n<<1<<2)|0)>>2]),((0|s)<0)<<31>>31|0,5038,0)),0|S,4096,0)),0|S,13),l[c>>2]=s,n=n+1|0}while((0|n)!=(0|e))}if(!a)return;n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=0|l[(c=t+((n<<1|1)<<2)|0)>>2]),((0|s)<0)<<31>>31|0,6659,0)),0|S,4096,0)),0|S,13),l[c>>2]=s,n=n+1|0}while((0|n)!=(0|i))}else if((a=(0|e)>0)|(0|i)>1){if(a){r=i+-1|0,n=0;do{o=n,s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|(n=n+1|0))>=(0|i)?r:n)<<1<<2)>>2])+(0|l[t+(((0|o)>=(0|i)?r:o)<<1<<2)>>2])|0),((0|s)<0)<<31>>31|0,12993,0)),0|S,4096,0)),0|S,13),l[(o=t+((o<<1|1)<<2)|0)>>2]=(0|l[o>>2])-s}while((0|n)!=(0|e))}if(o=(0|i)>0){r=e+-1|0,n=0;do{c=0|Er(0|(c=0|br(0|(c=0|yr(0|(c=(0|l[t+((((0|n)>=(0|e)?r:n)<<1|1)<<2)>>2])+(0|l[t+(((0|n)<1?1:(((0|n)>(0|e)?e:n)<<1)-1|0)<<2)>>2])|0),((0|c)<0)<<31>>31|0,434,0)),0|S,4096,0)),0|S,13),l[(s=t+(n<<1<<2)|0)>>2]=(0|l[s>>2])-c,n=n+1|0}while((0|n)!=(0|i))}if(a){r=i+-1|0,n=0;do{c=n,s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+(((0|(n=n+1|0))>=(0|i)?r:n)<<1<<2)>>2])+(0|l[t+(((0|c)>=(0|i)?r:c)<<1<<2)>>2])|0),((0|s)<0)<<31>>31|0,7233,0)),0|S,4096,0)),0|S,13),l[(c=t+((c<<1|1)<<2)|0)>>2]=(0|l[c>>2])+s}while((0|n)!=(0|e))}if(o){r=e+-1|0,n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=(0|l[t+((((0|n)>=(0|e)?r:n)<<1|1)<<2)>>2])+(0|l[t+(((0|n)<1?1:(((0|n)>(0|e)?e:n)<<1)-1|0)<<2)>>2])|0),((0|s)<0)<<31>>31|0,3633,0)),0|S,4096,0)),0|S,13),l[(c=t+(n<<1<<2)|0)>>2]=(0|l[c>>2])+s,n=n+1|0}while((0|n)!=(0|i))}if(a){n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=0|l[(c=t+((n<<1|1)<<2)|0)>>2]),((0|s)<0)<<31>>31|0,5038,0)),0|S,4096,0)),0|S,13),l[c>>2]=s,n=n+1|0}while((0|n)!=(0|e))}if(o){n=0;do{s=0|Er(0|(s=0|br(0|(s=0|yr(0|(s=0|l[(c=t+(n<<1<<2)|0)>>2]),((0|s)<0)<<31>>31|0,6659,0)),0|S,4096,0)),0|S,13),l[c>>2]=s,n=n+1|0}while((0|n)!=(0|i))}}},Zr];return{___muldi3:yr,___udivdi3:Ar,___uremdi3:Sr,_bitshift64Ashr:Mr,_bitshift64Lshr:Er,_bitshift64Shl:Tr,_emscripten_replace_memory:function(t){return!(16777215&y(t)||y(t)<=16777215||y(t)>2147483648||(r=new n(t),a=new o(t),l=new s(t),h=new c(t),d=new u(t),new f(t),m=new p(t),g=new _(t),i=t,0))},_free:gn,_i64Add:br,_i64Subtract:vr,_jp2_decode:function(t,e,i,n,r,o,a,s,c,h,u){t|=0,e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,c|=0,h|=0,u|=0;var d,f,p,m=0,_=0;if(p=w,w=w+8272|0,_=p+16|0,m=p,l[(d=p+12|0)>>2]=0,Rt(f=0|xt(1375686655==(0|l[t>>2])?0:2),1,0),Bt(f,2,0),Pt(f,3,0),Ct(_),l[m>>2]=t,l[m+4>>2]=t,l[m+8>>2]=e,m=0|Ft(m,1),!(0|Lt(f,_)))return _r(4211),X(m),St(f),w=p,0|(_=1);if(!(0|kt(m,f,d)))return _r(4263),X(m),St(f),yt(0|l[d>>2]),w=p,0|(_=1);if(!(0|At(f,m,0|l[d>>2])))return _r(4313),St(f),X(m),yt(0|l[d>>2]),w=p,0|(_=1);switch(t=0|l[d>>2],l[r>>2]=l[t+8>>2],l[o>>2]=l[t+12>>2],l[a>>2]=l[t+16>>2],_=0|l[(e=t+24|0)>>2],l[c>>2]=l[_+24>>2],l[h>>2]=l[_+32>>2],l[s>>2]=l[_+28>>2],l[u>>2]=l[t+20>>2],t=0|C(0|C(l[r>>2]<<2,0|l[o>>2]),0|l[a>>2]),l[n>>2]=t,h=0|_n(t),l[i>>2]=h,0|l[a>>2]){case 1:Cr(0|h,0|l[44+(0|l[e>>2])>>2],0|t);break;case 3:if((0|(c=0|C(0|l[o>>2],0|l[r>>2])))>0){s=0|l[e>>2],e=0|l[s+44>>2],u=0|l[s+96>>2],s=0|l[s+148>>2],t=0;do{l[h+((_=3*t|0)<<2)>>2]=l[e+(t<<2)>>2],l[h+(_+1<<2)>>2]=l[u+(t<<2)>>2],l[h+(_+2<<2)>>2]=l[s+(t<<2)>>2],t=t+1|0}while((0|t)<(0|c))}}return X(m),St(f),yt(0|l[d>>2]),w=p,0|(_=0)},_jp2_encode:function(t,e,i,n,r,o,a,s,c,u){t|=0,e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,c|=0,u|=0;var f,p,_,g=0,y=0,b=0,v=0,x=0,A=0,S=0;_=w,w=w+18880|0,g=_+16|0,x=_,It(p=_+160|0),l[p+18200>>2]=0,l[p+4788>>2]=1,l[p+20>>2]=1;t:do{if(r)m[p+4792>>2]=+(0|r);else switch(0|n){case 0:case 100:m[p+4792>>2]=0;break t;default:m[p+5192>>2]=+(0|n),l[p+28>>2]=1;break t}}while(0);if(l[g+24>>2]=i,l[g+28>>2]=i,l[g+32>>2]=0,l[g>>2]=1,l[g+4>>2]=1,l[g+8>>2]=t,l[g+12>>2]=e,l[g+60>>2]=i,l[g+64>>2]=i,l[g+68>>2]=0,l[g+36>>2]=1,l[g+40>>2]=1,l[g+44>>2]=t,l[g+48>>2]=e,l[g+96>>2]=i,l[g+100>>2]=i,l[g+104>>2]=0,l[g+72>>2]=1,l[g+76>>2]=1,l[g+80>>2]=t,l[g+84>>2]=e,l[g+132>>2]=i,l[g+136>>2]=i,l[g+140>>2]=0,l[g+108>>2]=1,l[g+112>>2]=1,l[g+116>>2]=t,l[g+120>>2]=e,!(f=0|gt(4,g,1)))return w=_,0|(u=0);if(16==(0|i)){if((0|e)>0&(0|t)>0){b=0|l[f+24>>2],r=0|l[b+200>>2],i=0|l[b+44>>2],y=0|l[b+96>>2],b=0|l[b+148>>2],g=0;do{v=0|C(g,t),n=0;do{S=(A=n+v|0)<<2,l[i+(A<<2)>>2]=d[o+(S<<1)>>1],l[y+(A<<2)>>2]=d[o+((1|S)<<1)>>1],l[b+(A<<2)>>2]=d[o+((2|S)<<1)>>1],l[r+(A<<2)>>2]=d[o+((3|S)<<1)>>1],n=n+1|0}while((0|n)!=(0|t));g=g+1|0}while((0|g)!=(0|e))}}else if((0|e)>0&(0|t)>0){b=0|l[f+24>>2],r=0|l[b+200>>2],i=0|l[b+44>>2],y=0|l[b+96>>2],b=0|l[b+148>>2],g=0;do{v=0|C(g,t),n=0;do{A=(S=n+v|0)<<2,l[i+(S<<2)>>2]=h[o+A>>0],l[y+(S<<2)>>2]=h[o+(1|A)>>0],l[b+(S<<2)>>2]=h[o+(2|A)>>0],l[r+(S<<2)>>2]=h[o+(3|A)>>0],n=n+1|0}while((0|n)!=(0|t));g=g+1|0}while((0|g)!=(0|e))}return l[f>>2]=0,l[f+4>>2]=0,l[f+8>>2]=t,l[f+12>>2]=e,(0|s)>0&&(l[f+28>>2]=a,l[f+32>>2]=s),Rt(0,1,0),Bt(0,2,0),Pt(0,3,0),Rt(r=0|wt(2),1,0),Bt(r,2,0),Pt(r,3,0),Dt(r,p,f),n=0|_n(67108864),l[x>>2]=n,l[(g=x+4|0)>>2]=n,l[x+8>>2]=67108864,(n=0|Ft(x,0))?0|Ot(r,f,n)&&0|Et(r,n)&&0|Tt(r,n)?(A=0|l[x>>2],x=0|_n(S=(0|l[g>>2])-A|0),l[c>>2]=x,Cr(0|x,0|A,0|S),l[u>>2]=S,X(n),St(r),yt(f),w=_,0|(S=1)):(X(n),St(r),yt(f),w=_,0|(S=0)):(w=_,0|(S=0))},_jp2_version:function(){return 4427},_llvm_bswap_i32:kr,_malloc:_n,_memcpy:Cr,_memset:Ir,_opj_create_compress:wt,_opj_create_decompress:xt,_opj_decode:At,_opj_decode_tile_data:function(t,e,i,n,r){return e|=0,n|=0,0!=(0|(t|=0))&0!=(0|(i|=0))&0!=(0|(r|=0))&&0|l[t+68>>2]?0|(r=0|$r[7&l[t+12>>2]](0|l[t+40>>2],e,i,n,r,t+44|0)):0|(r=0)},_opj_destroy_codec:St,_opj_destroy_cstr_index:function(t){var e;(e=0|l[(t|=0)>>2])&&(Qt(e),l[t>>2]=0)},_opj_destroy_cstr_info:Mt,_opj_dump_codec:function(t,e,i){e|=0,i|=0,(t|=0)&&ro[15&l[t+72>>2]](0|l[t+40>>2],e,i)},_opj_encode:Et,_opj_end_compress:Tt,_opj_end_decompress:function(t,e){return 0!=(0|(t|=0))&0!=(0|(e|=0))&&0|l[t+68>>2]?0|(e=0|Qr[63&l[t+16>>2]](0|l[t+40>>2],e,t+44|0)):0|(e=0)},_opj_get_cstr_index:function(t){return(t|=0)?0|(t=0|Xr[15&l[t+80>>2]](0|l[t+40>>2])):0|(t=0)},_opj_get_cstr_info:function(t){return(t|=0)?0|(t=0|Xr[15&l[t+76>>2]](0|l[t+40>>2])):0|(t=0)},_opj_get_decoded_tile:function(t,e,i,n){return i|=0,n|=0,0!=(0|(t|=0))&0!=(0|(e|=0))&&0|l[t+68>>2]?0|(n=0|Kr[3&l[t+32>>2]](0|l[t+40>>2],e,i,t+44|0,n)):0|(n=0)},_opj_image_create:gt,_opj_image_destroy:yt,_opj_image_tile_create:function(t,e,i){var n,r;if(t|=0,e|=0,i|=0,!(n=0|Ut(1,36)))return 0|(e=n);if(l[n+20>>2]=i,l[n+16>>2]=t,r=0|Ut(t,52),l[n+24>>2]=r,r){if(!t)return 0|(e=n);i=0;do{l[r+(52*i|0)>>2]=l[e+(36*i|0)>>2],l[r+(52*i|0)+4>>2]=l[e+(36*i|0)+4>>2],l[r+(52*i|0)+8>>2]=l[e+(36*i|0)+8>>2],l[r+(52*i|0)+12>>2]=l[e+(36*i|0)+12>>2],l[r+(52*i|0)+16>>2]=l[e+(36*i|0)+16>>2],l[r+(52*i|0)+20>>2]=l[e+(36*i|0)+20>>2],l[r+(52*i|0)+24>>2]=l[e+(36*i|0)+24>>2],l[r+(52*i|0)+32>>2]=l[e+(36*i|0)+32>>2],l[r+(52*i|0)+44>>2]=0,i=i+1|0}while((0|i)!=(0|t));return 0|n}return 0|(i=0|l[n+28>>2])&&jt(i),jt(n),0|(e=0)},_opj_read_header:kt,_opj_read_tile_header:function(t,e,i,n,r,o,a,s,c,h){return r|=0,o|=0,a|=0,s|=0,c|=0,h|=0,0!=(0|(i|=0))&0!=(0|(t|=0))&0!=(0|(e|=0))&0!=(0|(n|=0))&&0|l[t+68>>2]?0|(h=0|eo[3&l[t+8>>2]](0|l[t+40>>2],i,n,r,o,a,s,c,h,e,t+44|0)):0|(h=0)},_opj_set_MCT:function(t,e,i,n){t|=0,e|=0,i|=0;var o,s=0,c=0;return o=0|C(c=(n|=0)<<2,n),n=0|d[(s=t+18704|0)>>1],a[s>>1]=0==(32768&n|0)?-32512:65535&(256|n),l[t+5608>>2]=1,r[t+18690>>0]=2,s=0|zt(o+c|0),l[(n=t+18696|0)>>2]=s,s?(Cr(0|s,0|e,0|o),Cr((0|l[n>>2])+o|0,0|i,0|c),0|(c=1)):0|(c=0)},_opj_set_decode_area:function(t,e,i,n,r,o){return e|=0,i|=0,n|=0,r|=0,o|=0,(t|=0)&&0|l[t+68>>2]?0|(o=0|to[3&l[t+28>>2]](0|l[t+40>>2],e,i,n,r,o,t+44|0)):0|(o=0)},_opj_set_decoded_resolution_factor:function(t,e){return e|=0,(t|=0)?0|(e=0|Qr[63&l[t+36>>2]](0|l[t+40>>2],e,t+44|0)):0|(e=0)},_opj_set_default_decoder_parameters:Ct,_opj_set_default_encoder_parameters:It,_opj_set_error_handler:Pt,_opj_set_info_handler:Rt,_opj_set_warning_handler:Bt,_opj_setup_decoder:Lt,_opj_setup_encoder:Dt,_opj_start_compress:Ot,_opj_stream_create:Z,_opj_stream_create_buffer_stream:Ft,_opj_stream_create_default_file_stream:function(t,e){return 0|Gt(t|=0,1048576,e|=0)},_opj_stream_create_file_stream:Gt,_opj_stream_default_create:Y,_opj_stream_destroy:X,_opj_stream_set_read_function:J,_opj_stream_set_seek_function:Q,_opj_stream_set_skip_function:q,_opj_stream_set_user_data:K,_opj_stream_set_user_data_length:$,_opj_stream_set_write_function:tt,_opj_version:Nt,_opj_write_tile:function(t,e,i,n,r){return e|=0,n|=0,0!=(0|(i|=0))&0!=(0|(t|=0))&0!=(0|(r|=0))?0|l[t+68>>2]?0|(r=0):0|(r=0|$r[7&l[t+8>>2]](0|l[t+40>>2],e,i,n,r,t+44|0)):0|(r=0)},_rintf:Rr,_sbrk:Br,dynCall_di:function(t,e){return e|=0,+Yr[3&(t|=0)](0|e)},dynCall_ii:function(t,e){return e|=0,0|Xr[15&(t|=0)](0|e)},dynCall_iii:function(t,e,i){return e|=0,i|=0,0|Jr[7&(t|=0)](0|e,0|i)},dynCall_iiii:function(t,e,i,n){return e|=0,i|=0,n|=0,0|Qr[63&(t|=0)](0|e,0|i,0|n)},dynCall_iiiii:function(t,e,i,n,r){return e|=0,i|=0,n|=0,r|=0,0|qr[63&(t|=0)](0|e,0|i,0|n,0|r)},dynCall_iiiiii:function(t,e,i,n,r,o){return e|=0,i|=0,n|=0,r|=0,o|=0,0|Kr[3&(t|=0)](0|e,0|i,0|n,0|r,0|o)},dynCall_iiiiiii:function(t,e,i,n,r,o,a){return e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,0|$r[7&(t|=0)](0|e,0|i,0|n,0|r,0|o,0|a)},dynCall_iiiiiiii:function(t,e,i,n,r,o,a,s){return e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,0|to[3&(t|=0)](0|e,0|i,0|n,0|r,0|o,0|a,0|s)},dynCall_iiiiiiiiiiii:function(t,e,i,n,r,o,a,s,l,c,h,u){return e|=0,i|=0,n|=0,r|=0,o|=0,a|=0,s|=0,l|=0,c|=0,h|=0,u|=0,0|eo[3&(t|=0)](0|e,0|i,0|n,0|r,0|o,0|a,0|s,0|l,0|c,0|h,0|u)},dynCall_vi:function(t,e){e|=0,io[7&(t|=0)](0|e)},dynCall_vii:function(t,e,i){e|=0,i|=0,no[7&(t|=0)](0|e,0|i)},dynCall_viii:function(t,e,i,n){e|=0,i|=0,n|=0,ro[15&(t|=0)](0|e,0|i,0|n)},dynCall_viiii:function(t,e,i,n,r){e|=0,i|=0,n|=0,r|=0,oo[3&(t|=0)](0|e,0|i,0|n,0|r)},establishStackSpace:function(t,e){w=t|=0,0},getTempRet0:function(){return 0|S},runPostSets:function(){},setTempRet0:function(t){S=t|=0},setThrew:function(t,e){t|=0,0,A||(A=t)},stackAlloc:function(t){var e;return e=w,w=15+(w=w+(t|=0)|0)&-16,0|e},stackRestore:function(t){w=t|=0},stackSave:function(){return 0|w}}}(o.asmGlobalArg,o.asmLibraryArg,T),It=(o.___muldi3=Ct.___muldi3,o.___udivdi3=Ct.___udivdi3,o.___uremdi3=Ct.___uremdi3,o._bitshift64Ashr=Ct._bitshift64Ashr,o._bitshift64Lshr=Ct._bitshift64Lshr,o._bitshift64Shl=Ct._bitshift64Shl,o._emscripten_replace_memory=Ct._emscripten_replace_memory),Pt=(o._free=Ct._free,o._i64Add=Ct._i64Add,o._i64Subtract=Ct._i64Subtract,o._jp2_decode=Ct._jp2_decode,o._jp2_encode=Ct._jp2_encode,o._jp2_version=Ct._jp2_version,o._llvm_bswap_i32=Ct._llvm_bswap_i32,o._malloc=Ct._malloc),Rt=(o._memcpy=Ct._memcpy,o._memset=Ct._memset,o._opj_create_compress=Ct._opj_create_compress,o._opj_create_decompress=Ct._opj_create_decompress,o._opj_decode=Ct._opj_decode,o._opj_decode_tile_data=Ct._opj_decode_tile_data,o._opj_destroy_codec=Ct._opj_destroy_codec,o._opj_destroy_cstr_index=Ct._opj_destroy_cstr_index,o._opj_destroy_cstr_info=Ct._opj_destroy_cstr_info,o._opj_dump_codec=Ct._opj_dump_codec,o._opj_encode=Ct._opj_encode,o._opj_end_compress=Ct._opj_end_compress,o._opj_end_decompress=Ct._opj_end_decompress,o._opj_get_cstr_index=Ct._opj_get_cstr_index,o._opj_get_cstr_info=Ct._opj_get_cstr_info,o._opj_get_decoded_tile=Ct._opj_get_decoded_tile,o._opj_image_create=Ct._opj_image_create,o._opj_image_destroy=Ct._opj_image_destroy,o._opj_image_tile_create=Ct._opj_image_tile_create,o._opj_read_header=Ct._opj_read_header,o._opj_read_tile_header=Ct._opj_read_tile_header,o._opj_set_MCT=Ct._opj_set_MCT,o._opj_set_decode_area=Ct._opj_set_decode_area,o._opj_set_decoded_resolution_factor=Ct._opj_set_decoded_resolution_factor,o._opj_set_default_decoder_parameters=Ct._opj_set_default_decoder_parameters,o._opj_set_default_encoder_parameters=Ct._opj_set_default_encoder_parameters,o._opj_set_error_handler=Ct._opj_set_error_handler,o._opj_set_info_handler=Ct._opj_set_info_handler,o._opj_set_warning_handler=Ct._opj_set_warning_handler,o._opj_setup_decoder=Ct._opj_setup_decoder,o._opj_setup_encoder=Ct._opj_setup_encoder,o._opj_start_compress=Ct._opj_start_compress,o._opj_stream_create=Ct._opj_stream_create,o._opj_stream_create_buffer_stream=Ct._opj_stream_create_buffer_stream,o._opj_stream_create_default_file_stream=Ct._opj_stream_create_default_file_stream,o._opj_stream_create_file_stream=Ct._opj_stream_create_file_stream,o._opj_stream_default_create=Ct._opj_stream_default_create,o._opj_stream_destroy=Ct._opj_stream_destroy,o._opj_stream_set_read_function=Ct._opj_stream_set_read_function,o._opj_stream_set_seek_function=Ct._opj_stream_set_seek_function,o._opj_stream_set_skip_function=Ct._opj_stream_set_skip_function,o._opj_stream_set_user_data=Ct._opj_stream_set_user_data,o._opj_stream_set_user_data_length=Ct._opj_stream_set_user_data_length,o._opj_stream_set_write_function=Ct._opj_stream_set_write_function,o._opj_version=Ct._opj_version,o._opj_write_tile=Ct._opj_write_tile,o._rintf=Ct._rintf,o._sbrk=Ct._sbrk,o.establishStackSpace=Ct.establishStackSpace,o.getTempRet0=Ct.getTempRet0,o.runPostSets=Ct.runPostSets,o.setTempRet0=Ct.setTempRet0,o.setThrew=Ct.setThrew,o.stackAlloc=Ct.stackAlloc),Bt=o.stackRestore=Ct.stackRestore,Lt=o.stackSave=Ct.stackSave;o.dynCall_di=Ct.dynCall_di,o.dynCall_ii=Ct.dynCall_ii,o.dynCall_iii=Ct.dynCall_iii,o.dynCall_iiii=Ct.dynCall_iiii,o.dynCall_iiiii=Ct.dynCall_iiiii,o.dynCall_iiiiii=Ct.dynCall_iiiiii,o.dynCall_iiiiiii=Ct.dynCall_iiiiiii,o.dynCall_iiiiiiii=Ct.dynCall_iiiiiiii,o.dynCall_iiiiiiiiiiii=Ct.dynCall_iiiiiiiiiiii,o.dynCall_vi=Ct.dynCall_vi,o.dynCall_vii=Ct.dynCall_vii,o.dynCall_viii=Ct.dynCall_viii,o.dynCall_viiii=Ct.dynCall_viiii;if(o.asm=Ct,o.ccall=function(t,e,i,n,r){var a=function(t){var e=o["_"+t];return y(e,"Cannot call unknown function "+t+", make sure it is exported"),e}(t),s=[],l=0;if(n)for(var c=0;c<n.length;c++){var h=v[i[c]];h?(0===l&&(l=Lt()),s[c]=h(n[c])):s[c]=n[c]}var u=a.apply(null,s);return"string"===e&&(u=S(u)),0!==l&&Bt(l),u},o.getValue=function(t,e,i){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return k[t>>0];case"i16":return I[t>>1];case"i32":case"i64":return P[t>>2];case"float":return R[t>>2];case"double":return B[t>>3];default:Ht("invalid type for getValue: "+e)}return null},o.writeArrayToMemory=rt,ft)if(mt(ft)||("function"==typeof o.locateFile?ft=o.locateFile(ft):o.memoryInitializerPrefixURL&&(ft=o.memoryInitializerPrefixURL+ft)),u||d){var Dt=o.readBinary(ft);C.set(Dt,8)}else{ht++,o.monitorRunDependencies&&o.monitorRunDependencies(ht);var Ot=function(t){t.byteLength&&(t=new Uint8Array(t)),C.set(t,8),o.memoryInitializerRequest&&delete o.memoryInitializerRequest.response,function(t){if(ht--,o.monitorRunDependencies&&o.monitorRunDependencies(ht),0==ht&&(null!==ut&&(clearInterval(ut),ut=null),dt)){var e=dt;dt=null,e()}}()};function Ft(){o.readAsync(ft,Ot,function(){throw"could not load memory initializer "+ft})}var Gt=Tt(ft);if(Gt)Ot(Gt.buffer);else if(o.memoryInitializerRequest){function Nt(){var t=o.memoryInitializerRequest,e=t.response;if(200!==t.status&&0!==t.status){var i=Tt(o.memoryInitializerRequestURL);if(!i)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+t.status+", retrying "+ft),void Ft();e=i.buffer}Ot(e)}o.memoryInitializerRequest.response?setTimeout(Nt,0):o.memoryInitializerRequest.addEventListener("load",Nt)}else Ft()}function zt(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function Ut(t){function e(){o.calledRun||(o.calledRun=!0,g||(et||(et=!0,J(q)),J(K),o.onRuntimeInitialized&&o.onRuntimeInitialized(),function(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)nt(o.postRun.shift());J(tt)}()))}t=t||o.arguments,ht>0||(function(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)it(o.preRun.shift());J(Q)}(),ht>0||o.calledRun||(o.setStatus?(o.setStatus("Running..."),setTimeout(function(){setTimeout(function(){o.setStatus("")},1),e()},1)):e()))}function Ht(t){throw o.onAbort&&o.onAbort(t),void 0!==t?(o.print(t),o.printErr(t),t=JSON.stringify(t)):t="",g=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(o.then=function(t){if(o.calledRun)t(o);else{var e=o.onRuntimeInitialized;o.onRuntimeInitialized=function(){e&&e(),t(o)}}return o},zt.prototype=new Error,zt.prototype.constructor=zt,dt=function t(){o.calledRun||Ut(),o.calledRun||(dt=t)},o.run=Ut,o.exit=function(t,i){i&&o.noExitRuntime&&0===t||(o.noExitRuntime||(g=!0,O=kt,J($),o.onExit&&o.onExit(t)),u&&e.exit(t),o.quit(t,new zt(t)))},o.abort=Ht,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return o.noExitRuntime=!0,Ut(),t}}).call(this,i(53),i(148).Buffer)},function(t,e,i){"use strict";var n=i(57);i.d(e,"a",function(){return n.a})},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(9),r=i(5),o=i(0),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n,r,a,s,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r,a,s,l));return c._front=null,c._back=null,c._directions=[new o.L(1,0,0),new o.L(0,1,0),new o.L(0,0,1)],c._directionsLabel=["A","P","L","R","I","S"],c._orientation="default",c._convention="radio",c._stackOrientation=0,c._right=null,c._up=null,c._direction=null,c._controls=null,c._box=null,c._canvas={width:null,height:null},c._fromFront=!0,c._angle=0,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.init=function(t,e,i,a,s,l){if(console.warn("cameras.orthographic.init(...) is deprecated.\n        Use .cosines, .controls, .box and .canvas instead."),!(r.a.vector3(t)&&r.a.vector3(e)&&r.a.vector3(i)&&r.a.box(s)&&a))return console.log("Invalid input provided."),!1;this._right=t,this._up=this._adjustTopDirection(t,e),this._direction=(new o.L).crossVectors(this._right,this._up),this._controls=a,this._box=s,this._canvas=l;var c={position:this._box.center,direction:this._direction},h=this._orderIntersections(n.a.rayBox(c,this._box),this._direction);this._front=h[0],this._back=h[1],this.up.set(this._up.x,this._up.y,this._up.z),this._updateCanvas(),this._updatePositionAndTarget(this._front,this._back),this._updateMatrices(),this._updateDirections()},e.prototype.update=function(){if("default"===this._orientation)switch(this._getMaxIndex(this._directions[2])){case 0:this._orientation="sagittal";break;case 1:this._orientation="coronal";break;case 2:this._orientation="axial";break;default:this._orientation="free"}if("free"===this._orientation)this._right=this._directions[0],this._up=this._directions[1],this._direction=this._directions[2];else{var t=this.leftDirection(),e=this._directions[t],i=this.posteriorDirection(),r=this._directions[i],o=this.superiorDirection(),a=this._directions[o];if("radio"===this._convention)switch(this._orientation){case"axial":r.y>0&&r.negate(),a.z<0&&a.negate(),this._right=e,this._up=r,this._direction=a;break;case"coronal":a.z<0&&a.negate(),r.y<0&&r.negate(),this._right=e,this._up=a,this._direction=r;break;case"sagittal":a.z<0&&a.negate(),e.x>0&&e.negate(),this._right=r,this._up=a,this._direction=e;break;default:console.warn('"'+this._orientation+'" orientation is not valid.\n                  (choices: axial, coronal, sagittal)')}else if("neuro"===this._convention)switch(this._orientation){case"axial":r.y>0&&r.negate(),a.z>0&&a.negate(),this._right=e,this._up=r,this._direction=a;break;case"coronal":a.z<0&&a.negate(),r.y>0&&r.negate(),this._right=e,this._up=a,this._direction=r;break;case"sagittal":a.z<0&&a.negate(),e.x>0&&e.negate(),this._right=r,this._up=a,this._direction=e;break;default:console.warn('"'+this._orientation+'" orientation is not valid.\n                  (choices: axial, coronal, sagittal)')}else console.warn(this._convention+" is not valid (choices: radio, neuro)")}var s={position:this._box.center,direction:this._direction},l=this._orderIntersections(n.a.rayBox(s,this._box),this._direction);this._front=l[0],this._back=l[1],this.up.set(this._up.x,this._up.y,this._up.z),this._updateCanvas(),this._updatePositionAndTarget(this._front,this._back),this._updateMatrices(),this._updateDirections()},e.prototype.leftDirection=function(){return this._findMaxIndex(this._directions,0)},e.prototype.posteriorDirection=function(){return this._findMaxIndex(this._directions,1)},e.prototype.superiorDirection=function(){return this._findMaxIndex(this._directions,2)},e.prototype.invertRows=function(){this.up.multiplyScalar(-1),this.invertColumns(),this._updateDirections()},e.prototype.invertColumns=function(){this.center();var t=this._oppositePosition(this.position);this._updatePositionAndTarget(t,this.position.clone()),this._updateMatrices(),this._fromFront=!this._fromFront,this._angle%=360,this._angle=360-this._angle,this._updateDirections()},e.prototype.center=function(){this._fromFront?this._updatePositionAndTarget(this._front,this._back):this._updatePositionAndTarget(this._back,this._front),this._updateMatrices(),this._updateDirections()},e.prototype.rotate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.center();var e=90;null===t?(e*=-1,this._angle+=90):(e=360-(t-this._angle),this._angle=t),this._angle%=360;var i=(new o.r).makeRotationAxis(this._direction,e*Math.PI/180);this.up.applyMatrix4(i),this._updateMatrices(),this._updateDirections()},e.prototype.fitBox=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5,i=1;switch(t){case 0:i=e*this._computeZoom(this._canvas.width,this._right);break;case 1:i=e*this._computeZoom(this._canvas.height,this._up);break;case 2:i=e*Math.min(this._computeZoom(this._canvas.width,this._right),this._computeZoom(this._canvas.height,this._up))}if(!i)return!1;this.zoom=i,this.center()},e.prototype._adjustTopDirection=function(t,e){var i=this._getMaxIndex(e);return(2===i&&e.getComponent(i)<0||1===i&&e.getComponent(i)>0||0===i&&e.getComponent(i)>0)&&e.negate(),e},e.prototype._getMaxIndex=function(t){var e=Math.abs(t.x),i=0;return Math.abs(t.y)>e&&(e=Math.abs(t.y),i=1),Math.abs(t.z)>e&&(i=2),i},e.prototype._findMaxIndex=function(t,e){for(var i=this._getMaxIndices(t),n=0;n<i.length;n++)if(i[n]===e)return n},e.prototype._getMaxIndices=function(t){var e=[];return e.push(this._getMaxIndex(t[0])),e.push(this._getMaxIndex(t[1])),e.push(this._getMaxIndex(t[2])),e},e.prototype._orderIntersections=function(t,e){return t[0].dot(e)<t[1].dot(e)?t:[t[1],t[0]]},e.prototype._updateCanvas=function(){this.left=-this._canvas.width/2,this.right=this._canvas.width/2,this.top=this._canvas.height/2,this.bottom=-this._canvas.height/2,this._updateMatrices(),this.controls.handleResize()},e.prototype._oppositePosition=function(t){var e=t.clone();e.sub(this._box.center);var i=(new o.r).makeRotationAxis(this.up,Math.PI);return e.applyMatrix4(i),e.add(this._box.center),e},e.prototype._computeZoom=function(t,e){if(!(t&&t>0))return console.log("Invalid dimension provided."),console.log(t),!1;var i={position:this._box.center.clone(),direction:e},r=n.a.rayBox(i,this._box);return r.length<2?(console.log("Can not adjust the camera ( < 2 intersections)."),console.log(i),console.log(this._box),!1):t/r[0].distanceTo(r[1])},e.prototype._updatePositionAndTarget=function(t,e){this.position.set(t.x,t.y,t.z),this.lookAt(e.x,e.y,e.z),this._controls.target.set(e.x,e.y,e.z)},e.prototype._updateMatrices=function(){this._controls.update(),this.updateProjectionMatrix(),this.updateMatrixWorld()},e.prototype._updateLabels=function(){this._directionsLabel=[this._vector2Label(this._up),this._vector2Label(this._up.clone().negate()),this._vector2Label(this._right),this._vector2Label(this._right.clone().negate()),this._vector2Label(this._direction),this._vector2Label(this._direction.clone().negate())]},e.prototype._vector2Label=function(t){for(var e=this._getMaxIndex(t),i=t.clone().divideScalar(Math.abs(t.getComponent(e))),n="",r=0;r<3;r++)0===r&&(i.getComponent(r)+.2>=1?n+="L":i.getComponent(r)-.2<=-1&&(n+="R")),1===r&&(i.getComponent(r)+.2>=1?n+="P":i.getComponent(r)-.2<=-1&&(n+="A")),2===r&&(i.getComponent(r)+.2>=1?n+="S":i.getComponent(r)-.2<=-1&&(n+="I"));return n},e.prototype._updateDirections=function(){this._up=this.up.clone();var t=new o.L(0,0,-1).applyMatrix4(this.matrixWorld);this._direction=t.sub(this.position).normalize(),this._right=(new o.L).crossVectors(this._direction,this.up),this._updateLabels()},a(e,[{key:"controls",set:function(t){this._controls=t},get:function(){return this._controls}},{key:"box",set:function(t){this._box=t},get:function(){return this._box}},{key:"canvas",set:function(t){this._canvas=t,this._updateCanvas()},get:function(){return this._canvas}},{key:"angle",set:function(t){this.rotate(t)},get:function(){return this._angle}},{key:"directions",set:function(t){this._directions=t},get:function(){return this._directions}},{key:"convention",set:function(t){this._convention=t},get:function(){return this._convention}},{key:"orientation",set:function(t){this._orientation=t},get:function(){return this._orientation}},{key:"directionsLabel",set:function(t){this._directionsLabel=t},get:function(){return this._directionsLabel}},{key:"stackOrientation",set:function(t){if(this._stackOrientation=t,0===this._stackOrientation)this._orientation="default";else{var e=this._getMaxIndex(this._directions[(this._stackOrientation+2)%3]);0===e?this._orientation="sagittal":1===e?this._orientation="coronal":2===e&&(this._orientation="axial")}},get:function(){if("default"===this._orientation)this._stackOrientation=0;else{var t=this._getMaxIndex(this._direction);t===this._getMaxIndex(this._directions[2])?this._stackOrientation=0:t===this._getMaxIndex(this._directions[0])?this._stackOrientation=1:t===this._getMaxIndex(this._directions[1])&&(this._stackOrientation=2)}return this._stackOrientation}}]),e}(o.w)},function(t,e,i){"use strict";var n=i(59);i.d(e,"b",function(){return n.a});var r=i(60);i.d(e,"c",function(){return r.a});var o=i(61);i.d(e,"a",function(){return o.a})},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(0);var r=function(t){function e(i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),a=o,s={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5,CUSTOM:99};o.object=i,o.domElement=void 0!==r?r:document,o.enabled=!0,o.screen={left:0,top:0,width:0,height:0},o.rotateSpeed=1,o.zoomSpeed=1.2,o.panSpeed=.3,o.noRotate=!1,o.noZoom=!1,o.noPan=!1,o.noCustom=!1,o.forceState=-1,o.staticMoving=!1,o.dynamicDampingFactor=.2,o.minDistance=0,o.maxDistance=1/0,o.keys=[65,83,68],o.target=new n.L;var l=new n.L,c=s.NONE,h=s.NONE,u=new n.L,d=new n.K,f=new n.K,p=new n.L,m=0,_=new n.K,g=new n.K,y=0,b=0,v=new n.K,w=new n.K,x=new n.K,A=new n.K;o.target0=o.target.clone(),o.position0=o.object.position.clone(),o.up0=o.object.up.clone();var S={type:"change"},M={type:"start"},E={type:"end"};o.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=innerWidth,this.screen.height=innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+scrollX-e.clientLeft,this.screen.top=t.top+scrollY-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},o.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var T=function(){var t=new n.K;return function(e,i){return t.set((e-a.screen.left)/a.screen.width,(i-a.screen.top)/a.screen.height),t}}(),k=function(){var t=new n.K;return function(e,i){return t.set((e-.5*a.screen.width-a.screen.left)/(.5*a.screen.width),(a.screen.height+2*(a.screen.top-i))/a.screen.width),t}}();function C(t){!1!==a.enabled&&(removeEventListener("keydown",C),h=c,c===s.NONE&&(t.keyCode!==a.keys[s.ROTATE]||a.noRotate?t.keyCode!==a.keys[s.ZOOM]||a.noZoom?t.keyCode!==a.keys[s.PAN]||a.noPan||(c=s.PAN):c=s.ZOOM:c=s.ROTATE))}function I(t){!1!==a.enabled&&(c=h,addEventListener("keydown",C,!1))}function P(t){!1!==a.enabled&&(t.preventDefault(),t.stopPropagation(),c===s.NONE&&(c=t.button),c!==s.ROTATE||a.noRotate?c!==s.ZOOM||a.noZoom?c!==s.PAN||a.noPan?c!==s.CUSTOM||a.noCustom||(x.copy(T(t.pageX,t.pageY)),A.copy(v)):(v.copy(T(t.pageX,t.pageY)),w.copy(v)):(_.copy(T(t.pageX,t.pageY)),g.copy(_)):(f.copy(k(t.pageX,t.pageY)),d.copy(f)),document.addEventListener("mousemove",R,!1),document.addEventListener("mouseup",B,!1),a.dispatchEvent(M))}function R(t){!1!==a.enabled&&(t.preventDefault(),t.stopPropagation(),c!==s.ROTATE||a.noRotate?c!==s.ZOOM||a.noZoom?c!==s.PAN||a.noPan?c!==s.CUSTOM||a.noCustom||A.copy(T(t.pageX,t.pageY)):w.copy(T(t.pageX,t.pageY)):g.copy(T(t.pageX,t.pageY)):(d.copy(f),f.copy(k(t.pageX,t.pageY))))}function B(t){!1!==a.enabled&&(t.preventDefault(),t.stopPropagation(),-1===a.forceState&&(c=s.NONE),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",B),a.dispatchEvent(E))}function L(t){if(!1!==a.enabled&&!0!==a.noZoom){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:_.y-=.025*t.deltaY;break;case 1:_.y-=.01*t.deltaY;break;default:_.y-=25e-5*t.deltaY}a.dispatchEvent(M),a.dispatchEvent(E)}}function D(t){if(!1!==a.enabled){if(-1===a.forceState)switch(t.touches.length){case 1:c=s.TOUCH_ROTATE,f.copy(k(t.touches[0].pageX,t.touches[0].pageY)),d.copy(f);break;case 2:c=s.TOUCH_ZOOM;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=y=Math.sqrt(e*e+i*i);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;v.copy(T(n,r)),w.copy(v);break;default:c=s.NONE}else switch(c){case 0:c=s.TOUCH_ROTATE,f.copy(k(t.touches[0].pageX,t.touches[0].pageY)),d.copy(f);break;case 1:case 4:if(t.touches.length>=2){c=s.TOUCH_ZOOM;e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=y=Math.sqrt(e*e+i*i)}else c=s.ZOOM,_.copy(T(t.touches[0].pageX,t.touches[0].pageY)),g.copy(_);break;case 2:case 5:if(t.touches.length>=2){c=s.TOUCH_PAN;n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;v.copy(T(n,r)),w.copy(v)}else c=s.PAN,v.copy(T(t.touches[0].pageX,t.touches[0].pageY)),w.copy(v);break;case 99:c=s.CUSTOM;n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;x.copy(T(n,r)),A.copy(x);break;default:c=s.NONE}a.dispatchEvent(M)}}function O(t){if(!1!==a.enabled)if(t.preventDefault(),t.stopPropagation(),-1===a.forceState)switch(t.touches.length){case 1:d.copy(f),f.copy(k(t.touches[0].pageX,t.touches[0].pageY));break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=Math.sqrt(e*e+i*i);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;w.copy(T(n,r));break;default:c=s.NONE}else switch(c){case 0:d.copy(f),f.copy(k(t.touches[0].pageX,t.touches[0].pageY));break;case 1:g.copy(T(t.touches[0].pageX,t.touches[0].pageY));break;case 2:w.copy(T(t.touches[0].pageX,t.touches[0].pageY));break;case 4:e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;b=Math.sqrt(e*e+i*i);break;case 5:n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;w.copy(T(n,r));break;case 99:n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;A.copy(T(n,r));break;default:c=s.NONE}}function F(t){if(!1!==a.enabled){if(-1===a.forceState){switch(t.touches.length){case 1:d.copy(f),f.copy(k(t.touches[0].pageX,t.touches[0].pageY));break;case 2:y=b=0;var e=(t.touches[0].pageX+t.touches[1].pageX)/2,i=(t.touches[0].pageY+t.touches[1].pageY)/2;w.copy(T(e,i)),v.copy(w)}c=s.NONE}else switch(c){case 0:d.copy(f),f.copy(k(t.touches[0].pageX,t.touches[0].pageY));break;case 1:case 2:break;case 4:y=b=0,c=s.ZOOM;break;case 5:if(t.touches.length>=2){e=(t.touches[0].pageX+t.touches[1].pageX)/2,i=(t.touches[0].pageY+t.touches[1].pageY)/2;w.copy(T(e,i)),v.copy(w)}c=s.PAN;break;case 99:e=(t.touches[0].pageX+t.touches[1].pageX)/2,i=(t.touches[0].pageY+t.touches[1].pageY)/2;A.copy(T(e,i)),x.copy(A);break;default:c=s.NONE}a.dispatchEvent(E)}}function G(t){t.preventDefault()}return o.rotateCamera=function(){var t=new n.L,e=new n.y,i=new n.L,r=new n.L,o=new n.L,s=new n.L,l=void 0;return function(){s.set(f.x-d.x,f.y-d.y,0),(l=s.length())?(u.copy(a.object.position).sub(a.target),i.copy(u).normalize(),r.copy(a.object.up).normalize(),o.crossVectors(r,i).normalize(),r.setLength(f.y-d.y),o.setLength(f.x-d.x),s.copy(r.add(o)),t.crossVectors(s,u).normalize(),l*=a.rotateSpeed,e.setFromAxisAngle(t,l),u.applyQuaternion(e),a.object.up.applyQuaternion(e),p.copy(t),m=l):!a.staticMoving&&m&&(m*=Math.sqrt(1-a.dynamicDampingFactor),u.copy(a.object.position).sub(a.target),e.setFromAxisAngle(p,m),u.applyQuaternion(e),a.object.up.applyQuaternion(e)),d.copy(f)}}(),o.zoomCamera=function(){var t=void 0;c===s.TOUCH_ZOOM?(t=y/b,y=b,u.multiplyScalar(t)):1!==(t=1+(g.y-_.y)*a.zoomSpeed)&&t>0&&(u.multiplyScalar(t),a.staticMoving?_.copy(g):_.y+=(g.y-_.y)*this.dynamicDampingFactor)},o.panCamera=function(){var t=new n.K,e=new n.L,i=new n.L;return function(){t.copy(w).sub(v),t.lengthSq()&&(t.multiplyScalar(u.length()*a.panSpeed),i.copy(u).cross(a.object.up).setLength(t.x),i.add(e.copy(a.object.up).setLength(t.y)),a.object.position.add(i),a.target.add(i),a.staticMoving?v.copy(w):v.add(t.subVectors(w,v).multiplyScalar(a.dynamicDampingFactor)))}}(),o.checkDistances=function(){a.noZoom&&a.noPan||(u.lengthSq()>a.maxDistance*a.maxDistance&&a.object.position.addVectors(a.target,u.setLength(a.maxDistance)),u.lengthSq()<a.minDistance*a.minDistance&&a.object.position.addVectors(a.target,u.setLength(a.minDistance)))},o.update=function(){u.subVectors(a.object.position,a.target),a.noRotate||a.rotateCamera(),a.noZoom||a.zoomCamera(),a.noPan||a.panCamera(),a.noCustom||a.custom(x,A),a.object.position.addVectors(a.target,u),a.checkDistances(),a.object.lookAt(a.target),l.distanceToSquared(a.object.position)>1e-6&&(a.dispatchEvent(S),l.copy(a.object.position))},o.reset=function(){c=s.NONE,h=s.NONE,a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.up.copy(a.up0),u.subVectors(a.object.position,a.target),a.object.lookAt(a.target),a.dispatchEvent(S),l.copy(a.object.position)},o.setState=function(t){a.forceState=t,h=t,c=t},o.custom=function(t,e){},o.dispose=function(){this.domElement.removeEventListener("contextmenu",G,!1),this.domElement.removeEventListener("mousedown",P,!1),this.domElement.removeEventListener("wheel",L,!1),this.domElement.removeEventListener("touchstart",D,!1),this.domElement.removeEventListener("touchend",F,!1),this.domElement.removeEventListener("touchmove",O,!1),removeEventListener("keydown",C,!1),removeEventListener("keyup",I,!1)},o.domElement.addEventListener("contextmenu",G,!1),o.domElement.addEventListener("mousedown",P,!1),o.domElement.addEventListener("wheel",L,!1),o.domElement.addEventListener("touchstart",D,!1),o.domElement.addEventListener("touchend",F,!1),o.domElement.addEventListener("touchmove",O,!1),addEventListener("keydown",C,!1),addEventListener("keyup",I,!1),o.handleResize(),o.update(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.l)},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(0);var r=function(t){function e(i,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{NONE:-1,ROTATE:1,ZOOM:2,PAN:0,SCROLL:4,TOUCH_ROTATE:4,TOUCH_ZOOM_PAN:5};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),s=a,l=o;a.object=i,a.domElement=void 0!==r?r:document,a.enabled=!0,a.screen={left:0,top:0,width:0,height:0},a.radius=0,a.zoomSpeed=1.2,a.noZoom=!1,a.noPan=!1,a.staticMoving=!1,a.dynamicDampingFactor=.2,a.keys=[65,83,68],a.target=new n.L;var c=!0,h=l.NONE,u=l.NONE,d=new n.L,f=new n.K,p=new n.K,m=0,_=0,g=new n.K,y=new n.K;a.target0=a.target.clone(),a.position0=a.object.position.clone(),a.up0=a.object.up.clone(),a.left0=a.object.left,a.right0=a.object.right,a.top0=a.object.top,a.bottom0=a.object.bottom;var b={type:"change"},v={type:"start"},w={type:"end"};a.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=innerWidth,this.screen.height=innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+pageXOffset-e.clientLeft,this.screen.top=t.top+pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},a.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var x=function(){var t=new n.K;return function(e,i){return t.set((e-s.screen.left)/s.screen.width,(i-s.screen.top)/s.screen.height),t}}();function A(t){!1!==s.enabled&&(removeEventListener("keydown",A),u=h,h===l.NONE&&(t.keyCode!==s.keys[l.ROTATE]||s.noRotate?t.keyCode!==s.keys[l.ZOOM]||s.noZoom?t.keyCode!==s.keys[l.PAN]||s.noPan||(h=l.PAN):h=l.ZOOM:h=l.ROTATE))}function S(t){!1!==s.enabled&&(h=u,addEventListener("keydown",A,!1))}function M(t){!1!==s.enabled&&(t.preventDefault(),t.stopPropagation(),h===l.NONE&&(h=t.button),(h!==l.ROTATE||s.noRotate)&&(h!==l.ZOOM||s.noZoom?h!==l.PAN||s.noPan||(g.copy(x(t.pageX,t.pageY)),y.copy(g)):(f.copy(x(t.pageX,t.pageY)),p.copy(f))),document.addEventListener("mousemove",E,!1),document.addEventListener("mouseup",T,!1),s.dispatchEvent(v))}function E(t){!1!==s.enabled&&(t.preventDefault(),t.stopPropagation(),(h!==l.ROTATE||s.noRotate)&&(h!==l.ZOOM||s.noZoom?h!==l.PAN||s.noPan||y.copy(x(t.pageX,t.pageY)):p.copy(x(t.pageX,t.pageY))))}function T(t){!1!==s.enabled&&(t.preventDefault(),t.stopPropagation(),h=l.NONE,document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",T),s.dispatchEvent(w))}function k(t){!1!==s.enabled&&(t.preventDefault(),t.stopPropagation(),s.dispatchEvent({type:"OnScroll",delta:.01*t.deltaX+.01*t.deltaY}),s.dispatchEvent(v),s.dispatchEvent(w))}function C(t){if(!1!==s.enabled){switch(t.touches.length){case 1:h=l.TOUCH_ROTATE;break;case 2:h=l.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;_=m=Math.sqrt(e*e+i*i);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;g.copy(x(n,r)),y.copy(g);break;default:h=l.NONE}s.dispatchEvent(v)}}function I(t){if(!1!==s.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;_=Math.sqrt(e*e+i*i);var n=(t.touches[0].pageX+t.touches[1].pageX)/2,r=(t.touches[0].pageY+t.touches[1].pageY)/2;y.copy(x(n,r));break;default:h=l.NONE}}function P(t){if(!1!==s.enabled){switch(t.touches.length){case 1:break;case 2:m=_=0;var e=(t.touches[0].pageX+t.touches[1].pageX)/2,i=(t.touches[0].pageY+t.touches[1].pageY)/2;y.copy(x(e,i)),g.copy(y)}h=l.NONE,s.dispatchEvent(w)}}function R(t){t.preventDefault()}return a.zoomCamera=function(){if(h===l.TOUCH_ZOOM_PAN){var t=_/m;m=_,s.object.zoom*=t,c=!0}else{t=1+(p.y-f.y)*s.zoomSpeed;Math.abs(t-1)>1e-6&&t>0&&(s.object.zoom/=t,s.staticMoving?f.copy(p):f.y+=(p.y-f.y)*this.dynamicDampingFactor,c=!0)}},a.panCamera=function(){var t=new n.K,e=new n.L,i=new n.L;return function(){if(t.copy(y).sub(g),t.lengthSq()){var n=(s.object.right-s.object.left)/s.object.zoom,r=(s.object.top-s.object.bottom)/s.object.zoom;t.x*=n,t.y*=r,i.copy(d).cross(s.object.up).setLength(t.x),i.add(e.copy(s.object.up).setLength(t.y)),s.object.position.add(i),s.target.add(i),s.staticMoving?g.copy(y):g.add(t.subVectors(y,g).multiplyScalar(s.dynamicDampingFactor)),c=!0}}}(),a.update=function(){d.subVectors(s.object.position,s.target),s.noZoom||(s.zoomCamera(),c&&s.object.updateProjectionMatrix()),s.noPan||s.panCamera(),s.object.position.addVectors(s.target,d),s.object.lookAt(s.target),c&&(s.dispatchEvent(b),c=!1)},a.reset=function(){h=l.NONE,u=l.NONE,s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.up.copy(s.up0),d.subVectors(s.object.position,s.target),s.object.left=s.left0,s.object.right=s.right0,s.object.top=s.top0,s.object.bottom=s.bottom0,s.object.lookAt(s.target),s.dispatchEvent(b),c=!1},a.dispose=function(){this.domElement.removeEventListener("contextmenu",R,!1),this.domElement.removeEventListener("mousedown",M,!1),this.domElement.removeEventListener("wheel",k,!1),this.domElement.removeEventListener("touchstart",C,!1),this.domElement.removeEventListener("touchend",P,!1),this.domElement.removeEventListener("touchmove",I,!1),removeEventListener("keydown",A,!1),removeEventListener("keyup",S,!1)},a.domElement.addEventListener("contextmenu",R,!1),a.domElement.addEventListener("mousedown",M,!1),a.domElement.addEventListener("wheel",k,!1),a.domElement.addEventListener("touchstart",C,!1),a.domElement.addEventListener("touchend",P,!1),a.domElement.addEventListener("touchmove",I,!1),addEventListener("keydown",A,!1),addEventListener("keyup",S,!1),a.handleResize(),a.update(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.l)},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(0),r=function(){var t=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.preventDefault=!0,this.target=new n.L,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:n.q.LEFT,MIDDLE:n.q.MIDDLE,RIGHT:n.q.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=s.NONE},this.handleResize=function(){},this.update=function(){var e=new n.L,o=(new n.y).setFromUnitVectors(t.up,new n.L(0,1,0)),a=o.clone().inverse(),m=new n.L,_=new n.y;return function(){var t=i.object.position;return e.copy(t).sub(i.target),e.applyQuaternion(o),h.setFromVector3(e),i.autoRotate&&l===s.NONE&&M(2*Math.PI/60/60*i.autoRotateSpeed),h.theta+=u.theta,h.phi+=u.phi,h.theta=Math.max(i.minAzimuthAngle,Math.min(i.maxAzimuthAngle,h.theta)),h.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(i.minDistance,Math.min(i.maxDistance,h.radius)),i.target.add(f),e.setFromSpherical(h),e.applyQuaternion(a),t.copy(i.target).add(e),i.object.lookAt(i.target),!0===i.enableDamping?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,!!(p||m.distanceToSquared(i.object.position)>c||8*(1-_.dot(i.object.quaternion))>c)&&(i.dispatchEvent(r),m.copy(i.object.position),_.copy(i.object.quaternion),p=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",U,!1),i.domElement.removeEventListener("mousedown",B,!1),i.domElement.removeEventListener("wheel",O,!1),i.domElement.removeEventListener("touchstart",G,!1),i.domElement.removeEventListener("touchend",z,!1),i.domElement.removeEventListener("touchmove",N,!1),document.removeEventListener("mousemove",L,!1),document.removeEventListener("mouseup",D,!1),removeEventListener("keydown",F,!1)};var i=this,r={type:"change"},o={type:"start"},a={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},l=s.NONE,c=1e-6,h=new n.G,u=new n.G,d=1,f=new n.L,p=!1,m=new n.K,_=new n.K,g=new n.K,y=new n.K,b=new n.K,v=new n.K,w=new n.K,x=new n.K,A=new n.K;function S(){return Math.pow(.95,i.zoomSpeed)}function M(t){u.theta-=t}function E(t){u.phi-=t}var T=function(){var t=new n.L;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),f.add(t)}}(),k=function(){var t=new n.L;return function(e,n){!0===i.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(i.object.up,t)),t.multiplyScalar(e),f.add(t)}}(),C=function(){var t=new n.L;return function(e,n){var r=i.domElement===document?i.domElement.body:i.domElement;if(i.object.isPerspectiveCamera){var o=i.object.position;t.copy(o).sub(i.target);var a=t.length();a*=Math.tan(i.object.fov/2*Math.PI/180),T(2*e*a/r.clientHeight,i.object.matrix),k(2*n*a/r.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(T(e*(i.object.right-i.object.left)/i.object.zoom/r.clientWidth,i.object.matrix),k(n*(i.object.top-i.object.bottom)/i.object.zoom/r.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function I(t){i.object.isPerspectiveCamera?d/=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*t)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function P(t){i.object.isPerspectiveCamera?d*=t:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/t)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function R(t){y.set(t.clientX,t.clientY)}function B(t){if(!1!==i.enabled){switch(!0===i.preventDefault&&t.preventDefault(),t.button){case i.mouseButtons.LEFT:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===i.enablePan)return;R(t),l=s.PAN}else{if(!1===i.enableRotate)return;!function(t){m.set(t.clientX,t.clientY)}(t),l=s.ROTATE}break;case i.mouseButtons.MIDDLE:if(!1===i.enableZoom)return;!function(t){w.set(t.clientX,t.clientY)}(t),l=s.DOLLY;break;case i.mouseButtons.RIGHT:if(!1===i.enablePan)return;R(t),l=s.PAN}l!==s.NONE&&(document.addEventListener("mousemove",L,!1),document.addEventListener("mouseup",D,!1),i.dispatchEvent(o))}}function L(t){if(!1!==i.enabled)switch(!0===i.preventDefault&&t.preventDefault(),l){case s.ROTATE:if(!1===i.enableRotate)return;!function(t){_.set(t.clientX,t.clientY),g.subVectors(_,m).multiplyScalar(i.rotateSpeed);var e=i.domElement===document?i.domElement.body:i.domElement;M(2*Math.PI*g.x/e.clientHeight),E(2*Math.PI*g.y/e.clientHeight),m.copy(_),i.update()}(t);break;case s.DOLLY:if(!1===i.enableZoom)return;!function(t){x.set(t.clientX,t.clientY),A.subVectors(x,w),A.y>0?I(S()):A.y<0&&P(S()),w.copy(x),i.update()}(t);break;case s.PAN:if(!1===i.enablePan)return;!function(t){b.set(t.clientX,t.clientY),v.subVectors(b,y).multiplyScalar(i.panSpeed),C(v.x,v.y),y.copy(b),i.update()}(t)}}function D(t){!1!==i.enabled&&(document.removeEventListener("mousemove",L,!1),document.removeEventListener("mouseup",D,!1),i.dispatchEvent(a),l=s.NONE)}function O(t){!1===i.enabled||!1===i.enableZoom||l!==s.NONE&&l!==s.ROTATE||(!0===i.preventDefault&&(t.preventDefault(),t.stopPropagation()),i.dispatchEvent(o),function(t){t.deltaY<0?P(S()):t.deltaY>0&&I(S()),i.update()}(t),i.dispatchEvent(a))}function F(t){!1!==i.enabled&&!1!==i.enableKeys&&!1!==i.enablePan&&function(t){switch(t.keyCode){case i.keys.UP:C(0,i.keyPanSpeed),i.update();break;case i.keys.BOTTOM:C(0,-i.keyPanSpeed),i.update();break;case i.keys.LEFT:C(i.keyPanSpeed,0),i.update();break;case i.keys.RIGHT:C(-i.keyPanSpeed,0),i.update()}}(t)}function G(t){if(!1!==i.enabled){switch(!0===i.preventDefault&&t.preventDefault(),t.touches.length){case 1:if(!1===i.enableRotate)return;!function(t){m.set(t.touches[0].pageX,t.touches[0].pageY)}(t),l=s.TOUCH_ROTATE;break;case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(t){if(i.enableZoom){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);w.set(0,r)}if(i.enablePan){var o=.5*(t.touches[0].pageX+t.touches[1].pageX),a=.5*(t.touches[0].pageY+t.touches[1].pageY);y.set(o,a)}}(t),l=s.TOUCH_DOLLY_PAN;break;default:l=s.NONE}l!==s.NONE&&i.dispatchEvent(o)}}function N(t){if(!1!==i.enabled)switch(!0===i.preventDefault&&(t.preventDefault(),t.stopPropagation()),t.touches.length){case 1:if(!1===i.enableRotate)return;if(l!==s.TOUCH_ROTATE)return;!function(t){_.set(t.touches[0].pageX,t.touches[0].pageY),g.subVectors(_,m).multiplyScalar(i.rotateSpeed);var e=i.domElement===document?i.domElement.body:i.domElement;M(2*Math.PI*g.x/e.clientHeight),E(2*Math.PI*g.y/e.clientHeight),m.copy(_),i.update()}(t);break;case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;if(l!==s.TOUCH_DOLLY_PAN)return;!function(t){if(i.enableZoom){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);x.set(0,r),A.set(0,Math.pow(x.y/w.y,i.zoomSpeed)),I(A.y),w.copy(x)}if(i.enablePan){var o=.5*(t.touches[0].pageX+t.touches[1].pageX),a=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(o,a),v.subVectors(b,y).multiplyScalar(i.panSpeed),C(v.x,v.y),y.copy(b)}i.update()}(t);break;default:l=s.NONE}}function z(t){!1!==i.enabled&&(i.dispatchEvent(a),l=s.NONE)}function U(t){!1!==i.enabled&&!0===i.preventDefault&&t.preventDefault()}i.domElement.addEventListener("contextmenu",U,!1),i.domElement.addEventListener("mousedown",B,!1),i.domElement.addEventListener("wheel",O,!1),i.domElement.addEventListener("touchstart",G,!1),i.domElement.addEventListener("touchend",z,!1),i.domElement.addEventListener("touchmove",N,!1),addEventListener("keydown",F,!1),this.update()};return(t.prototype=Object.create(n.l.prototype)).constructor=t,Object.defineProperties(t.prototype,{center:{get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}}),t}},function(t,e,i){"use strict";var n=i(7);i.d(e,"a",function(){return n.b});var r=i(9);i.d(e,"b",function(){return r.a});var o=i(5);i.d(e,"d",function(){return o.a});var a=i(2);i.d(e,"c",function(){return a.a})},function(t,e,i){"use strict";var n=i(23);i.d(e,"a",function(){return n.a});var r=i(64);i.d(e,"b",function(){return r.a})},function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i(0),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,1,1,1));return r._location=i,r.applyMatrix((new n.r).makeTranslation(r._location.x,r._location.y,r._location.z)),r.verticesNeedUpdate=!0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resetVertices=function(){this.vertices[0].set(.5,.5,.5),this.vertices[1].set(.5,.5,-.5),this.vertices[2].set(.5,-.5,.5),this.vertices[3].set(.5,-.5,-.5),this.vertices[4].set(-.5,.5,-.5),this.vertices[5].set(-.5,.5,.5),this.vertices[6].set(-.5,-.5,-.5),this.vertices[7].set(-.5,-.5,.5)},r(e,[{key:"location",set:function(t){this._location=t,this.vertices[0].set(.5,.5,.5),this.vertices[1].set(.5,.5,-.5),this.vertices[2].set(.5,-.5,.5),this.vertices[3].set(.5,-.5,-.5),this.vertices[4].set(-.5,.5,-.5),this.vertices[5].set(-.5,.5,.5),this.vertices[6].set(-.5,-.5,-.5),this.vertices[7].set(-.5,-.5,.5),this.applyMatrix((new n.r).makeTranslation(this._location.x,this._location.y,this._location.z)),this.verticesNeedUpdate=!0},get:function(){return this._location}}]),e}(n.b)},function(t,e,i){"use strict";var n=i(24);i.d(e,"a",function(){return n.a});var r=i(25);i.d(e,"b",function(){return r.a});var o=i(66);i.d(e,"c",function(){return o.a});var a=i(67);i.d(e,"d",function(){return a.a});var s=i(68);i.d(e,"e",function(){return s.a});var l=i(69);i.d(e,"h",function(){return l.a});var c=i(28);i.d(e,"g",function(){return c.a});var h=i(70);i.d(e,"f",function(){return h.a});var u=i(29);i.d(e,"i",function(){return u.a});var d=i(71);i.d(e,"j",function(){return d.a});var f=i(72);i.d(e,"k",function(){return f.a})},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(26),r=i(17),o=i(16),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return l._stack=i,l._textureToFilter=s,l._contourWidth=1,l._contourOpacity=1,l._canvasWidth=0,l._canvasHeight=0,l._shadersFragment=o.a,l._shadersVertex=r.a,l._uniforms=n.a.uniforms(),l._material=null,l._geometry=a,l._create(),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){this._prepareMaterial(),this._mesh=new a.s(this._geometry,this._material),this._mesh.applyMatrix4(this._stack._ijk2LPS),this.add(this._mesh)},e.prototype._prepareMaterial=function(){if(!this._material){this._uniforms.uWidth.value=this._contourWidth,this._uniforms.uOpacity.value=this._contourOpacity,this._uniforms.uCanvasWidth.value=this._canvasWidth,this._uniforms.uCanvasHeight.value=this._canvasHeight;var t=new o.a(this._uniforms),e=new r.a;this._material=new a.B({side:a.j,uniforms:this._uniforms,vertexShader:e.compute(),fragmentShader:t.compute(),transparent:!0})}},e.prototype.update=function(){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh=null),this._create()},e.prototype.dispose=function(){null!==this._textureToFilter&&(this._textureToFilter.dispose(),this._textureToFilter=null),this._shadersFragment=null,this._shadersVertex=null,this._uniforms=null,this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null},s(e,[{key:"geometry",get:function(){return this._geometry},set:function(t){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh=null,this._geometry.dispose(),this._geometry=null),this._geometry=t,this._create()}},{key:"textureToFilter",get:function(){return this._textureToFilter},set:function(t){this._textureToFilter=t,this._uniforms.uTextureFilled.value=t,this._material.needsUpdate=!0}},{key:"contourOpacity",get:function(){return this._contourOpacity},set:function(t){this._contourOpacity=t,this._uniforms.uOpacity.value=this._contourOpacity}},{key:"contourWidth",get:function(){return this._contourWidth},set:function(t){this._contourWidth=t,this._uniforms.uWidth.value=this._contourWidth}},{key:"canvasWidth",get:function(){return this._canvasWidth},set:function(t){this._canvasWidth=t,this._uniforms.uCanvasWidth.value=this._canvasWidth}},{key:"canvasHeight",get:function(){return this._canvasHeight},set:function(t){this._canvasHeight=t,this._uniforms.uCanvasHeight.value=this._canvasHeight}}]),e}(a.v)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(27),r=i(19),o=i(18),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return l._stack=i,l._referencePlane=s,l._plane1=null,l._color1=null,l._plane2=null,l._color2=null,l._plane3=null,l._color3=null,l._canvasWidth=0,l._canvasHeight=0,l._shadersFragment=o.a,l._shadersVertex=r.a,l._uniforms=n.a.uniforms(),l._material=null,l._geometry=a,l._create(),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){this._prepareMaterial(),this._mesh=new a.s(this._geometry,this._material),this._mesh.applyMatrix(this._stack._ijk2LPS),this.add(this._mesh)},e.prototype._prepareMaterial=function(){if(!this._material){this._uniforms.uSlice.value=this._referencePlane,this._plane1&&(this._uniforms.uPlane1.value=this._plane1,this._uniforms.uPlaneColor1.value=this._color1),this._plane2&&(this._uniforms.uPlane2.value=this._plane2,this._uniforms.uPlaneColor2.value=this._color2),this._plane3&&(this._uniforms.uPlane3.value=this._plane3,this._uniforms.uPlaneColor3.value=this._color3),this._uniforms.uCanvasWidth.value=this._canvasWidth,this._uniforms.uCanvasHeight.value=this._canvasHeight;var t=new o.a(this._uniforms),e=new r.a;this._material=new a.B({side:a.j,uniforms:this._uniforms,vertexShader:e.compute(),fragmentShader:t.compute()}),this._material.transparent=!0}},e.prototype.update=function(){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh=null),this._create()},e.prototype.dispose=function(){this._referencePlane=null,this._plane1=null,this._color1=null,this._plane2=null,this._color2=null,this._plane3=null,this._color3=null,this._shadersFragment=null,this._shadersVertex=null,this._uniforms=null,this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null},s(e,[{key:"geometry",get:function(){return this._geometry},set:function(t){this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh=null,this._geometry.dispose(),this._geometry=null),this._geometry=t,this._create()}},{key:"referencePlane",get:function(){return this._referencePlane},set:function(t){this._referencePlane=t,this._uniforms.uSlice.value=this._referencePlane}},{key:"plane1",get:function(){return this._plane1},set:function(t){this._plane1=t,this._uniforms.uPlane1.value=this._plane1}},{key:"color1",get:function(){return this._color1},set:function(t){this._color1=t,this._uniforms.uPlaneColor1.value=this._color1}},{key:"plane2",get:function(){return this._plane2},set:function(t){this._plane2=t,this._uniforms.uPlane2.value=this._plane2}},{key:"color2",get:function(){return this._color2},set:function(t){this._color2=t,this._uniforms.uPlaneColor2.value=this._color2}},{key:"plane3",get:function(){return this._plane3},set:function(t){this._plane3=t,this._uniforms.uPlane3.value=this._plane3}},{key:"color3",get:function(){return this._color3},set:function(t){this._color3=t,this._uniforms.uPlaneColor3.value=this._color3}},{key:"canvasWidth",get:function(){return this._canvasWidth},set:function(t){this._canvasWidth=t,this._uniforms.uCanvasWidth.value=this._canvasWidth}},{key:"canvasHeight",get:function(){return this._canvasHeight},set:function(t){this._canvasHeight=t,this._uniforms.uCanvasHeight.value=this._canvasHeight}}]),e}(a.v)},function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i(2),r=i(0),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var a=function(t){function e(i){var r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[[0,0,0,0],[1,1,1,1]],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[[0,0],[1,1]],h=arguments.length>5&&void 0!==arguments[5]&&arguments[5];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.a.isString(i)?u._dom=document.getElementById(i):u._dom=i,u._discrete=h,u._color=l,u._lut=a,u._luts=((r={})[a]=l,r),u._opacity=c,u._lutO=s,u._lutsO=((o={})[s]=c,o),u.initCanvas(),u.paintCanvas(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.initCanvas=function(){this._canvasContainer=this.initCanvasContainer(this._dom),this._canvasBg=this.createCanvas(),this._canvasContainer.appendChild(this._canvasBg),this._canvas=this.createCanvas(),this._canvasContainer.appendChild(this._canvas)},e.prototype.initCanvasContainer=function(t){var e=t;return e.style.border="1px solid #F9F9F9",e},e.prototype.createCanvas=function(){var t=document.createElement("canvas");return t.height=1,t.width=256,t.style.width="256px",t.style.height="16px",t},e.prototype.paintCanvas=function(){var t=this._canvas.getContext("2d");if(t.clearRect(0,0,this._canvas.width,this._canvas.height),t.globalCompositeOperation="source-over",this._discrete){t.lineWidth=2*this._canvas.height;for(var e=0;e<this._color.length;e++){var i=this._color[e][0],n=1;e<this._color.length-1&&(n=this._color[e+1][0]);var r=0;e>0&&(r=this._color[e-1][0]);var o=r+(i-r)/2,a=i+(n-i)/2,s=this._color[e],l=this._opacity[e]?this._opacity[e][1]:1;t.beginPath(),t.strokeStyle="rgba( "+Math.round(255*s[1])+", "+Math.round(255*s[2])+", "+Math.round(255*s[3])+", "+l+")",t.moveTo(o*this._canvas.width,0),t.lineTo(a*this._canvas.width,0),t.stroke(),t.closePath()}}else{for(var c=t.createLinearGradient(0,0,this._canvas.width,0),h=0;h<this._color.length;h++)c.addColorStop(this._color[h][0],"rgba( "+Math.round(255*this._color[h][1])+", "+Math.round(255*this._color[h][2])+", "+Math.round(255*this._color[h][3])+", 1)");t.fillStyle=c,t.fillRect(0,0,this._canvas.width,this._canvas.height),t.globalCompositeOperation="destination-in";for(var u=t.createLinearGradient(0,0,this._canvas.width,0),d=0;d<this._opacity.length;d++)u.addColorStop(this._opacity[d][0],"rgba(255, 255, 255, "+this._opacity[d][1]+")");t.fillStyle=u,t.fillRect(0,0,this._canvas.width,this._canvas.height)}},e.prototype.lutsAvailable=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"color",e=[],i=this._luts;for(var n in"color"!==t&&(i=this._lutsO),i)e.push(n);return e},e.presetLuts=function(){return{default:[[0,0,0,0],[1,1,1,1]],spectrum:[[0,0,0,0],[.1,0,0,1],[.33,0,1,1],[.5,0,1,0],[.66,1,1,0],[.9,1,0,0],[1,1,1,1]],hot_and_cold:[[0,0,0,1],[.15,0,1,1],[.3,0,1,0],[.45,0,0,0],[.5,0,0,0],[.55,0,0,0],[.7,1,1,0],[.85,1,0,0],[1,1,1,1]],gold:[[0,0,0,0],[.13,.19,.03,0],[.25,.39,.12,0],[.38,.59,.26,0],[.5,.8,.46,.08],[.63,.99,.71,.21],[.75,.99,.88,.34],[.88,.99,.99,.48],[1,.9,.95,.61]],red:[[0,.75,0,0],[.5,1,.5,0],[.95,1,1,0],[1,1,1,1]],green:[[0,0,.75,0],[.5,.5,1,0],[.95,1,1,0],[1,1,1,1]],blue:[[0,0,0,1],[.5,0,.5,1],[.95,0,1,1],[1,1,1,1]],walking_dead:[[0,.1,1,1],[1,1,1,1]],random:[[0,0,0,0],[.27,.18,.18,.18],[.41,1,1,1],[.7,1,0,0],[1,1,1,1]],muscle_bone:[[0,0,0,0],[.00392156862745098,.00784313725490196,0,0],[.00784313725490196,.0196078431372549,0,0],[.011764705882352941,.03137254901960784,0,0],[.01568627450980392,.0392156862745098,0,.00392156862745098],[.0196078431372549,.050980392156862744,.00392156862745098,.00392156862745098],[.023529411764705882,.06274509803921569,.00392156862745098,.00392156862745098],[.027450980392156862,.07058823529411765,.00392156862745098,.00784313725490196],[.03137254901960784,.08235294117647059,.00392156862745098,.00784313725490196],[.03529411764705882,.09411764705882353,.00784313725490196,.00784313725490196],[.0392156862745098,.10196078431372549,.00784313725490196,.00784313725490196],[.043137254901960784,.11372549019607843,.00784313725490196,.011764705882352941],[.047058823529411764,.12549019607843137,.00784313725490196,.011764705882352941],[.050980392156862744,.13333333333333333,.011764705882352941,.011764705882352941],[.054901960784313725,.1450980392156863,.011764705882352941,.01568627450980392],[.058823529411764705,.1568627450980392,.011764705882352941,.01568627450980392],[.06274509803921569,.16470588235294117,.011764705882352941,.01568627450980392],[.06666666666666667,.17647058823529413,.011764705882352941,.0196078431372549],[.07058823529411765,.18823529411764706,.01568627450980392,.0196078431372549],[.07450980392156863,.2,.01568627450980392,.0196078431372549],[.0784313725490196,.20784313725490197,.01568627450980392,.0196078431372549],[.08235294117647059,.2196078431372549,.01568627450980392,.023529411764705882],[.08627450980392157,.23137254901960785,.0196078431372549,.023529411764705882],[.09019607843137255,.23921568627450981,.0196078431372549,.023529411764705882],[.09411764705882353,.25098039215686274,.0196078431372549,.027450980392156862],[.09803921568627451,.2627450980392157,.0196078431372549,.027450980392156862],[.10196078431372549,.27058823529411763,.023529411764705882,.027450980392156862],[.10588235294117647,.2823529411764706,.023529411764705882,.027450980392156862],[.10980392156862745,.29411764705882354,.023529411764705882,.03137254901960784],[.11372549019607843,.30196078431372547,.023529411764705882,.03137254901960784],[.11764705882352941,.3137254901960784,.023529411764705882,.03137254901960784],[.12156862745098039,.3254901960784314,.027450980392156862,.03529411764705882],[.12549019607843137,.3333333333333333,.027450980392156862,.03529411764705882],[.12941176470588237,.34509803921568627,.027450980392156862,.03529411764705882],[.13333333333333333,.3568627450980392,.027450980392156862,.0392156862745098],[.13725490196078433,.36470588235294116,.03137254901960784,.0392156862745098],[.1411764705882353,.3764705882352941,.03137254901960784,.0392156862745098],[.1450980392156863,.38823529411764707,.03137254901960784,.0392156862745098],[.14901960784313725,.4,.03137254901960784,.043137254901960784],[.15294117647058825,.40784313725490196,.03529411764705882,.043137254901960784],[.1568627450980392,.4196078431372549,.03529411764705882,.043137254901960784],[.1607843137254902,.43137254901960786,.03529411764705882,.047058823529411764],[.16470588235294117,.4392156862745098,.03529411764705882,.047058823529411764],[.16862745098039217,.45098039215686275,.03529411764705882,.047058823529411764],[.17254901960784313,.4627450980392157,.0392156862745098,.047058823529411764],[.17647058823529413,.47058823529411764,.0392156862745098,.050980392156862744],[.1803921568627451,.4823529411764706,.0392156862745098,.050980392156862744],[.1843137254901961,.49411764705882355,.0392156862745098,.050980392156862744],[.18823529411764706,.5019607843137255,.043137254901960784,.054901960784313725],[.19215686274509805,.5137254901960784,.043137254901960784,.054901960784313725],[.19607843137254902,.5254901960784314,.043137254901960784,.054901960784313725],[.2,.5333333333333333,.043137254901960784,.058823529411764705],[.20392156862745098,.5450980392156862,.047058823529411764,.058823529411764705],[.20784313725490197,.5568627450980392,.047058823529411764,.058823529411764705],[.21176470588235294,.5647058823529412,.047058823529411764,.058823529411764705],[.21568627450980393,.5764705882352941,.047058823529411764,.06274509803921569],[.2196078431372549,.5882352941176471,.047058823529411764,.06274509803921569],[.2235294117647059,.6,.050980392156862744,.06274509803921569],[.22745098039215686,.6078431372549019,.050980392156862744,.06666666666666667],[.23137254901960785,.6196078431372549,.050980392156862744,.06666666666666667],[.23529411764705882,.6313725490196078,.050980392156862744,.06666666666666667],[.23921568627450981,.6392156862745098,.054901960784313725,.06666666666666667],[.24313725490196078,.6509803921568628,.054901960784313725,.07058823529411765],[.24705882352941178,.6627450980392157,.054901960784313725,.07058823529411765],[.25098039215686274,.6705882352941176,.054901960784313725,.07058823529411765],[.2549019607843137,.6823529411764706,.058823529411764705,.07450980392156863],[.25882352941176473,.6941176470588235,.058823529411764705,.07450980392156863],[.2627450980392157,.7019607843137254,.058823529411764705,.07450980392156863],[.26666666666666666,.7137254901960784,.058823529411764705,.0784313725490196],[.27058823529411763,.7254901960784313,.058823529411764705,.0784313725490196],[.27450980392156865,.7333333333333333,.06274509803921569,.0784313725490196],[.2784313725490196,.7450980392156863,.06274509803921569,.0784313725490196],[.2823529411764706,.7568627450980392,.06274509803921569,.08235294117647059],[.28627450980392155,.7647058823529411,.06274509803921569,.08235294117647059],[.2901960784313726,.7764705882352941,.06666666666666667,.08235294117647059],[.29411764705882354,.788235294117647,.06666666666666667,.08627450980392157],[.2980392156862745,.8,.06666666666666667,.08627450980392157],[.30196078431372547,.807843137254902,.06666666666666667,.08627450980392157],[.3058823529411765,.8196078431372549,.07058823529411765,.08627450980392157],[.30980392156862746,.8313725490196079,.07058823529411765,.09019607843137255],[.3137254901960784,.8392156862745098,.07058823529411765,.09019607843137255],[.3176470588235294,.8509803921568627,.07058823529411765,.09019607843137255],[.3215686274509804,.8627450980392157,.07058823529411765,.09411764705882353],[.3254901960784314,.8705882352941177,.07450980392156863,.09411764705882353],[.32941176470588235,.8823529411764706,.07450980392156863,.09411764705882353],[.3333333333333333,.8941176470588236,.07450980392156863,.09803921568627451],[.33725490196078434,.9019607843137255,.07450980392156863,.09803921568627451],[.3411764705882353,.9137254901960784,.0784313725490196,.09803921568627451],[.34509803921568627,.9254901960784314,.0784313725490196,.09803921568627451],[.34901960784313724,.9333333333333333,.0784313725490196,.10196078431372549],[.35294117647058826,.9450980392156862,.0784313725490196,.10196078431372549],[.3568627450980392,.9568627450980393,.08235294117647059,.10196078431372549],[.3607843137254902,.9647058823529412,.08235294117647059,.10588235294117647],[.36470588235294116,.9764705882352941,.08235294117647059,.10588235294117647],[.3686274509803922,.9882352941176471,.08235294117647059,.10588235294117647],[.37254901960784315,1,.08235294117647059,.10588235294117647],[.3764705882352941,1,.09411764705882353,.10588235294117647],[.3803921568627451,1,.10588235294117647,.10588235294117647],[.3843137254901961,1,.11764705882352941,.10196078431372549],[.38823529411764707,1,.12941176470588237,.10196078431372549],[.39215686274509803,1,.1411764705882353,.10196078431372549],[.396078431372549,1,.15294117647058825,.09803921568627451],[.4,1,.16470588235294117,.09803921568627451],[.403921568627451,1,.17647058823529413,.09803921568627451],[.40784313725490196,1,.18823529411764706,.09411764705882353],[.4117647058823529,1,.2,.09411764705882353],[.41568627450980394,1,.21176470588235294,.09411764705882353],[.4196078431372549,1,.2235294117647059,.09019607843137255],[.4235294117647059,1,.23529411764705882,.09019607843137255],[.42745098039215684,1,.24705882352941178,.08627450980392157],[.43137254901960786,1,.25882352941176473,.08627450980392157],[.43529411764705883,1,.27058823529411763,.08627450980392157],[.4392156862745098,1,.2823529411764706,.08235294117647059],[.44313725490196076,1,.29411764705882354,.08235294117647059],[.4470588235294118,1,.3058823529411765,.08235294117647059],[.45098039215686275,1,.3176470588235294,.0784313725490196],[.4549019607843137,1,.32941176470588235,.0784313725490196],[.4588235294117647,1,.3411764705882353,.0784313725490196],[.4627450980392157,1,.35294117647058826,.07450980392156863],[.4666666666666667,1,.36470588235294116,.07450980392156863],[.47058823529411764,1,.3764705882352941,.07450980392156863],[.4745098039215686,1,.38823529411764707,.07058823529411765],[.47843137254901963,1,.4,.07058823529411765],[.4823529411764706,1,.4117647058823529,.07058823529411765],[.48627450980392156,1,.4235294117647059,.06666666666666667],[.49019607843137253,1,.43529411764705883,.06666666666666667],[.49411764705882355,1,.4470588235294118,.06274509803921569],[.4980392156862745,1,.4588235294117647,.06274509803921569],[.5019607843137255,1,.47058823529411764,.06274509803921569],[.5058823529411764,1,.4823529411764706,.058823529411764705],[.5098039215686274,1,.49411764705882355,.058823529411764705],[.5137254901960784,1,.5058823529411764,.058823529411764705],[.5176470588235295,1,.5137254901960784,.054901960784313725],[.5215686274509804,1,.5254901960784314,.054901960784313725],[.5254901960784314,1,.5372549019607843,.054901960784313725],[.5294117647058824,1,.5490196078431373,.050980392156862744],[.5333333333333333,1,.5607843137254902,.050980392156862744],[.5372549019607843,1,.5725490196078431,.050980392156862744],[.5411764705882353,1,.5843137254901961,.047058823529411764],[.5450980392156862,1,.596078431372549,.047058823529411764],[.5490196078431373,1,.6078431372549019,.043137254901960784],[.5529411764705883,1,.6196078431372549,.043137254901960784],[.5568627450980392,1,.6313725490196078,.043137254901960784],[.5607843137254902,1,.6431372549019608,.0392156862745098],[.5647058823529412,1,.6549019607843137,.0392156862745098],[.5686274509803921,1,.6666666666666666,.0392156862745098],[.5725490196078431,1,.6784313725490196,.03529411764705882],[.5764705882352941,1,.6901960784313725,.03529411764705882],[.5803921568627451,1,.6941176470588235,.0392156862745098],[.5843137254901961,1,.7019607843137254,.0392156862745098],[.5882352941176471,1,.7058823529411765,.043137254901960784],[.592156862745098,1,.7098039215686275,.043137254901960784],[.596078431372549,1,.7137254901960784,.047058823529411764],[.6,1,.7176470588235294,.047058823529411764],[.6039215686274509,1,.7254901960784313,.050980392156862744],[.6078431372549019,1,.7294117647058823,.050980392156862744],[.611764705882353,1,.7333333333333333,.054901960784313725],[.615686274509804,1,.7372549019607844,.058823529411764705],[.6196078431372549,1,.7411764705882353,.058823529411764705],[.6235294117647059,1,.7490196078431373,.06274509803921569],[.6274509803921569,1,.7529411764705882,.06274509803921569],[.6313725490196078,1,.7568627450980392,.06666666666666667],[.6352941176470588,1,.7607843137254902,.06666666666666667],[.6392156862745098,1,.7647058823529411,.07058823529411765],[.6431372549019608,1,.7725490196078432,.07058823529411765],[.6470588235294118,1,.7764705882352941,.07450980392156863],[.6509803921568628,1,.7803921568627451,.07450980392156863],[.6549019607843137,1,.7843137254901961,.0784313725490196],[.6588235294117647,1,.788235294117647,.08235294117647059],[.6627450980392157,1,.796078431372549,.08235294117647059],[.6666666666666666,1,.8,.08627450980392157],[.6705882352941176,1,.803921568627451,.08627450980392157],[.6745098039215687,1,.807843137254902,.09019607843137255],[.6784313725490196,1,.8117647058823529,.09019607843137255],[.6823529411764706,1,.8196078431372549,.09411764705882353],[.6862745098039216,1,.8235294117647058,.09411764705882353],[.6901960784313725,1,.8274509803921568,.09803921568627451],[.6941176470588235,1,.8313725490196079,.10196078431372549],[.6980392156862745,1,.8352941176470589,.10196078431372549],[.7019607843137254,1,.8431372549019608,.10588235294117647],[.7058823529411765,1,.8470588235294118,.10588235294117647],[.7098039215686275,1,.8509803921568627,.10980392156862745],[.7137254901960784,1,.8549019607843137,.10980392156862745],[.7176470588235294,1,.8627450980392157,.11372549019607843],[.7215686274509804,1,.8666666666666667,.11372549019607843],[.7254901960784313,1,.8705882352941177,.11764705882352941],[.7294117647058823,1,.8745098039215686,.12156862745098039],[.7333333333333333,1,.8784313725490196,.12156862745098039],[.7372549019607844,1,.8862745098039215,.12549019607843137],[.7411764705882353,1,.8901960784313725,.12549019607843137],[.7450980392156863,1,.8941176470588236,.12941176470588237],[.7490196078431373,1,.8980392156862745,.12941176470588237],[.7529411764705882,1,.9019607843137255,.13333333333333333],[.7568627450980392,1,.9098039215686274,.13333333333333333],[.7607843137254902,1,.9137254901960784,.13725490196078433],[.7647058823529411,1,.9176470588235294,.1411764705882353],[.7686274509803922,1,.9215686274509803,.1411764705882353],[.7725490196078432,1,.9254901960784314,.1450980392156863],[.7764705882352941,1,.9333333333333333,.1450980392156863],[.7803921568627451,1,.9372549019607843,.14901960784313725],[.7843137254901961,1,.9411764705882353,.14901960784313725],[.788235294117647,1,.9450980392156862,.15294117647058825],[.792156862745098,1,.9450980392156862,.16862745098039217],[.796078431372549,1,.9490196078431372,.1843137254901961],[.8,1,.9490196078431372,.2],[.803921568627451,1,.9490196078431372,.21568627450980393],[.807843137254902,1,.9490196078431372,.22745098039215686],[.8117647058823529,1,.9529411764705882,.24313725490196078],[.8156862745098039,1,.9529411764705882,.25882352941176473],[.8196078431372549,1,.9529411764705882,.27450980392156865],[.8235294117647058,1,.9529411764705882,.2901960784313726],[.8274509803921568,1,.9568627450980393,.3058823529411765],[.8313725490196079,1,.9568627450980393,.3215686274509804],[.8352941176470589,1,.9568627450980393,.33725490196078434],[.8392156862745098,1,.9568627450980393,.35294117647058826],[.8431372549019608,1,.9607843137254902,.3686274509803922],[.8470588235294118,1,.9607843137254902,.3843137254901961],[.8509803921568627,1,.9607843137254902,.4],[.8549019607843137,1,.9607843137254902,.4117647058823529],[.8588235294117647,1,.9647058823529412,.42745098039215684],[.8627450980392157,1,.9647058823529412,.44313725490196076],[.8666666666666667,1,.9647058823529412,.4588235294117647],[.8705882352941177,1,.9647058823529412,.4745098039215686],[.8745098039215686,1,.9686274509803922,.49019607843137253],[.8784313725490196,1,.9686274509803922,.5058823529411764],[.8823529411764706,1,.9686274509803922,.5215686274509804],[.8862745098039215,1,.9686274509803922,.5372549019607843],[.8901960784313725,1,.9725490196078431,.5529411764705883],[.8941176470588236,1,.9725490196078431,.5686274509803921],[.8980392156862745,1,.9725490196078431,.5843137254901961],[.9019607843137255,1,.9725490196078431,.6],[.9058823529411765,1,.9725490196078431,.611764705882353],[.9098039215686274,1,.9764705882352941,.6274509803921569],[.9137254901960784,1,.9764705882352941,.6431372549019608],[.9176470588235294,1,.9764705882352941,.6588235294117647],[.9215686274509803,1,.9764705882352941,.6745098039215687],[.9254901960784314,1,.9803921568627451,.6901960784313725],[.9294117647058824,1,.9803921568627451,.7058823529411765],[.9333333333333333,1,.9803921568627451,.7215686274509804],[.9372549019607843,1,.9803921568627451,.7372549019607844],[.9411764705882353,1,.984313725490196,.7529411764705882],[.9450980392156862,1,.984313725490196,.7686274509803922],[.9490196078431372,1,.984313725490196,.7843137254901961],[.9529411764705882,1,.984313725490196,.8],[.9568627450980393,1,.9882352941176471,.8117647058823529],[.9607843137254902,1,.9882352941176471,.8274509803921568],[.9647058823529412,1,.9882352941176471,.8431372549019608],[.9686274509803922,1,.9882352941176471,.8588235294117647],[.9725490196078431,1,.9921568627450981,.8745098039215686],[.9764705882352941,1,.9921568627450981,.8901960784313725],[.9803921568627451,1,.9921568627450981,.9058823529411765],[.984313725490196,1,.9921568627450981,.9215686274509803],[.9882352941176471,1,.996078431372549,.9372549019607843],[.9921568627450981,1,.996078431372549,.9529411764705882],[.996078431372549,1,.996078431372549,.9686274509803922],[1,1,.996078431372549,.984313725490196]]}},e.presetLutsO=function(){return{linear:[[0,0],[1,1]],lowpass:[[0,.8],[.2,.6],[.3,.1],[1,0]],bandpass:[[0,0],[.4,.8],[.6,.8],[1,0]],highpass:[[0,0],[.7,.1],[.8,.6],[1,.8]],flat:[[0,.7],[1,1]],random:[[0,0],[.38,0],[.55,1],[.72,1],[1,.05]],linear_full:[[0,0],[.00392156862745098,.00392156862745098],[.00784313725490196,.00784313725490196],[.011764705882352941,.011764705882352941],[.01568627450980392,.01568627450980392],[.0196078431372549,.0196078431372549],[.023529411764705882,.023529411764705882],[.027450980392156862,.027450980392156862],[.03137254901960784,.03137254901960784],[.03529411764705882,.03529411764705882],[.0392156862745098,.0392156862745098],[.043137254901960784,.043137254901960784],[.047058823529411764,.047058823529411764],[.050980392156862744,.050980392156862744],[.054901960784313725,.054901960784313725],[.058823529411764705,.058823529411764705],[.06274509803921569,.06274509803921569],[.06666666666666667,.06666666666666667],[.07058823529411765,.07058823529411765],[.07450980392156863,.07450980392156863],[.0784313725490196,.0784313725490196],[.08235294117647059,.08235294117647059],[.08627450980392157,.08627450980392157],[.09019607843137255,.09019607843137255],[.09411764705882353,.09411764705882353],[.09803921568627451,.09803921568627451],[.10196078431372549,.10196078431372549],[.10588235294117647,.10588235294117647],[.10980392156862745,.10980392156862745],[.11372549019607843,.11372549019607843],[.11764705882352941,.11764705882352941],[.12156862745098039,.12156862745098039],[.12549019607843137,.12549019607843137],[.12941176470588237,.12941176470588237],[.13333333333333333,.13333333333333333],[.13725490196078433,.13725490196078433],[.1411764705882353,.1411764705882353],[.1450980392156863,.1450980392156863],[.14901960784313725,.14901960784313725],[.15294117647058825,.15294117647058825],[.1568627450980392,.1568627450980392],[.1607843137254902,.1607843137254902],[.16470588235294117,.16470588235294117],[.16862745098039217,.16862745098039217],[.17254901960784313,.17254901960784313],[.17647058823529413,.17647058823529413],[.1803921568627451,.1803921568627451],[.1843137254901961,.1843137254901961],[.18823529411764706,.18823529411764706],[.19215686274509805,.19215686274509805],[.19607843137254902,.19607843137254902],[.2,.2],[.20392156862745098,.20392156862745098],[.20784313725490197,.20784313725490197],[.21176470588235294,.21176470588235294],[.21568627450980393,.21568627450980393],[.2196078431372549,.2196078431372549],[.2235294117647059,.2235294117647059],[.22745098039215686,.22745098039215686],[.23137254901960785,.23137254901960785],[.23529411764705882,.23529411764705882],[.23921568627450981,.23921568627450981],[.24313725490196078,.24313725490196078],[.24705882352941178,.24705882352941178],[.25098039215686274,.25098039215686274],[.2549019607843137,.2549019607843137],[.25882352941176473,.25882352941176473],[.2627450980392157,.2627450980392157],[.26666666666666666,.26666666666666666],[.27058823529411763,.27058823529411763],[.27450980392156865,.27450980392156865],[.2784313725490196,.2784313725490196],[.2823529411764706,.2823529411764706],[.28627450980392155,.28627450980392155],[.2901960784313726,.2901960784313726],[.29411764705882354,.29411764705882354],[.2980392156862745,.2980392156862745],[.30196078431372547,.30196078431372547],[.3058823529411765,.3058823529411765],[.30980392156862746,.30980392156862746],[.3137254901960784,.3137254901960784],[.3176470588235294,.3176470588235294],[.3215686274509804,.3215686274509804],[.3254901960784314,.3254901960784314],[.32941176470588235,.32941176470588235],[.3333333333333333,.3333333333333333],[.33725490196078434,.33725490196078434],[.3411764705882353,.3411764705882353],[.34509803921568627,.34509803921568627],[.34901960784313724,.34901960784313724],[.35294117647058826,.35294117647058826],[.3568627450980392,.3568627450980392],[.3607843137254902,.3607843137254902],[.36470588235294116,.36470588235294116],[.3686274509803922,.3686274509803922],[.37254901960784315,.37254901960784315],[.3764705882352941,.3764705882352941],[.3803921568627451,.3803921568627451],[.3843137254901961,.3843137254901961],[.38823529411764707,.38823529411764707],[.39215686274509803,.39215686274509803],[.396078431372549,.396078431372549],[.4,.4],[.403921568627451,.403921568627451],[.40784313725490196,.40784313725490196],[.4117647058823529,.4117647058823529],[.41568627450980394,.41568627450980394],[.4196078431372549,.4196078431372549],[.4235294117647059,.4235294117647059],[.42745098039215684,.42745098039215684],[.43137254901960786,.43137254901960786],[.43529411764705883,.43529411764705883],[.4392156862745098,.4392156862745098],[.44313725490196076,.44313725490196076],[.4470588235294118,.4470588235294118],[.45098039215686275,.45098039215686275],[.4549019607843137,.4549019607843137],[.4588235294117647,.4588235294117647],[.4627450980392157,.4627450980392157],[.4666666666666667,.4666666666666667],[.47058823529411764,.47058823529411764],[.4745098039215686,.4745098039215686],[.47843137254901963,.47843137254901963],[.4823529411764706,.4823529411764706],[.48627450980392156,.48627450980392156],[.49019607843137253,.49019607843137253],[.49411764705882355,.49411764705882355],[.4980392156862745,.4980392156862745],[.5019607843137255,.5019607843137255],[.5058823529411764,.5058823529411764],[.5098039215686274,.5098039215686274],[.5137254901960784,.5137254901960784],[.5176470588235295,.5176470588235295],[.5215686274509804,.5215686274509804],[.5254901960784314,.5254901960784314],[.5294117647058824,.5294117647058824],[.5333333333333333,.5333333333333333],[.5372549019607843,.5372549019607843],[.5411764705882353,.5411764705882353],[.5450980392156862,.5450980392156862],[.5490196078431373,.5490196078431373],[.5529411764705883,.5529411764705883],[.5568627450980392,.5568627450980392],[.5607843137254902,.5607843137254902],[.5647058823529412,.5647058823529412],[.5686274509803921,.5686274509803921],[.5725490196078431,.5725490196078431],[.5764705882352941,.5764705882352941],[.5803921568627451,.5803921568627451],[.5843137254901961,.5843137254901961],[.5882352941176471,.5882352941176471],[.592156862745098,.592156862745098],[.596078431372549,.596078431372549],[.6,.6],[.6039215686274509,.6039215686274509],[.6078431372549019,.6078431372549019],[.611764705882353,.611764705882353],[.615686274509804,.615686274509804],[.6196078431372549,.6196078431372549],[.6235294117647059,.6235294117647059],[.6274509803921569,.6274509803921569],[.6313725490196078,.6313725490196078],[.6352941176470588,.6352941176470588],[.6392156862745098,.6392156862745098],[.6431372549019608,.6431372549019608],[.6470588235294118,.6470588235294118],[.6509803921568628,.6509803921568628],[.6549019607843137,.6549019607843137],[.6588235294117647,.6588235294117647],[.6627450980392157,.6627450980392157],[.6666666666666666,.6666666666666666],[.6705882352941176,.6705882352941176],[.6745098039215687,.6745098039215687],[.6784313725490196,.6784313725490196],[.6823529411764706,.6823529411764706],[.6862745098039216,.6862745098039216],[.6901960784313725,.6901960784313725],[.6941176470588235,.6941176470588235],[.6980392156862745,.6980392156862745],[.7019607843137254,.7019607843137254],[.7058823529411765,.7058823529411765],[.7098039215686275,.7098039215686275],[.7137254901960784,.7137254901960784],[.7176470588235294,.7176470588235294],[.7215686274509804,.7215686274509804],[.7254901960784313,.7254901960784313],[.7294117647058823,.7294117647058823],[.7333333333333333,.7333333333333333],[.7372549019607844,.7372549019607844],[.7411764705882353,.7411764705882353],[.7450980392156863,.7450980392156863],[.7490196078431373,.7490196078431373],[.7529411764705882,.7529411764705882],[.7568627450980392,.7568627450980392],[.7607843137254902,.7607843137254902],[.7647058823529411,.7647058823529411],[.7686274509803922,.7686274509803922],[.7725490196078432,.7725490196078432],[.7764705882352941,.7764705882352941],[.7803921568627451,.7803921568627451],[.7843137254901961,.7843137254901961],[.788235294117647,.788235294117647],[.792156862745098,.792156862745098],[.796078431372549,.796078431372549],[.8,.8],[.803921568627451,.803921568627451],[.807843137254902,.807843137254902],[.8117647058823529,.8117647058823529],[.8156862745098039,.8156862745098039],[.8196078431372549,.8196078431372549],[.8235294117647058,.8235294117647058],[.8274509803921568,.8274509803921568],[.8313725490196079,.8313725490196079],[.8352941176470589,.8352941176470589],[.8392156862745098,.8392156862745098],[.8431372549019608,.8431372549019608],[.8470588235294118,.8470588235294118],[.8509803921568627,.8509803921568627],[.8549019607843137,.8549019607843137],[.8588235294117647,.8588235294117647],[.8627450980392157,.8627450980392157],[.8666666666666667,.8666666666666667],[.8705882352941177,.8705882352941177],[.8745098039215686,.8745098039215686],[.8784313725490196,.8784313725490196],[.8823529411764706,.8823529411764706],[.8862745098039215,.8862745098039215],[.8901960784313725,.8901960784313725],[.8941176470588236,.8941176470588236],[.8980392156862745,.8980392156862745],[.9019607843137255,.9019607843137255],[.9058823529411765,.9058823529411765],[.9098039215686274,.9098039215686274],[.9137254901960784,.9137254901960784],[.9176470588235294,.9176470588235294],[.9215686274509803,.9215686274509803],[.9254901960784314,.9254901960784314],[.9294117647058824,.9294117647058824],[.9333333333333333,.9333333333333333],[.9372549019607843,.9372549019607843],[.9411764705882353,.9411764705882353],[.9450980392156862,.9450980392156862],[.9490196078431372,.9490196078431372],[.9529411764705882,.9529411764705882],[.9568627450980393,.9568627450980393],[.9607843137254902,.9607843137254902],[.9647058823529412,.9647058823529412],[.9686274509803922,.9686274509803922],[.9725490196078431,.9725490196078431],[.9764705882352941,.9764705882352941],[.9803921568627451,.9803921568627451],[.984313725490196,.984313725490196],[.9882352941176471,.9882352941176471],[.9921568627450981,.9921568627450981],[.996078431372549,.996078431372549],[1,1]]}},o(e,[{key:"texture",get:function(){var t=new r.H(this._canvas);return t.mapping=r.I,t.wrapS=t.wrapT=r.f,t.magFilter=t.minFilter=r.u,t.premultiplyAlpha=!0,t.needsUpdate=!0,t}},{key:"lut",set:function(t){this._color=this._luts[t],this._lut=t,this.paintCanvas()},get:function(){return this._lut}},{key:"luts",set:function(t){this._luts=t},get:function(){return this._luts}},{key:"lutO",set:function(t){this._opacity=this._lutsO[t],this._lutO=t,this.paintCanvas()},get:function(){return this._lutO}},{key:"lutsO",set:function(t){this._lutsO=t},get:function(){return this._lutsO}},{key:"discrete",set:function(t){this._discrete=t,this.paintCanvas()},get:function(){return this._discrete}}]),e}(r.v)},function(t,e,i){"use strict";var n=i(2),r=i(0),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var a={0:{color:[0,0,0],opacity:0,label:"background"},1:{color:[255,0,0],opacity:1,label:"white matter"}},s=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n.a.isString(e)?this._dom=document.getElementById(e):this._dom=e,this._segmentation=i,this.initCanvas(),this.paintCanvas()}return t.prototype.initCanvas=function(){this._canvasContainer=this.initCanvasContainer(this._dom),this._canvasBg=this.createCanvas(),this._canvasContainer.appendChild(this._canvasBg),this._canvas=this.createCanvas(),this._canvasContainer.appendChild(this._canvas)},t.prototype.initCanvasContainer=function(t){var e=t;return e.style.width="256 px",e.style.height="128 px",e.style.border="1px solid #F9F9F9",e},t.prototype.createCanvas=function(){var t=document.createElement("canvas");return t.height=128,t.width=256,t},t.prototype.paintCanvas=function(){var t=this._canvas.getContext("2d");for(var e in t.clearRect(0,0,this._canvas.width,this._canvas.height),t.globalCompositeOperation="source-over",t.lineWidth=1,this._segmentation){var i=e%this._canvas.width,n=Math.floor(e/this._canvas.width),r=void 0!==this._segmentation[e].opacity?this._segmentation[e].opacity:1,o=this._segmentation[e].color;t.fillStyle="rgba( "+Math.round(o[0])+", "+Math.round(o[1])+", "+Math.round(o[2])+", "+r+")",t.fillRect(i,n,1,1)}},o(t,[{key:"texture",get:function(){var t=new r.H(this._canvas);return t.mapping=r.I,t.wrapS=t.wrapT=r.f,t.magFilter=t.minFilter=r.u,t.premultiplyAlpha=!0,t.needsUpdate=!0,t}},{key:"segmentation",set:function(t){this._segmentation=t,this.paintCanvas()},get:function(){return this._segmentation}}]),t}();e.a=s},function(t,e,i){"use strict";var n=i(2);var r=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&this._isFunction(e.emit)?(n.a.isString(i)?this._dom=document.getElementById(i):this._dom=i,n.a.isElement(this._dom)?(this._emitter=e,this.initContainerDom(),this.initEventListenner(),this.loaded=0,this.totalFile=0):console.error("please give the id of container dom or directly a dom instance")):console.error("please give the this._emitter instance")}return t.prototype._isFunction=function(t){return"[object Function]"===Object.prototype.toString.call(t)},t.prototype.initEventListenner=function(){var t=this;this._emitter.on("load-start",function(e){var i=e.files.length;t.totalFile=i,t._domTotalFile.innerHTML=i}),this._emitter.on("fetch-start",function(e){var i=document.createElement("li"),n=document.createElement("div");n.innerHTML="file: "+e.file,n.style.color="#ffffff",i.append(n),i.className="fetch-file",i.id="file-"+e.file,i.style.marginBottom="7px",i.style.border="1px solid #ffffff;",i.style.width="60%";var r=document.createElement("div");r.id="file-fetch-"+e.file,r.style.width="0%",i.append(r),t._domProcessList.append(i)}),this._emitter.on("fetch-progress",function(t){var e="file-fetch-"+t.file,i=document.getElementById(e);i.style.width=t.loaded/t.total*100+"%",i.style.border="1px solid red"}),this._emitter.on("fetch-success",function(t){var e=document.getElementById("file-"+t.file),i=document.createElement("div");i.id="file-result-"+t.file,i.innerHTML="fetch-success",i.style.color="#ffffff",e.append(i)}),this._emitter.on("fetch-error",function(t){}),this._emitter.on("fetch-abort",function(t){}),this._emitter.on("fetch-end",function(t){}),this._emitter.on("fetch-timeout",function(t){}),this._emitter.on("parse-start",function(t){var e=document.getElementById("file-"+t.file),i=document.createElement("div");i.id="file-parse-"+t.file,i.style.width="0%",e.append(i)}),this._emitter.on("parsing",function(t){var e="file-parse-"+t.file,i=document.getElementById(e);i.style.width=t.parsed/t.total*100+"%",i.style.border="1px solid yellow"}),this._emitter.on("parse-success",function(e){t.loaded+=1,t._domCurrentFile.innerHTML=t.loaded,t._domCurrentProgress.style.width=t.loaded/t.totalFile*100+"%";var i=document.getElementById("file-"+e.file),n=document.createElement("div");n.id="file-result-"+e.file,n.innerHTML="parse-success",n.style.color="#ffffff",i.append(n)})},t.prototype.initContainerDom=function(){var t=document.createElement("div");t.innerHTML='\n      <div id="ami-progress-bar-container" style="background-color: rgb(33, 33, 33); color: #ffffff;">\n      <div>\n      <label for="progress-bar" id="progress-label" style="width: 60%; border: 1px solid #ffffff; text-align: center;">\n      <span id="current-file-index">0</span>\n      <span id="total-file">0</span>\n      </label>\n      <div id="progress-bar" style="width: 60%; border: 1px solid #ffffff; text-align: center;">\n      <div id="current-progress" style="border: 1px solid red; width: 0%;"></div>\n      </div>\n      </div>\n      <ul id="process-list" style="list-style-type: none; padding: 0; overflow-y: auto;">\n      </ul>\n      </div>',this._dom.append(t),this._domCurrentFile=document.getElementById("current-file-index"),this._domTotalFile=document.getElementById("total-file"),this._domProcessList=document.getElementById("process-list"),this._domCurrentProgress=document.getElementById("current-progress")},t}();e.a=r},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(24),r=i(25),o=i(29),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._stack=i,n._bBox=null,n._slice=null,n._border=null,n._dummy=null,n._orientation=0,n._index=0,n._uniforms=null,n._autoWindowLevel=!1,n._outOfBounds=!1,n._orientationMaxIndex=0,n._orientationSpacing=0,n._canvasWidth=0,n._canvasHeight=0,n._borderColor=null,n._create(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){this._stack?(this._prepareStack(),this._prepareBBox(),this._prepareSlice(),this._prepareBorder()):console.log("no stack to be prepared...")},e.prototype._computeOrientationSpacing=function(){var t=this._stack._spacing;switch(this._orientation){case 0:this._orientationSpacing=t.z;break;case 1:this._orientationSpacing=t.x;break;case 2:this._orientationSpacing=t.y;break;default:this._orientationSpacing=0}},e.prototype._computeOrientationMaxIndex=function(){var t=this._stack.dimensionsIJK;switch(this._orientationMaxIndex=0,this._orientation){case 0:this._orientationMaxIndex=t.z-1;break;case 1:this._orientationMaxIndex=t.x-1;break;case 2:this._orientationMaxIndex=t.y-1}},e.prototype._isIndexOutOfBounds=function(){this._computeOrientationMaxIndex(),this._index>=this._orientationMaxIndex||this._index<0?this._outOfBounds=!0:this._outOfBounds=!1},e.prototype._prepareStack=function(){this._stack.prepared||this._stack.prepare(),this._stack.packed||this._stack.pack()},e.prototype._prepareBBox=function(){var t=Object(r.a)();this._bBox=new t(this._stack),this.add(this._bBox)},e.prototype._prepareBorder=function(){var t=Object(n.a)();this._border=new t(this._slice),this.add(this._border)},e.prototype._prepareSlice=function(){var t=this._stack.halfDimensionsIJK;this._index=this._prepareSliceIndex(t);var e=this._prepareSlicePosition(t,this._index),i=this._prepareDirection(this._orientation),n=Object(o.a)();this._slice=new n(this._stack,this._index,e,i),this.add(this._slice)},e.prototype._prepareSliceIndex=function(t){var e=0;switch(this._orientation){case 0:e=Math.floor(t.z);break;case 1:e=Math.floor(t.x);break;case 2:e=Math.floor(t.y)}return e},e.prototype._prepareSlicePosition=function(t,e){var i=new a.L(0,0,0);switch(this._orientation){case 0:i=new a.L(Math.floor(t.x),Math.floor(t.y),e);break;case 1:i=new a.L(e,Math.floor(t.y),Math.floor(t.z));break;case 2:i=new a.L(Math.floor(t.x),e,Math.floor(t.z))}return i},e.prototype._prepareDirection=function(t){var e=new a.L(0,0,1);switch(t){case 0:e=new a.L(0,0,1);break;case 1:e=new a.L(1,0,0);break;case 2:e=new a.L(0,1,0)}return e},e.prototype.dispose=function(){this.remove(this._slice),this._slice.dispose(),this._slice=null,this._bBox.dispose(),this._bBox=null,this._border.dispose(),this._border=null},s(e,[{key:"stack",get:function(){return this._stack},set:function(t){this._stack=t}},{key:"bbox",get:function(){return this._bBox}},{key:"slice",get:function(){return this._slice}},{key:"border",get:function(){return this._border}},{key:"index",get:function(){return this._index},set:function(t){this._index=t,this._slice.index=t;var e=this._stack.halfDimensionsIJK;this._slice.planePosition=this._prepareSlicePosition(e,this._index),this._border.helpersSlice=this._slice,this._isIndexOutOfBounds()}},{key:"orientation",set:function(t){this._orientation=t,this._computeOrientationMaxIndex(),this._computeOrientationSpacing(),this._slice.spacing=Math.abs(this._orientationSpacing),this._slice.thickness=this._slice.spacing,this._slice.planeDirection=this._prepareDirection(this._orientation),this._border.helpersSlice=this._slice},get:function(){return this._orientation}},{key:"outOfBounds",set:function(t){this._outOfBounds=t},get:function(){return this._outOfBounds}},{key:"orientationMaxIndex",set:function(t){this._orientationMaxIndex=t},get:function(){return this._orientationMaxIndex}},{key:"orientationSpacing",set:function(t){this._orientationSpacing=t},get:function(){return this._orientationSpacing}},{key:"canvasWidth",set:function(t){this._canvasWidth=t,this._slice.canvasWidth=this._canvasWidth},get:function(){return this._canvasWidth}},{key:"canvasHeight",set:function(t){this._canvasHeight=t,this._slice.canvasHeight=this._canvasHeight},get:function(){return this._canvasHeight}},{key:"borderColor",set:function(t){this._borderColor=t,this._border.color=t,this._slice.borderColor=this._borderColor},get:function(){return this._borderColor}}]),e}(a.v)},function(t,e,i){"use strict";i.d(e,"a",function(){return c});var n=i(20),r=i(34),o=i(33),a=i(45),s=i(0),l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var c=function(t){function e(i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return a._stack=i,a._textures=[],a._shadersFragment=o.a,a._shadersVertex=r.a,a._uniforms=n.a.uniforms(),a._material=null,a._geometry=null,a._mesh=null,a._algorithm=0,a._alphaCorrection=.5,a._interpolation=1,a._shading=1,a._shininess=10,a._steps=256,a._offset=0,a._windowCenter=0,a._windowWidth=1,a._create(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._create=function(){this._prepareStack(),this._prepareTexture(),this._prepareMaterial(),this._prepareGeometry(),this._mesh=new s.s(this._geometry,this._material),this.add(this._mesh)},e.prototype._prepareStack=function(){this._stack.prepared||this._stack.prepare(),this._stack.packed||this._stack.pack(),this._offset=Math.min(0,this._stack._minMax[0]),this._windowCenter=this._stack.windowCenter,this._windowWidth=.8*this._stack.windowWidth},e.prototype._prepareMaterial=function(){this._uniforms=n.a.uniforms(),this._uniforms.uWorldBBox.value=this._stack.worldBoundingBox(),this._uniforms.uTextureSize.value=this._stack.textureSize,this._uniforms.uTextureContainer.value=this._textures,this._stack.textureUnits>8&&(this._uniforms.uTextureContainer.length=14),this._uniforms.uWorldToData.value=this._stack.lps2IJK,this._uniforms.uNumberOfChannels.value=this._stack.numberOfChannels,this._uniforms.uPixelType.value=this._stack.pixelType,this._uniforms.uBitsAllocated.value=this._stack.bitsAllocated,this._uniforms.uPackedPerPixel.value=this._stack.packedPerPixel,this._uniforms.uWindowCenterWidth.value=[this._windowCenter-this._offset,this._windowWidth],this._uniforms.uRescaleSlopeIntercept.value=[this._stack.rescaleSlope,this._stack.rescaleIntercept],this._uniforms.uDataDimensions.value=[this._stack.dimensionsIJK.x,this._stack.dimensionsIJK.y,this._stack.dimensionsIJK.z],this._uniforms.uAlphaCorrection.value=this._alphaCorrection,this._uniforms.uInterpolation.value=this._interpolation,this._uniforms.uShading.value=this._shading,this._uniforms.uShininess.value=this._shininess,this._uniforms.uSteps.value=this._steps,this._uniforms.uAlgorithm.value=this._algorithm,this._createMaterial({side:s.a,transparent:!0})},e.prototype._prepareGeometry=function(){var t=this._stack.worldBoundingBox(),e=this._stack.worldCenter();this._geometry=new s.b(t[1]-t[0],t[3]-t[2],t[5]-t[4]),this._geometry.applyMatrix4((new s.r).makeTranslation(e.x,e.y,e.z))},e.prototype.dispose=function(){for(var t=0;t<this._textures.length;t++)this._textures[t].dispose(),this._textures[t]=null;this._textures=null,this._shadersFragment=null,this._shadersVertex=null,this._uniforms.uTextureContainer=null,this._uniforms.uTextureLUT=null,this._uniforms=null,this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null},l(e,[{key:"uniforms",get:function(){return this._uniforms},set:function(t){this._uniforms=t}},{key:"mesh",set:function(t){this._mesh=t},get:function(){return this._mesh}},{key:"stack",get:function(){return this._stack},set:function(t){this._stack=t}},{key:"windowCenter",get:function(){return this._windowCenter},set:function(t){this._windowCenter=t,this._uniforms.uWindowCenterWidth.value[0]=this._windowCenter-this._offset}},{key:"windowWidth",get:function(){return this._windowWidth},set:function(t){this._windowWidth=Math.max(1,t),this._uniforms.uWindowCenterWidth.value[1]=this._windowWidth}},{key:"steps",get:function(){return this._steps},set:function(t){this._steps=t,this._uniforms.uSteps.value=this._steps}},{key:"alphaCorrection",get:function(){return this._alphaCorrection},set:function(t){this._alphaCorrection=t,this._uniforms.uAlphaCorrection.value=this._alphaCorrection}},{key:"interpolation",get:function(){return this._interpolation},set:function(t){this._interpolation=t,this._uniforms.uInterpolation.value=this._interpolation,this._updateMaterial()}},{key:"shading",get:function(){return this._shading},set:function(t){this._shading=t,this._uniforms.uShading.value=this._shading}},{key:"shininess",get:function(){return this._shininess},set:function(t){this._shininess=t,this._uniforms.uShininess.value=this._shininess}},{key:"algorithm",get:function(){return this._algorithm},set:function(t){this._algorithm=t,this._uniforms.uAlgorithm.value=this._algorithm}}]),e}(a.a)},function(t,e,i){"use strict";var n=i(74);i.d(e,"a",function(){return n.a})},function(t,e,i){"use strict";var n=i(123),r=i(2),o=i(35),a=i(36),s=i(37),l=i(39),c=i(122),h=i(38),u=i(40),d=i(41);var f=i(47),p=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.parse=function(t){var e=this;return this.emit("parse-start",{file:t.url,time:new Date}),this._progressBar&&this._progressBar.update(0,100,"parse",t.url),new Promise(function(i,n){setTimeout(function(){i(new Promise(function(i,n){var r=t;if(Array.isArray(r)||(r=[r]),r.forEach(function(t){e._preprocess(t)}),1===r.length)r=r[0];else{var s=r.filter(e._filterByExtension.bind(null,"MHD")),l=r.filter(e._filterByExtension.bind(null,"RAW"));2===r.length&&1===s.length&&1===l.length&&(r.url=s[0].url,r.extension=s[0].extension,r.mhdBuffer=s[0].buffer,r.rawBuffer=l[0].buffer)}var c=e._parser(r.extension);c||(e.emit("parse-error",{file:t.url,time:new Date,error:r.filename+"can not be parsed."}),n(r.filename+" can not be parsed."));var h=null;try{h=new c(r,0)}catch(i){console.warn(i),e.emit("parse-error",{file:t.url,time:new Date,error:i}),n(i)}var u=new o.a;u.rawHeader=h.rawHeader(),u.seriesInstanceUID=h.seriesInstanceUID(),u.transferSyntaxUID=h.transferSyntaxUID(),u.seriesDate=h.seriesDate(),u.seriesDescription=h.seriesDescription(),u.studyDate=h.studyDate(),u.studyDescription=h.studyDescription(),u.numberOfFrames=h.numberOfFrames(),u.numberOfFrames||(u.numberOfFrames=1),u.numberOfChannels=h.numberOfChannels(),u.modality=h.modality(),"SEG"===u.modality&&(u.segmentationType=h.segmentationType(),u.segmentationSegments=h.segmentationSegments()),u.patientID=h.patientID(),u.patientName=h.patientName(),u.patientAge=h.patientAge(),u.patientBirthdate=h.patientBirthdate(),u.patientSex=h.patientSex();var d=new a.a;d.numberOfChannels=h.numberOfChannels(),d.pixelRepresentation=h.pixelRepresentation(),d.pixelType=h.pixelType(),d.invert=h.invert(),d.spacingBetweenSlices=h.spacingBetweenSlices(),d.modality=u.modality,"SEG"===d.modality&&(d.segmentationType=u.segmentationType,d.segmentationSegments=u.segmentationSegments),u.stack.push(d),setTimeout(e.parseFrameClosure(u,d,t.url,0,h,i,n),0)}))},10)})},e.prototype.parseFrameClosure=function(t,e,i,n,r,o,a){var s=this;return function(){s.parseFrame(t,e,i,n,r,o,a)}},e.prototype.parseFrame=function(t,e,i,n,r,o,a){var l=new s.a;l.sopInstanceUID=r.sopInstanceUID(n),l.url=i,l.index=n,l.invert=e.invert,l.frameTime=r.frameTime(n),l.ultrasoundRegions=r.ultrasoundRegions(n),l.rows=r.rows(n),l.columns=r.columns(n),l.numberOfChannels=e.numberOfChannels,l.pixelPaddingValue=r.pixelPaddingValue(n),l.pixelRepresentation=e.pixelRepresentation,l.pixelType=e.pixelType,l.pixelData=r.extractPixelData(n),l.pixelSpacing=r.pixelSpacing(n),l.spacingBetweenSlices=r.spacingBetweenSlices(n),l.sliceThickness=r.sliceThickness(n),l.imageOrientation=r.imageOrientation(n),l.rightHanded=r.rightHanded(),e.rightHanded=l.rightHanded,null===l.imageOrientation&&(l.imageOrientation=[1,0,0,0,1,0]),l.imagePosition=r.imagePosition(n),l.dimensionIndexValues=r.dimensionIndexValues(n),l.bitsAllocated=r.bitsAllocated(n),l.instanceNumber=r.instanceNumber(n),l.windowCenter=r.windowCenter(n),l.windowWidth=r.windowWidth(n),l.rescaleSlope=r.rescaleSlope(n),l.rescaleIntercept=r.rescaleIntercept(n),l.minMax=r.minMaxPixelData(l.pixelData),"SEG"===t.modality&&(l.referencedSegmentNumber=r.referencedSegmentNumber(n)),e.frame.push(l),this._parsed=n+1,this._totalParsed=t.numberOfFrames,this._progressBar&&this._progressBar.update(this._parsed,this._totalParsed,"parse",i),this.emit("parsing",{file:i,total:this._totalParsed,parsed:this._parsed,time:new Date}),this._parsed===this._totalParsed?(this.emit("parse-success",{file:i,total:this._totalParsed,parsed:this._parsed,time:new Date}),o(t)):setTimeout(this.parseFrameClosure(t,e,i,this._parsed,r,o,a),0)},e.prototype._parser=function(t){var e=null;switch(t.toUpperCase()){case"NII":case"NII_":e=h.a;break;case"DCM":case"DIC":case"DICOM":case"IMA":case"":e=l.a;break;case"MHD":e=c.a;break;case"NRRD":e=u.a;break;case"MGH":case"MGZ":e=d.a;break;default:return console.warn("unsupported extension: "+t),!1}return e},e.prototype._preprocess=function(t){var e=r.a.parseUrl(t.url);if(t.filename=e.filename,t.extension=e.extension,t.pathname=e.pathname,t.query=e.query,"gz"===t.extension?(t.gzcompressed=!0,t.extension=t.filename.split(".gz").shift().split(".").pop()):"mgz"===t.extension?(t.gzcompressed=!0,t.extension="mgh"):"zraw"===t.extension?(t.gzcompressed=!0,t.extension="raw"):t.gzcompressed=!1,t.gzcompressed){var i=f.inflate(t.buffer);t.buffer=i.buffer}},e.prototype._filterByExtension=function(t,e){return e.extension.toUpperCase()===t.toUpperCase()},e}(n.a);e.a=p},function(t,e,i){"use strict";t.exports=function(t,e,i,n){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{o=o+(r=r+e[n++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var o=n,a=r+i;t^=-1;for(var s=r;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},function(t,e,i){"use strict";var n=i(12),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",a=0;a<e;a++)i+=String.fromCharCode(t[a]);return i}a[254]=a[254]=1,e.string2buf=function(t){var e,i,r,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(i=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?e[a++]=i:i<2048?(e[a++]=192|i>>>6,e[a++]=128|63&i):i<65536?(e[a++]=224|i>>>12,e[a++]=128|i>>>6&63,e[a++]=128|63&i):(e[a++]=240|i>>>18,e[a++]=128|i>>>12&63,e[a++]=128|i>>>6&63,e[a++]=128|63&i);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,n,r,o,s=e||t.length,c=new Array(2*s);for(n=0,i=0;i<s;)if((r=t[i++])<128)c[n++]=r;else if((o=a[r])>4)c[n++]=65533,i+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&i<s;)r=r<<6|63&t[i++],o--;o>1?c[n++]=65533:r<65536?c[n++]=r:(r-=65536,c[n++]=55296|r>>10&1023,c[n++]=56320|1023&r)}return l(c,n)},e.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+a[t[i]]>e?i:e}},function(t,e,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){"use strict";t.exports=Math.floor},function(t,e,i){"use strict";t.exports=Math.ceil},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||i(52),n.NIFTI1=n.NIFTI1||function(){this.littleEndian=!1,this.dim_info=0,this.dims=[],this.intent_p1=0,this.intent_p2=0,this.intent_p3=0,this.intent_code=0,this.datatypeCode=0,this.numBitsPerVoxel=0,this.slice_start=0,this.slice_end=0,this.slice_code=0,this.pixDims=[],this.vox_offset=0,this.scl_slope=1,this.scl_inter=0,this.xyzt_units=0,this.cal_max=0,this.cal_min=0,this.slice_duration=0,this.toffset=0,this.description="",this.aux_file="",this.intent_name="",this.qform_code=0,this.sform_code=0,this.quatern_b=0,this.quatern_c=0,this.quatern_d=0,this.qoffset_x=0,this.qoffset_y=0,this.qoffset_z=0,this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.magic=0,this.isHDR=!1,this.extensionFlag=[0,0,0,0],this.extensionSize=0,this.extensionCode=0},n.NIFTI1.TYPE_NONE=0,n.NIFTI1.TYPE_BINARY=1,n.NIFTI1.TYPE_UINT8=2,n.NIFTI1.TYPE_INT16=4,n.NIFTI1.TYPE_INT32=8,n.NIFTI1.TYPE_FLOAT32=16,n.NIFTI1.TYPE_COMPLEX64=32,n.NIFTI1.TYPE_FLOAT64=64,n.NIFTI1.TYPE_RGB24=128,n.NIFTI1.TYPE_INT8=256,n.NIFTI1.TYPE_UINT16=512,n.NIFTI1.TYPE_UINT32=768,n.NIFTI1.TYPE_INT64=1024,n.NIFTI1.TYPE_UINT64=1280,n.NIFTI1.TYPE_FLOAT128=1536,n.NIFTI1.TYPE_COMPLEX128=1792,n.NIFTI1.TYPE_COMPLEX256=2048,n.NIFTI1.XFORM_UNKNOWN=0,n.NIFTI1.XFORM_SCANNER_ANAT=1,n.NIFTI1.XFORM_ALIGNED_ANAT=2,n.NIFTI1.XFORM_TALAIRACH=3,n.NIFTI1.XFORM_MNI_152=4,n.NIFTI1.SPATIAL_UNITS_MASK=7,n.NIFTI1.TEMPORAL_UNITS_MASK=56,n.NIFTI1.UNITS_UNKNOWN=0,n.NIFTI1.UNITS_METER=1,n.NIFTI1.UNITS_MM=2,n.NIFTI1.UNITS_MICRON=3,n.NIFTI1.UNITS_SEC=8,n.NIFTI1.UNITS_MSEC=16,n.NIFTI1.UNITS_USEC=24,n.NIFTI1.UNITS_HZ=32,n.NIFTI1.UNITS_PPM=40,n.NIFTI1.UNITS_RADS=48,n.NIFTI1.MAGIC_COOKIE=348,n.NIFTI1.MAGIC_NUMBER_LOCATION=344,n.NIFTI1.MAGIC_NUMBER=[110,43,49],n.NIFTI1.MAGIC_NUMBER2=[110,105,49],n.NIFTI1.EXTENSION_HEADER_SIZE=8,n.NIFTI1.prototype.readHeader=function(t){var e,i,r,o,a=new DataView(t),s=n.Utils.getIntAt(a,0,this.littleEndian);if(s!==n.NIFTI1.MAGIC_COOKIE&&(this.littleEndian=!0,s=n.Utils.getIntAt(a,0,this.littleEndian)),s!==n.NIFTI1.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=n.Utils.getByteAt(a,39),e=0;e<8;e+=1)o=40+2*e,this.dims[e]=n.Utils.getShortAt(a,o,this.littleEndian);for(this.intent_p1=n.Utils.getFloatAt(a,56,this.littleEndian),this.intent_p2=n.Utils.getFloatAt(a,60,this.littleEndian),this.intent_p3=n.Utils.getFloatAt(a,64,this.littleEndian),this.intent_code=n.Utils.getShortAt(a,68,this.littleEndian),this.datatypeCode=n.Utils.getShortAt(a,70,this.littleEndian),this.numBitsPerVoxel=n.Utils.getShortAt(a,72,this.littleEndian),this.slice_start=n.Utils.getShortAt(a,74,this.littleEndian),e=0;e<8;e+=1)o=76+4*e,this.pixDims[e]=n.Utils.getFloatAt(a,o,this.littleEndian);for(this.vox_offset=n.Utils.getFloatAt(a,108,this.littleEndian),this.scl_slope=n.Utils.getFloatAt(a,112,this.littleEndian),this.scl_inter=n.Utils.getFloatAt(a,116,this.littleEndian),this.slice_end=n.Utils.getShortAt(a,120,this.littleEndian),this.slice_code=n.Utils.getByteAt(a,122),this.xyzt_units=n.Utils.getByteAt(a,123),this.cal_max=n.Utils.getFloatAt(a,124,this.littleEndian),this.cal_min=n.Utils.getFloatAt(a,128,this.littleEndian),this.slice_duration=n.Utils.getFloatAt(a,132,this.littleEndian),this.toffset=n.Utils.getFloatAt(a,136,this.littleEndian),this.description=n.Utils.getStringAt(a,148,228),this.aux_file=n.Utils.getStringAt(a,228,252),this.qform_code=n.Utils.getShortAt(a,252,this.littleEndian),this.sform_code=n.Utils.getShortAt(a,254,this.littleEndian),this.quatern_b=n.Utils.getFloatAt(a,256,this.littleEndian),this.quatern_c=n.Utils.getFloatAt(a,260,this.littleEndian),this.quatern_d=n.Utils.getFloatAt(a,264,this.littleEndian),this.qoffset_x=n.Utils.getFloatAt(a,268,this.littleEndian),this.qoffset_y=n.Utils.getFloatAt(a,272,this.littleEndian),this.qoffset_z=n.Utils.getFloatAt(a,276,this.littleEndian),i=0;i<3;i+=1)for(r=0;r<4;r+=1)o=280+4*(4*i+r),this.affine[i][r]=n.Utils.getFloatAt(a,o,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=n.Utils.getStringAt(a,328,344),this.magic=n.Utils.getStringAt(a,344,348),this.isHDR=this.magic===n.NIFTI1.MAGIC_NUMBER2,a.byteLength>n.NIFTI1.MAGIC_COOKIE&&(this.extensionFlag[0]=n.Utils.getByteAt(a,348),this.extensionFlag[1]=n.Utils.getByteAt(a,349),this.extensionFlag[2]=n.Utils.getByteAt(a,350),this.extensionFlag[3]=n.Utils.getByteAt(a,351),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))},n.NIFTI1.prototype.toFormattedString=function(){var t=n.Utils.formatNumber,e="";return e+="Dim Info = "+this.dim_info+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Intent Code = "+this.intent_code+"\n",e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Slice End = "+this.slice_end+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(n.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(n.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+='Intent Name: "'+this.intent_name+'"\n',this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n"),e},n.NIFTI1.prototype.getDatatypeCodeString=function(t){return t===n.NIFTI1.TYPE_UINT8?"1-Byte Unsigned Integer":t===n.NIFTI1.TYPE_INT16?"2-Byte Signed Integer":t===n.NIFTI1.TYPE_INT32?"4-Byte Signed Integer":t===n.NIFTI1.TYPE_FLOAT32?"4-Byte Float":t===n.NIFTI1.TYPE_FLOAT64?"8-Byte Float":t===n.NIFTI1.TYPE_RGB24?"RGB":t===n.NIFTI1.TYPE_INT8?"1-Byte Signed Integer":t===n.NIFTI1.TYPE_UINT16?"2-Byte Unsigned Integer":t===n.NIFTI1.TYPE_UINT32?"4-Byte Unsigned Integer":t===n.NIFTI1.TYPE_INT64?"8-Byte Signed Integer":t===n.NIFTI1.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"},n.NIFTI1.prototype.getTransformCodeString=function(t){return t===n.NIFTI1.XFORM_SCANNER_ANAT?"Scanner":t===n.NIFTI1.XFORM_ALIGNED_ANAT?"Aligned":t===n.NIFTI1.XFORM_TALAIRACH?"Talairach":t===n.NIFTI1.XFORM_MNI_152?"MNI":"Unknown"},n.NIFTI1.prototype.getUnitsCodeString=function(t){return t===n.NIFTI1.UNITS_METER?"Meters":t===n.NIFTI1.UNITS_MM?"Millimeters":t===n.NIFTI1.UNITS_MICRON?"Microns":t===n.NIFTI1.UNITS_SEC?"Seconds":t===n.NIFTI1.UNITS_MSEC?"Milliseconds":t===n.NIFTI1.UNITS_USEC?"Microseconds":t===n.NIFTI1.UNITS_HZ?"Hz":t===n.NIFTI1.UNITS_PPM?"PPM":t===n.NIFTI1.UNITS_RADS?"Rads":"Unknown"},n.NIFTI1.prototype.getQformMat=function(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])},n.NIFTI1.prototype.convertNiftiQFormToNiftiSForm=function(t,e,i,n,r,o,a,s,l,c){var h,u,d,f,p=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],m=t,_=e,g=i;return p[3][0]=p[3][1]=p[3][2]=0,p[3][3]=1,(h=1-(m*m+_*_+g*g))<1e-7?(m*=h=1/Math.sqrt(m*m+_*_+g*g),_*=h,g*=h,h=0):h=Math.sqrt(h),u=a>0?a:1,d=s>0?s:1,f=l>0?l:1,c<0&&(f=-f),p[0][0]=(h*h+m*m-_*_-g*g)*u,p[0][1]=2*(m*_-h*g)*d,p[0][2]=2*(m*g+h*_)*f,p[1][0]=2*(m*_+h*g)*u,p[1][1]=(h*h+_*_-m*m-g*g)*d,p[1][2]=2*(_*g-h*m)*f,p[2][0]=2*(m*g-h*_)*u,p[2][1]=2*(_*g+h*m)*d,p[2][2]=(h*h+g*g-_*_-m*m)*f,p[0][3]=n,p[1][3]=r,p[2][3]=o,p},n.NIFTI1.prototype.convertNiftiSFormToNEMA=function(t){var e,i,n,r,o,a,s,l,c,h,u,d,f,p,m,_,g,y,b,v,w,x,A,S,M,E,T,k,C,I,P,R,B;if(p=0,E=[[0,0,0],[0,0,0],[0,0,0]],T=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],i=t[0][1],n=t[0][2],r=t[1][0],o=t[1][1],a=t[1][2],s=t[2][0],l=t[2][1],c=t[2][2],0===(h=Math.sqrt(e*e+r*r+s*s)))return null;if(e/=h,r/=h,s/=h,0===(h=Math.sqrt(i*i+o*o+l*l)))return null;if(h=e*(i/=h)+r*(o/=h)+s*(l/=h),Math.abs(h)>1e-4){if(i-=h*e,o-=h*r,l-=h*s,0===(h=Math.sqrt(i*i+o*o+l*l)))return null;i/=h,o/=h,l/=h}if(0===(h=Math.sqrt(n*n+a*a+c*c))?(n=r*l-s*o,a=s*i-l*e,c=e*o-r*i):(n/=h,a/=h,c/=h),h=e*n+r*a+s*c,Math.abs(h)>1e-4){if(n-=h*e,a-=h*r,c-=h*s,0===(h=Math.sqrt(n*n+a*a+c*c)))return null;n/=h,a/=h,c/=h}if(h=i*n+o*a+l*c,Math.abs(h)>1e-4){if(n-=h*i,a-=h*o,c-=h*l,0===(h=Math.sqrt(n*n+a*a+c*c)))return null;n/=h,a/=h,c/=h}if(E[0][0]=e,E[0][1]=i,E[0][2]=n,E[1][0]=r,E[1][1]=o,E[1][2]=a,E[2][0]=s,E[2][1]=l,E[2][2]=c,0===(u=this.nifti_mat33_determ(E)))return null;for(M=-666,y=w=x=A=1,b=2,v=3,d=1;d<=3;d+=1)for(f=1;f<=3;f+=1)if(d!==f)for(p=1;p<=3;p+=1)if(d!==p&&f!==p)for(T[0][0]=T[0][1]=T[0][2]=T[1][0]=T[1][1]=T[1][2]=T[2][0]=T[2][1]=T[2][2]=0,m=-1;m<=1;m+=2)for(_=-1;_<=1;_+=2)for(g=-1;g<=1;g+=2)T[0][d-1]=m,T[1][f-1]=_,T[2][p-1]=g,this.nifti_mat33_determ(T)*u>0&&(h=(S=this.nifti_mat33_mul(T,E))[0][0]+S[1][1]+S[2][2])>M&&(M=h,y=d,b=f,v=p,w=m,x=_,A=g);switch(k=C=I=P=R=B=0,y*w){case 1:k="X",P="+";break;case-1:k="X",P="-";break;case 2:k="Y",P="+";break;case-2:k="Y",P="-";break;case 3:k="Z",P="+";break;case-3:k="Z",P="-"}switch(b*x){case 1:C="X",R="+";break;case-1:C="X",R="-";break;case 2:C="Y",R="+";break;case-2:C="Y",R="-";break;case 3:C="Z",R="+";break;case-3:C="Z",R="-"}switch(v*A){case 1:I="X",B="+";break;case-1:I="X",B="-";break;case 2:I="Y",B="+";break;case-2:I="Y",B="-";break;case 3:I="Z",B="+";break;case-3:I="Z",B="-"}return k+C+I+P+R+B},n.NIFTI1.prototype.nifti_mat33_mul=function(t,e){var i,n,r=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;i<3;i+=1)for(n=0;n<3;n+=1)r[i][n]=t[i][0]*e[0][n]+t[i][1]*e[1][n]+t[i][2]*e[2][n];return r},n.NIFTI1.prototype.nifti_mat33_determ=function(t){var e,i,n,r,o,a,s,l,c;return e=t[0][0],i=t[0][1],n=t[0][2],r=t[1][0],o=t[1][1],a=t[1][2],s=t[2][0],l=t[2][1],e*o*(c=t[2][2])-e*l*a-r*i*c+r*l*n+s*i*a-s*o*n},n.NIFTI1.prototype.getExtensionLocation=function(){return n.NIFTI1.MAGIC_COOKIE+4},n.NIFTI1.prototype.getExtensionSize=function(t){return n.Utils.getIntAt(t,this.getExtensionLocation(),this.littleEndian)},n.NIFTI1.prototype.getExtensionCode=function(t){return n.Utils.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)},"undefined"!==typeof t&&t.exports&&(t.exports=n.NIFTI1)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.ComponentSpec=n.lossless.ComponentSpec||function(){this.hSamp=0,this.quantTableSel=0,this.vSamp=0},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.ComponentSpec)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.Utils=n.lossless.Utils||i(22),n.lossless.HuffmanTable=n.lossless.HuffmanTable||function(){this.l=n.lossless.Utils.createArray(4,2,16),this.th=[],this.v=n.lossless.Utils.createArray(4,2,16,200),this.tc=n.lossless.Utils.createArray(4,2),this.tc[0][0]=0,this.tc[1][0]=0,this.tc[2][0]=0,this.tc[3][0]=0,this.tc[0][1]=0,this.tc[1][1]=0,this.tc[2][1]=0,this.tc[3][1]=0,this.th[0]=0,this.th[1]=0,this.th[2]=0,this.th[3]=0},n.lossless.HuffmanTable.MSB=2147483648,n.lossless.HuffmanTable.prototype.read=function(t,e){var i,n,r,o,a,s,l=0;for(i=t.get16(),l+=2;l<i;){if(l+=1,(r=15&(n=t.get8()))>3)throw new Error("ERROR: Huffman table ID > 3");if((o=n>>4)>2)throw new Error("ERROR: Huffman table [Table class > 2 ]");for(this.th[r]=1,this.tc[r][o]=1,a=0;a<16;a+=1)this.l[r][o][a]=t.get8(),l+=1;for(a=0;a<16;a+=1)for(s=0;s<this.l[r][o][a];s+=1){if(l>i)throw new Error("ERROR: Huffman table format error [count>Lh]");this.v[r][o][a][s]=t.get8(),l+=1}}if(l!==i)throw new Error("ERROR: Huffman table format error [count!=Lf]");for(a=0;a<4;a+=1)for(s=0;s<2;s+=1)0!==this.tc[a][s]&&this.buildHuffTable(e[a][s],this.l[a][s],this.v[a][s]);return 1},n.lossless.HuffmanTable.prototype.buildHuffTable=function(t,e,i){var r,o,a,s,l;for(256,o=0,a=0;a<8;a+=1)for(s=0;s<e[a];s+=1)for(l=0;l<256>>a+1;l+=1)t[o]=i[a][s]|a+1<<8,o+=1;for(a=1;o<256;a+=1,o+=1)t[o]=a|n.lossless.HuffmanTable.MSB;for(r=1,o=0,a=8;a<16;a+=1)for(s=0;s<e[a];s+=1){for(l=0;l<256>>a-7;l+=1)t[256*r+o]=i[a][s]|a+1<<8,o+=1;if(o>=256){if(o>256)throw new Error("ERROR: Huffman table error(1)!");o=0,r+=1}}},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.HuffmanTable)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.Utils=n.lossless.Utils||i(22),n.lossless.QuantizationTable=n.lossless.QuantizationTable||function(){this.precision=[],this.tq=[],this.quantTables=n.lossless.Utils.createArray(4,64),this.tq[0]=0,this.tq[1]=0,this.tq[2]=0,this.tq[3]=0},n.lossless.QuantizationTable.enhanceQuantizationTable=function(t,e){var i;for(i=0;i<8;i+=1)t[e[0+i]]*=90,t[e[32+i]]*=90,t[e[16+i]]*=118,t[e[48+i]]*=49,t[e[40+i]]*=71,t[e[8+i]]*=126,t[e[56+i]]*=25,t[e[24+i]]*=106;for(i=0;i<8;i+=1)t[e[0+8*i]]*=90,t[e[4+8*i]]*=90,t[e[2+8*i]]*=118,t[e[6+8*i]]*=49,t[e[5+8*i]]*=71,t[e[1+8*i]]*=126,t[e[7+8*i]]*=25,t[e[3+8*i]]*=106;for(i=0;i<64;i+=1)t[i]>>=6},n.lossless.QuantizationTable.prototype.read=function(t,e){var i,r,o,a,s=0;for(i=t.get16(),s+=2;s<i;){if(s+=1,(o=15&(r=t.get8()))>3)throw new Error("ERROR: Quantization table ID > 3");if(this.precision[o]=r>>4,0===this.precision[o])this.precision[o]=8;else{if(1!==this.precision[o])throw new Error("ERROR: Quantization table precision error");this.precision[o]=16}if(this.tq[o]=1,8===this.precision[o]){for(a=0;a<64;a+=1){if(s>i)throw new Error("ERROR: Quantization table format error");this.quantTables[o][a]=t.get8(),s+=1}n.lossless.QuantizationTable.enhanceQuantizationTable(this.quantTables[o],e)}else{for(a=0;a<64;a+=1){if(s>i)throw new Error("ERROR: Quantization table format error");this.quantTables[o][a]=t.get16(),s+=2}n.lossless.QuantizationTable.enhanceQuantizationTable(this.quantTables[o],e)}}if(s!==i)throw new Error("ERROR: Quantization table error [count!=Lq]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.QuantizationTable)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.ScanComponent=n.lossless.ScanComponent||i(87),n.lossless.ScanHeader=n.lossless.ScanHeader||function(){this.ah=0,this.al=0,this.numComp=0,this.selection=0,this.spectralEnd=0,this.components=[]},n.lossless.ScanHeader.prototype.read=function(t){var e,i,r,o=0;for(e=t.get16(),o+=2,this.numComp=t.get8(),o+=1,i=0;i<this.numComp;i+=1){if(this.components[i]=new n.lossless.ScanComponent,o>e)throw new Error("ERROR: scan header format error");this.components[i].scanCompSel=t.get8(),o+=1,r=t.get8(),o+=1,this.components[i].dcTabSel=r>>4,this.components[i].acTabSel=15&r}if(this.selection=t.get8(),o+=1,this.spectralEnd=t.get8(),o+=1,r=t.get8(),this.ah=r>>4,this.al=15&r,(o+=1)!==e)throw new Error("ERROR: scan header format error [count!=Ns]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.ScanHeader)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.ScanComponent=n.lossless.ScanComponent||function(){this.acTabSel=0,this.dcTabSel=0,this.scanCompSel=0},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.ScanComponent)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.ComponentSpec=n.lossless.ComponentSpec||i(83),n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.FrameHeader=n.lossless.FrameHeader||function(){this.components=[],this.dimX=0,this.dimY=0,this.numComp=0,this.precision=0},n.lossless.FrameHeader.prototype.read=function(t){var e,i,r,o,a=0;for(e=t.get16(),a+=2,this.precision=t.get8(),a+=1,this.dimY=t.get16(),a+=2,this.dimX=t.get16(),a+=2,this.numComp=t.get8(),a+=1,i=1;i<=this.numComp;i+=1){if(a>e)throw new Error("ERROR: frame format error");if(r=t.get8(),(a+=1)>=e)throw new Error("ERROR: frame format error [c>=Lf]");o=t.get8(),a+=1,this.components[r]||(this.components[r]=new n.lossless.ComponentSpec),this.components[r].hSamp=o>>4,this.components[r].vSamp=15&o,this.components[r].quantTableSel=t.get8(),a+=1}if(a!==e)throw new Error("ERROR: frame format error [Lf!=count]");return 1},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.FrameHeader)},function(t,e,i){"use strict";var n=i(37);i.d(e,"a",function(){return n.a});var r=i(36);i.d(e,"c",function(){return r.a});var o=i(35);i.d(e,"b",function(){return o.a});var a=i(42);i.d(e,"d",function(){return a.a})},function(t,e,i){"use strict";var n=i(39);i.d(e,"a",function(){return n.a});var r=i(41);i.d(e,"b",function(){return r.a});var o=i(38);i.d(e,"c",function(){return o.a});var a=i(40);i.d(e,"d",function(){return a.a})},function(t,e,i){"use strict";var n=i(92);i.d(e,"a",function(){return n.a})},function(t,e,i){"use strict";var n=i(125),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Freesurfer";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._presetID=e,this._presets=this.presetSegs()}return t.prototype.fetchPreset=function(t){return this._presets[t]},t.prototype.addPreset=function(t){this._presets.push(t)},t.prototype.presetsAvailable=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=[],e=this._presets;for(var i in e)t.push(i);return t},t.prototype.presetSegs=function(){return{Freesurfer:n.a}},r(t,[{key:"preset",set:function(t){this._presetID=t},get:function(){return this.fetchPreset(this._presetID)}}]),t}();e.a=o},function(t,e,i){"use strict";var n=i(26);i.d(e,"b",function(){return n.a});var r=i(16);i.d(e,"a",function(){return r.a});var o=i(17);i.d(e,"c",function(){return o.a});var a=i(32);i.d(e,"e",function(){return a.a});var s=i(30);i.d(e,"d",function(){return s.a});var l=i(31);i.d(e,"f",function(){return l.a});var c=i(20);i.d(e,"n",function(){return c.a});var h=i(33);i.d(e,"m",function(){return h.a});var u=i(34);i.d(e,"o",function(){return u.a});var d=i(94);i.d(e,"h",function(){return d.a});var f=i(95);i.d(e,"g",function(){return f.a});var p=i(96);i.d(e,"i",function(){return p.a});var m=i(27);i.d(e,"k",function(){return m.a});var _=i(18);i.d(e,"j",function(){return _.a});var g=i(19);i.d(e,"l",function(){return g.a})},function(t,e,i){"use strict";var n=i(126);var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.uniforms=function(){return{uTextureBackTest0:{type:"t",value:[],typeGLSL:"sampler2D"},uTextureBackTest1:{type:"t",value:[],typeGLSL:"sampler2D"},uOpacity0:{type:"f",value:1,typeGLSL:"float"},uOpacity1:{type:"f",value:1,typeGLSL:"float"},uType0:{type:"i",value:0,typeGLSL:"int"},uType1:{type:"i",value:1,typeGLSL:"int"},uTrackMouse:{type:"i",value:0,typeGLSL:"int"},uMouse:{type:"v2",value:new n.a,typeGLSL:"vec2"}}},t}();e.a=r},function(t,e,i){"use strict";var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._uniforms=e,this._functions={},this._main=""}return t.prototype.functions=function(){""===this._main&&this.main();var t="";for(var e in this._functions)t+=this._functions[e]+"\n";return t},t.prototype.uniforms=function(){var t="";for(var e in this._uniforms){var i=this._uniforms[e];t+="uniform "+i.typeGLSL+" "+e,i&&i.length&&(t+="["+i.length+"]"),t+=";\n"}return t},t.prototype.main=function(){this._main="\nvoid main(void) {\n\n  vec2 texc = vec2(((vProjectedCoords.x / vProjectedCoords.w) + 1.0 ) / 2.0,\n                ((vProjectedCoords.y / vProjectedCoords.w) + 1.0 ) / 2.0 );\n\n  // just silence warning for\n  // vec4 dummy = vPos;\n\n  //The back position is the world space position stored in the texture.\n  vec4 baseColor0 = texture2D(uTextureBackTest0, texc);\n  vec4 baseColor1 = texture2D(uTextureBackTest1, texc);\n\n  if( uTrackMouse == 1 ){\n\n      if( vProjectedCoords.x < uMouse.x ){\n\n        gl_FragColor = baseColor0;\n\n      }\n      else{\n\n        gl_FragColor = mix( baseColor0, baseColor1, uOpacity1 );\n\n      }\n\n  }\n  else{\n\n    if( uType1 == 0 ){\n\n      //merge an image into\n      gl_FragColor = mix( baseColor0, baseColor1, uOpacity1 );\n\n    }\n    else{\n\n      float opacity = baseColor1.a;\n      gl_FragColor = mix( baseColor0, baseColor1, opacity * uOpacity1 );\n\n    }\n\n  }\n\n  return;\n}\n   "},t.prototype.compute=function(){return"\n// uniforms\n"+this.uniforms()+"\n\n// varying (should fetch it from vertex directly)\n// varying vec4      vPos;\nvarying vec4      vProjectedCoords;\n\n// tailored functions\n"+this.functions()+"\n\n// main loop\n"+this._main+"\n      "},t}();e.a=n},function(t,e,i){"use strict";var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.prototype.compute=function(){return"\n// varying vec4 vPos;\nvarying vec4 vProjectedCoords;\n\n//\n// main\n//\nvoid main() {\n\n  vec4 vPos = modelMatrix * vec4(position, 1.0 );\n  vProjectedCoords =  projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );\n\n}\n        "},t}();e.a=n},function(t,e,i){"use strict";var n=i(43);i.d(e,"o",function(){return n.a});var r=i(98);i.d(e,"a",function(){return r.a});var o=i(99);i.d(e,"b",function(){return o.a});var a=i(100);i.d(e,"c",function(){return a.a});var s=i(101);i.d(e,"d",function(){return s.a});var l=i(102);i.d(e,"e",function(){return l.a});var c=i(103);i.d(e,"f",function(){return c.a});var h=i(3);i.d(e,"g",function(){return h.a});var u=i(104);i.d(e,"h",function(){return u.a});var d=i(105);i.d(e,"j",function(){return d.a});var f=i(106);i.d(e,"i",function(){return f.a});var p=i(107);i.d(e,"k",function(){return p.a});var m=i(108);i.d(e,"l",function(){return m.a});var _=i(109);i.d(e,"m",function(){return _.a});var g=i(110);i.d(e,"n",function(){return g.a})},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(4),r=i(3),o=i(0),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="Angle",a._opangle=null,a._moving=!1,a._domHovered=!1,a._defaultAngle=!0,a._material=null,a._geometry=null,a._mesh=null,a._line=null,a._line2=null,a._label=null,a._handles=[];for(var s=void 0,l=Object(r.a)(),c=0;c<3;c++)s=new l(i,n,o),a.add(s),a._handles.push(s);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._handles[2].active=!0,a._handles[2].tracking=!0,a._moveHandle=new l(i,n,o),a.add(a._moveHandle),a._handles.push(a._moveHandle),a._moveHandle.hide(),a.create(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._line.addEventListener("mouseenter",this.onHover),this._line.addEventListener("mouseleave",this.onHover),this._line2.addEventListener("mouseenter",this.onHover),this._line2.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._line.removeEventListener("mouseenter",this.onHover),this._line.removeEventListener("mouseleave",this.onHover),this._line2.removeEventListener("mouseenter",this.onHover),this._line2.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._handles[2].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles[0].onStart(t),this._handles[1].onStart(t),this._handles[2].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active||this._domHovered,!this._domHovered||this._handles[1].tracking||this._handles[2].tracking||(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this;if(this._active){var i=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(i))})}else this.onHover(null);this._handles[0].onMove(t),this._handles[1].onMove(t),this._handles[2].onMove(t),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||!this._handles[1].tracking&&this._handles[2].tracking&&this._handles[1].screenPosition.distanceTo(this._handles[2].screenPosition)<10||(this._dragged||!this._active||this._handles[2].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected),this._handles[1].active?this._handles[2].onEnd():this._dragged||!this._handles[2].tracking?(this._handles[2].tracking=!1,this._handles[2].onEnd()):this._handles[2].tracking=!1,this._handles[2].selected=this._selected,this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active,this._dragged=this._handles[2].tracking,this._moving=!1,this.update())},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new o.e;var t=new Float32Array(12);this._geometry.setAttribute("position",new o.d(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,t[e++]=this._handles[2].worldPosition.x,t[e++]=this._handles[2].worldPosition.y,t[e++]=this._handles[2].worldPosition.z,this._material=new o.o,this.updateMeshColor(),this._mesh=new o.p(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._line2=document.createElement("div"),this._line2.className="widgets-line",this._container.appendChild(this._line2),this._label=document.createElement("div"),this._label.className="widgets-label",this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.hideDOM=function(){this._line.style.display="none",this._line2.style.display="none",this._label.style.display="none",this._handles.forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._line2.style.display="",this._label.style.display="",this._handles[0].showDOM(),this._handles[1].showDOM(),this._handles[2].showDOM()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update(),this._handles[2].update(),this._opangle=180*this._handles[1].worldPosition.clone().sub(this._handles[0].worldPosition).angleTo(this._handles[1].worldPosition.clone().sub(this._handles[2].worldPosition))/Math.PI||0,this._opangle=this._defaultAngle?this._opangle:360-this._opangle,this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[1].screenPosition,this._handles[0].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n            rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px";var e=this.getLineData(this._handles[1].screenPosition,this._handles[2].screenPosition);this._line2.style.transform="translate3D("+e.transformX+"px, "+e.transformY+"px, 0)\n            rotate("+e.transformAngle+"rad)",this._line2.style.width=e.length+"px",this._label.innerHTML=this._opangle.toFixed(2)+"&deg;";var i=t.line.clone().add(e.line).normalize().negate(),n=i.angleTo(new o.L(1,0,0));n>Math.PI/2&&(n=Math.PI-n);var r=Math.tan(n)<this._label.offsetHeight/this._label.offsetWidth?this._label.offsetWidth/2/Math.cos(n)+15:this._label.offsetHeight/2/Math.cos(Math.PI/2-n)+15,a=this._handles[1].screenPosition.clone().add(i.multiplyScalar(r)),s=this.adjustLabelTransform(this._label,a);this._label.style.transform="translate3D("+s.x+"px, "+s.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._line2.style.backgroundColor=this._color,this._label.style.borderColor=this._color},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._line2),this._container.removeChild(this._label),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.toggleDefaultAngle=function(){this._defaultAngle=!this._defaultAngle},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._handles[2].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"angle",get:function(){return this._opangle}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(0),r=i(4),o=i(3),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,r,a));s._widgetType="Annotation",s._initialized=!1,s._movinglabel=null,s._labelmoved=!1,s._labelhovered=!1,s._manuallabeldisplay=!1,s._material=null,s._geometry=null,s._meshline=null,s._cone=null,s._line=null,s._dashline=null,s._label=null,s._labeltext=null,s._labelOffset=new n.L,s._mouseLabelOffset=new n.L,s._handles=[];for(var l=void 0,c=Object(o.a)(),h=0;h<2;h++)l=new c(i,r,a),s.add(l),s._handles.push(l);return s._handles[1].active=!0,s.create(),s.initOffsets(),s.onResize=s.onResize.bind(s),s.onMove=s.onMove.bind(s),s.onHoverlabel=s.onHoverlabel.bind(s),s.notonHoverlabel=s.notonHoverlabel.bind(s),s.changelabeltext=s.changelabeltext.bind(s),s.addEventListeners(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){addEventListener("resize",this.onResize),this._label.addEventListener("mouseenter",this.onHoverlabel),this._label.addEventListener("mouseleave",this.notonHoverlabel),this._label.addEventListener("dblclick",this.changelabeltext),this._container.addEventListener("wheel",this.onMove)},e.prototype.removeEventListeners=function(){removeEventListener("resize",this.onResize),this._label.removeEventListener("mouseenter",this.onHoverlabel),this._label.removeEventListener("mouseleave",this.notonHoverlabel),this._label.removeEventListener("dblclick",this.changelabeltext),this._container.removeEventListener("wheel",this.onMove)},e.prototype.onResize=function(){this.initOffsets()},e.prototype.onHoverlabel=function(){this._labelhovered=!0,this._container.style.cursor="pointer"},e.prototype.notonHoverlabel=function(){this._labelhovered=!1,this._container.style.cursor="default"},e.prototype.onStart=function(t){if(this._labelhovered){var e=this.getMouseOffsets(t,this._container),i=this._handles[1].screenPosition.clone().sub(this._labelOffset);this._mouseLabelOffset=new n.L(e.screenX-i.x,e.screenY-i.y,0),this._movinglabel=!0,this._labelmoved=!0}this._handles[0].onStart(t),this._handles[1].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._labelhovered,this.update()},e.prototype.onMove=function(t){if(this._movinglabel){var e=this.getMouseOffsets(t,this._container);this._labelOffset=new n.L(this._handles[1].screenPosition.x-e.screenX+this._mouseLabelOffset.x,this._handles[1].screenPosition.y-e.screenY+this._mouseLabelOffset.y,0),this._controls.enabled=!1}this._active&&(this._dragged=!0),this._handles[0].onMove(t),this._handles[1].onMove(t),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._labelhovered,this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,!this._dragged&&this._active&&this._initialized&&(this._selected=!this._selected,this._handles[0].selected=this._selected,this._handles[1].selected=this._selected),this._initialized||(this._labelOffset=this._handles[1].screenPosition.clone().sub(this._handles[0].screenPosition).multiplyScalar(.5),this.setlabeltext(),this._initialized=!0),this._active=this._handles[0].active||this._handles[1].active,this._dragged=!1,this._movinglabel=!1,this.update()},e.prototype.setlabeltext=function(){for(;!this._labeltext;)this._labeltext=prompt("Please enter the annotation text","");this.displaylabel()},e.prototype.changelabeltext=function(){this._labeltext=prompt("Please enter a new annotation text",this._label.innerHTML),this.displaylabel()},e.prototype.displaylabel=function(){this._label.innerHTML="string"==typeof this._labeltext&&this._labeltext.length>0?this._labeltext:"",this._label.style.display="",this._dashline.style.display="",this._label.style.transform="translate3D(\n        "+(this._handles[1].screenPosition.x-this._labelOffset.x-this._label.offsetWidth/2)+"px,\n        "+(this._handles[1].screenPosition.y-this._labelOffset.y-this._label.offsetHeight/2-this._container.offsetHeight)+"px, 0)"},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._material=new n.o,this.updateMeshColor(),this._geometry=new n.e;var t=new Float32Array(6);this._geometry.setAttribute("position",new n.d(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,this._meshline=new n.n(this._geometry,this._material),this._meshline.visible=!0,this.add(this._meshline),this._conegeometry=new n.h(0,2,10),this._conegeometry.translate(0,-5,0),this._conegeometry.rotateX(-Math.PI/2),this._cone=new n.s(this._conegeometry,this._material),this._cone.visible=!0,this.add(this._cone)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._dashline=document.createElement("div"),this._dashline.className="widgets-dashline",this._dashline.style.display="none",this._container.appendChild(this._dashline),this._label=document.createElement("div"),this._label.className="widgets-label",this._label.style.display="none",this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update(),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0),this._cone&&(this._cone.position.copy(this._handles[1].worldPosition),this._cone.lookAt(this._handles[0].worldPosition))},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[0].screenPosition,this._handles[1].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n        rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px";var e=t.line.multiplyScalar(.5),i=this._handles[1].screenPosition.clone().sub(this._labelmoved?this._labelOffset:e),n=this.adjustLabelTransform(this._label,i);this._label.style.transform="translate3D("+n.x+"px, "+n.y+"px, 0)",this._manuallabeldisplay&&this.displaylabel();var r=this.getLineData(this._handles[0].screenPosition,i),o=this.getLineData(t.center,i),a=this.getLineData(this._handles[1].screenPosition,i);r.length>o.length&&(r=o),r.length>a.length&&(r=a),this._dashline.style.transform="translate3D("+r.transformX+"px, "+r.transformY+"px, 0)\n        rotate("+r.transformAngle+"rad)",this._dashline.style.width=r.length+"px"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._dashline.style.borderTop="1.5px dashed "+this._color,this._label.style.borderColor=this._color},e.prototype.hideDOM=function(){this._line.style.display="none",this._dashline.style.display="none",this._label.style.display="none",this._handles.forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._dashline.style.display="",this._label.style.display="",this._handles.forEach(function(t){return t.showDOM()})},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._dashline),this._container.removeChild(this._label),this.remove(this._meshline),this._meshline.geometry.dispose(),this._meshline.geometry=null,this._meshline.material.dispose(),this._meshline.material=null,this._meshline=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this.remove(this._cone),this._cone.geometry.dispose(),this._cone.geometry=null,this._cone.material.dispose(),this._cone.material=null,this._cone=null,this._conegeometry.dispose(),this._conegeometry=null,t.prototype.free.call(this)},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}}]),e}(r.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(0),r=i(4),o=i(3),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r));a._widgetType="BiRuler",a._calibrationFactor=r.calibrationFactor||null,a._distance=null,a._distance2=null,a._units=a._calibrationFactor||r.pixelSpacing?"mm":"units",a._material=null,a._geometry=null,a._mesh=null,a._line=null,a._label=null,a._line2=null,a._label2=null,a._dashline=null,a._handles=[];for(var s=void 0,l=Object(o.a)(),c=0;c<4;c++)s=new l(i,n,r),a.add(s),a._handles.push(s);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._handles[3].active=!0,a._handles[3].tracking=!0,a.create(),a.onMove=a.onMove.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove)},e.prototype.onStart=function(t){this._handles.forEach(function(e){return e.onStart(t)}),this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active||this._handles[3].active,this.update()},e.prototype.onMove=function(t){this._active?this._dragged=!0:(this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._handles[2].hovered||this._handles[3].hovered,this._container.style.cursor=this._hovered?"pointer":"default"),this._handles.forEach(function(e){return e.onMove(t)}),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[2].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[3].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected,this._handles[2].selected=this._selected),this._handles[1].active?this._handles[3].onEnd():this._dragged||!this._handles[3].tracking?(this._handles[3].tracking=!1,this._handles[3].onEnd()):this._handles[3].tracking=!1,this._handles[3].selected=this._selected,this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active||this._handles[3].active,this._dragged=!1,this.update())},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new BufferGeometry;var t=new Float32Array(12);this._geometry.setAttribute("position",new BufferAttribute(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,t[e++]=this._handles[2].worldPosition.x,t[e++]=this._handles[2].worldPosition.y,t[e++]=this._handles[2].worldPosition.z,t[e++]=this._handles[3].worldPosition.x,t[e++]=this._handles[3].worldPosition.y,t[e++]=this._handles[3].worldPosition.z,this._material=new n.o,this.updateMeshColor(),this._mesh=new n.p(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._label=document.createElement("div"),this._label.className="widgets-label",this._container.appendChild(this._label),this._line2=document.createElement("div"),this._line2.className="widgets-line",this._container.appendChild(this._line2),this._label2=document.createElement("div"),this._label2.className="widgets-label",this._container.appendChild(this._label2),this._dashline=document.createElement("div"),this._dashline.className="widgets-dashline",this._container.appendChild(this._dashline),this.updateDOMColor()},e.prototype.hideDOM=function(){this._line.style.display="none",this._label.style.display="none",this._line2.style.display="none",this._label2.style.display="none",this._dashline.style.display="none",this._handles.forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._label.style.display="",this._line2.style.display="",this._label2.style.display="",this._dashline.style.display="",this._handles.forEach(function(t){return t.showDOM()})},e.prototype.update=function(){this.updateColor(),this._handles.forEach(function(t){return t.update()}),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[0].screenPosition,this._handles[1].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n                rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px";var e=this.getLineData(this._handles[2].screenPosition,this._handles[3].screenPosition);this._line2.style.transform="translate3D("+e.transformX+"px, "+e.transformY+"px, 0)\n                rotate("+e.transformAngle+"rad)",this._line2.style.width=e.length+"px";var i=this._handles[0].worldPosition.clone().add(this._handles[1].worldPosition).multiplyScalar(.5),n=this._handles[2].worldPosition.clone().add(this._handles[3].worldPosition).multiplyScalar(.5),r=this.getLineData(this.worldToScreen(i),this.worldToScreen(n));this._dashline.style.transform="translate3D("+r.transformX+"px, "+r.transformY+"px, 0)\n                rotate("+r.transformAngle+"rad)",this._dashline.style.width=r.length+"px";var o=this.getDistanceData(this._handles[0].worldPosition,this._handles[1].worldPosition,this._calibrationFactor),a=this.getDistanceData(this._handles[2].worldPosition,this._handles[3].worldPosition,this._calibrationFactor),s="Calibration is required to display the distance in mm";this._distance=o.distance,this._distance2=a.distance,o.units&&a.units&&o.units===a.units?this._units=o.units:(o.units||(o.units=this._units),a.units||(a.units=this._units)),"units"!==o.units||this._label.hasAttribute("title")?"units"!==o.units&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title",s),this._label.style.color=this._colors.error),"units"!==a.units||this._label2.hasAttribute("title")?"units"!==a.units&&this._label2.hasAttribute("title")&&(this._label2.removeAttribute("title"),this._label2.style.color=this._colors.text):(this._label2.setAttribute("title",s),this._label2.style.color=this._colors.error),this._label.innerHTML=this._distance.toFixed(2)+" "+o.units,this._label2.innerHTML=this._distance2.toFixed(2)+" "+a.units;var l=Math.abs(t.transformAngle);l>Math.PI/2&&(l=Math.PI-l);var c=Math.tan(l)<this._label.offsetHeight/this._label.offsetWidth?this._label.offsetWidth/2/Math.cos(l)+15:this._label.offsetHeight/2/Math.cos(Math.PI/2-l)+15,h=t.line.normalize().multiplyScalar(c),u=t.length>2*c?this._handles[1].screenPosition.clone().sub(h):this._handles[1].screenPosition.clone().add(h),d=this.adjustLabelTransform(this._label,u);this._label.style.transform="translate3D("+d.x+"px, "+d.y+"px, 0)";var f=Math.abs(e.transformAngle);f>Math.PI/2&&(f=Math.PI-f);var p=Math.tan(f)<this._label2.offsetHeight/this._label2.offsetWidth?this._label2.offsetWidth/2/Math.cos(f)+15:this._label2.offsetHeight/2/Math.cos(Math.PI/2-f)+15,m=e.line.normalize().multiplyScalar(p),_=e.length>2*p?this._handles[3].screenPosition.clone().sub(m):this._handles[3].screenPosition.clone().add(m),g=this.adjustLabelTransform(this._label2,_);this._label2.style.transform="translate3D("+g.x+"px, "+g.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._label.style.borderColor=this._color,this._line2.style.backgroundColor=this._color,this._label2.style.borderColor=this._color,this._dashline.style.borderTop="1.5px dashed "+this._color},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._label),this._container.removeChild(this._line2),this._container.removeChild(this._label2),this._container.removeChild(this._dashline),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.getDistances=function(){return[this._distance,this._distance2]},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles.forEach(function(e){return e.worldPosition.copy(t)}),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="mm",this.update()}},{key:"shotestDistance",get:function(){return this._distance<this._distance2?this._distance:this._distance2}},{key:"longestDistance",get:function(){return this._distance>this._distance2?this._distance:this._distance2}}]),e}(r.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(4),r=i(3),o=i(0),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="CrossRuler",a._calibrationFactor=o.calibrationFactor||null,a._distances=null,a._line01=null,a._normal=null,a._distance=null,a._distance2=null,a._units=a._calibrationFactor||o.pixelSpacing?"mm":"units",a._domHovered=!1,a._moving=!1,a._material=null,a._geometry=null,a._mesh=null,a._line=null,a._line2=null,a._label=null,a._label2=null,a._handles=[];for(var s=void 0,l=Object(r.a)(),c=0;c<4;c++)s=new l(i,n,o),a.add(s),a._handles.push(s);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._moveHandle=new l(i,n,o),a.add(a._moveHandle),a._handles.push(a._moveHandle),a._moveHandle.hide(),a.onHover=a.onHover.bind(a),a.onMove=a.onMove.bind(a),a.create(),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._line.addEventListener("mouseenter",this.onHover),this._line.addEventListener("mouseleave",this.onHover),this._line2.addEventListener("mouseenter",this.onHover),this._line2.addEventListener("mouseleave",this.onHover),this._container.addEventListener("wheel",this.onMove)},e.prototype.removeEventListeners=function(){this._line.removeEventListener("mouseenter",this.onHover),this._line.removeEventListener("mouseleave",this.onHover),this._line2.removeEventListener("mouseenter",this.onHover),this._line2.removeEventListener("mouseleave",this.onHover),this._container.removeEventListener("wheel",this.onMove)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._handles[2].hovered||this._handles[3].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles.slice(0,-1).forEach(function(e){return e.onStart(t)}),this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active||this._handles[3].active||this._domHovered,this._domHovered&&this._distances&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this;if(this._active){var i=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(i))})}else this.onHover(null);this._handles.slice(0,-1).forEach(function(e){return e.onMove(t)}),this._distances&&(this._handles[0].active||this._handles[1].active?this.repositionOrtho():(this._handles[2].active||this._handles[3].active)&&this.recalculateOrtho()),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[2].onEnd(),this._handles[3].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[1].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected,this._handles[2].selected=this._selected,this._handles[3].selected=this._selected),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active||this._handles[2].active||this._handles[3].active,this._dragged=!1,this._moving=!1,this._distances||this.initOrtho(),this.update())},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new BufferGeometry;var t=new Float32Array(12);this._geometry.setAttribute("position",new BufferAttribute(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,t[e++]=this._handles[2].worldPosition.x,t[e++]=this._handles[2].worldPosition.y,t[e++]=this._handles[2].worldPosition.z,t[e++]=this._handles[3].worldPosition.x,t[e++]=this._handles[3].worldPosition.y,t[e++]=this._handles[3].worldPosition.z,this._material=new o.o,this.updateMeshColor(),this._mesh=new o.p(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._line2=document.createElement("div"),this._line2.className="widgets-line",this._container.appendChild(this._line2),this._label=document.createElement("div"),this._label.className="widgets-label",this._container.appendChild(this._label),this._label2=document.createElement("div"),this._label2.className="widgets-label",this._container.appendChild(this._label2),this.updateDOMColor()},e.prototype.hideDOM=function(){this._line.style.display="none",this._line2.style.display="none",this._label.style.display="none",this._label2.style.display="none",this._handles.slice(0,-1).forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._line2.style.display="",this._label.style.display="",this._label2.style.display="",this._handles.slice(0,-1).forEach(function(t){return t.showDOM()})},e.prototype.update=function(){this.updateColor(),this._handles.slice(0,-1).forEach(function(t){return t.update()}),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[0].screenPosition,this._handles[1].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n            rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px";var e=this.getLineData(this._handles[2].screenPosition,this._handles[3].screenPosition);this._line2.style.transform="translate3D("+e.transformX+"px, "+e.transformY+"px, 0)\n            rotate("+e.transformAngle+"rad)",this._line2.style.width=e.length+"px";var i=this.getDistanceData(this._handles[0].worldPosition,this._handles[1].worldPosition,this._calibrationFactor),n=this.getDistanceData(this._handles[2].worldPosition,this._handles[3].worldPosition,this._calibrationFactor),r="Calibration is required to display the distance in mm";this._distance=i.distance,this._distance2=n.distance,i.units&&n.units&&i.units===n.units?this._units=i.units:(i.units||(i.units=this._units),n.units||(n.units=this._units)),"units"!==i.units||this._label.hasAttribute("title")?"units"!==i.units&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title",r),this._label.style.color=this._colors.error),"units"!==n.units||this._label2.hasAttribute("title")?"units"!==n.units&&this._label2.hasAttribute("title")&&(this._label2.removeAttribute("title"),this._label2.style.color=this._colors.text):(this._label2.setAttribute("title",r),this._label2.style.color=this._colors.error),this._label.innerHTML=this._distance.toFixed(2)+" "+i.units,this._label2.innerHTML=this._distance2.toFixed(2)+" "+n.units;var o=Math.abs(t.transformAngle);o>Math.PI/2&&(o=Math.PI-o);var a=Math.tan(o)<this._label.offsetHeight/this._label.offsetWidth?this._label.offsetWidth/2/Math.cos(o)+15:this._label.offsetHeight/2/Math.cos(Math.PI/2-o)+15,s=t.line.normalize().multiplyScalar(a),l=t.length>4*a?this._handles[1].screenPosition.clone().sub(s):this._handles[1].screenPosition.clone().add(s),c=this.adjustLabelTransform(this._label,l);this._label.style.transform="translate3D("+c.x+"px, "+c.y+"px, 0)";var h=Math.abs(e.transformAngle);h>Math.PI/2&&(h=Math.PI-h);var u=Math.tan(h)<this._label2.offsetHeight/this._label2.offsetWidth?this._label2.offsetWidth/2/Math.cos(h)+15:this._label2.offsetHeight/2/Math.cos(Math.PI/2-h)+15,d=e.line.normalize().multiplyScalar(u),f=e.length>4*u?this._handles[3].screenPosition.clone().sub(d):this._handles[3].screenPosition.clone().add(d),p=this.adjustLabelTransform(this._label2,f);this._label2.style.transform="translate3D("+p.x+"px, "+p.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._line2.style.backgroundColor=this._color,this._label.style.borderColor=this._color,this._label2.style.borderColor=this._color},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._line2),this._container.removeChild(this._label),this._container.removeChild(this._label2),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.initLineAndNormal=function(){this._line01=this._handles[1].worldPosition.clone().sub(this._handles[0].worldPosition),this._normal=this._line01.clone().cross(this._camera._direction).normalize()},e.prototype.initOrtho=function(){this.initLineAndNormal();var t=this._handles[1].worldPosition.clone().add(this._handles[0].worldPosition).multiplyScalar(.5),e=this._line01.length()/2,i=this._normal.clone().multiplyScalar(.8*e),n=i.length();this._handles[2].worldPosition.copy(t.clone().add(i)),this._handles[3].worldPosition.copy(t.clone().sub(i)),this._distances=[e,e,n,n]},e.prototype.repositionOrtho=function(){this.initLineAndNormal(),this._distances[0]*=this._line01.length()/(this._distances[0]+this._distances[1]),this._distances[1]=this._line01.length()-this._distances[0];var t=this._handles[0].worldPosition.clone().add(this._line01.clone().normalize().multiplyScalar(this._distances[0]));this._handles[2].worldPosition.copy(t.clone().add(this._normal.clone().multiplyScalar(this._distances[2]))),this._handles[3].worldPosition.copy(t.clone().sub(this._normal.clone().multiplyScalar(this._distances[3])))},e.prototype.recalculateOrtho=function(){var t=this._handles[2].active?2:3,e=[],i=new o.L;e[2]=this._handles[2].worldPosition.clone().sub(this._handles[0].worldPosition),e[3]=this._handles[3].worldPosition.clone().sub(this._handles[0].worldPosition),new o.z(this._handles[0].worldPosition,this._line01.clone().normalize()).closestPointToPoint(this._handles[t].worldPosition,i);var n=i.clone().sub(this._handles[0].worldPosition).length()>this._line01.length();(n||i.equals(this._handles[0].worldPosition))&&(n&&i.copy(this._handles[1].worldPosition),this._handles[t].worldPosition.copy(i.clone().add(e[t].clone().projectOnVector(this._normal)))),e[2].cross(this._line01).angleTo(this._camera._direction)>.01&&this._handles[2].worldPosition.copy(i),e[3].cross(this._line01).angleTo(this._camera._direction)<Math.PI-.01&&this._handles[3].worldPosition.copy(i),e[0]=this._normal.clone().multiplyScalar(this._distances[5-t]),2===t&&e[0].negate(),this._handles[5-t].worldPosition.copy(i.clone().add(e[0])),this._distances[t]=i.distanceTo(this._handles[t].worldPosition),this._distances[0]=i.distanceTo(this._handles[0].worldPosition),this._distances[1]=i.distanceTo(this._handles[1].worldPosition)},e.prototype.getDimensions=function(){return[this._distance,this._distance2]},e.prototype.getCoordinates=function(){return[this._handles[0].worldPosition,this._handles[1].worldPosition,this._handles[2].worldPosition,this._handles[3].worldPosition]},e.prototype.initCoordinates=function(t,e,i,n){var r=new o.L,a=new o.L,s=new o.z(t);s.lookAt(e),s.distanceSqToSegment(i,n,r,a),r.distanceTo(a)>.01&&r.distanceTo(t)>e.distanceTo(t)+.01?console.warn("Lines do not intersect"):(this.active=!1,this.hovered=!1,this.setDefaultColor("#198"),this._worldPosition.copy(t),this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(e),this._handles[1].active=!1,this._handles[1].tracking=!1,this._handles[2].worldPosition.copy(i),this._handles[3].worldPosition.copy(n),this._distances=[r.distanceTo(t),r.distanceTo(e),r.distanceTo(i),r.distanceTo(n)],this.initLineAndNormal(),this.update())},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles.slice(0,-1).forEach(function(e){return e.worldPosition.copy(t)}),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="mm",this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="Ellipse",a._stack=o.stack,a._calibrationFactor=o.calibrationFactor||null,a._area=null,a._units=a._calibrationFactor||o.stack.frame[o.frameIndex].pixelSpacing?"cm²":"units",a._moving=!1,a._domHovered=!1,a._material=null,a._geometry=null,a._mesh=null,a._rectangle=null,a._ellipse=null,a._label=null,a._handles=[];for(var s=void 0,l=Object(r.a)(),c=0;c<2;c++)s=new l(i,n,o),a.add(s),a._handles.push(s);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._moveHandle=new l(i,n,o),a.add(a._moveHandle),a._handles.push(a._moveHandle),a._moveHandle.hide(),a.create(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._rectangle.addEventListener("mouseenter",this.onHover),this._rectangle.addEventListener("mouseleave",this.onHover),this._ellipse.addEventListener("mouseenter",this.onHover),this._ellipse.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._rectangle.removeEventListener("mouseenter",this.onHover),this._rectangle.removeEventListener("mouseleave",this.onHover),this._ellipse.removeEventListener("mouseenter",this.onHover),this._ellipse.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles[0].onStart(t),this._handles[1].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._domHovered,this._domHovered&&!this._handles[1].tracking&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this;if(this._active){var i=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(i))}),this.updateRoI(!0)}else this.onHover(null);this._handles[0].onMove(t),this._handles[1].onMove(t),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[1].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active,this._dragged=!1,this._moving=!1,this.updateRoI(),this.update())},e.prototype.hideDOM=function(){this._handles.forEach(function(t){return t.hideDOM()}),this._rectangle.style.display="none",this._ellipse.style.display="none",this._label.style.display="none"},e.prototype.showDOM=function(){this._handles[0].showDOM(),this._handles[1].showDOM(),this._rectangle.style.display="",this._ellipse.style.display="",this._label.style.display=""},e.prototype.create=function(){this.createMaterial(),this.createDOM()},e.prototype.createMaterial=function(){this._material=new a.t,this._material.transparent=!0,this._material.opacity=.2},e.prototype.createDOM=function(){this._rectangle=document.createElement("div"),this._rectangle.className="widgets-rectangle-helper",this._container.appendChild(this._rectangle),this._ellipse=document.createElement("div"),this._ellipse.className="widgets-ellipse",this._container.appendChild(this._ellipse),this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="mean-sd",t.appendChild(e);var i=document.createElement("div");i.className="max-min",t.appendChild(i);var n=document.createElement("div");n.className="area",t.appendChild(n),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update(),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._mesh&&this.remove(this._mesh);var t=this._handles[1].worldPosition.clone().sub(this._handles[0].worldPosition),e=t.clone().projectOnVector(this._camera.up).length(),i=t.clone().projectOnVector(this._camera._right).length();0!==i&&0!==e&&(this._geometry=new a.E(new a.C(new a.k(0,0,i/2,e/2,0,2*Math.PI,!1).getPoints(50))),this._mesh=new a.s(this._geometry,this._material),this._mesh.position.copy(this._handles[0].worldPosition.clone().add(t.multiplyScalar(.5))),this._mesh.rotation.copy(this._camera.rotation),this._mesh.visible=!0,this.add(this._mesh))},e.prototype.updateRoI=function(t){if(this._geometry){var e=this._label.querySelector(".mean-sd"),i=this._label.querySelector(".max-min");if(t)return e.innerHTML="",void(i.innerHTML="");var n=o.a.getRoI(this._mesh,this._camera,this._stack);null!==n?(e.innerHTML="Mean: "+n.mean.toFixed(1)+" / SD: "+n.sd.toFixed(1),i.innerHTML="Max: "+n.max.toFixed()+" / Min: "+n.min.toFixed()):(e.innerHTML="",i.innerHTML="")}},e.prototype.updateDOMColor=function(){this._rectangle.style.borderColor=this._color,this._ellipse.style.borderColor=this._color,this._label.style.borderColor=this._color},e.prototype.updateDOM=function(){if(this._geometry){this.updateDOMColor();var t=this._stack.frame[this._params.frameIndex].ultrasoundRegions||[];if(this._area=o.a.getGeometryArea(this._geometry),this._calibrationFactor)this._area*=Math.pow(this._calibrationFactor,2);else if(t&&t.length>0&&this._stack.lps2IJK){var e=this.getRegionByXY(t,o.a.worldToData(this._stack.lps2IJK,this._handles[0].worldPosition)),i=this.getRegionByXY(t,o.a.worldToData(this._stack.lps2IJK,this._handles[1].worldPosition));null!==e&&null!==i&&e===i&&"cm"===t[e].unitsX&&"cm"===t[e].unitsY?(this._area*=Math.pow(t[e].deltaX,2),this._units="cm²"):this._stack.frame[this._params.frameIndex].pixelSpacing?(this._area/=100,this._units="cm²"):this._units="units"}else"cm²"===this._units&&(this._area/=100);"units"!==this._units||this._label.hasAttribute("title")?"units"!==this._units&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title","Calibration is required to display the area in cm²"),this._label.style.color=this._colors.error),this._label.querySelector(".area").innerHTML="Area: "+this._area.toFixed(2)+" "+this._units;var n=this.getRectData(this._handles[0].screenPosition,this._handles[1].screenPosition),r=this.adjustLabelTransform(this._label,this._handles[1].screenPosition.clone().add(n.paddingVector.multiplyScalar(15+this._label.offsetHeight/2)));this._rectangle.style.transform="translate3D("+n.transformX+"px, "+n.transformY+"px, 0)",this._rectangle.style.width=n.width+"px",this._rectangle.style.height=n.height+"px",this._ellipse.style.transform="translate3D("+n.transformX+"px, "+n.transformY+"px, 0)",this._ellipse.style.width=n.width+"px",this._ellipse.style.height=n.height+"px",this._label.style.transform="translate3D("+r.x+"px,"+r.y+"px, 0)"}},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._rectangle),this._container.removeChild(this._ellipse),this._container.removeChild(this._label),this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{area:this._area,units:this._units}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="cm²",this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="Freehand",a._stack=o.stack,a._calibrationFactor=o.calibrationFactor||null,a._area=null,a._units=a._calibrationFactor||o.stack.frame[o.frameIndex].pixelSpacing?"cm²":"units",a._initialized=!1,a._moving=!1,a._domHovered=!1,a._material=null,a._geometry=null,a._mesh=null,a._lines=[],a._label=null,a._handles=[];var s=Object(r.a)(),l=new s(i,n,o);return a.add(l),a._handles.push(l),a._moveHandle=new s(i,n,o),a.add(a._moveHandle),a._moveHandle.hide(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.create(),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh();var e=!1;this._handles.forEach(function(t){return e=e||t.hovered}),this._hovered=e||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){var e=!1;this._moveHandle.onMove(t,!0),this._handles.forEach(function(i){i.onStart(t),e=e||i.active}),this._active=e||this._domHovered,this._domHovered&&this._initialized&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this,i=!1;if(this.active)if(this._dragged=!0,this._initialized){var n=this._moveHandle.worldPosition.clone();this._moveHandle.onMove(t,!0),this._mesh&&this.remove(this._mesh),this.updateDOMContent(!0),this._moving&&this._handles.forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(n))})}else{this._handles[this._handles.length-1].hovered=!1,this._handles[this._handles.length-1].active=!1,this._handles[this._handles.length-1].tracking=!1;var o=new(Object(r.a)())(this._targetMesh,this._controls,this._params);o.hovered=!0,o.active=!0,o.tracking=!0,this.add(o),this._handles.push(o),this.createLine()}this._handles.forEach(function(e){e.onMove(t),i=i||e.hovered}),this._hovered=i||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default",this.active&&this._handles.length>2&&this.pushPopHandle(),this.update()},e.prototype.onEnd=function(){var t=this;if(!(this._handles.length<3)){var e=!1;this._handles.slice(0,-1).forEach(function(t){t.onEnd(),e=e||t.active}),this._dragged||!this._handles[this._handles.length-1].tracking?(this._handles[this._handles.length-1].tracking=!1,this._handles[this._handles.length-1].onEnd()):this._handles[this._handles.length-1].tracking=!1,this._lines.length<this._handles.length&&this.createLine(),!this._dragged&&this._initialized||(this.updateMesh(),this.updateDOMContent()),!this._dragged&&this._active&&(this._selected=!this._selected,this._handles.forEach(function(e){return e.selected=t._selected})),this._active=e||this._handles[this._handles.length-1].active,this._dragged=!1,this._moving=!1,this._initialized=!0,this.update()}},e.prototype.create=function(){this.createMaterial(),this.createDOM()},e.prototype.createMaterial=function(){this._material=new a.t({side:a.j}),this._material.transparent=!0,this._material.opacity=.2},e.prototype.createDOM=function(){this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="mean-sd",t.appendChild(e);var i=document.createElement("div");i.className="max-min",t.appendChild(i);var n=document.createElement("div");n.className="area",t.appendChild(n),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.createLine=function(){var t=document.createElement("div");t.className="widgets-line",t.addEventListener("mouseenter",this.onHover),t.addEventListener("mouseleave",this.onHover),this._lines.push(t),this._container.appendChild(t)},e.prototype.hideDOM=function(){this._handles.forEach(function(t){return t.hideDOM()}),this._lines.forEach(function(t){return t.style.display="none"}),this._label.style.display="none"},e.prototype.showDOM=function(){this._handles.forEach(function(t){return t.showDOM()}),this._lines.forEach(function(t){return t.style.display=""}),this._label.style.display=""},e.prototype.update=function(){this.updateColor(),this._handles.forEach(function(t){return t.update()}),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOMColor(),this.updateDOMPosition()},e.prototype.updateMesh=function(){this._mesh&&this.remove(this._mesh);var t=[];this._handles.forEach(function(e){return t.push(e.worldPosition)});for(var e=o.a.centerOfMass(t),i=(new a.L).subVectors(t[0],e).normalize(),n=(new a.L).crossVectors((new a.L).subVectors(t[0],e),(new a.L).subVectors(t[1],e)),r=(new a.L).crossVectors(i,n).normalize(),s=[],l=0;l<t.length;l++){var c=new a.L(t[l].x,t[l].y,t[l].z);c.direction=(new a.L).subVectors(t[l],e).normalize();var h=i.dot(c.direction),u=r.dot(c.direction);c.xy={x:h,y:u},c.angle=Math.atan2(u,h)*(180/Math.PI),s.push(c)}this._shapeWarn=!1;var d=console.warn;console.warn=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return"three.ShapeUtils: Unable to triangulate polygon! in triangulate()"===e[0]&&(this._shapeWarn=!0),d.apply(console,e)}.bind(this);var f=new a.C;f.moveTo(s[0].xy.x,s[0].xy.y);for(var p=1;p<s.length;p++)f.lineTo(s[p].xy.x,s[p].xy.y);f.lineTo(s[0].xy.x,s[0].xy.y),this._geometry=new a.E(f),console.warn=d,this._geometry.vertices=s,this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this.updateMeshColor(),this._mesh=new a.s(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.isPointOnLine=function(t,e,i){var n=new a.L;return n.crossVectors(t.clone().sub(i),e.clone().sub(i)),!n.length()},e.prototype.pushPopHandle=function(){var t=this._handles[this._handles.length-3],e=this._handles[this._handles.length-2],i=this._handles[this._handles.length-1],n=this.isPointOnLine(t.worldPosition,e.worldPosition,i.worldPosition);return(n||t.screenPosition.distanceTo(i.screenPosition)<25)&&(this.remove(e),e.free(),this._handles[this._handles.length-2]=i,this._handles.pop(),this._container.removeChild(this._lines.pop())),n},e.prototype.updateDOMColor=function(){var t=this;this._handles.length>=2&&this._lines.forEach(function(e){return e.style.backgroundColor=t._color}),this._label.style.borderColor=this._color},e.prototype.updateDOMContent=function(t){var e=this,i=this._label.querySelector(".mean-sd"),n=this._label.querySelector(".max-min"),r=this._label.querySelector(".area");if(t)return i.innerHTML="",n.innerHTML="",void(r.innerHTML="");var a=this._stack.frame[this._params.frameIndex].ultrasoundRegions||[];if(this._area=o.a.getGeometryArea(this._geometry),this._calibrationFactor)this._area*=Math.pow(this._calibrationFactor,2);else if(a&&a.length>0&&this._stack.lps2IJK){var s=!0,l=void 0,c=void 0;this._handles.forEach(function(t){(null===(l=e.getRegionByXY(a,o.a.worldToData(e._stack.lps2IJK,t.worldPosition)))||"cm"!==a[l].unitsX||void 0!==c&&c!==l)&&(s=!1),c=l}),s?(this._area*=Math.pow(a[l].deltaX,2),this._units="cm²"):this._stack.frame[this._params.frameIndex].pixelSpacing?(this._area/=100,this._units="cm²"):this._units="units"}else"cm²"===this._units&&(this._area/=100);var h="units"===this._units?"Calibration is required to display the area in cm². ":"";this._shapeWarn&&(h+="Values may be incorrect due to triangulation error."),""===h||this._label.hasAttribute("title")?""===h&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title",h),this._label.style.color=this._colors.error);var u=o.a.getRoI(this._mesh,this._camera,this._stack);null!==u?(i.innerHTML="Mean: "+u.mean.toFixed(1)+" / SD: "+u.sd.toFixed(1),n.innerHTML="Max: "+u.max.toFixed()+" / Min: "+u.min.toFixed()):(i.innerHTML="",n.innerHTML=""),r.innerHTML="Area: "+this._area.toFixed(2)+" "+this._units},e.prototype.updateDOMPosition=function(){var t=this;if(!(this._handles.length<2)){var e=null;this._lines.forEach(function(i,n){var r=t.getLineData(t._handles[n].screenPosition,t._handles[n+1===t._handles.length?0:n+1].screenPosition);i.style.transform="translate3D("+r.transformX+"px, "+r.transformY+"px, 0)\n                rotate("+r.transformAngle+"rad)",i.style.width=r.length+"px",(null===e||e.y<t._handles[n].screenPosition.y)&&(e=t._handles[n].screenPosition.clone())}),this._initialized&&(e.y+=15+this._label.offsetHeight/2,e=this.adjustLabelTransform(this._label,e),this._label.style.transform="translate3D("+e.x+"px, "+e.y+"px, 0)")}},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this.remove(this._moveHandle),this._moveHandle.free(),this._moveHandle=null,this._lines.forEach(function(t){t.removeEventListener("mouseenter",e.onHover),t.removeEventListener("mouseleave",e.onHover),e._container.removeChild(t)}),this._lines=[],this._container.removeChild(this._label),this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{area:this._area,units:this._units}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this._moveHandle.targetMesh=t,this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles.forEach(function(e){return e._worldPosition.copy(t)}),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="cm²",this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(4),r=i(3),o=i(2),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,a));if(s._widgetType="PeakVelocity",s._regions=a.ultrasoundRegions||[],s._regions.length<1)throw new Error("Ultrasound regions should not be empty!");if(s._velocity=null,s._gradient=null,s._container.style.cursor="pointer",s._controls.enabled=!1,s._initialized=!1,s._active=!0,s._domHovered=!1,s._initialRegion=s.getRegionByXY(s._regions,o.a.worldToData(a.lps2IJK,a.worldPosition)),null===s._initialRegion)throw new Error("Invalid initial UltraSound region!");s._line=null,s._label=null;var l=Object(r.a)();return s._handle=new l(i,n,a),s.add(s._handle),s._moveHandle=new l(i,n,a),s.add(s._moveHandle),s._moveHandle.hide(),s.create(),s.onMove=s.onMove.bind(s),s.onHover=s.onHover.bind(s),s.addEventListeners(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._line.addEventListener("mouseenter",this.onHover),this._line.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._line.removeEventListener("mouseenter",this.onHover),this._line.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this._hovered=this._handle.hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handle.onStart(t),this._active=this._handle.active||this._domHovered,this._domHovered&&(this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){if(this._active){var e=this._moveHandle.worldPosition.clone();this._moveHandle.onMove(t,!0);var i=this._moveHandle.worldPosition.clone().sub(e);if(!this.isCorrectRegion(i))return void this._moveHandle.worldPosition.copy(e);this._handle.active||this._handle.worldPosition.add(i),this._dragged=!0}else this.onHover(null);this._handle.onMove(t),this.update()},e.prototype.onEnd=function(){this._handle.onEnd(),!this._dragged&&this._active&&this._initialized&&(this._selected=!this._selected,this._handle.selected=this._selected),this._initialized=!0,this._active=!1,this._dragged=!1,this.update()},e.prototype.isCorrectRegion=function(t){var e=this.getRegionByXY(this._regions,o.a.worldToData(this._params.lps2IJK,this._handle.worldPosition.clone().add(t)));return null!==e&&e===this._initialRegion&&"cm/sec"===this._regions[e].unitsY},e.prototype.create=function(){this.createDOM()},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-dashline",this._container.appendChild(this._line),this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="peakVelocity",t.appendChild(e);var i=document.createElement("div");i.className="gradient",t.appendChild(i),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.update=function(){this.updateColor(),this._handle.update(),this._worldPosition.copy(this._handle.worldPosition),this.updateDOM()},e.prototype.updateDOM=function(){this.updateDOMColor();var t=o.a.worldToData(this._params.lps2IJK,this._worldPosition),e=this._regions[this.getRegionByXY(this._regions,t)],i=this.getPointInRegion(e,t);this._velocity=Math.abs(i.y/100),this._gradient=4*Math.pow(this._velocity,2),this._label.querySelector(".peakVelocity").innerHTML=this._velocity.toFixed(2)+" m/s",this._label.querySelector(".gradient").innerHTML=this._gradient.toFixed(2)+" mmhg";var n=this.adjustLabelTransform(this._label,this._handle.screenPosition,!0);this._line.style.transform="translate3D("+(n.x-(t.x-e.x0)*this._camera.zoom)+"px, "+n.y+"px, 0)",this._line.style.width=(e.x1-e.x0)*this._camera.zoom+"px",this._label.style.transform="translate3D("+(n.x+10)+"px, "+(n.y+10)+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._label.style.borderColor=this._color},e.prototype.hideDOM=function(){this._line.style.display="none",this._label.style.display="none",this._handle.hideDOM()},e.prototype.showDOM=function(){this._line.style.display="",this._label.style.display="",this._handle.showDOM()},e.prototype.free=function(){this.removeEventListeners(),this.remove(this._handle),this._handle.free(),this._handle=null,this.remove(this._moveHandle),this._moveHandle.free(),this._moveHandle=null,this._container.removeChild(this._line),this._container.removeChild(this._label),t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{velocity:this._velocity,gradient:this._gradient}},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handle.targetMesh=t,this._moveHandle.targetMesh=t,this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handle.worldPosition.copy(t),this._moveHandle.worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"active",get:function(){return this._active},set:function(t){this._active=t,this._controls.enabled=!this._active,this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,a));if(s._widgetType="PressureHalfTime",s._regions=a.ultrasoundRegions||[],s._regions.length<1)throw new Error("Ultrasound regions should not be empty!");if(s._vMax=null,s._gMax=null,s._pht=null,s._mva=null,s._dt=null,s._ds=null,s._domHovered=!1,s._initialRegion=s.getRegionByXY(s._regions,o.a.worldToData(a.lps2IJK,a.worldPosition)),null===s._initialRegion)throw new Error("Invalid initial UltraSound region!");s._material=null,s._geometry=null,s._mesh=null,s._line=null,s._label=null,s._handles=[];for(var l=Object(r.a)(),c=void 0,h=0;h<2;h++)c=new l(i,n,a),s.add(c),s._handles.push(c);return s._handles[1].active=!0,s._handles[1].tracking=!0,s._moveHandle=new l(i,n,a),s.add(s._moveHandle),s._handles.push(s._moveHandle),s._moveHandle.hide(),s.create(),s.onMove=s.onMove.bind(s),s.onHover=s.onHover.bind(s),s.addEventListeners(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._line.addEventListener("mouseenter",this.onHover),this._line.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._line.removeEventListener("mouseenter",this.onHover),this._line.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles[0].onStart(t),this._handles[1].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._domHovered,this._domHovered&&(this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){if(this._active){var e=this._moveHandle.worldPosition.clone();this._moveHandle.onMove(t,!0);var i=this._moveHandle.worldPosition.clone().sub(e);if(!this.isCorrectRegion(i))return void this._moveHandle.worldPosition.copy(e);this._handles[0].active||this._handles[1].active||this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(i)}),this._dragged=!0}else this.onHover(null);this._handles[0].onMove(t),this._handles[1].onMove(t),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[1].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active,this._dragged=!1,this.update())},e.prototype.isCorrectRegion=function(t){var e=!(this._handles[0].active||this._handles[1].active),i=!0;return(this._handles[0].active||e)&&(i=i&&this.checkHandle(0,t)),(this._handles[1].active||e)&&(i=i&&this.checkHandle(1,t)),i},e.prototype.checkHandle=function(t,e){var i=this.getRegionByXY(this._regions,o.a.worldToData(this._params.lps2IJK,this._handles[t].worldPosition.clone().add(e)));return null!==i&&i===this._initialRegion&&"cm/sec"===this._regions[i].unitsY},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new BufferGeometry;var t=new Float32Array(6);this._geometry.setAttribute("position",new BufferAttribute(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,this._material=new a.o,this.updateMeshColor(),this._mesh=new a.n(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div");["vmax","gmax","pht","mva","dt","ds"].forEach(function(e){var i=document.createElement("div");i.className=e,t.appendChild(i)}),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.hideDOM=function(){this._line.style.display="none",this._label.style.display="none",this._handles.forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._label.style.display="",this._handles[0].showDOM(),this._handles[1].showDOM()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update(),this.updateValues(),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateValues=function(){var t=this.getUsPoint(this._regions,o.a.worldToData(this._params.lps2IJK,this._handles[0].worldPosition)),e=this.getUsPoint(this._regions,o.a.worldToData(this._params.lps2IJK,this._handles[1].worldPosition)),i=Math.abs(t.y/100),n=Math.abs(e.y/100),r=Math.abs(t.x),a=Math.abs(e.x),s=this._vMax===i?r:a;this._vMax=Math.max(i,n),this._gMax=4*Math.pow(this._vMax,2);var l=this._vMax/Math.sqrt(2),c=(i-l)/(n-l),h=i/n;this._pht=1===c?Number.POSITIVE_INFINITY:1e3*Math.abs(s-(r-c*a)/(1-c)),this._mva=220/this._pht,this._dt=1===h?Number.POSITIVE_INFINITY:1e3*Math.abs(s-(r-h*a)/(1-h)),this._ds=0===this._dt?Number.POSITIVE_INFINITY:this._vMax/this._dt*1e3},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[0].screenPosition,this._handles[1].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n                rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px",this._label.querySelector(".vmax").innerHTML="Vmax: "+this._vMax.toFixed(2)+" m/s",this._label.querySelector(".gmax").innerHTML="Gmax: "+this._gMax.toFixed(2)+" mmhg",this._label.querySelector(".pht").innerHTML="PHT: "+this._pht.toFixed(1)+" ms",this._label.querySelector(".mva").innerHTML="MVA: "+this._mva.toFixed(2)+" cm²",this._label.querySelector(".dt").innerHTML="DT: "+this._dt.toFixed(1)+" ms",this._label.querySelector(".ds").innerHTML="DS: "+this._ds.toFixed(2)+" m/s²";var e=Math.abs(t.transformAngle);e>Math.PI/2&&(e=Math.PI-e);var i=Math.tan(e)<this._label.offsetHeight/this._label.offsetWidth?this._label.offsetWidth/2/Math.cos(e)+15:this._label.offsetHeight/2/Math.cos(Math.PI/2-e)+15,n=t.line.normalize().multiplyScalar(i),r=t.length>2*i?this._handles[1].screenPosition.clone().sub(n):this._handles[1].screenPosition.clone().add(n),o=this.adjustLabelTransform(this._label,r);this._label.style.transform="translate3D("+o.x+"px, "+o.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._label.style.borderColor=this._color},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._label),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{vMax:this._vMax,gMax:this._gMax,pht:this._pht,mva:this._mva,dt:this._dt,ds:this._ds}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="Polygon",a._stack=o.stack,a._calibrationFactor=o.calibrationFactor||null,a._area=null,a._units=a._calibrationFactor||o.stack.frame[o.frameIndex].pixelSpacing?"cm²":"units",a._initialized=!1,a._newHandleRequired=!0,a._moving=!1,a._domHovered=!1,a._material=null,a._geometry=null,a._mesh=null,a._lines=[],a._label=null,a._handles=[];var s=Object(r.a)(),l=new s(i,n,o);return a.add(l),a._handles.push(l),a._moveHandle=new s(i,n,o),a.add(a._moveHandle),a._moveHandle.hide(),a.onDoubleClick=a.onDoubleClick.bind(a),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.create(),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("dblclick",this.onDoubleClick),this._container.addEventListener("wheel",this.onMove),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("dblclick",this.onDoubleClick),this._container.removeEventListener("wheel",this.onMove),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh();var e=!1;this._handles.forEach(function(t){return e=e||t.hovered}),this._hovered=e||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){var e=!1;this._handles.forEach(function(i){i.onStart(t),e=e||i.active}),this._initialized&&(this._moveHandle.onMove(t,!0),this._active=e||this._domHovered,this._domHovered&&this._initialized&&(this._moving=!0,this._controls.enabled=!1),this.update())},e.prototype.onMove=function(t){var e=this,i=!1;if(this.active)if(this._dragged=!0,this._newHandleRequired&&!this._initialized){this._handles[this._handles.length-1].hovered=!1,this._handles[this._handles.length-1].active=!1,this._handles[this._handles.length-1].tracking=!1;var n=new(Object(r.a)())(this._targetMesh,this._controls,this._params);n.hovered=!0,n.active=!0,n.tracking=!0,this.add(n),this._handles.push(n),this.createLine(),this._newHandleRequired=!1}else{var o=this._moveHandle.worldPosition.clone();this._moveHandle.onMove(t,!0),this._mesh&&this.remove(this._mesh),this.updateDOMContent(!0),this._moving&&this._handles.forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(o))})}this._handles.forEach(function(e){e.onMove(t),i=i||e.hovered}),this._hovered=i||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default",this.update()},e.prototype.onEnd=function(){var t=this,e=this._handles.length,i=!1;!this._initialized&&e>1&&this._handles[e-2].screenPosition.distanceTo(this._handles[e-1].screenPosition)<10||(this._handles.forEach(function(t){t.onEnd(),i=i||t.active}),this._initialized?(this._dragged&&(this.updateMesh(),this.updateDOMContent()),!this._dragged&&this._active&&(this._selected=!this._selected,this._handles.forEach(function(e){return e.selected=t._selected})),this._active=i||this._handles[e-1].active,this._dragged=!1,this._moving=!1,this.update()):this._newHandleRequired=!0)},e.prototype.onDoubleClick=function(){var t=this._handles.length;t<3||this._initialized||t>1&&this._handles[t-2].screenPosition.distanceTo(this._handles[t-1].screenPosition)<10||(this._handles[t-1].tracking=!1,this._handles.forEach(function(t){return t.onEnd()}),this._active=!1,this._dragged=!1,this._moving=!1,this._initialized=!0,this.updateMesh(),this.updateDOMContent(),this.update())},e.prototype.create=function(){this.createMaterial(),this.createDOM()},e.prototype.createMaterial=function(){this._material=new a.t({side:a.j}),this._material.transparent=!0,this._material.opacity=.2},e.prototype.createDOM=function(){this.createLine(),this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="mean-sd",t.appendChild(e);var i=document.createElement("div");i.className="max-min",t.appendChild(i);var n=document.createElement("div");n.className="area",t.appendChild(n),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.createLine=function(){var t=document.createElement("div");t.className="widgets-line",t.addEventListener("mouseenter",this.onHover),t.addEventListener("mouseleave",this.onHover),this._lines.push(t),this._container.appendChild(t)},e.prototype.hideDOM=function(){this._handles.forEach(function(t){return t.hideDOM()}),this._lines.forEach(function(t){return t.style.display="none"}),this._label.style.display="none"},e.prototype.showDOM=function(){this._handles.forEach(function(t){return t.showDOM()}),this._lines.forEach(function(t){return t.style.display=""}),this._label.style.display=""},e.prototype.update=function(){this.updateColor(),this._handles.forEach(function(t){return t.update()}),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOMColor(),this.updateDOMPosition()},e.prototype.updateMesh=function(){this._mesh&&this.remove(this._mesh);var t=[];this._handles.forEach(function(e){return t.push(e.worldPosition)});for(var e=o.a.centerOfMass(t),i=(new a.L).subVectors(t[0],e).normalize(),n=(new a.L).crossVectors((new a.L).subVectors(t[0],e),(new a.L).subVectors(t[1],e)),r=(new a.L).crossVectors(i,n).normalize(),s=[],l=0;l<t.length;l++){var c=new a.L(t[l].x,t[l].y,t[l].z);c.direction=(new a.L).subVectors(t[l],e).normalize();var h=i.dot(c.direction),u=r.dot(c.direction);c.xy={x:h,y:u},c.angle=Math.atan2(u,h)*(180/Math.PI),s.push(c)}this._shapeWarn=!1;var d=console.warn;console.warn=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return"THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"===e[0]&&(this._shapeWarn=!0),d.apply(console,e)}.bind(this);var f=new a.C;f.moveTo(s[0].xy.x,s[0].xy.y);for(var p=1;p<s.length;p++)f.lineTo(s[p].xy.x,s[p].xy.y);f.lineTo(s[0].xy.x,s[0].xy.y),this._geometry=new a.E(f),console.warn=d,this._geometry.vertices=s,this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this.updateMeshColor(),this._mesh=new a.s(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOMColor=function(){var t=this;this._lines.forEach(function(e){return e.style.backgroundColor=t._color}),this._label.style.borderColor=this._color},e.prototype.updateDOMContent=function(t){var e=this,i=this._label.querySelector(".mean-sd"),n=this._label.querySelector(".max-min"),r=this._label.querySelector(".area");if(t)return i.innerHTML="",n.innerHTML="",void(r.innerHTML="");var a=this._stack.frame[this._params.frameIndex].ultrasoundRegions||[];if(this._area=o.a.getGeometryArea(this._geometry),this._calibrationFactor)this._area*=Math.pow(this._calibrationFactor,2);else if(a&&a.length>0&&this._stack.lps2IJK){var s=!0,l=void 0,c=void 0;this._handles.forEach(function(t){(null===(l=e.getRegionByXY(a,o.a.worldToData(e._stack.lps2IJK,t.worldPosition)))||"cm"!==a[l].unitsX||void 0!==c&&c!==l)&&(s=!1),c=l}),s?(this._area*=Math.pow(a[l].deltaX,2),this._units="cm²"):this._stack.frame[this._params.frameIndex].pixelSpacing?(this._area/=100,this._units="cm²"):this._units="units"}else"cm²"===this._units&&(this._area/=100);var h="units"===this._units?"Calibration is required to display the area in cm². ":"";this._shapeWarn&&(h+="Values may be incorrect due to triangulation error."),""===h||this._label.hasAttribute("title")?""===h&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title",h),this._label.style.color=this._colors.error);var u=o.a.getRoI(this._mesh,this._camera,this._stack);null!==u?(i.innerHTML="Mean: "+u.mean.toFixed(1)+" / SD: "+u.sd.toFixed(1),n.innerHTML="Max: "+u.max.toFixed()+" / Min: "+u.min.toFixed()):(i.innerHTML="",n.innerHTML=""),r.innerHTML="Area: "+this._area.toFixed(2)+" "+this._units},e.prototype.updateDOMPosition=function(){var t=this,e=null;this._lines.forEach(function(i,n){var r=t.getLineData(t._handles[n].screenPosition,t._handles[n+1===t._handles.length?0:n+1].screenPosition);i.style.transform="translate3D("+r.transformX+"px, "+r.transformY+"px, 0)\n                    rotate("+r.transformAngle+"rad)",i.style.width=r.length+"px",(null===e||e.y<t._handles[n].screenPosition.y)&&(e=t._handles[n].screenPosition.clone())}),this._initialized&&(e.y+=15+this._label.offsetHeight/2,e=this.adjustLabelTransform(this._label,e),this._label.style.transform="translate3D("+e.x+"px, "+e.y+"px, 0)")},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this.remove(this._moveHandle),this._moveHandle.free(),this._moveHandle=null,this._lines.forEach(function(t){t.removeEventListener("mouseenter",e.onHover),t.removeEventListener("mouseleave",e.onHover),e._container.removeChild(t)}),this._lines=[],this._container.removeChild(this._label),this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{area:this._area,units:this._units}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this._moveHandle.targetMesh=t,this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles.forEach(function(e){return e.worldPosition.copy(t)}),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="cm²",this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="Rectangle",a._stack=o.stack,a._calibrationFactor=o.calibrationFactor||null,a._area=null,a._units=a._calibrationFactor||o.stack.frame[o.frameIndex].pixelSpacing?"cm²":"units",a._moving=!1,a._domHovered=!1,a._material=null,a._geometry=null,a._mesh=null,a._rectangle=null,a._label=null,a._handles=[];for(var s=Object(r.a)(),l=void 0,c=0;c<2;c++)l=new s(i,n,o),a.add(l),a._handles.push(l);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._moveHandle=new s(i,n,o),a.add(a._moveHandle),a._handles.push(a._moveHandle),a._moveHandle.hide(),a.create(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._rectangle.addEventListener("mouseenter",this.onHover),this._rectangle.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._rectangle.removeEventListener("mouseenter",this.onHover),this._rectangle.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles[0].onStart(t),this._handles[1].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._domHovered,this._domHovered&&!this._handles[1].tracking&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this;if(this._active){var i=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(i))}),this.updateRoI(!0)}else this.onHover(null);this._handles[0].onMove(t),this._handles[1].onMove(t),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[1].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active,this._dragged=!1,this._moving=!1,this.updateRoI(),this.update())},e.prototype.hideDOM=function(){this._handles.forEach(function(t){return t.hideDOM()}),this._rectangle.style.display="none",this._label.style.display="none"},e.prototype.showDOM=function(){this._handles[0].showDOM(),this._handles[1].showDOM(),this._rectangle.style.display="",this._label.style.display=""},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new a.x(1,1),this._material=new a.t({side:a.j}),this._material.transparent=!0,this._material.opacity=.2,this.updateMeshColor(),this._mesh=new a.s(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._rectangle=document.createElement("div"),this._rectangle.className="widgets-rectangle",this._container.appendChild(this._rectangle),this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="mean-sd",t.appendChild(e);var i=document.createElement("div");i.className="max-min",t.appendChild(i);var n=document.createElement("div");n.className="area",t.appendChild(n),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update(),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){if(this._geometry){var t=(new a.L).subVectors(this._handles[1].worldPosition,this._handles[0].worldPosition).projectOnVector(this._camera.up);this._geometry.vertices[0].copy(this._handles[0].worldPosition),this._geometry.vertices[1].copy((new a.L).addVectors(this._handles[0].worldPosition,t)),this._geometry.vertices[2].copy((new a.L).subVectors(this._handles[1].worldPosition,t)),this._geometry.vertices[3].copy(this._handles[1].worldPosition),this._geometry.verticesNeedUpdate=!0,this._geometry.computeBoundingSphere()}},e.prototype.updateRoI=function(t){var e=this._label.querySelector(".mean-sd"),i=this._label.querySelector(".max-min");if(t)return e.innerHTML="",void(i.innerHTML="");var n=o.a.getRoI(this._mesh,this._camera,this._stack);null!==n?(e.innerHTML="Mean: "+n.mean.toFixed(1)+" / SD: "+n.sd.toFixed(1),i.innerHTML="Max: "+n.max.toFixed()+" / Min: "+n.min.toFixed()):(e.innerHTML="",i.innerHTML="")},e.prototype.updateDOMColor=function(){this._rectangle.style.borderColor=this._color,this._label.style.borderColor=this._color},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this._stack.frame[this._params.frameIndex].ultrasoundRegions||[];if(this._area=o.a.getGeometryArea(this._geometry),this._calibrationFactor)this._area*=Math.pow(this._calibrationFactor,2);else if(t&&t.length>0&&this._stack.lps2IJK){var e=this.getRegionByXY(t,o.a.worldToData(this._stack.lps2IJK,this._handles[0].worldPosition)),i=this.getRegionByXY(t,o.a.worldToData(this._stack.lps2IJK,this._handles[1].worldPosition));null!==e&&null!==i&&e===i&&"cm"===t[e].unitsX&&"cm"===t[e].unitsY?(this._area*=Math.pow(t[e].deltaX,2),this._units="cm²"):this._stack.frame[this._params.frameIndex].pixelSpacing?(this._area/=100,this._units="cm²"):this._units="units"}else"cm²"===this._units&&(this._area/=100);"units"!==this._units||this._label.hasAttribute("title")?"units"!==this._units&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title","Calibration is required to display the area in cm²"),this._label.style.color=this._colors.error),this._label.querySelector(".area").innerHTML="Area: "+this._area.toFixed(2)+" "+this._units;var n=this.getRectData(this._handles[0].screenPosition,this._handles[1].screenPosition),r=this.adjustLabelTransform(this._label,this._handles[1].screenPosition.clone().add(n.paddingVector.multiplyScalar(15+this._label.offsetHeight/2)));this._rectangle.style.transform="translate3D("+n.transformX+"px, "+n.transformY+"px, 0)",this._rectangle.style.width=n.width+"px",this._rectangle.style.height=n.height+"px",this._label.style.transform="translate3D("+r.x+"px,"+r.y+"px, 0)"},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._rectangle),this._container.removeChild(this._label),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,this._stack=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{area:this._area,units:this._units}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="cm²",this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i(0),r=i(4),o=i(3),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(i,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,r));a._widgetType="Ruler",a._calibrationFactor=r.calibrationFactor||null,a._distance=null,a._units=a._calibrationFactor||r.pixelSpacing?"mm":"units",a._moving=!1,a._domHovered=!1,a._material=null,a._geometry=null,a._mesh=null,a._line=null,a._label=null,a._handles=[];for(var s=Object(o.a)(),l=void 0,c=0;c<2;c++)l=new s(i,n,r),a.add(l),a._handles.push(l);return a._handles[1].active=!0,a._handles[1].tracking=!0,a._moveHandle=new s(i,n,r),a.add(a._moveHandle),a._handles.push(a._moveHandle),a._moveHandle.hide(),a.create(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._line.addEventListener("mouseenter",this.onHover),this._line.addEventListener("mouseleave",this.onHover),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._line.removeEventListener("mouseenter",this.onHover),this._line.removeEventListener("mouseleave",this.onHover),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh(),this._hovered=this._handles[0].hovered||this._handles[1].hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handles[0].onStart(t),this._handles[1].onStart(t),this._active=this._handles[0].active||this._handles[1].active||this._domHovered,this._domHovered&&!this._handles[1].tracking&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){var e=this;if(this._active){var i=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handles.slice(0,-1).forEach(function(t){t.worldPosition.add(e._moveHandle.worldPosition.clone().sub(i))})}else this.onHover(null);this._handles[0].onMove(t),this._handles[1].onMove(t),this.update()},e.prototype.onEnd=function(){this._handles[0].onEnd(),this._handles[1].tracking&&this._handles[0].screenPosition.distanceTo(this._handles[1].screenPosition)<10||(this._dragged||!this._active||this._handles[1].tracking||(this._selected=!this._selected,this._handles[0].selected=this._selected),this._dragged||!this._handles[1].tracking?(this._handles[1].tracking=!1,this._handles[1].onEnd()):this._handles[1].tracking=!1,this._handles[1].selected=this._selected,this._active=this._handles[0].active||this._handles[1].active,this._dragged=!1,this._moving=!1,this.update())},e.prototype.create=function(){this.createMesh(),this.createDOM()},e.prototype.createMesh=function(){this._geometry=new BufferGeometry;var t=new Float32Array(6);this._geometry.setAttribute("position",new BufferAttribute(t,3));var e=0;t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,t[e++]=this._handles[1].worldPosition.x,t[e++]=this._handles[1].worldPosition.y,t[e++]=this._handles[1].worldPosition.z,this._material=new n.o,this.updateMeshColor(),this._mesh=new n.n(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.createDOM=function(){this._line=document.createElement("div"),this._line.className="widgets-line",this._container.appendChild(this._line),this._label=document.createElement("div"),this._label.className="widgets-label",this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.hideDOM=function(){this._line.style.display="none",this._label.style.display="none",this._handles.forEach(function(t){return t.hideDOM()})},e.prototype.showDOM=function(){this._line.style.display="",this._label.style.display="",this._handles[0].showDOM(),this._handles[1].showDOM()},e.prototype.update=function(){this.updateColor(),this._handles[0].update(),this._handles[1].update();var t=this.getDistanceData(this._handles[0].worldPosition,this._handles[1].worldPosition,this._calibrationFactor);this._distance=t.distance,t.units&&(this._units=t.units),this.updateMeshColor(),this.updateMeshPosition(),this.updateDOM()},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateMeshPosition=function(){this._geometry&&(this._geometry.verticesNeedUpdate=!0)},e.prototype.updateDOM=function(){this.updateDOMColor();var t=this.getLineData(this._handles[0].screenPosition,this._handles[1].screenPosition);this._line.style.transform="translate3D("+t.transformX+"px, "+t.transformY+"px, 0)\n      rotate("+t.transformAngle+"rad)",this._line.style.width=t.length+"px","units"!==this._units||this._label.hasAttribute("title")?"units"!==this._units&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text):(this._label.setAttribute("title","Calibration is required to display the distance in mm"),this._label.style.color=this._colors.error),this._label.innerHTML=this._distance.toFixed(2)+" "+this._units;var e=Math.abs(t.transformAngle);e>Math.PI/2&&(e=Math.PI-e);var i=Math.tan(e)<this._label.offsetHeight/this._label.offsetWidth?this._label.offsetWidth/2/Math.cos(e)+15:this._label.offsetHeight/2/Math.cos(Math.PI/2-e)+15,n=t.line.normalize().multiplyScalar(i),r=t.length>2*i?this._handles[1].screenPosition.clone().sub(n):this._handles[1].screenPosition.clone().add(n),o=this.adjustLabelTransform(this._label,r);this._label.style.transform="translate3D("+o.x+"px, "+o.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._line.style.backgroundColor=this._color,this._label.style.borderColor=this._color},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._container.removeChild(this._line),this._container.removeChild(this._label),this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null,this._geometry.dispose(),this._geometry=null,this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{distance:this._distance,units:this._units}},a(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles[0].worldPosition.copy(t),this._handles[1].worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"calibrationFactor",get:function(){return this._calibrationFactor},set:function(t){this._calibrationFactor=t,this._units="mm",this.update()}}]),e}(r.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(2),a=i(0),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,a));if(s._widgetType="VelocityTimeIntegral",s._regions=a.ultrasoundRegions||[],s._regions.length<1)throw new Error("Ultrasound regions should not be empty!");if(s._vMax=null,s._vMean=null,s._gMax=null,s._gMean=null,s._envTi=null,s._vti=null,s._extraInfo=null,s._initialized=!1,s._isHandleActive=!0,s._domHovered=!1,s._initialRegion=s.getRegionByXY(s._regions,o.a.worldToData(a.lps2IJK,a.worldPosition)),null===s._initialRegion)throw new Error("Invalid initial UltraSound region!");s._usPoints=[],s._material=null,s._geometry=null,s._mesh=null,s._lines=[],s._label=null,s._handles=[];var l=Object(r.a)(),c=new l(i,n,a);return s.add(c),s._handles.push(c),s._moveHandle=new l(i,n,a),s.add(s._moveHandle),s._moveHandle.hide(),s.onMove=s.onMove.bind(s),s.onHover=s.onHover.bind(s),s.create(),s.addEventListeners(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._container.addEventListener("wheel",this.onMove),this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover)},e.prototype.removeEventListeners=function(){this._container.removeEventListener("wheel",this.onMove),this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover)},e.prototype.onHover=function(t){t&&this.hoverDom(t),this.hoverMesh();var e=!1;this._handles.forEach(function(t){return e=e||t.hovered}),this._hovered=e||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverMesh=function(){},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.onStart=function(t){var e=!1;this._moveHandle.onMove(t,!0),this._handles.forEach(function(i){i.onStart(t),e=e||i.active}),this._active=e||this._domHovered,this._isHandleActive=e,this._domHovered&&(this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){if(this.active){var e=this._moveHandle.worldPosition.clone();this._moveHandle.onMove(t,!0);var i=this._moveHandle.worldPosition.clone().sub(e);if(!this.isCorrectRegion(i))return void this._moveHandle.worldPosition.copy(e);if(this._initialized)this.updateDOMContent(!0),(!this._isHandleActive||this._handles[this._handles.length-2].active||this._handles[this._handles.length-1].active)&&(this._handles.forEach(function(t){t.worldPosition.add(i)}),this._isHandleActive=!1,this._handles[this._handles.length-2].active=!1,this._handles[this._handles.length-1].active=!1,this._controls.enabled=!1);else{this._handles[this._handles.length-1].hovered=!1,this._handles[this._handles.length-1].active=!1,this._handles[this._handles.length-1].tracking=!1;var n=new(Object(r.a)())(this._targetMesh,this._controls,this._params);n.hovered=!0,n.active=!0,n.tracking=!0,this.add(n),this._handles.push(n),this.createLine()}this._dragged=!0}else this.onHover(null);this._handles.forEach(function(e){e.onMove(t)}),this.active&&this._handles.length>2&&this.pushPopHandle(),this.update()},e.prototype.onEnd=function(){var t=this;if(!(this._handles.length<3)){var e=!1;this._handles.slice(0,-1).forEach(function(t){t.onEnd(),e=e||t.active}),this._dragged||!this._handles[this._handles.length-1].tracking?(this._handles[this._handles.length-1].tracking=!1,this._handles[this._handles.length-1].onEnd()):this._handles[this._handles.length-1].tracking=!1,!this._dragged&&this._initialized||(this.finalize(),this.updateDOMContent()),!this._dragged&&this._active&&(this._selected=!this._selected,this._handles.forEach(function(e){return e.selected=t._selected})),this._active=e||this._handles[this._handles.length-1].active,this._isHandleActive=e,this._dragged=!1,this._initialized=!0,this.update()}},e.prototype.isCorrectRegion=function(t){var e=this,i=!0;return this._handles.forEach(function(n,r){!n.active&&e._isHandleActive||(i=i&&e.checkHandle(r,t))}),i},e.prototype.checkHandle=function(t,e){var i=this.getRegionByXY(this._regions,o.a.worldToData(this._params.lps2IJK,this._handles[t].worldPosition.clone().add(e)));return null!==i&&i===this._initialRegion&&"cm/sec"===this._regions[i].unitsY},e.prototype.create=function(){this.createMaterial(),this.createDOM()},e.prototype.createMaterial=function(){this._material=new a.o},e.prototype.createDOM=function(){this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div");["vmax","vmean","gmax","gmean","envti","vti","info"].forEach(function(e){var i=document.createElement("div");i.className=e,t.appendChild(i)}),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.createLine=function(){var t=document.createElement("div");t.className="widgets-line",t.addEventListener("mouseenter",this.onHover),t.addEventListener("mouseleave",this.onHover),this._lines.push(t),this._container.appendChild(t)},e.prototype.pushPopHandle=function(){var t=this._handles[this._handles.length-3],e=this._handles[this._handles.length-2],i=this._handles[this._handles.length-1],n=this.isPointOnLine(t.worldPosition,e.worldPosition,i.worldPosition);return(n||t.screenPosition.distanceTo(i.screenPosition)<25)&&(this.remove(e),e.free(),this._handles[this._handles.length-2]=i,this._handles.pop(),this._container.removeChild(this._lines.pop())),n},e.prototype.isPointOnLine=function(t,e,i){return!(new a.L).crossVectors(t.clone().sub(i),e.clone().sub(i)).length()},e.prototype.finalize=function(){var t=this;this._initialized&&this._handles.splice(-2).forEach(function(e){t.remove(e),e.free()});var e=o.a.worldToData(this._params.lps2IJK,this._handles[0]._worldPosition),i=o.a.worldToData(this._params.lps2IJK,this._handles[this._handles.length-1]._worldPosition),n=this._regions[this.getRegionByXY(this._regions,e)],a=n.y0+(n.axisY||0),s=Object(r.a)(),l={hideHandleMesh:this._params.hideHandleMesh||!1};for(e.y=a,i.y=a,this._usPoints=[this.getPointInRegion(n,i),this.getPointInRegion(n,e)],l.worldPosition=i.applyMatrix4(this._params.ijk2LPS),this._handles.push(new s(this._targetMesh,this._controls,l)),this.add(this._handles[this._handles.length-1]),l.worldPosition=e.applyMatrix4(this._params.ijk2LPS),this._handles.push(new s(this._targetMesh,this._controls,l)),this.add(this._handles[this._handles.length-1]);this._lines.length<this._handles.length;)this.createLine()},e.prototype.update=function(){this.updateColor(),this._handles.forEach(function(t){return t.update()}),this.updateMesh(),this.updateDOMColor(),this.updateDOMPosition()},e.prototype.updateValues=function(){var t=this,e=this._regions[this.getRegionByXY(this._regions,o.a.worldToData(this._params.lps2IJK,this._handles[0]._worldPosition))],i={xMin:Number.POSITIVE_INFINITY,xMax:Number.NEGATIVE_INFINITY,yMin:Number.POSITIVE_INFINITY,yMax:Number.NEGATIVE_INFINITY},n=void 0,r=void 0,a=void 0,s=0;this._vMax=0,this._vMean=0,this._gMean=0,this._usPoints.splice(2),this._handles.slice(0,-2).forEach(function(l){var c=t.getPointInRegion(e,o.a.worldToData(t._params.lps2IJK,l._worldPosition)),h=Math.abs(c.y/100),u=4*Math.pow(h,2);if((null===t._vMax||h>t._vMax)&&(t._vMax=h),i.xMin=Math.min(c.x,i.xMin),i.xMax=Math.max(c.x,i.xMax),i.yMin=Math.min(c.y,i.yMin),i.yMax=Math.max(c.y,i.yMax),a){var d=Math.abs(c.x-a);s+=d,t._vMean+=d*(n+h)/2,t._gMean+=d*(r+u)/2}n=h,r=u,a=c.x,t._usPoints.push(c)}),this._gMax=4*Math.pow(this._vMax,2),this._vMean/=s,this._gMean/=s,this._envTi=1e3*s,this._vti=this.getArea(this._usPoints),this._shapeWarn=i.xMax-i.xMin!==s||i.yMin<0!=i.yMax<0},e.prototype.updateMesh=function(){this._mesh&&this.remove(this._mesh),this._geometry=new a.e;var t=new Float32Array(3*this._handles.length);this._geometry.setAttribute("position",new a.d(t,3));var e=0;this._handles.forEach(function(i){t[e++]=i.worldPosition.x,t[e++]=i.worldPosition.y,t[e++]=i.worldPosition.z}),t[e++]=this._handles[0].worldPosition.x,t[e++]=this._handles[0].worldPosition.y,t[e++]=this._handles[0].worldPosition.z,this._geometry.computeVertexNormals(),this.updateMeshColor(),this._mesh=new a.n(this._geometry,this._material),this._mesh.visible=!0,this.add(this._mesh)},e.prototype.updateMeshColor=function(){this._material&&this._material.color.set(this._color)},e.prototype.updateDOMColor=function(){var t=this;this._handles.length>=2&&this._lines.forEach(function(e){return e.style.backgroundColor=t._color}),this._label.style.borderColor=this._color},e.prototype.updateDOMContent=function(t){var e=this._label.querySelector(".vmax"),i=this._label.querySelector(".vmean"),n=this._label.querySelector(".gmax"),r=this._label.querySelector(".gmean"),o=this._label.querySelector(".envti"),a=this._label.querySelector(".vti"),s=this._label.querySelector(".info");if(t)return e.innerHTML="",i.innerHTML="",n.innerHTML="",r.innerHTML="",o.innerHTML="",a.innerHTML="",void(s.innerHTML="");this.updateValues(),this._shapeWarn&&!this._label.hasAttribute("title")?(this._label.setAttribute("title","Values may be incorrect due to invalid curve."),this._label.style.color=this._colors.error):!this._shapeWarn&&this._label.hasAttribute("title")&&(this._label.removeAttribute("title"),this._label.style.color=this._colors.text),e.innerHTML="Vmax: "+this._vMax.toFixed(2)+" m/s",i.innerHTML="Vmean: "+this._vMean.toFixed(2)+" m/s",n.innerHTML="Gmax: "+this._gMax.toFixed(2)+" mmhg",r.innerHTML="Gmean: "+this._gMean.toFixed(2)+" mmhg",o.innerHTML="Env.Ti: "+this._envTi.toFixed(1)+" ms",a.innerHTML="VTI: "+this._vti.toFixed(2)+" cm",s.innerHTML=this._extraInfo},e.prototype.updateDOMPosition=function(){var t=this;if(!(this._handles.length<2)){var e=null;this._lines.forEach(function(i,n){var r=t.getLineData(t._handles[n].screenPosition,t._handles[n+1===t._handles.length?0:n+1].screenPosition);i.style.transform="translate3D("+r.transformX+"px, "+r.transformY+"px, 0)\n                    rotate("+r.transformAngle+"rad)",i.style.width=r.length+"px",(null===e||e.y<t._handles[n].screenPosition.y)&&(e=t._handles[n].screenPosition.clone())}),this._initialized&&(e.y+=15+this._label.offsetHeight/2,e=this.adjustLabelTransform(this._label,e),this._label.style.transform="translate3D("+e.x+"px, "+e.y+"px, 0)")}},e.prototype.hideDOM=function(){this._handles.forEach(function(t){return t.hideDOM()}),this._lines.forEach(function(t){return t.style.display="none"}),this._label.style.display="none"},e.prototype.showDOM=function(){this._handles.forEach(function(t){return t.showDOM()}),this._lines.forEach(function(t){return t.style.display=""}),this._label.style.display=""},e.prototype.free=function(){var e=this;this.removeEventListeners(),this._handles.forEach(function(t){e.remove(t),t.free()}),this._handles=[],this._usPoints=[],this.remove(this._moveHandle),this._moveHandle.free(),this._moveHandle=null,this._lines.forEach(function(t){t.removeEventListener("mouseenter",e.onHover),t.removeEventListener("mouseleave",e.onHover),e._container.removeChild(t)}),this._lines=[],this._container.removeChild(this._label),this._mesh&&(this.remove(this._mesh),this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.dispose(),this._mesh.material=null,this._mesh=null),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._material.vertexShader=null,this._material.fragmentShader=null,this._material.uniforms=null,this._material.dispose(),this._material=null,t.prototype.free.call(this)},e.prototype.getMeasurements=function(){return{vMax:this._vMax,vMean:this._vMean,gMax:this._gMax,gMean:this._gMean,envTi:this._envTi,vti:this._vti}},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handles.forEach(function(e){return e.targetMesh=t}),this._moveHandle.targetMesh=t,this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handles.forEach(function(e){return e._worldPosition.copy(t)}),this._worldPosition.copy(t),this.update()}},{key:"extraInfo",get:function(){return this._extraInfo},set:function(t){this._extraInfo=t,this._label.querySelector(".info").innerHTML=t}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i(4),r=i(3),o=i(42),a=i(2),s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var l=function(t){function e(i,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n,o));a._widgetType="VoxelProbe",a._stack=o.stack,a._container.style.cursor="pointer",a._controls.enabled=!1,a._initialized=!1,a._active=!0,a._moving=!0,a._domHovered=!1,a._label=null;var s=Object(r.a)();return a._handle=new s(i,n,o),a.add(a._handle),a._moveHandle=new s(i,n,o),a.add(a._moveHandle),a._moveHandle.hide(),a.create(),a.onMove=a.onMove.bind(a),a.onHover=a.onHover.bind(a),a.addEventListeners(),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.addEventListeners=function(){this._label.addEventListener("mouseenter",this.onHover),this._label.addEventListener("mouseleave",this.onHover),this._container.addEventListener("wheel",this.onMove)},e.prototype.removeEventListeners=function(){this._label.removeEventListener("mouseenter",this.onHover),this._label.removeEventListener("mouseleave",this.onHover),this._container.removeEventListener("wheel",this.onMove)},e.prototype.onStart=function(t){this._moveHandle.onMove(t,!0),this._handle.onStart(t),this._active=this._handle.active||this._domHovered,this._domHovered&&(this._moving=!0,this._controls.enabled=!1),this.update()},e.prototype.onMove=function(t){if(this._active){var e=this._moveHandle.worldPosition.clone();this._dragged=!0,this._moveHandle.onMove(t,!0),this._moving&&this._handle.worldPosition.add(this._moveHandle.worldPosition.clone().sub(e))}else this.onHover(null);this._handle.onMove(t),this.update()},e.prototype.onEnd=function(){this._handle.onEnd(),!this._dragged&&this._active&&this._initialized&&(this._selected=!this._selected,this._handle.selected=this._selected),this._initialized=!0,this._active=this._handle.active,this._dragged=!1,this._moving=!1,this.update()},e.prototype.onHover=function(t){t&&this.hoverDom(t),this._hovered=this._handle.hovered||this._domHovered,this._container.style.cursor=this._hovered?"pointer":"default"},e.prototype.hoverDom=function(t){this._domHovered="mouseenter"===t.type},e.prototype.create=function(){this.createVoxel(),this.createDOM()},e.prototype.createVoxel=function(){this._voxel=new o.a,this._voxel.id=this.id},e.prototype.createDOM=function(){this._label=document.createElement("div"),this._label.className="widgets-label";var t=document.createElement("div"),e=document.createElement("div");e.className="lpsPosition",t.appendChild(e);var i=document.createElement("div");i.className="ijkPosition",t.appendChild(i);var n=document.createElement("div");n.className="value",t.appendChild(n),this._label.appendChild(t),this._container.appendChild(this._label),this.updateDOMColor()},e.prototype.update=function(){this.updateColor(),this._handle.update(),this._worldPosition.copy(this._handle.worldPosition),this.updateVoxel(),this.updateDOM()},e.prototype.updateVoxel=function(){this._voxel.worldCoordinates=this._worldPosition,this._voxel.dataCoordinates=a.a.worldToData(this._stack.lps2IJK,this._worldPosition);var t=a.a.getPixelData(this._stack,this._voxel.dataCoordinates);this._voxel.value=null===t||this._stack.numberOfChannels>1?"NA":a.a.rescaleSlopeIntercept(t,this._stack.rescaleSlope,this._stack.rescaleIntercept).toFixed()},e.prototype.updateDOM=function(){var t=this._label.querySelector(".lpsPosition"),e=this._label.querySelector(".ijkPosition"),i=this._label.querySelector(".value");t.innerHTML="LPS: \n      "+this._voxel.worldCoordinates.x.toFixed(2)+" :\n      "+this._voxel.worldCoordinates.y.toFixed(2)+" :\n      "+this._voxel.worldCoordinates.z.toFixed(2),e.innerHTML="IJK: \n      "+this._voxel.dataCoordinates.x+" :\n      "+this._voxel.dataCoordinates.y+" :\n      "+this._voxel.dataCoordinates.z,i.innerHTML="Value: "+this._voxel.value,this.updateDOMColor();var n=this.adjustLabelTransform(this._label,this._handle.screenPosition,!0);this._label.style.transform="translate3D("+n.x+"px, "+n.y+"px, 0)"},e.prototype.updateDOMColor=function(){this._label.style.borderColor=this._color},e.prototype.free=function(){this.removeEventListeners(),this.remove(this._handle),this._handle.free(),this._handle=null,this.remove(this._moveHandle),this._moveHandle.free(),this._moveHandle=null,this._container.removeChild(this._label),this._stack=null,this._voxel=null,t.prototype.free.call(this)},e.prototype.hideDOM=function(){this._label.style.display="none",this._handle.hideDOM()},e.prototype.showDOM=function(){this._label.style.display="",this._handle.showDOM()},s(e,[{key:"targetMesh",get:function(){return this._targetMesh},set:function(t){this._targetMesh=t,this._handle.targetMesh=t,this._moveHandle.targetMesh=t,this.update()}},{key:"worldPosition",get:function(){return this._worldPosition},set:function(t){this._handle.worldPosition.copy(t),this._moveHandle.worldPosition.copy(t),this._worldPosition.copy(t),this.update()}},{key:"active",get:function(){return this._active},set:function(t){this._active=t,this._controls.enabled=!this._active,this.update()}}]),e}(n.a)},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(44);class r{constructor(t=0,e=0,i=0,n=1){this._x=t,this._y=e,this._z=i,this._w=n}static slerp(t,e,i,n){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(t,e,n)}static slerpFlat(t,e,i,n,r,o,a){let s=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3];const u=r[o+0],d=r[o+1],f=r[o+2],p=r[o+3];if(0===a)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=h);if(1===a)return t[e+0]=u,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(h!==p||s!==u||l!==d||c!==f){let t=1-a;const e=s*u+l*d+c*f+h*p,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const r=Math.sqrt(n),o=Math.atan2(r,e*i);t=Math.sin(t*o)/r,a=Math.sin(a*o)/r}const r=a*i;if(s=s*t+u*r,l=l*t+d*r,c=c*t+f*r,h=h*t+p*r,t===1-a){const t=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=t,l*=t,c*=t,h*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,i,n,r,o){const a=i[n],s=i[n+1],l=i[n+2],c=i[n+3],h=r[o],u=r[o+1],d=r[o+2],f=r[o+3];return t[e]=a*f+c*h+s*d-l*u,t[e+1]=s*f+c*u+l*h-a*d,t[e+2]=l*f+c*d+a*u-s*h,t[e+3]=c*f-a*h-s*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=t._x,n=t._y,r=t._z,o=t._order,a=Math.cos,s=Math.sin,l=a(i/2),c=a(n/2),h=a(r/2),u=s(i/2),d=s(n/2),f=s(r/2);switch(o){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],r=e[8],o=e[1],a=e[5],s=e[9],l=e[2],c=e[6],h=e[10],u=i+a+h;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(c-s)*t,this._y=(r-l)*t,this._z=(o-n)*t}else if(i>a&&i>h){const t=2*Math.sqrt(1+i-a-h);this._w=(c-s)/t,this._x=.25*t,this._y=(n+o)/t,this._z=(r+l)/t}else if(a>h){const t=2*Math.sqrt(1+a-i-h);this._w=(r-l)/t,this._x=(n+o)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+h-i-a);this._w=(o-n)/t,this._x=(r+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(n.a(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,r=t._z,o=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+o*a+n*l-r*s,this._y=n*c+o*s+r*a-i*l,this._z=r*c+o*l+i*s-n*a,this._w=o*c-i*a-n*s-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,r=this._z,o=this._w;let a=o*t._w+i*t._x+n*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;const s=1-a*a;if(s<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=o*h+this._w*u,this._x=i*h+this._x*u,this._y=n*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(n),i*Math.sin(r),i*Math.cos(r),e*Math.sin(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}r.prototype.isQuaternion=!0},function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(1);class r{constructor(t=new n.a(1/0,1/0,1/0),e=new n.a(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.length;s<l;s+=3){const l=t[s],c=t[s+1],h=t[s+2];l<e&&(e=l),c<i&&(i=c),h<n&&(n=h),l>r&&(r=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,i,n),this.max.set(r,o,a),this}setFromBufferAttribute(t){let e=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=t.count;s<l;s++){const l=t.getX(s),c=t.getY(s),h=t.getZ(s);l<e&&(e=l),c<i&&(i=c),h<n&&(n=h),l>r&&(r=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,i,n),this.max.set(r,o,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=a.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const i=t.geometry;if(void 0!==i)if(e&&void 0!=i.attributes&&void 0!==i.attributes.position){const e=i.attributes.position;for(let i=0,n=e.count;i<n;i++)a.fromBufferAttribute(e,i).applyMatrix4(t.matrixWorld),this.expandByPoint(a)}else null===i.boundingBox&&i.computeBoundingBox(),s.copy(i.boundingBox),s.applyMatrix4(t.matrixWorld),this.union(s);const n=t.children;for(let t=0,i=n.length;t<i;t++)this.expandByObject(n[t],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,a),a.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(p),m.subVectors(this.max,p),l.subVectors(t.a,p),c.subVectors(t.b,p),h.subVectors(t.c,p),u.subVectors(c,l),d.subVectors(h,c),f.subVectors(l,h);let e=[0,-u.z,u.y,0,-d.z,d.y,0,-f.z,f.y,u.z,0,-u.x,d.z,0,-d.x,f.z,0,-f.x,-u.y,u.x,0,-d.y,d.x,0,-f.y,f.x,0];return!!y(e,l,c,h,m)&&(!!y(e=[1,0,0,0,1,0,0,0,1],l,c,h,m)&&(_.crossVectors(u,d),y(e=[_.x,_.y,_.z],l,c,h,m)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return a.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(a).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(o),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}r.prototype.isBox3=!0;const o=[new n.a,new n.a,new n.a,new n.a,new n.a,new n.a,new n.a,new n.a],a=new n.a,s=new r,l=new n.a,c=new n.a,h=new n.a,u=new n.a,d=new n.a,f=new n.a,p=new n.a,m=new n.a,_=new n.a,g=new n.a;function y(t,e,i,n,r){for(let o=0,a=t.length-3;o<=a;o+=3){g.fromArray(t,o);const a=r.x*Math.abs(g.x)+r.y*Math.abs(g.y)+r.z*Math.abs(g.z),s=e.dot(g),l=i.dot(g),c=n.dot(g);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}},function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i(114),r=i(115);class o{constructor(t,e,i=0,o=1/0){this.ray=new n.a(t,e),this.near=i,this.far=o,this.camera=null,this.layers=new r.a,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,i=[]){return s(t,this,i,e),i.sort(a),i}intersectObjects(t,e=!0,i=[]){for(let n=0,r=t.length;n<r;n++)s(t[n],this,i,e);return i.sort(a),i}}function a(t,e){return t.distance-e.distance}function s(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),!0===n){const n=t.children;for(let t=0,r=n.length;t<r;t++)s(n[t],e,i,!0)}}},function(t,e,i){"use strict";i.d(e,"a",function(){return u});var n=i(1);const r=new n.a,o=new n.a,a=new n.a,s=new n.a,l=new n.a,c=new n.a,h=new n.a;class u{constructor(t=new n.a,e=new n.a(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,r)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=r.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(r.copy(this.direction).multiplyScalar(e).add(this.origin),r.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){o.copy(t).add(e).multiplyScalar(.5),a.copy(e).sub(t).normalize(),s.copy(this.origin).sub(o);const r=.5*t.distanceTo(e),l=-this.direction.dot(a),c=s.dot(this.direction),h=-s.dot(a),u=s.lengthSq(),d=Math.abs(1-l*l);let f,p,m,_;if(d>0)if(p=l*c-h,_=r*d,(f=l*h-c)>=0)if(p>=-_)if(p<=_){const t=1/d;m=(f*=t)*(f+l*(p*=t)+2*c)+p*(l*f+p+2*h)+u}else p=r,m=-(f=Math.max(0,-(l*p+c)))*f+p*(p+2*h)+u;else p=-r,m=-(f=Math.max(0,-(l*p+c)))*f+p*(p+2*h)+u;else p<=-_?m=-(f=Math.max(0,-(-l*r+c)))*f+(p=f>0?-r:Math.min(Math.max(-r,-h),r))*(p+2*h)+u:p<=_?(f=0,m=(p=Math.min(Math.max(-r,-h),r))*(p+2*h)+u):m=-(f=Math.max(0,-(l*r+c)))*f+(p=f>0?r:Math.min(Math.max(-r,-h),r))*(p+2*h)+u;else p=l>0?-r:r,m=-(f=Math.max(0,-(l*p+c)))*f+p*(p+2*h)+u;return i&&i.copy(this.direction).multiplyScalar(f).add(this.origin),n&&n.copy(a).multiplyScalar(p).add(o),m}intersectSphere(t,e){r.subVectors(t.center,this.origin);const i=r.dot(this.direction),n=r.dot(r)-i*i,o=t.radius*t.radius;if(n>o)return null;const a=Math.sqrt(o-n),s=i-a,l=i+a;return s<0&&l<0?null:s<0?this.at(l,e):this.at(s,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return null===i?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(i=(t.min.x-u.x)*l,n=(t.max.x-u.x)*l):(i=(t.max.x-u.x)*l,n=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,o=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,o=(t.min.y-u.y)*c),i>o||r>n?null:((r>i||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),h>=0?(a=(t.min.z-u.z)*h,s=(t.max.z-u.z)*h):(a=(t.max.z-u.z)*h,s=(t.min.z-u.z)*h),i>s||a>n?null:((a>i||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,r)}intersectTriangle(t,e,i,n,r){l.subVectors(e,t),c.subVectors(i,t),h.crossVectors(l,c);let o,a=this.direction.dot(h);if(a>0){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}s.subVectors(this.origin,t);const u=o*this.direction.dot(c.crossVectors(s,c));if(u<0)return null;const d=o*this.direction.dot(l.cross(s));if(d<0)return null;if(u+d>a)return null;const f=-o*s.dot(h);return f<0?null:this.at(f/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}},function(t,e,i){"use strict";i.d(e,"a",function(){return n});class n{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}},function(t,e,i){"use strict";i.d(e,"a",function(){return p});var n=i(1);const r=new n.a,o=new n.a,a=new n.a,s=new n.a,l=new n.a,c=new n.a,h=new n.a,u=new n.a,d=new n.a,f=new n.a;class p{constructor(t=new n.a,e=new n.a,i=new n.a){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),r.subVectors(t,e),n.cross(r);const o=n.lengthSq();return o>0?n.multiplyScalar(1/Math.sqrt(o)):n.set(0,0,0)}static getBarycoord(t,e,i,n,s){r.subVectors(n,e),o.subVectors(i,e),a.subVectors(t,e);const l=r.dot(r),c=r.dot(o),h=r.dot(a),u=o.dot(o),d=o.dot(a),f=l*u-c*c;if(0===f)return s.set(-2,-1,-1);const p=1/f,m=(u*h-c*d)*p,_=(l*d-c*h)*p;return s.set(1-m-_,_,m)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,s),s.x>=0&&s.y>=0&&s.x+s.y<=1}static getUV(t,e,i,n,r,o,a,l){return this.getBarycoord(t,e,i,n,s),l.set(0,0),l.addScaledVector(r,s.x),l.addScaledVector(o,s.y),l.addScaledVector(a,s.z),l}static isFrontFacing(t,e,i,n){return r.subVectors(i,e),o.subVectors(t,e),r.cross(o).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return r.subVectors(this.c,this.b),o.subVectors(this.a,this.b),.5*r.cross(o).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return p.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return p.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return p.getUV(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return p.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return p.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const i=this.a,n=this.b,r=this.c;let o,a;l.subVectors(n,i),c.subVectors(r,i),u.subVectors(t,i);const s=l.dot(u),p=c.dot(u);if(s<=0&&p<=0)return e.copy(i);d.subVectors(t,n);const m=l.dot(d),_=c.dot(d);if(m>=0&&_<=m)return e.copy(n);const g=s*_-m*p;if(g<=0&&s>=0&&m<=0)return o=s/(s-m),e.copy(i).addScaledVector(l,o);f.subVectors(t,r);const y=l.dot(f),b=c.dot(f);if(b>=0&&y<=b)return e.copy(r);const v=y*p-s*b;if(v<=0&&p>=0&&b<=0)return a=p/(p-b),e.copy(i).addScaledVector(c,a);const w=m*b-y*_;if(w<=0&&_-m>=0&&y-b>=0)return h.subVectors(r,n),a=(_-m)/(_-m+(y-b)),e.copy(n).addScaledVector(h,a);const x=1/(w+v+g);return o=v*x,a=g*x,e.copy(i).addScaledVector(l,o).addScaledVector(c,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}},function(t,e,i){"use strict";var n=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.name="texture3d",i._dataCoordinates="dataCoordinates",i._dataValue="dataValue",i._offset="offset",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.api=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._base,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._dataCoordinates,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._dataValue,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._offset;return this._base=t,this.compute(e,i,n)},e.prototype.compute=function(t,e,i){return this.computeDefinition(),this._base._functions[this._name]=this._definition,this._name+"("+t+", "+e+", "+i+");"},e.prototype.computeDefinition=function(){var t="\n      step( abs( textureIndexF - 0.0 ), 0.0 ) * texture2D(uTextureContainer[0], uv) +\n      step( abs( textureIndexF - 1.0 ), 0.0 ) * texture2D(uTextureContainer[1], uv) +\n      step( abs( textureIndexF - 2.0 ), 0.0 ) * texture2D(uTextureContainer[2], uv) +\n      step( abs( textureIndexF - 3.0 ), 0.0 ) * texture2D(uTextureContainer[3], uv) +\n      step( abs( textureIndexF - 4.0 ), 0.0 ) * texture2D(uTextureContainer[4], uv) +\n      step( abs( textureIndexF - 5.0 ), 0.0 ) * texture2D(uTextureContainer[5], uv) +\n      step( abs( textureIndexF - 6.0 ), 0.0 ) * texture2D(uTextureContainer[6], uv)";14===this._base._uniforms.uTextureContainer.length&&(t+=" +\n      step( abs( textureIndexF - 7.0 ), 0.0 ) * texture2D(uTextureContainer[7], uv) +\n      step( abs( textureIndexF - 8.0 ), 0.0 ) * texture2D(uTextureContainer[8], uv) +\n      step( abs( textureIndexF - 9.0 ), 0.0 ) * texture2D(uTextureContainer[9], uv) +\n      step( abs( textureIndexF - 10.0 ), 0.0 ) * texture2D(uTextureContainer[10], uv) +\n      step( abs( textureIndexF - 11.0 ), 0.0 ) * texture2D(uTextureContainer[11], uv) +\n      step( abs( textureIndexF - 12.0 ), 0.0 ) * texture2D(uTextureContainer[12], uv) +\n      step( abs( textureIndexF - 13.0 ), 0.0 ) * texture2D(uTextureContainer[13], uv)"),this._definition="\nvoid "+this._name+"(in ivec3 dataCoordinates, out vec4 dataValue, out int offset){\n  float textureSizeF = float(uTextureSize);\n  int voxelsPerTexture = uTextureSize*uTextureSize;\n\n  int index = dataCoordinates.x\n            + dataCoordinates.y * uDataDimensions.x\n            + dataCoordinates.z * uDataDimensions.y * uDataDimensions.x;\n  \n  // dividing an integer by an integer will give you an integer result, rounded down\n  // can not get float numbers to work :(\n  int packedIndex = index/uPackedPerPixel;\n  offset = index - uPackedPerPixel*packedIndex;\n\n  // Map data index to right sampler2D texture\n  int textureIndex = packedIndex/voxelsPerTexture;\n  int inTextureIndex = packedIndex - voxelsPerTexture*textureIndex;\n\n  // Get row and column in the texture\n  int rowIndex = inTextureIndex/uTextureSize;\n  float rowIndexF = float(rowIndex);\n  float colIndex = float(inTextureIndex - uTextureSize * rowIndex);\n\n  // Map row and column to uv\n  vec2 uv = vec2(0,0);\n  uv.x = (0.5 + colIndex) / textureSizeF;\n  uv.y = 1. - (0.5 + rowIndexF) / textureSizeF;\n\n  float textureIndexF = float(textureIndex);\n  dataValue = vec4(0.) + "+t+";\n}\n    "},e}(i(10).a);e.a=new n},function(t,e,i){"use strict";var n=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.name="unpack",i._packedData="packedData",i._offset="offset",i._unpackedData="unpackedData",i._base._uniforms={uNumberOfChannels:{value:1},uBitsAllocated:{value:16},uPixelType:{value:0}},i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.api=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._base,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._packedData,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._offset,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._unpackedData;return this._base=t,this.compute(e,i,n)},e.prototype.compute=function(t,e,i){return this.computeDefinition(),this._base._functions[this._name]=this._definition,this._name+"("+t+", "+e+", "+i+");"},e.prototype.computeDefinition=function(){var t="";if(1===this._base._uniforms.uNumberOfChannels.value)switch(this._base._uniforms.uBitsAllocated.value){case 1:case 8:t=this.upack8();break;case 16:t=this.upack16();break;case 32:t=this.upack32();break;default:t=this.upackIdentity()}else t=this.upackIdentity();this._definition="\nvoid "+this._name+"(in vec4 packedData, in int offset, out vec4 unpackedData){\n\n"+t+"\n\n}  \n    "},e.prototype.upack8=function(){return this._base._functions.uInt8=this.uInt8(),"\nfloat floatedOffset = float(offset);\nfloat floatedOffsetSquared = floatedOffset * floatedOffset;\nuInt8(\n  step( floatedOffsetSquared , 0.0 ) * packedData.r +\n  step( floatedOffsetSquared - 2. * floatedOffset + 1., 0.0 ) * packedData.g +\n  step( floatedOffsetSquared - 2. * 2. *  floatedOffset + 4., 0.0 ) * packedData.b +\n  step( floatedOffsetSquared - 2. * 3. *  floatedOffset + 9., 0.0 ) * packedData.a\n  ,\n  unpackedData.x);\n    "},e.prototype.upack16=function(){return this._base._functions.uInt16=this.uInt16(),"\nfloat floatedOffset = float(offset);\nuInt16(\n  packedData.r * (1. - floatedOffset) + packedData.b * floatedOffset,\n  packedData.g * (1. - floatedOffset) + packedData.a * floatedOffset,\n  unpackedData.x);\n    "},e.prototype.upack32=function(){return 0===this._base._uniforms.uPixelType.value?(this._base._functions.uInt32=this.uInt32(),"\nuInt32(\n  packedData.r,\n  packedData.g,\n  packedData.b,\n  packedData.a,\n  unpackedData.x);\n      "):(this._base._functions.uFloat32=this.uFloat32(),"\nuFloat32(\n  packedData.r,\n  packedData.g,\n  packedData.b,\n  packedData.a,\n  unpackedData.x);\n      ")},e.prototype.upackIdentity=function(){return"\nunpackedData = packedData;\n      "},e.prototype.uInt8=function(){return"\nvoid uInt8(in float r, out float value){\n  value = r * 255.;\n}\n    "},e.prototype.uInt16=function(){return"\nvoid uInt16(in float r, in float a, out float value){\n  value = r * 255. + a * 255. * 256.;\n}\n    "},e.prototype.uInt32=function(){return"\nvoid uInt32(in float r, in float g, in float b, in float a, out float value){\n  value = r * 255. + g * 255. * 256. + b * 255. * 256. * 256. + a * 255. * 256. * 256. * 256.;\n  // value = r * 255. + g * 65025. + b * 16581375. + a * 4228250625.;\n}\n    "},e.prototype.uFloat32=function(){return"\nvoid uFloat32(in float r, in float g, in float b, in float a, out float value){\n\n  // create arrays containing bits for rgba values\n  // value between 0 and 255\n  value = r * 255.;\n  int bytemeR[8];\n  bytemeR[0] = int(floor(value / 128.));\n  value -= float(bytemeR[0] * 128);\n  bytemeR[1] = int(floor(value / 64.));\n  value -= float(bytemeR[1] * 64);\n  bytemeR[2] = int(floor(value / 32.));\n  value -= float(bytemeR[2] * 32);\n  bytemeR[3] = int(floor(value / 16.));\n  value -= float(bytemeR[3] * 16);\n  bytemeR[4] = int(floor(value / 8.));\n  value -= float(bytemeR[4] * 8);\n  bytemeR[5] = int(floor(value / 4.));\n  value -= float(bytemeR[5] * 4);\n  bytemeR[6] = int(floor(value / 2.));\n  value -= float(bytemeR[6] * 2);\n  bytemeR[7] = int(floor(value));\n\n  value = g * 255.;\n  int bytemeG[8];\n  bytemeG[0] = int(floor(value / 128.));\n  value -= float(bytemeG[0] * 128);\n  bytemeG[1] = int(floor(value / 64.));\n  value -= float(bytemeG[1] * 64);\n  bytemeG[2] = int(floor(value / 32.));\n  value -= float(bytemeG[2] * 32);\n  bytemeG[3] = int(floor(value / 16.));\n  value -= float(bytemeG[3] * 16);\n  bytemeG[4] = int(floor(value / 8.));\n  value -= float(bytemeG[4] * 8);\n  bytemeG[5] = int(floor(value / 4.));\n  value -= float(bytemeG[5] * 4);\n  bytemeG[6] = int(floor(value / 2.));\n  value -= float(bytemeG[6] * 2);\n  bytemeG[7] = int(floor(value));\n\n  value = b * 255.;\n  int bytemeB[8];\n  bytemeB[0] = int(floor(value / 128.));\n  value -= float(bytemeB[0] * 128);\n  bytemeB[1] = int(floor(value / 64.));\n  value -= float(bytemeB[1] * 64);\n  bytemeB[2] = int(floor(value / 32.));\n  value -= float(bytemeB[2] * 32);\n  bytemeB[3] = int(floor(value / 16.));\n  value -= float(bytemeB[3] * 16);\n  bytemeB[4] = int(floor(value / 8.));\n  value -= float(bytemeB[4] * 8);\n  bytemeB[5] = int(floor(value / 4.));\n  value -= float(bytemeB[5] * 4);\n  bytemeB[6] = int(floor(value / 2.));\n  value -= float(bytemeB[6] * 2);\n  bytemeB[7] = int(floor(value));\n\n  value = a * 255.;\n  int bytemeA[8];\n  bytemeA[0] = int(floor(value / 128.));\n  value -= float(bytemeA[0] * 128);\n  bytemeA[1] = int(floor(value / 64.));\n  value -= float(bytemeA[1] * 64);\n  bytemeA[2] = int(floor(value / 32.));\n  value -= float(bytemeA[2] * 32);\n  bytemeA[3] = int(floor(value / 16.));\n  value -= float(bytemeA[3] * 16);\n  bytemeA[4] = int(floor(value / 8.));\n  value -= float(bytemeA[4] * 8);\n  bytemeA[5] = int(floor(value / 4.));\n  value -= float(bytemeA[5] * 4);\n  bytemeA[6] = int(floor(value / 2.));\n  value -= float(bytemeA[6] * 2);\n  bytemeA[7] = int(floor(value));\n\n  // compute float32 value from bit arrays\n\n  // sign\n  int issigned = 1 - 2 * bytemeR[0];\n  //   issigned = int(pow(-1., float(bytemeR[0])));\n\n  // exponent\n  int exponent = 0;\n\n  exponent += bytemeR[1] * int(pow(2., 7.));\n  exponent += bytemeR[2] * int(pow(2., 6.));\n  exponent += bytemeR[3] * int(pow(2., 5.));\n  exponent += bytemeR[4] * int(pow(2., 4.));\n  exponent += bytemeR[5] * int(pow(2., 3.));\n  exponent += bytemeR[6] * int(pow(2., 2.));\n  exponent += bytemeR[7] * int(pow(2., 1.));\n\n  exponent += bytemeG[0];\n\n\n  // fraction\n  float fraction = 0.;\n\n  fraction = float(bytemeG[1]) * pow(2., -1.);\n  fraction += float(bytemeG[2]) * pow(2., -2.);\n  fraction += float(bytemeG[3]) * pow(2., -3.);\n  fraction += float(bytemeG[4]) * pow(2., -4.);\n  fraction += float(bytemeG[5]) * pow(2., -5.);\n  fraction += float(bytemeG[6]) * pow(2., -6.);\n  fraction += float(bytemeG[7]) * pow(2., -7.);\n\n  fraction += float(bytemeB[0]) * pow(2., -8.);\n  fraction += float(bytemeB[1]) * pow(2., -9.);\n  fraction += float(bytemeB[2]) * pow(2., -10.);\n  fraction += float(bytemeB[3]) * pow(2., -11.);\n  fraction += float(bytemeB[4]) * pow(2., -12.);\n  fraction += float(bytemeB[5]) * pow(2., -13.);\n  fraction += float(bytemeB[6]) * pow(2., -14.);\n  fraction += float(bytemeB[7]) * pow(2., -15.);\n\n  fraction += float(bytemeA[0]) * pow(2., -16.);\n  fraction += float(bytemeA[1]) * pow(2., -17.);\n  fraction += float(bytemeA[2]) * pow(2., -18.);\n  fraction += float(bytemeA[3]) * pow(2., -19.);\n  fraction += float(bytemeA[4]) * pow(2., -20.);\n  fraction += float(bytemeA[5]) * pow(2., -21.);\n  fraction += float(bytemeA[6]) * pow(2., -22.);\n  fraction += float(bytemeA[7]) * pow(2., -23.);\n\n  value = float(issigned) * pow( 2., float(exponent - 127)) * (1. + fraction);\n}\n    "},e}(i(10).a);e.a=new n},function(t,e,i){"use strict";var n=i(10),r=i(8);var o=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.name="interpolationTrilinear",i._currentVoxel="currentVoxel",i._dataValue="dataValue",i._gradient="gradient",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.api=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._base,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._currentVoxel,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._dataValue,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._gradient;return this._base=t,this.compute(e,i,n)},e.prototype.compute=function(t,e,i){return this.computeDefinition(),this._base._functions[this._name]=this._definition,this._name+"("+t+", "+e+", "+i+");"},e.prototype.computeDefinition=function(){this._definition="\nvoid trilinearInterpolation(\n  in vec3 normalizedPosition,\n  out vec4 interpolatedValue,\n  in vec4 v000, in vec4 v100,\n  in vec4 v001, in vec4 v101,\n  in vec4 v010, in vec4 v110,\n  in vec4 v011, in vec4 v111) {\n  // https://en.wikipedia.org/wiki/Trilinear_interpolation\n  vec4 c00 = v000 * ( 1.0 - normalizedPosition.x ) + v100 * normalizedPosition.x;\n  vec4 c01 = v001 * ( 1.0 - normalizedPosition.x ) + v101 * normalizedPosition.x;\n  vec4 c10 = v010 * ( 1.0 - normalizedPosition.x ) + v110 * normalizedPosition.x;\n  vec4 c11 = v011 * ( 1.0 - normalizedPosition.x ) + v111 * normalizedPosition.x;\n\n  // c0 and c1\n  vec4 c0 = c00 * ( 1.0 - normalizedPosition.y) + c10 * normalizedPosition.y;\n  vec4 c1 = c01 * ( 1.0 - normalizedPosition.y) + c11 * normalizedPosition.y;\n\n  // c\n  vec4 c = c0 * ( 1.0 - normalizedPosition.z) + c1 * normalizedPosition.z;\n  interpolatedValue = c;\n}\n\nvoid "+this._name+"(in vec3 currentVoxel, out vec4 dataValue, out vec3 gradient){\n\n  vec3 lower_bound = floor(currentVoxel);\n  lower_bound = max(vec3(0.), lower_bound);\n  \n  vec3 higher_bound = lower_bound + vec3(1.);\n\n  vec3 normalizedPosition = (currentVoxel - lower_bound);\n  normalizedPosition =  max(vec3(0.), normalizedPosition);\n\n  vec4 interpolatedValue = vec4(0.);\n\n  //\n  // fetch values required for interpolation\n  //\n  vec4 v000 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c000 = vec3(lower_bound.x, lower_bound.y, lower_bound.z);\n  "+r.a.api(this._base,"c000","v000")+"\n\n  //\n  vec4 v100 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c100 = vec3(higher_bound.x, lower_bound.y, lower_bound.z);\n  "+r.a.api(this._base,"c100","v100")+"\n\n  //\n  vec4 v001 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c001 = vec3(lower_bound.x, lower_bound.y, higher_bound.z);\n  "+r.a.api(this._base,"c001","v001")+"\n\n  //\n  vec4 v101 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c101 = vec3(higher_bound.x, lower_bound.y, higher_bound.z);\n  "+r.a.api(this._base,"c101","v101")+"\n  \n  //\n  vec4 v010 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c010 = vec3(lower_bound.x, higher_bound.y, lower_bound.z);\n  "+r.a.api(this._base,"c010","v010")+"\n\n  vec4 v110 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c110 = vec3(higher_bound.x, higher_bound.y, lower_bound.z);\n  "+r.a.api(this._base,"c110","v110")+"\n\n  //\n  vec4 v011 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c011 = vec3(lower_bound.x, higher_bound.y, higher_bound.z);\n  "+r.a.api(this._base,"c011","v011")+"\n\n  vec4 v111 = vec4(0.0, 0.0, 0.0, 0.0);\n  vec3 c111 = vec3(higher_bound.x, higher_bound.y, higher_bound.z);\n  "+r.a.api(this._base,"c111","v111")+"\n\n  // compute interpolation at position\n  trilinearInterpolation(normalizedPosition, interpolatedValue ,v000, v100, v001, v101, v010,v110, v011,v111);\n  dataValue = interpolatedValue;\n\n  // That breaks shading in volume rendering\n  // if (gradient.x == 1.) { // skip gradient calculation for slice helper\n  //  return;\n  // }\n\n  // compute gradient\n  float gradientStep = 0.005;\n\n  // x axis\n  vec3 g100 = vec3(1., 0., 0.);\n  vec3 ng100 = normalizedPosition + g100 * gradientStep;\n  ng100.x = min(1., ng100.x);\n\n  vec4 vg100 = vec4(0.);\n  trilinearInterpolation(ng100, vg100 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  vec3 go100 = -g100;\n  vec3 ngo100 = normalizedPosition + go100 * gradientStep;\n  ngo100.x = max(0., ngo100.x);\n\n  vec4 vgo100 = vec4(0.);\n  trilinearInterpolation(ngo100, vgo100 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  gradient.x = (g100.x * vg100.x + go100.x * vgo100.x);\n\n  // y axis\n  vec3 g010 = vec3(0., 1., 0.);\n  vec3 ng010 = normalizedPosition + g010 * gradientStep;\n  ng010.y = min(1., ng010.y);\n\n  vec4 vg010 = vec4(0.);\n  trilinearInterpolation(ng010, vg010 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  vec3 go010 = -g010;\n  vec3 ngo010 = normalizedPosition + go010 * gradientStep;\n  ngo010.y = max(0., ngo010.y);\n\n  vec4 vgo010 = vec4(0.);\n  trilinearInterpolation(ngo010, vgo010 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  gradient.y = (g010.y * vg010.x + go010.y * vgo010.x);\n\n  // z axis\n  vec3 g001 = vec3(0., 0., 1.);\n  vec3 ng001 = normalizedPosition + g001 * gradientStep;\n  ng001.z = min(1., ng001.z);\n\n  vec4 vg001 = vec4(0.);\n  trilinearInterpolation(ng001, vg001 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  vec3 go001 = -g001;\n  vec3 ngo001 = normalizedPosition + go001 * gradientStep;\n  ngo001.z = max(0., ngo001.z);\n\n  vec4 vgo001 = vec4(0.);\n  trilinearInterpolation(ngo001, vgo001 ,v000, v100, v001, v101, v010,v110, v011,v111);\n\n  gradient.z = (g001.z * vg001.x + go001.z * vgo001.x);\n\n  // normalize gradient\n  // +0.0001  instead of if?\n  float gradientMagnitude = length(gradient);\n  if (gradientMagnitude > 0.0) {\n    gradient = -(1. / gradientMagnitude) * gradient;\n  }\n}\n    "},e}(n.a);e.a=new o},function(t,e,i){"use strict";var n=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.name="intersectBox",i._rayOrigin="rayOrigin",i._rayDirection="rayDirection",i._aabbMin="aabbMin",i._aabbMax="aabbMax",i._tNear="tNear",i._tFar="tFar",i._intersect="intersect",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.api=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._base,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._rayOrigin,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._rayDirection,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._aabbMin,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._aabbMax,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this._tNear,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._tFar,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:this._intersect;return this._base=t,this.compute(e,i,n,r,o,a,s)},e.prototype.compute=function(t,e,i,n,r,o,a){return this.computeDefinition(),this._base._functions[this._name]=this._definition,this._name+"("+t+", "+e+", "+i+", "+n+", "+r+", "+o+", "+a+");"},e.prototype.computeDefinition=function(){this._definition="\nvoid "+this._name+"(vec3 rayOrigin, vec3 rayDirection, vec3 boxMin, vec3 boxMax, out float tNear, out float tFar, out bool intersect){\n  // compute intersection of ray with all six bbox planes\n  vec3 invRay = vec3(1.) / rayDirection;\n  vec3 tBot = invRay * (boxMin - rayOrigin);\n  vec3 tTop = invRay * (boxMax - rayOrigin);\n  // re-order intersections to find smallest and largest on each axis\n  vec3 tMin = min(tTop, tBot);\n  vec3 tMax = max(tTop, tBot);\n  // find the largest tMin and the smallest tMax\n  float largest_tMin = max(max(tMin.x, tMin.y), max(tMin.x, tMin.z));\n  float smallest_tMax = min(min(tMax.x, tMax.y), min(tMax.x, tMax.z));\n  tNear = largest_tMin;\n  tFar = smallest_tMax;\n  intersect = smallest_tMax > largest_tMin;\n}\n\n    "},e}(i(10).a);e.a=new n},function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(t,e){if(8===t.bitsAllocated)return t.planarConfiguration?function(t,e){for(var i=e,n=t.rows*t.columns,r=new ArrayBuffer(n*t.samplesPerPixel),o=new DataView(i.buffer,i.byteOffset),a=new Int8Array(i.buffer,i.byteOffset),s=new Int8Array(r),l=0,c=o.getInt32(0,!0),h=0;h<c;++h){l=h*n;var u=o.getInt32(4*(h+1),!0),d=o.getInt32(4*(h+2),!0);0===d&&(d=i.length);for(var f=n*c;u<d;){var p=a[u++];if(p>=0&&p<=127)for(var m=0;m<p+1&&l<f;++m)s[l]=a[u++],l++;else if(p<=-1&&p>=-127)for(var _=a[u++],g=0;g<1-p&&l<f;++g)s[l]=_,l++}}return t.pixelData=new Uint8Array(r),t}(t,e):function(t,e){for(var i=e,n=t.rows*t.columns,r=new ArrayBuffer(n*t.samplesPerPixel),o=new DataView(i.buffer,i.byteOffset),a=new Int8Array(i.buffer,i.byteOffset),s=new Int8Array(r),l=0,c=o.getInt32(0,!0),h=0;h<c;++h){l=h;var u=o.getInt32(4*(h+1),!0),d=o.getInt32(4*(h+2),!0);0===d&&(d=i.length);for(var f=n*c;u<d;){var p=a[u++];if(p>=0&&p<=127)for(var m=0;m<p+1&&l<f;++m)s[l]=a[u++],l+=t.samplesPerPixel;else if(p<=-1&&p>=-127)for(var _=a[u++],g=0;g<1-p&&l<f;++g)s[l]=_,l+=t.samplesPerPixel}}return t.pixelData=new Uint8Array(r),t}(t,e);if(16===t.bitsAllocated)return function(t,e){for(var i=e,n=t.rows*t.columns,r=new ArrayBuffer(n*t.samplesPerPixel*2),o=new DataView(i.buffer,i.byteOffset),a=new Int8Array(i.buffer,i.byteOffset),s=new Int8Array(r),l=o.getInt32(0,!0),c=0;c<l;++c){var h=0,u=0===c?1:0,d=o.getInt32(4*(c+1),!0),f=o.getInt32(4*(c+2),!0);for(0===f&&(f=i.length);d<f;){var p=a[d++];if(p>=0&&p<=127)for(var m=0;m<p+1&&h<n;++m)s[2*h+u]=a[d++],h++;else if(p<=-1&&p>=-127)for(var _=a[d++],g=0;g<1-p&&h<n;++g)s[2*h+u]=_,h++}}return 0===t.pixelRepresentation?t.pixelData=new Uint16Array(r):t.pixelData=new Int16Array(r),t}(t,e);throw new Error("unsupported pixel format for RLE")}},function(t,e,i){"use strict";var n=i(11),r=i(1);var o=function(t){function e(i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));r._id=n,r._url=i.url,r._header={},r._buffer=null;try{(new TextDecoder).decode(i.mhdBuffer).split("\n").forEach(function(t){var e=t.split("=");2===e.length&&(r._header[e[0].trim()]=e[1].trim())}),r._header.DimSize=r._header.DimSize.split(" "),r._header.ElementSpacing=r._header.ElementSpacing.split(" "),r._header.TransformMatrix=r._header.TransformMatrix.split(" "),r._header.Offset=r._header.Offset.split(" "),r._buffer=i.rawBuffer}catch(t){console.log("ooops... :(")}return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.rightHanded=function(){var t=this._header.AnatomicalOrientation;return this._rightHanded="RAS"===t||"RPI"===t||"LPS"===t||"LAI"===t,this._rightHanded},e.prototype.seriesInstanceUID=function(){return this._url},e.prototype.numberOfFrames=function(){return parseInt(this._header.DimSize[2],10)},e.prototype.sopInstanceUID=function(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0},e.prototype.rows=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return parseInt(this._header.DimSize[1],10)},e.prototype.columns=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return parseInt(this._header.DimSize[0],10)},e.prototype.pixelType=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=0;return"MET_UFLOAT"!==this._header.ElementType&&"MET_FLOAT"!==this._header.ElementType||(t=1),t},e.prototype.bitsAllocated=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=1;return"MET_UCHAR"===this._header.ElementType||"MET_CHAR"===this._header.ElementType?t=8:"MET_USHORT"===this._header.ElementType||"MET_SHORT"===this._header.ElementType?t=16:"MET_UINT"!==this._header.ElementType&&"MET_INT"!==this._header.ElementType&&"MET_UFLOAT"!==this._header.ElementType&&"MET_FLOAT"!==this._header.ElementType||(t=32),t},e.prototype.pixelSpacing=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[parseFloat(this._header.ElementSpacing[1],10),parseFloat(this._header.ElementSpacing[0],10),parseFloat(this._header.ElementSpacing[2],10)]},e.prototype.imageOrientation=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._header.AnatomicalOrientation.match(/L/)?-1:1,e=this._header.AnatomicalOrientation.match(/P/)?-1:1,i=new r.a(parseFloat(this._header.TransformMatrix[0])*t,parseFloat(this._header.TransformMatrix[1])*e,parseFloat(this._header.TransformMatrix[2]));i.normalize();var n=new r.a(parseFloat(this._header.TransformMatrix[3])*t,parseFloat(this._header.TransformMatrix[4])*e,parseFloat(this._header.TransformMatrix[5]));return n.normalize(),[i.x,i.y,i.z,n.x,n.y,n.z]},e.prototype.imagePosition=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[parseFloat(this._header.Offset[0]),parseFloat(this._header.Offset[1]),parseFloat(this._header.Offset[2])]},e.prototype.extractPixelData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._decompressUncompressed(t)},e.prototype._decompressUncompressed=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._buffer,i=this.numberOfChannels(),n=this.rows(t)*this.columns(t)*i;this.rightHanded()||(t=this.numberOfFrames()-1-t);var r=t*n;return"MET_CHAR"===this._header.ElementType?new Int8Array(e,r,n):"MET_UCHAR"===this._header.ElementType?new Uint8Array(e,r,n):"MET_SHORT"===this._header.ElementType?(r*=2,new Int16Array(e,r,n)):"MET_USHORT"===this._header.ElementType?(r*=2,new Uint16Array(e,r,n)):"MET_INT"===this._header.ElementType?(r*=4,new Int32Array(e,r,n)):"MET_UINT"===this._header.ElementType?(r*=4,new Uint32Array(e,r,n)):"MET_FLOAT"===this._header.ElementType?(r*=4,new Float32Array(e,r,n)):void 0},e}(n.a);e.a=o},function(t,e,i){"use strict";var n=i(28),r=i(124),o=i.n(r),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var s=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return o._loaded=-1,o._totalLoaded=-1,o._parsed=-1,o._totalParsed=-1,o._data=[],o._container=i,o._progressBar=null,o._container&&r&&(o._progressBar=new r(o._container)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.free=function(){this._data=[],this._container=null,this._progressBar&&(this._progressBar.free(),this._progressBar=null)},e.prototype.fetch=function(t,e){var i=this;return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("GET",t),o.crossOrigin=!0,o.responseType="arraybuffer",o.onloadstart=function(e){i.emit("fetch-start",{file:t,time:new Date})},o.onload=function(e){if(200===o.status||0===o.status){i._loaded=e.loaded,i._totalLoaded=e.total,i._progressBar&&i._progressBar.update(i._loaded,i._totalLoaded,"load",t);var a=o.response,s={url:t,buffer:a};i.emit("fetch-success",{file:t,time:new Date,totalLoaded:e.total}),n(s)}else r(o.statusText)},o.onerror=function(){i.emit("fetch-error",{file:t,time:new Date}),r(o.statusText)},o.onabort=function(e){i.emit("fetch-abort",{file:t,time:new Date}),r(o.statusText||"Aborted")},o.ontimeout=function(){i.emit("fetch-timeout",{file:t,time:new Date}),r(o.statusText)},o.onprogress=function(e){i._loaded=e.loaded,i._totalLoaded=e.total,i.emit("fetch-progress",{file:t,total:e.total,loaded:e.loaded,time:new Date}),i._progressBar&&i._progressBar.update(i._loaded,i._totalLoaded,"load",t)},o.onloadend=function(e){i.emit("fetch-end",{file:t,time:new Date})},e instanceof Map&&e.set(t,o),o.send()})},e.prototype.parse=function(t){return new Promise(function(e,i){e(t)})},e.prototype.loadSequenceGroup=function(t,e){var i=this,n=[];return t.forEach(function(t){n.push(i.fetch(t,e))}),Promise.all(n).then(function(t){return i.parse(t)}).then(function(t){return i._data.push(t),t}).catch(function(t){"Aborted"!==t&&(console.log("oops... something went wrong..."),console.log(t))})},e.prototype.loadSequence=function(t,e){var i=this;return this.fetch(t,e).then(function(t){return i.parse(t)}).then(function(t){return i._data.push(t),t}).catch(function(t){"Aborted"!==t&&(console.log("oops... something went wrong..."),console.log(t))})},e.prototype.load=function(t,e){var i=this;Array.isArray(t)||(t=[t]),this._progressBar&&(this._progressBar.totalFiles=t.length,this._progressBar.requests=e),this.emit("load-start",{files:t,time:new Date});var n=[];return t.forEach(function(t){Array.isArray(t)?n.push(i.loadSequenceGroup(t,e)):n.push(i.loadSequence(t,e))}),Promise.all(n)},a(e,[{key:"data",set:function(t){this._data=t},get:function(){return this._data}}]),e}(o.a);e.a=s},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,a,s,l,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(o(i=this._events[t]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(r(i))for(s=Array.prototype.slice.call(arguments,1),a=(c=i.slice()).length,l=0;l<a;l++)c[l].apply(this,s);return!0},i.prototype.addListener=function(t,e){var a;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var i=!1;function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},i.prototype.removeListener=function(t,e){var i,o,a,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(i=this._events[t]).length,o=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(s=a;s-- >0;)if(i[s]===e||i[s].listener&&i[s].listener===e){o=s;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";e.a={0:{color:[0,0,0],opacity:0,label:"Unknown"},1:{color:[70,130,180],opacity:1,label:"Left-Cerebral-Exterior"},2:{color:[245,245,245],opacity:1,label:"Left-Cerebral-White-Matter"},3:{color:[205,62,78],opacity:1,label:"Left-Cerebral-Cortex"},4:{color:[120,18,134],opacity:1,label:"Left-Lateral-Ventricle"},5:{color:[196,58,250],opacity:1,label:"Left-Inf-Lat-Vent"},6:{color:[0,148,0],opacity:1,label:"Left-Cerebellum-Exterior"},7:{color:[220,248,164],opacity:1,label:"Left-Cerebellum-White-Matter"},8:{color:[230,148,34],opacity:1,label:"Left-Cerebellum-Cortex"},9:{color:[0,118,14],opacity:1,label:"Left-Thalamus"},10:{color:[0,118,14],opacity:1,label:"Left-Thalamus-Proper"},11:{color:[122,186,220],opacity:1,label:"Left-Caudate"},12:{color:[236,13,176],opacity:1,label:"Left-Putamen"},13:{color:[12,48,255],opacity:1,label:"Left-Pallidum"},14:{color:[204,182,142],opacity:1,label:"3rd-Ventricle"},15:{color:[42,204,164],opacity:1,label:"4th-Ventricle"},16:{color:[119,159,176],opacity:1,label:"Brain-Stem"},17:{color:[220,216,20],opacity:1,label:"Left-Hippocampus"},18:{color:[103,255,255],opacity:1,label:"Left-Amygdala"},19:{color:[80,196,98],opacity:1,label:"Left-Insula"},20:{color:[60,58,210],opacity:1,label:"Left-Operculum"},21:{color:[60,58,210],opacity:1,label:"Line-1"},22:{color:[60,58,210],opacity:1,label:"Line-2"},23:{color:[60,58,210],opacity:1,label:"Line-3"},24:{color:[60,60,60],opacity:1,label:"CSF"},25:{color:[255,165,0],opacity:1,label:"Left-Lesion"},26:{color:[255,165,0],opacity:1,label:"Left-Accumbens-area"},27:{color:[0,255,127],opacity:1,label:"Left-Substancia-Nigra"},28:{color:[165,42,42],opacity:1,label:"Left-VentralDC"},29:{color:[135,206,235],opacity:1,label:"Left-undetermined"},30:{color:[160,32,240],opacity:1,label:"Left-vessel"},31:{color:[0,200,200],opacity:1,label:"Left-choroid-plexus"},32:{color:[100,50,100],opacity:1,label:"Left-F3orb"},33:{color:[135,50,74],opacity:1,label:"Left-lOg"},34:{color:[122,135,50],opacity:1,label:"Left-aOg"},35:{color:[51,50,135],opacity:1,label:"Left-mOg"},36:{color:[74,155,60],opacity:1,label:"Left-pOg"},37:{color:[120,62,43],opacity:1,label:"Left-Stellate"},38:{color:[74,155,60],opacity:1,label:"Left-Porg"},39:{color:[122,135,50],opacity:1,label:"Left-Aorg"},40:{color:[70,130,180],opacity:1,label:"Right-Cerebral-Exterior"},41:{color:[245,245,245],opacity:1,label:"Right-Cerebral-White-Matter"},42:{color:[205,62,78],opacity:1,label:"Right-Cerebral-Cortex"},43:{color:[120,18,134],opacity:1,label:"Right-Lateral-Ventricle"},44:{color:[196,58,250],opacity:1,label:"Right-Inf-Lat-Vent"},45:{color:[0,148,0],opacity:1,label:"Right-Cerebellum-Exterior"},46:{color:[220,248,164],opacity:1,label:"Right-Cerebellum-White-Matter"},47:{color:[230,148,34],opacity:1,label:"Right-Cerebellum-Cortex"},48:{color:[0,118,14],opacity:1,label:"Right-Thalamus"},49:{color:[0,118,14],opacity:1,label:"Right-Thalamus-Proper"},50:{color:[122,186,220],opacity:1,label:"Right-Caudate"},51:{color:[236,13,176],opacity:1,label:"Right-Putamen"},52:{color:[13,48,255],opacity:1,label:"Right-Pallidum"},53:{color:[220,216,20],opacity:1,label:"Right-Hippocampus"},54:{color:[103,255,255],opacity:1,label:"Right-Amygdala"},55:{color:[80,196,98],opacity:1,label:"Right-Insula"},56:{color:[60,58,210],opacity:1,label:"Right-Operculum"},57:{color:[255,165,0],opacity:1,label:"Right-Lesion"},58:{color:[255,165,0],opacity:1,label:"Right-Accumbens-area"},59:{color:[0,255,127],opacity:1,label:"Right-Substancia-Nigra"},60:{color:[165,42,42],opacity:1,label:"Right-VentralDC"},61:{color:[135,206,235],opacity:1,label:"Right-undetermined"},62:{color:[160,32,240],opacity:1,label:"Right-vessel"},63:{color:[0,200,221],opacity:1,label:"Right-choroid-plexus"},64:{color:[100,50,100],opacity:1,label:"Right-F3orb"},65:{color:[135,50,74],opacity:1,label:"Right-lOg"},66:{color:[122,135,50],opacity:1,label:"Right-aOg"},67:{color:[51,50,135],opacity:1,label:"Right-mOg"},68:{color:[74,155,60],opacity:1,label:"Right-pOg"},69:{color:[120,62,43],opacity:1,label:"Right-Stellate"},70:{color:[74,155,60],opacity:1,label:"Right-Porg"},71:{color:[122,135,50],opacity:1,label:"Right-Aorg"},72:{color:[120,190,150],opacity:1,label:"5th-Ventricle"},73:{color:[122,135,50],opacity:1,label:"Left-Interior"},74:{color:[122,135,50],opacity:1,label:"Right-Interior"},77:{color:[200,70,255],opacity:1,label:"WM-hypointensities"},78:{color:[255,148,10],opacity:1,label:"Left-WM-hypointensities"},79:{color:[255,148,10],opacity:1,label:"Right-WM-hypointensities"},80:{color:[164,108,226],opacity:1,label:"non-WM-hypointensities"},81:{color:[164,108,226],opacity:1,label:"Left-non-WM-hypointensities"},82:{color:[164,108,226],opacity:1,label:"Right-non-WM-hypointensities"},83:{color:[255,218,185],opacity:1,label:"Left-F1"},84:{color:[255,218,185],opacity:1,label:"Right-F1"},85:{color:[234,169,30],opacity:1,label:"Optic-Chiasm"},192:{color:[250,255,50],opacity:1,label:"Corpus_Callosum"},86:{color:[200,120,255],opacity:1,label:"Left_future_WMSA"},87:{color:[200,121,255],opacity:1,label:"Right_future_WMSA"},88:{color:[200,122,255],opacity:1,label:"future_WMSA"},96:{color:[205,10,125],opacity:1,label:"Left-Amygdala-Anterior"},97:{color:[205,10,125],opacity:1,label:"Right-Amygdala-Anterior"},98:{color:[160,32,240],opacity:1,label:"Dura"},100:{color:[124,140,178],opacity:1,label:"Left-wm-intensity-abnormality"},101:{color:[125,140,178],opacity:1,label:"Left-caudate-intensity-abnormality"},102:{color:[126,140,178],opacity:1,label:"Left-putamen-intensity-abnormality"},103:{color:[127,140,178],opacity:1,label:"Left-accumbens-intensity-abnormality"},104:{color:[124,141,178],opacity:1,label:"Left-pallidum-intensity-abnormality"},105:{color:[124,142,178],opacity:1,label:"Left-amygdala-intensity-abnormality"},106:{color:[124,143,178],opacity:1,label:"Left-hippocampus-intensity-abnormality"},107:{color:[124,144,178],opacity:1,label:"Left-thalamus-intensity-abnormality"},108:{color:[124,140,179],opacity:1,label:"Left-VDC-intensity-abnormality"},109:{color:[124,140,178],opacity:1,label:"Right-wm-intensity-abnormality"},110:{color:[125,140,178],opacity:1,label:"Right-caudate-intensity-abnormality"},111:{color:[126,140,178],opacity:1,label:"Right-putamen-intensity-abnormality"},112:{color:[127,140,178],opacity:1,label:"Right-accumbens-intensity-abnormality"},113:{color:[124,141,178],opacity:1,label:"Right-pallidum-intensity-abnormality"},114:{color:[124,142,178],opacity:1,label:"Right-amygdala-intensity-abnormality"},115:{color:[124,143,178],opacity:1,label:"Right-hippocampus-intensity-abnormality"},116:{color:[124,144,178],opacity:1,label:"Right-thalamus-intensity-abnormality"},117:{color:[124,140,179],opacity:1,label:"Right-VDC-intensity-abnormality"},118:{color:[255,20,147],opacity:1,label:"Epidermis"},119:{color:[205,179,139],opacity:1,label:"Conn-Tissue"},120:{color:[238,238,209],opacity:1,label:"SC-Fat-Muscle"},121:{color:[200,200,200],opacity:1,label:"Cranium"},122:{color:[74,255,74],opacity:1,label:"CSF-SA"},123:{color:[238,0,0],opacity:1,label:"Muscle"},124:{color:[0,0,139],opacity:1,label:"Ear"},125:{color:[173,255,47],opacity:1,label:"Adipose"},126:{color:[133,203,229],opacity:1,label:"Spinal-Cord"},127:{color:[26,237,57],opacity:1,label:"Soft-Tissue"},128:{color:[34,139,34],opacity:1,label:"Nerve"},129:{color:[30,144,255],opacity:1,label:"Bone"},130:{color:[147,19,173],opacity:1,label:"Air"},131:{color:[238,59,59],opacity:1,label:"Orbital-Fat"},132:{color:[221,39,200],opacity:1,label:"Tongue"},133:{color:[238,174,238],opacity:1,label:"Nasal-Structures"},134:{color:[255,0,0],opacity:1,label:"Globe"},135:{color:[72,61,139],opacity:1,label:"Teeth"},136:{color:[21,39,132],opacity:1,label:"Left-Caudate-Putamen"},137:{color:[21,39,132],opacity:1,label:"Right-Caudate-Putamen"},138:{color:[65,135,20],opacity:1,label:"Left-Claustrum"},139:{color:[65,135,20],opacity:1,label:"Right-Claustrum"},140:{color:[134,4,160],opacity:1,label:"Cornea"},142:{color:[221,226,68],opacity:1,label:"Diploe"},143:{color:[255,255,254],opacity:1,label:"Vitreous-Humor"},144:{color:[52,209,226],opacity:1,label:"Lens"},145:{color:[239,160,223],opacity:1,label:"Aqueous-Humor"},146:{color:[70,130,180],opacity:1,label:"Outer-Table"},147:{color:[70,130,181],opacity:1,label:"Inner-Table"},148:{color:[139,121,94],opacity:1,label:"Periosteum"},149:{color:[224,224,224],opacity:1,label:"Endosteum"},150:{color:[255,0,0],opacity:1,label:"R-C-S"},151:{color:[205,205,0],opacity:1,label:"Iris"},152:{color:[238,238,209],opacity:1,label:"SC-Adipose-Muscle"},153:{color:[139,121,94],opacity:1,label:"SC-Tissue"},154:{color:[238,59,59],opacity:1,label:"Orbital-Adipose"},155:{color:[238,59,59],opacity:1,label:"Left-IntCapsule-Ant"},156:{color:[238,59,59],opacity:1,label:"Right-IntCapsule-Ant"},157:{color:[62,10,205],opacity:1,label:"Left-IntCapsule-Pos"},158:{color:[62,10,205],opacity:1,label:"Right-IntCapsule-Pos"},159:{color:[0,118,14],opacity:1,label:"Left-Cerebral-WM-unmyelinated"},160:{color:[0,118,14],opacity:1,label:"Right-Cerebral-WM-unmyelinated"},161:{color:[220,216,21],opacity:1,label:"Left-Cerebral-WM-myelinated"},162:{color:[220,216,21],opacity:1,label:"Right-Cerebral-WM-myelinated"},163:{color:[122,186,220],opacity:1,label:"Left-Subcortical-Gray-Matter"},164:{color:[122,186,220],opacity:1,label:"Right-Subcortical-Gray-Matter"},165:{color:[120,120,120],opacity:1,label:"Skull"},166:{color:[14,48,255],opacity:1,label:"Posterior-fossa"},167:{color:[166,42,42],opacity:1,label:"Scalp"},168:{color:[121,18,134],opacity:1,label:"Hematoma"},169:{color:[236,13,127],opacity:1,label:"Left-Basal-Ganglia"},176:{color:[236,13,126],opacity:1,label:"Right-Basal-Ganglia"},170:{color:[119,159,176],opacity:1,label:"brainstem"},171:{color:[119,0,176],opacity:1,label:"DCG"},172:{color:[119,100,176],opacity:1,label:"Vermis"},173:{color:[242,104,76],opacity:1,label:"Midbrain"},174:{color:[206,195,58],opacity:1,label:"Pons"},175:{color:[119,159,176],opacity:1,label:"Medulla"},177:{color:[119,50,176],opacity:1,label:"Vermis-White-Matter"},178:{color:[142,182,0],opacity:1,label:"SCP"},179:{color:[19,100,176],opacity:1,label:"Floculus"},180:{color:[73,61,139],opacity:1,label:"Left-Cortical-Dysplasia"},181:{color:[73,62,139],opacity:1,label:"Right-Cortical-Dysplasia"},182:{color:[10,100,176],opacity:1,label:"CblumNodulus"},193:{color:[0,196,255],opacity:1,label:"Left-hippocampal_fissure"},194:{color:[255,164,164],opacity:1,label:"Left-CADG-head"},195:{color:[196,196,0],opacity:1,label:"Left-subiculum"},196:{color:[0,100,255],opacity:1,label:"Left-fimbria"},197:{color:[128,196,164],opacity:1,label:"Right-hippocampal_fissure"},198:{color:[0,126,75],opacity:1,label:"Right-CADG-head"},199:{color:[128,96,64],opacity:1,label:"Right-subiculum"},200:{color:[0,50,128],opacity:1,label:"Right-fimbria"},201:{color:[255,204,153],opacity:1,label:"alveus"},202:{color:[255,128,128],opacity:1,label:"perforant_pathway"},203:{color:[255,255,0],opacity:1,label:"parasubiculum"},204:{color:[64,0,64],opacity:1,label:"presubiculum"},205:{color:[0,0,255],opacity:1,label:"subiculum"},206:{color:[255,0,0],opacity:1,label:"CA1"},207:{color:[128,128,255],opacity:1,label:"CA2"},208:{color:[0,128,0],opacity:1,label:"CA3"},209:{color:[196,160,128],opacity:1,label:"CA4"},210:{color:[32,200,255],opacity:1,label:"GC-DG"},211:{color:[128,255,128],opacity:1,label:"HATA"},212:{color:[204,153,204],opacity:1,label:"fimbria"},213:{color:[121,17,136],opacity:1,label:"lateral_ventricle"},214:{color:[128,0,0],opacity:1,label:"molecular_layer_HP"},215:{color:[128,32,255],opacity:1,label:"hippocampal_fissure"},216:{color:[255,204,102],opacity:1,label:"entorhinal_cortex"},217:{color:[128,128,128],opacity:1,label:"molecular_layer_subiculum"},218:{color:[104,255,255],opacity:1,label:"Amygdala"},219:{color:[0,226,0],opacity:1,label:"Cerebral_White_Matter"},220:{color:[205,63,78],opacity:1,label:"Cerebral_Cortex"},221:{color:[197,58,250],opacity:1,label:"Inf_Lat_Vent"},222:{color:[33,150,250],opacity:1,label:"Perirhinal"},223:{color:[226,0,0],opacity:1,label:"Cerebral_White_Matter_Edge"},224:{color:[100,100,100],opacity:1,label:"Background"},225:{color:[197,150,250],opacity:1,label:"Ectorhinal"},226:{color:[170,170,255],opacity:1,label:"HP_tail"},250:{color:[255,0,0],opacity:1,label:"Fornix"},251:{color:[0,0,64],opacity:1,label:"CC_Posterior"},252:{color:[0,0,112],opacity:1,label:"CC_Mid_Posterior"},253:{color:[0,0,160],opacity:1,label:"CC_Central"},254:{color:[0,0,208],opacity:1,label:"CC_Mid_Anterior"},255:{color:[0,0,255],opacity:1,label:"CC_Anterior"},256:{color:[0,0,0],opacity:1,label:"Voxel-Unchanged"},257:{color:[60,60,60],opacity:1,label:"CSF-ExtraCerebral"},258:{color:[150,150,200],opacity:1,label:"Head-ExtraCerebral"},259:{color:[120,120,120],opacity:1,label:"SkullApprox"},260:{color:[119,159,176],opacity:1,label:"BoneOrAir"},261:{color:[120,18,134],opacity:1,label:"PossibleFluid"},262:{color:[119,159,176],opacity:1,label:"Sinus"},263:{color:[119,159,176],opacity:1,label:"Left-Eustachian"},264:{color:[119,159,176],opacity:1,label:"Right-Eustachian"},331:{color:[255,0,0],opacity:1,label:"Aorta"},332:{color:[255,80,0],opacity:1,label:"Left-Common-IliacA"},333:{color:[255,160,0],opacity:1,label:"Right-Common-IliacA"},334:{color:[255,255,0],opacity:1,label:"Left-External-IliacA"},335:{color:[0,255,0],opacity:1,label:"Right-External-IliacA"},336:{color:[255,0,160],opacity:1,label:"Left-Internal-IliacA"},337:{color:[255,0,255],opacity:1,label:"Right-Internal-IliacA"},338:{color:[255,50,80],opacity:1,label:"Left-Lateral-SacralA"},339:{color:[80,255,50],opacity:1,label:"Right-Lateral-SacralA"},340:{color:[160,255,50],opacity:1,label:"Left-ObturatorA"},341:{color:[160,200,255],opacity:1,label:"Right-ObturatorA"},342:{color:[0,255,160],opacity:1,label:"Left-Internal-PudendalA"},343:{color:[0,0,255],opacity:1,label:"Right-Internal-PudendalA"},344:{color:[80,50,255],opacity:1,label:"Left-UmbilicalA"},345:{color:[160,0,255],opacity:1,label:"Right-UmbilicalA"},346:{color:[255,210,0],opacity:1,label:"Left-Inf-RectalA"},347:{color:[0,160,255],opacity:1,label:"Right-Inf-RectalA"},348:{color:[255,200,80],opacity:1,label:"Left-Common-IliacV"},349:{color:[255,200,160],opacity:1,label:"Right-Common-IliacV"},350:{color:[255,80,200],opacity:1,label:"Left-External-IliacV"},351:{color:[255,160,200],opacity:1,label:"Right-External-IliacV"},352:{color:[30,255,80],opacity:1,label:"Left-Internal-IliacV"},353:{color:[80,200,255],opacity:1,label:"Right-Internal-IliacV"},354:{color:[80,255,200],opacity:1,label:"Left-ObturatorV"},355:{color:[195,255,200],opacity:1,label:"Right-ObturatorV"},356:{color:[120,200,20],opacity:1,label:"Left-Internal-PudendalV"},357:{color:[170,10,200],opacity:1,label:"Right-Internal-PudendalV"},358:{color:[20,130,180],opacity:1,label:"Pos-Lymph"},359:{color:[20,180,130],opacity:1,label:"Neg-Lymph"},400:{color:[206,62,78],opacity:1,label:"V1"},401:{color:[121,18,134],opacity:1,label:"V2"},402:{color:[199,58,250],opacity:1,label:"BA44"},403:{color:[1,148,0],opacity:1,label:"BA45"},404:{color:[221,248,164],opacity:1,label:"BA4a"},405:{color:[231,148,34],opacity:1,label:"BA4p"},406:{color:[1,118,14],opacity:1,label:"BA6"},407:{color:[120,118,14],opacity:1,label:"BA2"},408:{color:[123,186,221],opacity:1,label:"BA1_old"},409:{color:[238,13,177],opacity:1,label:"BAun2"},410:{color:[123,186,220],opacity:1,label:"BA1"},411:{color:[138,13,206],opacity:1,label:"BA2b"},412:{color:[238,130,176],opacity:1,label:"BA3a"},413:{color:[218,230,76],opacity:1,label:"BA3b"},414:{color:[38,213,176],opacity:1,label:"MT"},415:{color:[1,225,176],opacity:1,label:"AIPS_AIP_l"},416:{color:[1,225,176],opacity:1,label:"AIPS_AIP_r"},417:{color:[200,2,100],opacity:1,label:"AIPS_VIP_l"},418:{color:[200,2,100],opacity:1,label:"AIPS_VIP_r"},419:{color:[5,200,90],opacity:1,label:"IPL_PFcm_l"},420:{color:[5,200,90],opacity:1,label:"IPL_PFcm_r"},421:{color:[100,5,200],opacity:1,label:"IPL_PF_l"},422:{color:[25,255,100],opacity:1,label:"IPL_PFm_l"},423:{color:[25,255,100],opacity:1,label:"IPL_PFm_r"},424:{color:[230,7,100],opacity:1,label:"IPL_PFop_l"},425:{color:[230,7,100],opacity:1,label:"IPL_PFop_r"},426:{color:[100,5,200],opacity:1,label:"IPL_PF_r"},427:{color:[150,10,200],opacity:1,label:"IPL_PFt_l"},428:{color:[150,10,200],opacity:1,label:"IPL_PFt_r"},429:{color:[175,10,176],opacity:1,label:"IPL_PGa_l"},430:{color:[175,10,176],opacity:1,label:"IPL_PGa_r"},431:{color:[10,100,255],opacity:1,label:"IPL_PGp_l"},432:{color:[10,100,255],opacity:1,label:"IPL_PGp_r"},433:{color:[150,45,70],opacity:1,label:"Visual_V3d_l"},434:{color:[150,45,70],opacity:1,label:"Visual_V3d_r"},435:{color:[45,200,15],opacity:1,label:"Visual_V4_l"},436:{color:[45,200,15],opacity:1,label:"Visual_V4_r"},437:{color:[227,45,100],opacity:1,label:"Visual_V5_b"},438:{color:[227,45,100],opacity:1,label:"Visual_VP_l"},439:{color:[227,45,100],opacity:1,label:"Visual_VP_r"},498:{color:[143,188,143],opacity:1,label:"wmsa"},499:{color:[255,248,220],opacity:1,label:"other_wmsa"},500:{color:[17,85,136],opacity:1,label:"right_CA2_3"},501:{color:[119,187,102],opacity:1,label:"right_alveus"},502:{color:[204,68,34],opacity:1,label:"right_CA1"},503:{color:[204,0,255],opacity:1,label:"right_fimbria"},504:{color:[221,187,17],opacity:1,label:"right_presubiculum"},505:{color:[153,221,238],opacity:1,label:"right_hippocampal_fissure"},506:{color:[51,17,17],opacity:1,label:"right_CA4_DG"},507:{color:[0,119,85],opacity:1,label:"right_subiculum"},508:{color:[20,100,200],opacity:1,label:"right_fornix"},550:{color:[17,85,137],opacity:1,label:"left_CA2_3"},551:{color:[119,187,103],opacity:1,label:"left_alveus"},552:{color:[204,68,35],opacity:1,label:"left_CA1"},553:{color:[204,0,254],opacity:1,label:"left_fimbria"},554:{color:[221,187,16],opacity:1,label:"left_presubiculum"},555:{color:[153,221,239],opacity:1,label:"left_hippocampal_fissure"},556:{color:[51,17,18],opacity:1,label:"left_CA4_DG"},557:{color:[0,119,86],opacity:1,label:"left_subiculum"},558:{color:[20,100,201],opacity:1,label:"left_fornix"},600:{color:[254,254,254],opacity:1,label:"Tumor"},601:{color:[70,130,180],opacity:1,label:"Cbm_Left_I_IV"},602:{color:[245,245,245],opacity:1,label:"Cbm_Right_I_IV"},603:{color:[205,62,78],opacity:1,label:"Cbm_Left_V"},604:{color:[120,18,134],opacity:1,label:"Cbm_Right_V"},605:{color:[196,58,250],opacity:1,label:"Cbm_Left_VI"},606:{color:[0,148,0],opacity:1,label:"Cbm_Vermis_VI"},607:{color:[220,248,164],opacity:1,label:"Cbm_Right_VI"},608:{color:[230,148,34],opacity:1,label:"Cbm_Left_CrusI"},609:{color:[0,118,14],opacity:1,label:"Cbm_Vermis_CrusI"},610:{color:[0,118,14],opacity:1,label:"Cbm_Right_CrusI"},611:{color:[122,186,220],opacity:1,label:"Cbm_Left_CrusII"},612:{color:[236,13,176],opacity:1,label:"Cbm_Vermis_CrusII"},613:{color:[12,48,255],opacity:1,label:"Cbm_Right_CrusII"},614:{color:[204,182,142],opacity:1,label:"Cbm_Left_VIIb"},615:{color:[42,204,164],opacity:1,label:"Cbm_Vermis_VIIb"},616:{color:[119,159,176],opacity:1,label:"Cbm_Right_VIIb"},617:{color:[220,216,20],opacity:1,label:"Cbm_Left_VIIIa"},618:{color:[103,255,255],opacity:1,label:"Cbm_Vermis_VIIIa"},619:{color:[80,196,98],opacity:1,label:"Cbm_Right_VIIIa"},620:{color:[60,58,210],opacity:1,label:"Cbm_Left_VIIIb"},621:{color:[60,58,210],opacity:1,label:"Cbm_Vermis_VIIIb"},622:{color:[60,58,210],opacity:1,label:"Cbm_Right_VIIIb"},623:{color:[60,58,210],opacity:1,label:"Cbm_Left_IX"},624:{color:[60,60,60],opacity:1,label:"Cbm_Vermis_IX"},625:{color:[255,165,0],opacity:1,label:"Cbm_Right_IX"},626:{color:[255,165,0],opacity:1,label:"Cbm_Left_X"},627:{color:[0,255,127],opacity:1,label:"Cbm_Vermis_X"},628:{color:[165,42,42],opacity:1,label:"Cbm_Right_X"},640:{color:[204,0,0],opacity:1,label:"Cbm_Right_I_V_med"},641:{color:[255,0,0],opacity:1,label:"Cbm_Right_I_V_mid"},642:{color:[0,0,255],opacity:1,label:"Cbm_Right_VI_med"},643:{color:[30,144,255],opacity:1,label:"Cbm_Right_VI_mid"},644:{color:[100,212,237],opacity:1,label:"Cbm_Right_VI_lat"},645:{color:[218,165,32],opacity:1,label:"Cbm_Right_CrusI_med"},646:{color:[255,215,0],opacity:1,label:"Cbm_Right_CrusI_mid"},647:{color:[255,255,166],opacity:1,label:"Cbm_Right_CrusI_lat"},648:{color:[153,0,204],opacity:1,label:"Cbm_Right_CrusII_med"},649:{color:[153,141,209],opacity:1,label:"Cbm_Right_CrusII_mid"},650:{color:[204,204,255],opacity:1,label:"Cbm_Right_CrusII_lat"},651:{color:[31,212,194],opacity:1,label:"Cbm_Right_7med"},652:{color:[3,255,237],opacity:1,label:"Cbm_Right_7mid"},653:{color:[204,255,255],opacity:1,label:"Cbm_Right_7lat"},654:{color:[86,74,147],opacity:1,label:"Cbm_Right_8med"},655:{color:[114,114,190],opacity:1,label:"Cbm_Right_8mid"},656:{color:[184,178,255],opacity:1,label:"Cbm_Right_8lat"},657:{color:[126,138,37],opacity:1,label:"Cbm_Right_PUNs"},658:{color:[189,197,117],opacity:1,label:"Cbm_Right_TONs"},659:{color:[240,230,140],opacity:1,label:"Cbm_Right_FLOs"},660:{color:[204,0,0],opacity:1,label:"Cbm_Left_I_V_med"},661:{color:[255,0,0],opacity:1,label:"Cbm_Left_I_V_mid"},662:{color:[0,0,255],opacity:1,label:"Cbm_Left_VI_med"},663:{color:[30,144,255],opacity:1,label:"Cbm_Left_VI_mid"},664:{color:[100,212,237],opacity:1,label:"Cbm_Left_VI_lat"},665:{color:[218,165,32],opacity:1,label:"Cbm_Left_CrusI_med"},666:{color:[255,215,0],opacity:1,label:"Cbm_Left_CrusI_mid"},667:{color:[255,255,166],opacity:1,label:"Cbm_Left_CrusI_lat"},668:{color:[153,0,204],opacity:1,label:"Cbm_Left_CrusII_med"},669:{color:[153,141,209],opacity:1,label:"Cbm_Left_CrusII_mid"},670:{color:[204,204,255],opacity:1,label:"Cbm_Left_CrusII_lat"},671:{color:[31,212,194],opacity:1,label:"Cbm_Left_7med"},672:{color:[3,255,237],opacity:1,label:"Cbm_Left_7mid"},673:{color:[204,255,255],opacity:1,label:"Cbm_Left_7lat"},674:{color:[86,74,147],opacity:1,label:"Cbm_Left_8med"},675:{color:[114,114,190],opacity:1,label:"Cbm_Left_8mid"},676:{color:[184,178,255],opacity:1,label:"Cbm_Left_8lat"},677:{color:[126,138,37],opacity:1,label:"Cbm_Left_PUNs"},678:{color:[189,197,117],opacity:1,label:"Cbm_Left_TONs"},679:{color:[240,230,140],opacity:1,label:"Cbm_Left_FLOs"},690:{color:[122,135,50],opacity:1,label:"CbmWM_Gyri_Left"},691:{color:[122,135,50],opacity:1,label:"CbmWM_Gyri_Right"},701:{color:[120,18,134],opacity:1,label:"CSF-FSL-FAST"},702:{color:[205,62,78],opacity:1,label:"GrayMatter-FSL-FAST"},703:{color:[0,225,0],opacity:1,label:"WhiteMatter-FSL-FAST"},999:{color:[255,100,100],opacity:1,label:"SUSPICIOUS"},1000:{color:[25,5,25],opacity:1,label:"ctx-lh-unknown"},1001:{color:[25,100,40],opacity:1,label:"ctx-lh-bankssts"},1002:{color:[125,100,160],opacity:1,label:"ctx-lh-caudalanteriorcingulate"},1003:{color:[100,25,0],opacity:1,label:"ctx-lh-caudalmiddlefrontal"},1004:{color:[120,70,50],opacity:1,label:"ctx-lh-corpuscallosum"},1005:{color:[220,20,100],opacity:1,label:"ctx-lh-cuneus"},1006:{color:[220,20,10],opacity:1,label:"ctx-lh-entorhinal"},1007:{color:[180,220,140],opacity:1,label:"ctx-lh-fusiform"},1008:{color:[220,60,220],opacity:1,label:"ctx-lh-inferiorparietal"},1009:{color:[180,40,120],opacity:1,label:"ctx-lh-inferiortemporal"},1010:{color:[140,20,140],opacity:1,label:"ctx-lh-isthmuscingulate"},1011:{color:[20,30,140],opacity:1,label:"ctx-lh-lateraloccipital"},1012:{color:[35,75,50],opacity:1,label:"ctx-lh-lateralorbitofrontal"},1013:{color:[225,140,140],opacity:1,label:"ctx-lh-lingual"},1014:{color:[200,35,75],opacity:1,label:"ctx-lh-medialorbitofrontal"},1015:{color:[160,100,50],opacity:1,label:"ctx-lh-middletemporal"},1016:{color:[20,220,60],opacity:1,label:"ctx-lh-parahippocampal"},1017:{color:[60,220,60],opacity:1,label:"ctx-lh-paracentral"},1018:{color:[220,180,140],opacity:1,label:"ctx-lh-parsopercularis"},1019:{color:[20,100,50],opacity:1,label:"ctx-lh-parsorbitalis"},1020:{color:[220,60,20],opacity:1,label:"ctx-lh-parstriangularis"},1021:{color:[120,100,60],opacity:1,label:"ctx-lh-pericalcarine"},1022:{color:[220,20,20],opacity:1,label:"ctx-lh-postcentral"},1023:{color:[220,180,220],opacity:1,label:"ctx-lh-posteriorcingulate"},1024:{color:[60,20,220],opacity:1,label:"ctx-lh-precentral"},1025:{color:[160,140,180],opacity:1,label:"ctx-lh-precuneus"},1026:{color:[80,20,140],opacity:1,label:"ctx-lh-rostralanteriorcingulate"},1027:{color:[75,50,125],opacity:1,label:"ctx-lh-rostralmiddlefrontal"},1028:{color:[20,220,160],opacity:1,label:"ctx-lh-superiorfrontal"},1029:{color:[20,180,140],opacity:1,label:"ctx-lh-superiorparietal"},1030:{color:[140,220,220],opacity:1,label:"ctx-lh-superiortemporal"},1031:{color:[80,160,20],opacity:1,label:"ctx-lh-supramarginal"},1032:{color:[100,0,100],opacity:1,label:"ctx-lh-frontalpole"},1033:{color:[70,70,70],opacity:1,label:"ctx-lh-temporalpole"},1034:{color:[150,150,200],opacity:1,label:"ctx-lh-transversetemporal"},1035:{color:[255,192,32],opacity:1,label:"ctx-lh-insula"},2000:{color:[25,5,25],opacity:1,label:"ctx-rh-unknown"},2001:{color:[25,100,40],opacity:1,label:"ctx-rh-bankssts"},2002:{color:[125,100,160],opacity:1,label:"ctx-rh-caudalanteriorcingulate"},2003:{color:[100,25,0],opacity:1,label:"ctx-rh-caudalmiddlefrontal"},2004:{color:[120,70,50],opacity:1,label:"ctx-rh-corpuscallosum"},2005:{color:[220,20,100],opacity:1,label:"ctx-rh-cuneus"},2006:{color:[220,20,10],opacity:1,label:"ctx-rh-entorhinal"},2007:{color:[180,220,140],opacity:1,label:"ctx-rh-fusiform"},2008:{color:[220,60,220],opacity:1,label:"ctx-rh-inferiorparietal"},2009:{color:[180,40,120],opacity:1,label:"ctx-rh-inferiortemporal"},2010:{color:[140,20,140],opacity:1,label:"ctx-rh-isthmuscingulate"},2011:{color:[20,30,140],opacity:1,label:"ctx-rh-lateraloccipital"},2012:{color:[35,75,50],opacity:1,label:"ctx-rh-lateralorbitofrontal"},2013:{color:[225,140,140],opacity:1,label:"ctx-rh-lingual"},2014:{color:[200,35,75],opacity:1,label:"ctx-rh-medialorbitofrontal"},2015:{color:[160,100,50],opacity:1,label:"ctx-rh-middletemporal"},2016:{color:[20,220,60],opacity:1,label:"ctx-rh-parahippocampal"},2017:{color:[60,220,60],opacity:1,label:"ctx-rh-paracentral"},2018:{color:[220,180,140],opacity:1,label:"ctx-rh-parsopercularis"},2019:{color:[20,100,50],opacity:1,label:"ctx-rh-parsorbitalis"},2020:{color:[220,60,20],opacity:1,label:"ctx-rh-parstriangularis"},2021:{color:[120,100,60],opacity:1,label:"ctx-rh-pericalcarine"},2022:{color:[220,20,20],opacity:1,label:"ctx-rh-postcentral"},2023:{color:[220,180,220],opacity:1,label:"ctx-rh-posteriorcingulate"},2024:{color:[60,20,220],opacity:1,label:"ctx-rh-precentral"},2025:{color:[160,140,180],opacity:1,label:"ctx-rh-precuneus"},2026:{color:[80,20,140],opacity:1,label:"ctx-rh-rostralanteriorcingulate"},2027:{color:[75,50,125],opacity:1,label:"ctx-rh-rostralmiddlefrontal"},2028:{color:[20,220,160],opacity:1,label:"ctx-rh-superiorfrontal"},2029:{color:[20,180,140],opacity:1,label:"ctx-rh-superiorparietal"},2030:{color:[140,220,220],opacity:1,label:"ctx-rh-superiortemporal"},2031:{color:[80,160,20],opacity:1,label:"ctx-rh-supramarginal"},2032:{color:[100,0,100],opacity:1,label:"ctx-rh-frontalpole"},2033:{color:[70,70,70],opacity:1,label:"ctx-rh-temporalpole"},2034:{color:[150,150,200],opacity:1,label:"ctx-rh-transversetemporal"},2035:{color:[255,192,32],opacity:1,label:"ctx-rh-insula"},3000:{color:[230,250,230],opacity:1,label:"wm-lh-unknown"},3001:{color:[230,155,215],opacity:1,label:"wm-lh-bankssts"},3002:{color:[130,155,95],opacity:1,label:"wm-lh-caudalanteriorcingulate"},3003:{color:[155,230,255],opacity:1,label:"wm-lh-caudalmiddlefrontal"},3004:{color:[135,185,205],opacity:1,label:"wm-lh-corpuscallosum"},3005:{color:[35,235,155],opacity:1,label:"wm-lh-cuneus"},3006:{color:[35,235,245],opacity:1,label:"wm-lh-entorhinal"},3007:{color:[75,35,115],opacity:1,label:"wm-lh-fusiform"},3008:{color:[35,195,35],opacity:1,label:"wm-lh-inferiorparietal"},3009:{color:[75,215,135],opacity:1,label:"wm-lh-inferiortemporal"},3010:{color:[115,235,115],opacity:1,label:"wm-lh-isthmuscingulate"},3011:{color:[235,225,115],opacity:1,label:"wm-lh-lateraloccipital"},3012:{color:[220,180,205],opacity:1,label:"wm-lh-lateralorbitofrontal"},3013:{color:[30,115,115],opacity:1,label:"wm-lh-lingual"},3014:{color:[55,220,180],opacity:1,label:"wm-lh-medialorbitofrontal"},3015:{color:[95,155,205],opacity:1,label:"wm-lh-middletemporal"},3016:{color:[235,35,195],opacity:1,label:"wm-lh-parahippocampal"},3017:{color:[195,35,195],opacity:1,label:"wm-lh-paracentral"},3018:{color:[35,75,115],opacity:1,label:"wm-lh-parsopercularis"},3019:{color:[235,155,205],opacity:1,label:"wm-lh-parsorbitalis"},3020:{color:[35,195,235],opacity:1,label:"wm-lh-parstriangularis"},3021:{color:[135,155,195],opacity:1,label:"wm-lh-pericalcarine"},3022:{color:[35,235,235],opacity:1,label:"wm-lh-postcentral"},3023:{color:[35,75,35],opacity:1,label:"wm-lh-posteriorcingulate"},3024:{color:[195,235,35],opacity:1,label:"wm-lh-precentral"},3025:{color:[95,115,75],opacity:1,label:"wm-lh-precuneus"},3026:{color:[175,235,115],opacity:1,label:"wm-lh-rostralanteriorcingulate"},3027:{color:[180,205,130],opacity:1,label:"wm-lh-rostralmiddlefrontal"},3028:{color:[235,35,95],opacity:1,label:"wm-lh-superiorfrontal"},3029:{color:[235,75,115],opacity:1,label:"wm-lh-superiorparietal"},3030:{color:[115,35,35],opacity:1,label:"wm-lh-superiortemporal"},3031:{color:[175,95,235],opacity:1,label:"wm-lh-supramarginal"},3032:{color:[155,255,155],opacity:1,label:"wm-lh-frontalpole"},3033:{color:[185,185,185],opacity:1,label:"wm-lh-temporalpole"},3034:{color:[105,105,55],opacity:1,label:"wm-lh-transversetemporal"},3035:{color:[20,220,160],opacity:1,label:"wm-lh-insula"},4000:{color:[230,250,230],opacity:1,label:"wm-rh-unknown"},4001:{color:[230,155,215],opacity:1,label:"wm-rh-bankssts"},4002:{color:[130,155,95],opacity:1,label:"wm-rh-caudalanteriorcingulate"},4003:{color:[155,230,255],opacity:1,label:"wm-rh-caudalmiddlefrontal"},4004:{color:[135,185,205],opacity:1,label:"wm-rh-corpuscallosum"},4005:{color:[35,235,155],opacity:1,label:"wm-rh-cuneus"},4006:{color:[35,235,245],opacity:1,label:"wm-rh-entorhinal"},4007:{color:[75,35,115],opacity:1,label:"wm-rh-fusiform"},4008:{color:[35,195,35],opacity:1,label:"wm-rh-inferiorparietal"},4009:{color:[75,215,135],opacity:1,label:"wm-rh-inferiortemporal"},4010:{color:[115,235,115],opacity:1,label:"wm-rh-isthmuscingulate"},4011:{color:[235,225,115],opacity:1,label:"wm-rh-lateraloccipital"},4012:{color:[220,180,205],opacity:1,label:"wm-rh-lateralorbitofrontal"},4013:{color:[30,115,115],opacity:1,label:"wm-rh-lingual"},4014:{color:[55,220,180],opacity:1,label:"wm-rh-medialorbitofrontal"},4015:{color:[95,155,205],opacity:1,label:"wm-rh-middletemporal"},4016:{color:[235,35,195],opacity:1,label:"wm-rh-parahippocampal"},4017:{color:[195,35,195],opacity:1,label:"wm-rh-paracentral"},4018:{color:[35,75,115],opacity:1,label:"wm-rh-parsopercularis"},4019:{color:[235,155,205],opacity:1,label:"wm-rh-parsorbitalis"},4020:{color:[35,195,235],opacity:1,label:"wm-rh-parstriangularis"},4021:{color:[135,155,195],opacity:1,label:"wm-rh-pericalcarine"},4022:{color:[35,235,235],opacity:1,label:"wm-rh-postcentral"},4023:{color:[35,75,35],opacity:1,label:"wm-rh-posteriorcingulate"},4024:{color:[195,235,35],opacity:1,label:"wm-rh-precentral"},4025:{color:[95,115,75],opacity:1,label:"wm-rh-precuneus"},4026:{color:[175,235,115],opacity:1,label:"wm-rh-rostralanteriorcingulate"},4027:{color:[180,205,130],opacity:1,label:"wm-rh-rostralmiddlefrontal"},4028:{color:[235,35,95],opacity:1,label:"wm-rh-superiorfrontal"},4029:{color:[235,75,115],opacity:1,label:"wm-rh-superiorparietal"},4030:{color:[115,35,35],opacity:1,label:"wm-rh-superiortemporal"},4031:{color:[175,95,235],opacity:1,label:"wm-rh-supramarginal"},4032:{color:[155,255,155],opacity:1,label:"wm-rh-frontalpole"},4033:{color:[185,185,185],opacity:1,label:"wm-rh-temporalpole"},4034:{color:[105,105,55],opacity:1,label:"wm-rh-transversetemporal"},4035:{color:[20,220,160],opacity:1,label:"wm-rh-insula"},3201:{color:[235,35,95],opacity:1,label:"wm-lh-frontal-lobe"},3203:{color:[35,75,35],opacity:1,label:"wm-lh-cingulate-lobe"},3204:{color:[135,155,195],opacity:1,label:"wm-lh-occiptal-lobe"},3205:{color:[115,35,35],opacity:1,label:"wm-lh-temporal-lobe"},3206:{color:[35,195,35],opacity:1,label:"wm-lh-parietal-lobe"},3207:{color:[20,220,160],opacity:1,label:"wm-lh-insula-lobe"},4201:{color:[235,35,95],opacity:1,label:"wm-rh-frontal-lobe"},4203:{color:[35,75,35],opacity:1,label:"wm-rh-cingulate-lobe"},4204:{color:[135,155,195],opacity:1,label:"wm-rh-occiptal-lobe"},4205:{color:[115,35,35],opacity:1,label:"wm-rh-temporal-lobe"},4206:{color:[35,195,35],opacity:1,label:"wm-rh-parietal-lobe"},4207:{color:[20,220,160],opacity:1,label:"wm-rh-insula-lobe"},1100:{color:[0,0,0],opacity:1,label:"ctx-lh-Unknown"},1101:{color:[50,50,50],opacity:1,label:"ctx-lh-Corpus_callosum"},1102:{color:[180,20,30],opacity:1,label:"ctx-lh-G_and_S_Insula_ONLY_AVERAGE"},1103:{color:[60,25,25],opacity:1,label:"ctx-lh-G_cingulate-Isthmus"},1104:{color:[25,60,60],opacity:1,label:"ctx-lh-G_cingulate-Main_part"},1200:{color:[25,60,61],opacity:1,label:"ctx-lh-G_cingulate-caudal_ACC"},1201:{color:[25,90,60],opacity:1,label:"ctx-lh-G_cingulate-rostral_ACC"},1202:{color:[25,120,60],opacity:1,label:"ctx-lh-G_cingulate-posterior"},1205:{color:[25,150,60],opacity:1,label:"ctx-lh-S_cingulate-caudal_ACC"},1206:{color:[25,180,60],opacity:1,label:"ctx-lh-S_cingulate-rostral_ACC"},1207:{color:[25,210,60],opacity:1,label:"ctx-lh-S_cingulate-posterior"},1210:{color:[25,150,90],opacity:1,label:"ctx-lh-S_pericallosal-caudal"},1211:{color:[25,180,90],opacity:1,label:"ctx-lh-S_pericallosal-rostral"},1212:{color:[25,210,90],opacity:1,label:"ctx-lh-S_pericallosal-posterior"},1105:{color:[180,20,20],opacity:1,label:"ctx-lh-G_cuneus"},1106:{color:[220,20,100],opacity:1,label:"ctx-lh-G_frontal_inf-Opercular_part"},1107:{color:[140,60,60],opacity:1,label:"ctx-lh-G_frontal_inf-Orbital_part"},1108:{color:[180,220,140],opacity:1,label:"ctx-lh-G_frontal_inf-Triangular_part"},1109:{color:[140,100,180],opacity:1,label:"ctx-lh-G_frontal_middle"},1110:{color:[180,20,140],opacity:1,label:"ctx-lh-G_frontal_superior"},1111:{color:[140,20,140],opacity:1,label:"ctx-lh-G_frontomarginal"},1112:{color:[21,10,10],opacity:1,label:"ctx-lh-G_insular_long"},1113:{color:[225,140,140],opacity:1,label:"ctx-lh-G_insular_short"},1114:{color:[23,60,180],opacity:1,label:"ctx-lh-G_and_S_occipital_inferior"},1115:{color:[180,60,180],opacity:1,label:"ctx-lh-G_occipital_middle"},1116:{color:[20,220,60],opacity:1,label:"ctx-lh-G_occipital_superior"},1117:{color:[60,20,140],opacity:1,label:"ctx-lh-G_occipit-temp_lat-Or_fusiform"},1118:{color:[220,180,140],opacity:1,label:"ctx-lh-G_occipit-temp_med-Lingual_part"},1119:{color:[65,100,20],opacity:1,label:"ctx-lh-G_occipit-temp_med-Parahippocampal_part"},1120:{color:[220,60,20],opacity:1,label:"ctx-lh-G_orbital"},1121:{color:[60,100,60],opacity:1,label:"ctx-lh-G_paracentral"},1122:{color:[20,60,220],opacity:1,label:"ctx-lh-G_parietal_inferior-Angular_part"},1123:{color:[100,100,60],opacity:1,label:"ctx-lh-G_parietal_inferior-Supramarginal_part"},1124:{color:[220,180,220],opacity:1,label:"ctx-lh-G_parietal_superior"},1125:{color:[20,180,140],opacity:1,label:"ctx-lh-G_postcentral"},1126:{color:[60,140,180],opacity:1,label:"ctx-lh-G_precentral"},1127:{color:[25,20,140],opacity:1,label:"ctx-lh-G_precuneus"},1128:{color:[20,60,100],opacity:1,label:"ctx-lh-G_rectus"},1129:{color:[60,220,20],opacity:1,label:"ctx-lh-G_subcallosal"},1130:{color:[60,20,220],opacity:1,label:"ctx-lh-G_subcentral"},1131:{color:[220,220,100],opacity:1,label:"ctx-lh-G_temporal_inferior"},1132:{color:[180,60,60],opacity:1,label:"ctx-lh-G_temporal_middle"},1133:{color:[60,60,220],opacity:1,label:"ctx-lh-G_temp_sup-G_temp_transv_and_interm_S"},1134:{color:[220,60,220],opacity:1,label:"ctx-lh-G_temp_sup-Lateral_aspect"},1135:{color:[65,220,60],opacity:1,label:"ctx-lh-G_temp_sup-Planum_polare"},1136:{color:[25,140,20],opacity:1,label:"ctx-lh-G_temp_sup-Planum_tempolare"},1137:{color:[13,0,250],opacity:1,label:"ctx-lh-G_and_S_transverse_frontopolar"},1138:{color:[61,20,220],opacity:1,label:"ctx-lh-Lat_Fissure-ant_sgt-ramus_horizontal"},1139:{color:[61,20,60],opacity:1,label:"ctx-lh-Lat_Fissure-ant_sgt-ramus_vertical"},1140:{color:[61,60,100],opacity:1,label:"ctx-lh-Lat_Fissure-post_sgt"},1141:{color:[25,25,25],opacity:1,label:"ctx-lh-Medial_wall"},1142:{color:[140,20,60],opacity:1,label:"ctx-lh-Pole_occipital"},1143:{color:[220,180,20],opacity:1,label:"ctx-lh-Pole_temporal"},1144:{color:[63,180,180],opacity:1,label:"ctx-lh-S_calcarine"},1145:{color:[221,20,10],opacity:1,label:"ctx-lh-S_central"},1146:{color:[21,220,20],opacity:1,label:"ctx-lh-S_central_insula"},1147:{color:[183,100,20],opacity:1,label:"ctx-lh-S_cingulate-Main_part_and_Intracingulate"},1148:{color:[221,20,100],opacity:1,label:"ctx-lh-S_cingulate-Marginalis_part"},1149:{color:[221,60,140],opacity:1,label:"ctx-lh-S_circular_insula_anterior"},1150:{color:[221,20,220],opacity:1,label:"ctx-lh-S_circular_insula_inferior"},1151:{color:[61,220,220],opacity:1,label:"ctx-lh-S_circular_insula_superior"},1152:{color:[100,200,200],opacity:1,label:"ctx-lh-S_collateral_transverse_ant"},1153:{color:[10,200,200],opacity:1,label:"ctx-lh-S_collateral_transverse_post"},1154:{color:[221,220,20],opacity:1,label:"ctx-lh-S_frontal_inferior"},1155:{color:[141,20,100],opacity:1,label:"ctx-lh-S_frontal_middle"},1156:{color:[61,220,100],opacity:1,label:"ctx-lh-S_frontal_superior"},1157:{color:[21,220,60],opacity:1,label:"ctx-lh-S_frontomarginal"},1158:{color:[141,60,20],opacity:1,label:"ctx-lh-S_intermedius_primus-Jensen"},1159:{color:[143,20,220],opacity:1,label:"ctx-lh-S_intraparietal-and_Parietal_transverse"},1160:{color:[61,20,180],opacity:1,label:"ctx-lh-S_occipital_anterior"},1161:{color:[101,60,220],opacity:1,label:"ctx-lh-S_occipital_middle_and_Lunatus"},1162:{color:[21,20,140],opacity:1,label:"ctx-lh-S_occipital_superior_and_transversalis"},1163:{color:[221,140,20],opacity:1,label:"ctx-lh-S_occipito-temporal_lateral"},1164:{color:[141,100,220],opacity:1,label:"ctx-lh-S_occipito-temporal_medial_and_S_Lingual"},1165:{color:[101,20,20],opacity:1,label:"ctx-lh-S_orbital-H_shapped"},1166:{color:[221,100,20],opacity:1,label:"ctx-lh-S_orbital_lateral"},1167:{color:[181,200,20],opacity:1,label:"ctx-lh-S_orbital_medial-Or_olfactory"},1168:{color:[21,180,140],opacity:1,label:"ctx-lh-S_paracentral"},1169:{color:[101,100,180],opacity:1,label:"ctx-lh-S_parieto_occipital"},1170:{color:[181,220,20],opacity:1,label:"ctx-lh-S_pericallosal"},1171:{color:[21,140,200],opacity:1,label:"ctx-lh-S_postcentral"},1172:{color:[21,20,240],opacity:1,label:"ctx-lh-S_precentral-Inferior-part"},1173:{color:[21,20,200],opacity:1,label:"ctx-lh-S_precentral-Superior-part"},1174:{color:[61,180,60],opacity:1,label:"ctx-lh-S_subcentral_ant"},1175:{color:[61,180,250],opacity:1,label:"ctx-lh-S_subcentral_post"},1176:{color:[21,20,60],opacity:1,label:"ctx-lh-S_suborbital"},1177:{color:[101,60,60],opacity:1,label:"ctx-lh-S_subparietal"},1178:{color:[21,220,220],opacity:1,label:"ctx-lh-S_supracingulate"},1179:{color:[21,180,180],opacity:1,label:"ctx-lh-S_temporal_inferior"},1180:{color:[223,220,60],opacity:1,label:"ctx-lh-S_temporal_superior"},1181:{color:[221,60,60],opacity:1,label:"ctx-lh-S_temporal_transverse"},2100:{color:[0,0,0],opacity:1,label:"ctx-rh-Unknown"},2101:{color:[50,50,50],opacity:1,label:"ctx-rh-Corpus_callosum"},2102:{color:[180,20,30],opacity:1,label:"ctx-rh-G_and_S_Insula_ONLY_AVERAGE"},2103:{color:[60,25,25],opacity:1,label:"ctx-rh-G_cingulate-Isthmus"},2104:{color:[25,60,60],opacity:1,label:"ctx-rh-G_cingulate-Main_part"},2105:{color:[180,20,20],opacity:1,label:"ctx-rh-G_cuneus"},2106:{color:[220,20,100],opacity:1,label:"ctx-rh-G_frontal_inf-Opercular_part"},2107:{color:[140,60,60],opacity:1,label:"ctx-rh-G_frontal_inf-Orbital_part"},2108:{color:[180,220,140],opacity:1,label:"ctx-rh-G_frontal_inf-Triangular_part"},2109:{color:[140,100,180],opacity:1,label:"ctx-rh-G_frontal_middle"},2110:{color:[180,20,140],opacity:1,label:"ctx-rh-G_frontal_superior"},2111:{color:[140,20,140],opacity:1,label:"ctx-rh-G_frontomarginal"},2112:{color:[21,10,10],opacity:1,label:"ctx-rh-G_insular_long"},2113:{color:[225,140,140],opacity:1,label:"ctx-rh-G_insular_short"},2114:{color:[23,60,180],opacity:1,label:"ctx-rh-G_and_S_occipital_inferior"},2115:{color:[180,60,180],opacity:1,label:"ctx-rh-G_occipital_middle"},2116:{color:[20,220,60],opacity:1,label:"ctx-rh-G_occipital_superior"},2117:{color:[60,20,140],opacity:1,label:"ctx-rh-G_occipit-temp_lat-Or_fusiform"},2118:{color:[220,180,140],opacity:1,label:"ctx-rh-G_occipit-temp_med-Lingual_part"},2119:{color:[65,100,20],opacity:1,label:"ctx-rh-G_occipit-temp_med-Parahippocampal_part"},2120:{color:[220,60,20],opacity:1,label:"ctx-rh-G_orbital"},2121:{color:[60,100,60],opacity:1,label:"ctx-rh-G_paracentral"},2122:{color:[20,60,220],opacity:1,label:"ctx-rh-G_parietal_inferior-Angular_part"},2123:{color:[100,100,60],opacity:1,label:"ctx-rh-G_parietal_inferior-Supramarginal_part"},2124:{color:[220,180,220],opacity:1,label:"ctx-rh-G_parietal_superior"},2125:{color:[20,180,140],opacity:1,label:"ctx-rh-G_postcentral"},2126:{color:[60,140,180],opacity:1,label:"ctx-rh-G_precentral"},2127:{color:[25,20,140],opacity:1,label:"ctx-rh-G_precuneus"},2128:{color:[20,60,100],opacity:1,label:"ctx-rh-G_rectus"},2129:{color:[60,220,20],opacity:1,label:"ctx-rh-G_subcallosal"},2130:{color:[60,20,220],opacity:1,label:"ctx-rh-G_subcentral"},2131:{color:[220,220,100],opacity:1,label:"ctx-rh-G_temporal_inferior"},2132:{color:[180,60,60],opacity:1,label:"ctx-rh-G_temporal_middle"},2133:{color:[60,60,220],opacity:1,label:"ctx-rh-G_temp_sup-G_temp_transv_and_interm_S"},2134:{color:[220,60,220],opacity:1,label:"ctx-rh-G_temp_sup-Lateral_aspect"},2135:{color:[65,220,60],opacity:1,label:"ctx-rh-G_temp_sup-Planum_polare"},2136:{color:[25,140,20],opacity:1,label:"ctx-rh-G_temp_sup-Planum_tempolare"},2137:{color:[13,0,250],opacity:1,label:"ctx-rh-G_and_S_transverse_frontopolar"},2138:{color:[61,20,220],opacity:1,label:"ctx-rh-Lat_Fissure-ant_sgt-ramus_horizontal"},2139:{color:[61,20,60],opacity:1,label:"ctx-rh-Lat_Fissure-ant_sgt-ramus_vertical"},2140:{color:[61,60,100],opacity:1,label:"ctx-rh-Lat_Fissure-post_sgt"},2141:{color:[25,25,25],opacity:1,label:"ctx-rh-Medial_wall"},2142:{color:[140,20,60],opacity:1,label:"ctx-rh-Pole_occipital"},2143:{color:[220,180,20],opacity:1,label:"ctx-rh-Pole_temporal"},2144:{color:[63,180,180],opacity:1,label:"ctx-rh-S_calcarine"},2145:{color:[221,20,10],opacity:1,label:"ctx-rh-S_central"},2146:{color:[21,220,20],opacity:1,label:"ctx-rh-S_central_insula"},2147:{color:[183,100,20],opacity:1,label:"ctx-rh-S_cingulate-Main_part_and_Intracingulate"},2148:{color:[221,20,100],opacity:1,label:"ctx-rh-S_cingulate-Marginalis_part"},2149:{color:[221,60,140],opacity:1,label:"ctx-rh-S_circular_insula_anterior"},2150:{color:[221,20,220],opacity:1,label:"ctx-rh-S_circular_insula_inferior"},2151:{color:[61,220,220],opacity:1,label:"ctx-rh-S_circular_insula_superior"},2152:{color:[100,200,200],opacity:1,label:"ctx-rh-S_collateral_transverse_ant"},2153:{color:[10,200,200],opacity:1,label:"ctx-rh-S_collateral_transverse_post"},2154:{color:[221,220,20],opacity:1,label:"ctx-rh-S_frontal_inferior"},2155:{color:[141,20,100],opacity:1,label:"ctx-rh-S_frontal_middle"},2156:{color:[61,220,100],opacity:1,label:"ctx-rh-S_frontal_superior"},2157:{color:[21,220,60],opacity:1,label:"ctx-rh-S_frontomarginal"},2158:{color:[141,60,20],opacity:1,label:"ctx-rh-S_intermedius_primus-Jensen"},2159:{color:[143,20,220],opacity:1,label:"ctx-rh-S_intraparietal-and_Parietal_transverse"},2160:{color:[61,20,180],opacity:1,label:"ctx-rh-S_occipital_anterior"},2161:{color:[101,60,220],opacity:1,label:"ctx-rh-S_occipital_middle_and_Lunatus"},2162:{color:[21,20,140],opacity:1,label:"ctx-rh-S_occipital_superior_and_transversalis"},2163:{color:[221,140,20],opacity:1,label:"ctx-rh-S_occipito-temporal_lateral"},2164:{color:[141,100,220],opacity:1,label:"ctx-rh-S_occipito-temporal_medial_and_S_Lingual"},2165:{color:[101,20,20],opacity:1,label:"ctx-rh-S_orbital-H_shapped"},2166:{color:[221,100,20],opacity:1,label:"ctx-rh-S_orbital_lateral"},2167:{color:[181,200,20],opacity:1,label:"ctx-rh-S_orbital_medial-Or_olfactory"},2168:{color:[21,180,140],opacity:1,label:"ctx-rh-S_paracentral"},2169:{color:[101,100,180],opacity:1,label:"ctx-rh-S_parieto_occipital"},2170:{color:[181,220,20],opacity:1,label:"ctx-rh-S_pericallosal"},2171:{color:[21,140,200],opacity:1,label:"ctx-rh-S_postcentral"},2172:{color:[21,20,240],opacity:1,label:"ctx-rh-S_precentral-Inferior-part"},2173:{color:[21,20,200],opacity:1,label:"ctx-rh-S_precentral-Superior-part"},2174:{color:[61,180,60],opacity:1,label:"ctx-rh-S_subcentral_ant"},2175:{color:[61,180,250],opacity:1,label:"ctx-rh-S_subcentral_post"},2176:{color:[21,20,60],opacity:1,label:"ctx-rh-S_suborbital"},2177:{color:[101,60,60],opacity:1,label:"ctx-rh-S_subparietal"},2178:{color:[21,220,220],opacity:1,label:"ctx-rh-S_supracingulate"},2179:{color:[21,180,180],opacity:1,label:"ctx-rh-S_temporal_inferior"},2180:{color:[223,220,60],opacity:1,label:"ctx-rh-S_temporal_superior"},2181:{color:[221,60,60],opacity:1,label:"ctx-rh-S_temporal_transverse"},2200:{color:[25,60,61],opacity:1,label:"ctx-rh-G_cingulate-caudal_ACC"},2201:{color:[25,90,60],opacity:1,label:"ctx-rh-G_cingulate-rostral_ACC"},2202:{color:[25,120,60],opacity:1,label:"ctx-rh-G_cingulate-posterior"},2205:{color:[25,150,60],opacity:1,label:"ctx-rh-S_cingulate-caudal_ACC"},2206:{color:[25,180,60],opacity:1,label:"ctx-rh-S_cingulate-rostral_ACC"},2207:{color:[25,210,60],opacity:1,label:"ctx-rh-S_cingulate-posterior"},2210:{color:[25,150,90],opacity:1,label:"ctx-rh-S_pericallosal-caudal"},2211:{color:[25,180,90],opacity:1,label:"ctx-rh-S_pericallosal-rostral"},2212:{color:[25,210,90],opacity:1,label:"ctx-rh-S_pericallosal-posterior"},3100:{color:[0,0,0],opacity:1,label:"wm-lh-Unknown"},3101:{color:[50,50,50],opacity:1,label:"wm-lh-Corpus_callosum"},3102:{color:[180,20,30],opacity:1,label:"wm-lh-G_and_S_Insula_ONLY_AVERAGE"},3103:{color:[60,25,25],opacity:1,label:"wm-lh-G_cingulate-Isthmus"},3104:{color:[25,60,60],opacity:1,label:"wm-lh-G_cingulate-Main_part"},3105:{color:[180,20,20],opacity:1,label:"wm-lh-G_cuneus"},3106:{color:[220,20,100],opacity:1,label:"wm-lh-G_frontal_inf-Opercular_part"},3107:{color:[140,60,60],opacity:1,label:"wm-lh-G_frontal_inf-Orbital_part"},3108:{color:[180,220,140],opacity:1,label:"wm-lh-G_frontal_inf-Triangular_part"},3109:{color:[140,100,180],opacity:1,label:"wm-lh-G_frontal_middle"},3110:{color:[180,20,140],opacity:1,label:"wm-lh-G_frontal_superior"},3111:{color:[140,20,140],opacity:1,label:"wm-lh-G_frontomarginal"},3112:{color:[21,10,10],opacity:1,label:"wm-lh-G_insular_long"},3113:{color:[225,140,140],opacity:1,label:"wm-lh-G_insular_short"},3114:{color:[23,60,180],opacity:1,label:"wm-lh-G_and_S_occipital_inferior"},3115:{color:[180,60,180],opacity:1,label:"wm-lh-G_occipital_middle"},3116:{color:[20,220,60],opacity:1,label:"wm-lh-G_occipital_superior"},3117:{color:[60,20,140],opacity:1,label:"wm-lh-G_occipit-temp_lat-Or_fusiform"},3118:{color:[220,180,140],opacity:1,label:"wm-lh-G_occipit-temp_med-Lingual_part"},3119:{color:[65,100,20],opacity:1,label:"wm-lh-G_occipit-temp_med-Parahippocampal_part"},3120:{color:[220,60,20],opacity:1,label:"wm-lh-G_orbital"},3121:{color:[60,100,60],opacity:1,label:"wm-lh-G_paracentral"},3122:{color:[20,60,220],opacity:1,label:"wm-lh-G_parietal_inferior-Angular_part"},3123:{color:[100,100,60],opacity:1,label:"wm-lh-G_parietal_inferior-Supramarginal_part"},3124:{color:[220,180,220],opacity:1,label:"wm-lh-G_parietal_superior"},3125:{color:[20,180,140],opacity:1,label:"wm-lh-G_postcentral"},3126:{color:[60,140,180],opacity:1,label:"wm-lh-G_precentral"},3127:{color:[25,20,140],opacity:1,label:"wm-lh-G_precuneus"},3128:{color:[20,60,100],opacity:1,label:"wm-lh-G_rectus"},3129:{color:[60,220,20],opacity:1,label:"wm-lh-G_subcallosal"},3130:{color:[60,20,220],opacity:1,label:"wm-lh-G_subcentral"},3131:{color:[220,220,100],opacity:1,label:"wm-lh-G_temporal_inferior"},3132:{color:[180,60,60],opacity:1,label:"wm-lh-G_temporal_middle"},3133:{color:[60,60,220],opacity:1,label:"wm-lh-G_temp_sup-G_temp_transv_and_interm_S"},3134:{color:[220,60,220],opacity:1,label:"wm-lh-G_temp_sup-Lateral_aspect"},3135:{color:[65,220,60],opacity:1,label:"wm-lh-G_temp_sup-Planum_polare"},3136:{color:[25,140,20],opacity:1,label:"wm-lh-G_temp_sup-Planum_tempolare"},3137:{color:[13,0,250],opacity:1,label:"wm-lh-G_and_S_transverse_frontopolar"},3138:{color:[61,20,220],opacity:1,label:"wm-lh-Lat_Fissure-ant_sgt-ramus_horizontal"},3139:{color:[61,20,60],opacity:1,label:"wm-lh-Lat_Fissure-ant_sgt-ramus_vertical"},3140:{color:[61,60,100],opacity:1,label:"wm-lh-Lat_Fissure-post_sgt"},3141:{color:[25,25,25],opacity:1,label:"wm-lh-Medial_wall"},3142:{color:[140,20,60],opacity:1,label:"wm-lh-Pole_occipital"},3143:{color:[220,180,20],opacity:1,label:"wm-lh-Pole_temporal"},3144:{color:[63,180,180],opacity:1,label:"wm-lh-S_calcarine"},3145:{color:[221,20,10],opacity:1,label:"wm-lh-S_central"},3146:{color:[21,220,20],opacity:1,label:"wm-lh-S_central_insula"},3147:{color:[183,100,20],opacity:1,label:"wm-lh-S_cingulate-Main_part_and_Intracingulate"},3148:{color:[221,20,100],opacity:1,label:"wm-lh-S_cingulate-Marginalis_part"},3149:{color:[221,60,140],opacity:1,label:"wm-lh-S_circular_insula_anterior"},3150:{color:[221,20,220],opacity:1,label:"wm-lh-S_circular_insula_inferior"},3151:{color:[61,220,220],opacity:1,label:"wm-lh-S_circular_insula_superior"},3152:{color:[100,200,200],opacity:1,label:"wm-lh-S_collateral_transverse_ant"},3153:{color:[10,200,200],opacity:1,label:"wm-lh-S_collateral_transverse_post"},3154:{color:[221,220,20],opacity:1,label:"wm-lh-S_frontal_inferior"},3155:{color:[141,20,100],opacity:1,label:"wm-lh-S_frontal_middle"},3156:{color:[61,220,100],opacity:1,label:"wm-lh-S_frontal_superior"},3157:{color:[21,220,60],opacity:1,label:"wm-lh-S_frontomarginal"},3158:{color:[141,60,20],opacity:1,label:"wm-lh-S_intermedius_primus-Jensen"},3159:{color:[143,20,220],opacity:1,label:"wm-lh-S_intraparietal-and_Parietal_transverse"},3160:{color:[61,20,180],opacity:1,label:"wm-lh-S_occipital_anterior"},3161:{color:[101,60,220],opacity:1,label:"wm-lh-S_occipital_middle_and_Lunatus"},3162:{color:[21,20,140],opacity:1,label:"wm-lh-S_occipital_superior_and_transversalis"},3163:{color:[221,140,20],opacity:1,label:"wm-lh-S_occipito-temporal_lateral"},3164:{color:[141,100,220],opacity:1,label:"wm-lh-S_occipito-temporal_medial_and_S_Lingual"},3165:{color:[101,20,20],opacity:1,label:"wm-lh-S_orbital-H_shapped"},3166:{color:[221,100,20],opacity:1,label:"wm-lh-S_orbital_lateral"},3167:{color:[181,200,20],opacity:1,label:"wm-lh-S_orbital_medial-Or_olfactory"},3168:{color:[21,180,140],opacity:1,label:"wm-lh-S_paracentral"},3169:{color:[101,100,180],opacity:1,label:"wm-lh-S_parieto_occipital"},3170:{color:[181,220,20],opacity:1,label:"wm-lh-S_pericallosal"},3171:{color:[21,140,200],opacity:1,label:"wm-lh-S_postcentral"},3172:{color:[21,20,240],opacity:1,label:"wm-lh-S_precentral-Inferior-part"},3173:{color:[21,20,200],opacity:1,label:"wm-lh-S_precentral-Superior-part"},3174:{color:[61,180,60],opacity:1,label:"wm-lh-S_subcentral_ant"},3175:{color:[61,180,250],opacity:1,label:"wm-lh-S_subcentral_post"},3176:{color:[21,20,60],opacity:1,label:"wm-lh-S_suborbital"},3177:{color:[101,60,60],opacity:1,label:"wm-lh-S_subparietal"},3178:{color:[21,220,220],opacity:1,label:"wm-lh-S_supracingulate"},3179:{color:[21,180,180],opacity:1,label:"wm-lh-S_temporal_inferior"},3180:{color:[223,220,60],opacity:1,label:"wm-lh-S_temporal_superior"},3181:{color:[221,60,60],opacity:1,label:"wm-lh-S_temporal_transverse"},4100:{color:[0,0,0],opacity:1,label:"wm-rh-Unknown"},4101:{color:[50,50,50],opacity:1,label:"wm-rh-Corpus_callosum"},4102:{color:[180,20,30],opacity:1,label:"wm-rh-G_and_S_Insula_ONLY_AVERAGE"},4103:{color:[60,25,25],opacity:1,label:"wm-rh-G_cingulate-Isthmus"},4104:{color:[25,60,60],opacity:1,label:"wm-rh-G_cingulate-Main_part"},4105:{color:[180,20,20],opacity:1,label:"wm-rh-G_cuneus"},4106:{color:[220,20,100],opacity:1,label:"wm-rh-G_frontal_inf-Opercular_part"},4107:{color:[140,60,60],opacity:1,label:"wm-rh-G_frontal_inf-Orbital_part"},4108:{color:[180,220,140],opacity:1,label:"wm-rh-G_frontal_inf-Triangular_part"},4109:{color:[140,100,180],opacity:1,label:"wm-rh-G_frontal_middle"},4110:{color:[180,20,140],opacity:1,label:"wm-rh-G_frontal_superior"},4111:{color:[140,20,140],opacity:1,label:"wm-rh-G_frontomarginal"},4112:{color:[21,10,10],opacity:1,label:"wm-rh-G_insular_long"},4113:{color:[225,140,140],opacity:1,label:"wm-rh-G_insular_short"},4114:{color:[23,60,180],opacity:1,label:"wm-rh-G_and_S_occipital_inferior"},4115:{color:[180,60,180],opacity:1,label:"wm-rh-G_occipital_middle"},4116:{color:[20,220,60],opacity:1,label:"wm-rh-G_occipital_superior"},4117:{color:[60,20,140],opacity:1,label:"wm-rh-G_occipit-temp_lat-Or_fusiform"},4118:{color:[220,180,140],opacity:1,label:"wm-rh-G_occipit-temp_med-Lingual_part"},4119:{color:[65,100,20],opacity:1,label:"wm-rh-G_occipit-temp_med-Parahippocampal_part"},4120:{color:[220,60,20],opacity:1,label:"wm-rh-G_orbital"},4121:{color:[60,100,60],opacity:1,label:"wm-rh-G_paracentral"},4122:{color:[20,60,220],opacity:1,label:"wm-rh-G_parietal_inferior-Angular_part"},4123:{color:[100,100,60],opacity:1,label:"wm-rh-G_parietal_inferior-Supramarginal_part"},4124:{color:[220,180,220],opacity:1,label:"wm-rh-G_parietal_superior"},4125:{color:[20,180,140],opacity:1,label:"wm-rh-G_postcentral"},4126:{color:[60,140,180],opacity:1,label:"wm-rh-G_precentral"},4127:{color:[25,20,140],opacity:1,label:"wm-rh-G_precuneus"},4128:{color:[20,60,100],opacity:1,label:"wm-rh-G_rectus"},4129:{color:[60,220,20],opacity:1,label:"wm-rh-G_subcallosal"},4130:{color:[60,20,220],opacity:1,label:"wm-rh-G_subcentral"},4131:{color:[220,220,100],opacity:1,label:"wm-rh-G_temporal_inferior"},4132:{color:[180,60,60],opacity:1,label:"wm-rh-G_temporal_middle"},4133:{color:[60,60,220],opacity:1,label:"wm-rh-G_temp_sup-G_temp_transv_and_interm_S"},4134:{color:[220,60,220],opacity:1,label:"wm-rh-G_temp_sup-Lateral_aspect"},4135:{color:[65,220,60],opacity:1,label:"wm-rh-G_temp_sup-Planum_polare"},4136:{color:[25,140,20],opacity:1,label:"wm-rh-G_temp_sup-Planum_tempolare"},4137:{color:[13,0,250],opacity:1,label:"wm-rh-G_and_S_transverse_frontopolar"},4138:{color:[61,20,220],opacity:1,label:"wm-rh-Lat_Fissure-ant_sgt-ramus_horizontal"},4139:{color:[61,20,60],opacity:1,label:"wm-rh-Lat_Fissure-ant_sgt-ramus_vertical"},4140:{color:[61,60,100],opacity:1,label:"wm-rh-Lat_Fissure-post_sgt"},4141:{color:[25,25,25],opacity:1,label:"wm-rh-Medial_wall"},4142:{color:[140,20,60],opacity:1,label:"wm-rh-Pole_occipital"},4143:{color:[220,180,20],opacity:1,label:"wm-rh-Pole_temporal"},4144:{color:[63,180,180],opacity:1,label:"wm-rh-S_calcarine"},4145:{color:[221,20,10],opacity:1,label:"wm-rh-S_central"},4146:{color:[21,220,20],opacity:1,label:"wm-rh-S_central_insula"},4147:{color:[183,100,20],opacity:1,label:"wm-rh-S_cingulate-Main_part_and_Intracingulate"},4148:{color:[221,20,100],opacity:1,label:"wm-rh-S_cingulate-Marginalis_part"},4149:{color:[221,60,140],opacity:1,label:"wm-rh-S_circular_insula_anterior"},4150:{color:[221,20,220],opacity:1,label:"wm-rh-S_circular_insula_inferior"},4151:{color:[61,220,220],opacity:1,label:"wm-rh-S_circular_insula_superior"},4152:{color:[100,200,200],opacity:1,label:"wm-rh-S_collateral_transverse_ant"},4153:{color:[10,200,200],opacity:1,label:"wm-rh-S_collateral_transverse_post"},4154:{color:[221,220,20],opacity:1,label:"wm-rh-S_frontal_inferior"},4155:{color:[141,20,100],opacity:1,label:"wm-rh-S_frontal_middle"},4156:{color:[61,220,100],opacity:1,label:"wm-rh-S_frontal_superior"},4157:{color:[21,220,60],opacity:1,label:"wm-rh-S_frontomarginal"},4158:{color:[141,60,20],opacity:1,label:"wm-rh-S_intermedius_primus-Jensen"},4159:{color:[143,20,220],opacity:1,label:"wm-rh-S_intraparietal-and_Parietal_transverse"},4160:{color:[61,20,180],opacity:1,label:"wm-rh-S_occipital_anterior"},4161:{color:[101,60,220],opacity:1,label:"wm-rh-S_occipital_middle_and_Lunatus"},4162:{color:[21,20,140],opacity:1,label:"wm-rh-S_occipital_superior_and_transversalis"},4163:{color:[221,140,20],opacity:1,label:"wm-rh-S_occipito-temporal_lateral"},4164:{color:[141,100,220],opacity:1,label:"wm-rh-S_occipito-temporal_medial_and_S_Lingual"},4165:{color:[101,20,20],opacity:1,label:"wm-rh-S_orbital-H_shapped"},4166:{color:[221,100,20],opacity:1,label:"wm-rh-S_orbital_lateral"},4167:{color:[181,200,20],opacity:1,label:"wm-rh-S_orbital_medial-Or_olfactory"},4168:{color:[21,180,140],opacity:1,label:"wm-rh-S_paracentral"},4169:{color:[101,100,180],opacity:1,label:"wm-rh-S_parieto_occipital"},4170:{color:[181,220,20],opacity:1,label:"wm-rh-S_pericallosal"},4171:{color:[21,140,200],opacity:1,label:"wm-rh-S_postcentral"},4172:{color:[21,20,240],opacity:1,label:"wm-rh-S_precentral-Inferior-part"},4173:{color:[21,20,200],opacity:1,label:"wm-rh-S_precentral-Superior-part"},4174:{color:[61,180,60],opacity:1,label:"wm-rh-S_subcentral_ant"},4175:{color:[61,180,250],opacity:1,label:"wm-rh-S_subcentral_post"},4176:{color:[21,20,60],opacity:1,label:"wm-rh-S_suborbital"},4177:{color:[101,60,60],opacity:1,label:"wm-rh-S_subparietal"},4178:{color:[21,220,220],opacity:1,label:"wm-rh-S_supracingulate"},4179:{color:[21,180,180],opacity:1,label:"wm-rh-S_temporal_inferior"},4180:{color:[223,220,60],opacity:1,label:"wm-rh-S_temporal_superior"},4181:{color:[221,60,60],opacity:1,label:"wm-rh-S_temporal_transverse"},5001:{color:[20,30,40],opacity:1,label:"Left-UnsegmentedWhiteMatter"},5002:{color:[20,30,40],opacity:1,label:"Right-UnsegmentedWhiteMatter"},5100:{color:[204,102,102],opacity:1,label:"fmajor"},5101:{color:[204,102,102],opacity:1,label:"fminor"},5102:{color:[255,255,102],opacity:1,label:"lh.atr"},5103:{color:[153,204,0],opacity:1,label:"lh.cab"},5104:{color:[0,153,153],opacity:1,label:"lh.ccg"},5105:{color:[204,153,255],opacity:1,label:"lh.cst"},5106:{color:[255,153,51],opacity:1,label:"lh.ilf"},5107:{color:[204,204,204],opacity:1,label:"lh.slfp"},5108:{color:[153,255,255],opacity:1,label:"lh.slft"},5109:{color:[102,153,255],opacity:1,label:"lh.unc"},5110:{color:[255,255,102],opacity:1,label:"rh.atr"},5111:{color:[153,204,0],opacity:1,label:"rh.cab"},5112:{color:[0,153,153],opacity:1,label:"rh.ccg"},5113:{color:[204,153,255],opacity:1,label:"rh.cst"},5114:{color:[255,153,51],opacity:1,label:"rh.ilf"},5115:{color:[204,204,204],opacity:1,label:"rh.slfp"},5116:{color:[153,255,255],opacity:1,label:"rh.slft"},5117:{color:[102,153,255],opacity:1,label:"rh.unc"},5200:{color:[204,102,102],opacity:1,label:"CC-ForcepsMajor"},5201:{color:[204,102,102],opacity:1,label:"CC-ForcepsMinor"},5202:{color:[255,255,102],opacity:1,label:"LAntThalRadiation"},5203:{color:[153,204,0],opacity:1,label:"LCingulumAngBundle"},5204:{color:[0,153,153],opacity:1,label:"LCingulumCingGyrus"},5205:{color:[204,153,255],opacity:1,label:"LCorticospinalTract"},5206:{color:[255,153,51],opacity:1,label:"LInfLongFas"},5207:{color:[204,204,204],opacity:1,label:"LSupLongFasParietal"},5208:{color:[153,255,255],opacity:1,label:"LSupLongFasTemporal"},5209:{color:[102,153,255],opacity:1,label:"LUncinateFas"},5210:{color:[255,255,102],opacity:1,label:"RAntThalRadiation"},5211:{color:[153,204,0],opacity:1,label:"RCingulumAngBundle"},5212:{color:[0,153,153],opacity:1,label:"RCingulumCingGyrus"},5213:{color:[204,153,255],opacity:1,label:"RCorticospinalTract"},5214:{color:[255,153,51],opacity:1,label:"RInfLongFas"},5215:{color:[204,204,204],opacity:1,label:"RSupLongFasParietal"},5216:{color:[153,255,255],opacity:1,label:"RSupLongFasTemporal"},5217:{color:[102,153,255],opacity:1,label:"RUncinateFas"},6000:{color:[0,255,0],opacity:1,label:"CST-orig"},6001:{color:[255,255,0],opacity:1,label:"CST-hammer"},6002:{color:[0,255,255],opacity:1,label:"CST-CVS"},6003:{color:[0,0,255],opacity:1,label:"CST-flirt"},6010:{color:[236,16,231],opacity:1,label:"Left-SLF1"},6020:{color:[237,18,232],opacity:1,label:"Right-SLF1"},6030:{color:[236,13,227],opacity:1,label:"Left-SLF3"},6040:{color:[236,17,228],opacity:1,label:"Right-SLF3"},6050:{color:[1,255,1],opacity:1,label:"Left-CST"},6060:{color:[2,255,1],opacity:1,label:"Right-CST"},6070:{color:[236,14,230],opacity:1,label:"Left-SLF2"},6080:{color:[237,14,230],opacity:1,label:"Right-SLF2"},7001:{color:[72,132,181],opacity:1,label:"Lateral-nucleus"},7002:{color:[243,243,243],opacity:1,label:"Basolateral-nucleus"},7003:{color:[207,63,79],opacity:1,label:"Basal-nucleus"},7004:{color:[121,20,135],opacity:1,label:"Centromedial-nucleus"},7005:{color:[197,60,248],opacity:1,label:"Central-nucleus"},7006:{color:[2,149,2],opacity:1,label:"Medial-nucleus"},7007:{color:[221,249,166],opacity:1,label:"Cortical-nucleus"},7008:{color:[232,146,35],opacity:1,label:"Accessory-Basal-nucleus"},7009:{color:[20,60,120],opacity:1,label:"Corticoamygdaloid-transitio"},7010:{color:[250,250,0],opacity:1,label:"Anterior-amygdaloid-area-AAA"},7011:{color:[122,187,222],opacity:1,label:"Fusion-amygdala-HP-FAH"},7012:{color:[237,12,177],opacity:1,label:"Hippocampal-amygdala-transition-HATA"},7013:{color:[10,49,255],opacity:1,label:"Endopiriform-nucleus"},7014:{color:[205,184,144],opacity:1,label:"Lateral-nucleus-olfactory-tract"},7015:{color:[45,205,165],opacity:1,label:"Paralaminar-nucleus"},7016:{color:[117,160,175],opacity:1,label:"Intercalated-nucleus"},7017:{color:[221,217,21],opacity:1,label:"Prepiriform-cortex"},7018:{color:[20,60,120],opacity:1,label:"Periamygdaloid-cortex"},7019:{color:[141,21,100],opacity:1,label:"Envelope-Amygdala"},7020:{color:[225,140,141],opacity:1,label:"Extranuclear-Amydala"},7100:{color:[42,201,168],opacity:1,label:"Brainstem-inferior-colliculus"},7101:{color:[168,104,162],opacity:1,label:"Brainstem-cochlear-nucleus"},8001:{color:[74,130,181],opacity:1,label:"Thalamus-Anterior"},8002:{color:[242,241,240],opacity:1,label:"Thalamus-Ventral-anterior"},8003:{color:[206,65,78],opacity:1,label:"Thalamus-Lateral-dorsal"},8004:{color:[120,21,133],opacity:1,label:"Thalamus-Lateral-posterior"},8005:{color:[195,61,246],opacity:1,label:"Thalamus-Ventral-lateral"},8006:{color:[3,147,6],opacity:1,label:"Thalamus-Ventral-posterior-medial"},8007:{color:[220,251,163],opacity:1,label:"Thalamus-Ventral-posterior-lateral"},8008:{color:[232,146,33],opacity:1,label:"Thalamus-intralaminar"},8009:{color:[4,114,14],opacity:1,label:"Thalamus-centromedian"},8010:{color:[121,184,220],opacity:1,label:"Thalamus-mediodorsal"},8011:{color:[235,11,175],opacity:1,label:"Thalamus-medial"},8012:{color:[12,46,250],opacity:1,label:"Thalamus-pulvinar"},8013:{color:[203,182,143],opacity:1,label:"Thalamus-lateral-geniculate"},8014:{color:[42,204,167],opacity:1,label:"Thalamus-medial-geniculate"},9000:{color:[50,100,30],opacity:1,label:"ctx-lh-prefrontal"},9001:{color:[30,100,45],opacity:1,label:"ctx-lh-primary-motor"},9002:{color:[130,100,165],opacity:1,label:"ctx-lh-premotor"},9003:{color:[105,25,5],opacity:1,label:"ctx-lh-temporal"},9004:{color:[125,70,55],opacity:1,label:"ctx-lh-posterior-parietal"},9005:{color:[225,20,105],opacity:1,label:"ctx-lh-prim-sec-somatosensory"},9006:{color:[225,20,15],opacity:1,label:"ctx-lh-occipital"},9500:{color:[50,200,30],opacity:1,label:"ctx-rh-prefrontal"},9501:{color:[30,150,45],opacity:1,label:"ctx-rh-primary-motor"},9502:{color:[130,150,165],opacity:1,label:"ctx-rh-premotor"},9503:{color:[105,75,5],opacity:1,label:"ctx-rh-temporal"},9504:{color:[125,120,55],opacity:1,label:"ctx-rh-posterior-parietal"},9505:{color:[225,70,105],opacity:1,label:"ctx-rh-prim-sec-somatosensory"},9506:{color:[225,70,15],opacity:1,label:"ctx-rh-occipital"},11100:{color:[0,0,0],opacity:1,label:"ctx_lh_Unknown"},11101:{color:[23,220,60],opacity:1,label:"ctx_lh_G_and_S_frontomargin"},11102:{color:[23,60,180],opacity:1,label:"ctx_lh_G_and_S_occipital_inf"},11103:{color:[63,100,60],opacity:1,label:"ctx_lh_G_and_S_paracentral"},11104:{color:[63,20,220],opacity:1,label:"ctx_lh_G_and_S_subcentral"},11105:{color:[13,0,250],opacity:1,label:"ctx_lh_G_and_S_transv_frontopol"},11106:{color:[26,60,0],opacity:1,label:"ctx_lh_G_and_S_cingul-Ant"},11107:{color:[26,60,75],opacity:1,label:"ctx_lh_G_and_S_cingul-Mid-Ant"},11108:{color:[26,60,150],opacity:1,label:"ctx_lh_G_and_S_cingul-Mid-Post"},11109:{color:[25,60,250],opacity:1,label:"ctx_lh_G_cingul-Post-dorsal"},11110:{color:[60,25,25],opacity:1,label:"ctx_lh_G_cingul-Post-ventral"},11111:{color:[180,20,20],opacity:1,label:"ctx_lh_G_cuneus"},11112:{color:[220,20,100],opacity:1,label:"ctx_lh_G_front_inf-Opercular"},11113:{color:[140,60,60],opacity:1,label:"ctx_lh_G_front_inf-Orbital"},11114:{color:[180,220,140],opacity:1,label:"ctx_lh_G_front_inf-Triangul"},11115:{color:[140,100,180],opacity:1,label:"ctx_lh_G_front_middle"},11116:{color:[180,20,140],opacity:1,label:"ctx_lh_G_front_sup"},11117:{color:[23,10,10],opacity:1,label:"ctx_lh_G_Ins_lg_and_S_cent_ins"},11118:{color:[225,140,140],opacity:1,label:"ctx_lh_G_insular_short"},11119:{color:[180,60,180],opacity:1,label:"ctx_lh_G_occipital_middle"},11120:{color:[20,220,60],opacity:1,label:"ctx_lh_G_occipital_sup"},11121:{color:[60,20,140],opacity:1,label:"ctx_lh_G_oc-temp_lat-fusifor"},11122:{color:[220,180,140],opacity:1,label:"ctx_lh_G_oc-temp_med-Lingual"},11123:{color:[65,100,20],opacity:1,label:"ctx_lh_G_oc-temp_med-Parahip"},11124:{color:[220,60,20],opacity:1,label:"ctx_lh_G_orbital"},11125:{color:[20,60,220],opacity:1,label:"ctx_lh_G_pariet_inf-Angular"},11126:{color:[100,100,60],opacity:1,label:"ctx_lh_G_pariet_inf-Supramar"},11127:{color:[220,180,220],opacity:1,label:"ctx_lh_G_parietal_sup"},11128:{color:[20,180,140],opacity:1,label:"ctx_lh_G_postcentral"},11129:{color:[60,140,180],opacity:1,label:"ctx_lh_G_precentral"},11130:{color:[25,20,140],opacity:1,label:"ctx_lh_G_precuneus"},11131:{color:[20,60,100],opacity:1,label:"ctx_lh_G_rectus"},11132:{color:[60,220,20],opacity:1,label:"ctx_lh_G_subcallosal"},11133:{color:[60,60,220],opacity:1,label:"ctx_lh_G_temp_sup-G_T_transv"},11134:{color:[220,60,220],opacity:1,label:"ctx_lh_G_temp_sup-Lateral"},11135:{color:[65,220,60],opacity:1,label:"ctx_lh_G_temp_sup-Plan_polar"},11136:{color:[25,140,20],opacity:1,label:"ctx_lh_G_temp_sup-Plan_tempo"},11137:{color:[220,220,100],opacity:1,label:"ctx_lh_G_temporal_inf"},11138:{color:[180,60,60],opacity:1,label:"ctx_lh_G_temporal_middle"},11139:{color:[61,20,220],opacity:1,label:"ctx_lh_Lat_Fis-ant-Horizont"},11140:{color:[61,20,60],opacity:1,label:"ctx_lh_Lat_Fis-ant-Vertical"},11141:{color:[61,60,100],opacity:1,label:"ctx_lh_Lat_Fis-post"},11142:{color:[25,25,25],opacity:1,label:"ctx_lh_Medial_wall"},11143:{color:[140,20,60],opacity:1,label:"ctx_lh_Pole_occipital"},11144:{color:[220,180,20],opacity:1,label:"ctx_lh_Pole_temporal"},11145:{color:[63,180,180],opacity:1,label:"ctx_lh_S_calcarine"},11146:{color:[221,20,10],opacity:1,label:"ctx_lh_S_central"},11147:{color:[221,20,100],opacity:1,label:"ctx_lh_S_cingul-Marginalis"},11148:{color:[221,60,140],opacity:1,label:"ctx_lh_S_circular_insula_ant"},11149:{color:[221,20,220],opacity:1,label:"ctx_lh_S_circular_insula_inf"},11150:{color:[61,220,220],opacity:1,label:"ctx_lh_S_circular_insula_sup"},11151:{color:[100,200,200],opacity:1,label:"ctx_lh_S_collat_transv_ant"},11152:{color:[10,200,200],opacity:1,label:"ctx_lh_S_collat_transv_post"},11153:{color:[221,220,20],opacity:1,label:"ctx_lh_S_front_inf"},11154:{color:[141,20,100],opacity:1,label:"ctx_lh_S_front_middle"},11155:{color:[61,220,100],opacity:1,label:"ctx_lh_S_front_sup"},11156:{color:[141,60,20],opacity:1,label:"ctx_lh_S_interm_prim-Jensen"},11157:{color:[143,20,220],opacity:1,label:"ctx_lh_S_intrapariet_and_P_trans"},11158:{color:[101,60,220],opacity:1,label:"ctx_lh_S_oc_middle_and_Lunatus"},11159:{color:[21,20,140],opacity:1,label:"ctx_lh_S_oc_sup_and_transversal"},11160:{color:[61,20,180],opacity:1,label:"ctx_lh_S_occipital_ant"},11161:{color:[221,140,20],opacity:1,label:"ctx_lh_S_oc-temp_lat"},11162:{color:[141,100,220],opacity:1,label:"ctx_lh_S_oc-temp_med_and_Lingual"},11163:{color:[221,100,20],opacity:1,label:"ctx_lh_S_orbital_lateral"},11164:{color:[181,200,20],opacity:1,label:"ctx_lh_S_orbital_med-olfact"},11165:{color:[101,20,20],opacity:1,label:"ctx_lh_S_orbital-H_Shaped"},11166:{color:[101,100,180],opacity:1,label:"ctx_lh_S_parieto_occipital"},11167:{color:[181,220,20],opacity:1,label:"ctx_lh_S_pericallosal"},11168:{color:[21,140,200],opacity:1,label:"ctx_lh_S_postcentral"},11169:{color:[21,20,240],opacity:1,label:"ctx_lh_S_precentral-inf-part"},11170:{color:[21,20,200],opacity:1,label:"ctx_lh_S_precentral-sup-part"},11171:{color:[21,20,60],opacity:1,label:"ctx_lh_S_suborbital"},11172:{color:[101,60,60],opacity:1,label:"ctx_lh_S_subparietal"},11173:{color:[21,180,180],opacity:1,label:"ctx_lh_S_temporal_inf"},11174:{color:[223,220,60],opacity:1,label:"ctx_lh_S_temporal_sup"},11175:{color:[221,60,60],opacity:1,label:"ctx_lh_S_temporal_transverse"},12100:{color:[0,0,0],opacity:1,label:"ctx_rh_Unknown"},12101:{color:[23,220,60],opacity:1,label:"ctx_rh_G_and_S_frontomargin"},12102:{color:[23,60,180],opacity:1,label:"ctx_rh_G_and_S_occipital_inf"},12103:{color:[63,100,60],opacity:1,label:"ctx_rh_G_and_S_paracentral"},12104:{color:[63,20,220],opacity:1,label:"ctx_rh_G_and_S_subcentral"},12105:{color:[13,0,250],opacity:1,label:"ctx_rh_G_and_S_transv_frontopol"},12106:{color:[26,60,0],opacity:1,label:"ctx_rh_G_and_S_cingul-Ant"},12107:{color:[26,60,75],opacity:1,label:"ctx_rh_G_and_S_cingul-Mid-Ant"},12108:{color:[26,60,150],opacity:1,label:"ctx_rh_G_and_S_cingul-Mid-Post"},12109:{color:[25,60,250],opacity:1,label:"ctx_rh_G_cingul-Post-dorsal"},12110:{color:[60,25,25],opacity:1,label:"ctx_rh_G_cingul-Post-ventral"},12111:{color:[180,20,20],opacity:1,label:"ctx_rh_G_cuneus"},12112:{color:[220,20,100],opacity:1,label:"ctx_rh_G_front_inf-Opercular"},12113:{color:[140,60,60],opacity:1,label:"ctx_rh_G_front_inf-Orbital"},12114:{color:[180,220,140],opacity:1,label:"ctx_rh_G_front_inf-Triangul"},12115:{color:[140,100,180],opacity:1,label:"ctx_rh_G_front_middle"},12116:{color:[180,20,140],opacity:1,label:"ctx_rh_G_front_sup"},12117:{color:[23,10,10],opacity:1,label:"ctx_rh_G_Ins_lg_and_S_cent_ins"},12118:{color:[225,140,140],opacity:1,label:"ctx_rh_G_insular_short"},12119:{color:[180,60,180],opacity:1,label:"ctx_rh_G_occipital_middle"},12120:{color:[20,220,60],opacity:1,label:"ctx_rh_G_occipital_sup"},12121:{color:[60,20,140],opacity:1,label:"ctx_rh_G_oc-temp_lat-fusifor"},12122:{color:[220,180,140],opacity:1,label:"ctx_rh_G_oc-temp_med-Lingual"},12123:{color:[65,100,20],opacity:1,label:"ctx_rh_G_oc-temp_med-Parahip"},12124:{color:[220,60,20],opacity:1,label:"ctx_rh_G_orbital"},12125:{color:[20,60,220],opacity:1,label:"ctx_rh_G_pariet_inf-Angular"},12126:{color:[100,100,60],opacity:1,label:"ctx_rh_G_pariet_inf-Supramar"},12127:{color:[220,180,220],opacity:1,label:"ctx_rh_G_parietal_sup"},12128:{color:[20,180,140],opacity:1,label:"ctx_rh_G_postcentral"},12129:{color:[60,140,180],opacity:1,label:"ctx_rh_G_precentral"},12130:{color:[25,20,140],opacity:1,label:"ctx_rh_G_precuneus"},12131:{color:[20,60,100],opacity:1,label:"ctx_rh_G_rectus"},12132:{color:[60,220,20],opacity:1,label:"ctx_rh_G_subcallosal"},12133:{color:[60,60,220],opacity:1,label:"ctx_rh_G_temp_sup-G_T_transv"},12134:{color:[220,60,220],opacity:1,label:"ctx_rh_G_temp_sup-Lateral"},12135:{color:[65,220,60],opacity:1,label:"ctx_rh_G_temp_sup-Plan_polar"},12136:{color:[25,140,20],opacity:1,label:"ctx_rh_G_temp_sup-Plan_tempo"},12137:{color:[220,220,100],opacity:1,label:"ctx_rh_G_temporal_inf"},12138:{color:[180,60,60],opacity:1,label:"ctx_rh_G_temporal_middle"},12139:{color:[61,20,220],opacity:1,label:"ctx_rh_Lat_Fis-ant-Horizont"},12140:{color:[61,20,60],opacity:1,label:"ctx_rh_Lat_Fis-ant-Vertical"},12141:{color:[61,60,100],opacity:1,label:"ctx_rh_Lat_Fis-post"},12142:{color:[25,25,25],opacity:1,label:"ctx_rh_Medial_wall"},12143:{color:[140,20,60],opacity:1,label:"ctx_rh_Pole_occipital"},12144:{color:[220,180,20],opacity:1,label:"ctx_rh_Pole_temporal"},12145:{color:[63,180,180],opacity:1,label:"ctx_rh_S_calcarine"},12146:{color:[221,20,10],opacity:1,label:"ctx_rh_S_central"},12147:{color:[221,20,100],opacity:1,label:"ctx_rh_S_cingul-Marginalis"},12148:{color:[221,60,140],opacity:1,label:"ctx_rh_S_circular_insula_ant"},12149:{color:[221,20,220],opacity:1,label:"ctx_rh_S_circular_insula_inf"},12150:{color:[61,220,220],opacity:1,label:"ctx_rh_S_circular_insula_sup"},12151:{color:[100,200,200],opacity:1,label:"ctx_rh_S_collat_transv_ant"},12152:{color:[10,200,200],opacity:1,label:"ctx_rh_S_collat_transv_post"},12153:{color:[221,220,20],opacity:1,label:"ctx_rh_S_front_inf"},12154:{color:[141,20,100],opacity:1,label:"ctx_rh_S_front_middle"},12155:{color:[61,220,100],opacity:1,label:"ctx_rh_S_front_sup"},12156:{color:[141,60,20],opacity:1,label:"ctx_rh_S_interm_prim-Jensen"},12157:{color:[143,20,220],opacity:1,label:"ctx_rh_S_intrapariet_and_P_trans"},12158:{color:[101,60,220],opacity:1,label:"ctx_rh_S_oc_middle_and_Lunatus"},12159:{color:[21,20,140],opacity:1,label:"ctx_rh_S_oc_sup_and_transversal"},12160:{color:[61,20,180],opacity:1,label:"ctx_rh_S_occipital_ant"},12161:{color:[221,140,20],opacity:1,label:"ctx_rh_S_oc-temp_lat"},12162:{color:[141,100,220],opacity:1,label:"ctx_rh_S_oc-temp_med_and_Lingual"},12163:{color:[221,100,20],opacity:1,label:"ctx_rh_S_orbital_lateral"},12164:{color:[181,200,20],opacity:1,label:"ctx_rh_S_orbital_med-olfact"},12165:{color:[101,20,20],opacity:1,label:"ctx_rh_S_orbital-H_Shaped"},12166:{color:[101,100,180],opacity:1,label:"ctx_rh_S_parieto_occipital"},12167:{color:[181,220,20],opacity:1,label:"ctx_rh_S_pericallosal"},12168:{color:[21,140,200],opacity:1,label:"ctx_rh_S_postcentral"},12169:{color:[21,20,240],opacity:1,label:"ctx_rh_S_precentral-inf-part"},12170:{color:[21,20,200],opacity:1,label:"ctx_rh_S_precentral-sup-part"},12171:{color:[21,20,60],opacity:1,label:"ctx_rh_S_suborbital"},12172:{color:[101,60,60],opacity:1,label:"ctx_rh_S_subparietal"},12173:{color:[21,180,180],opacity:1,label:"ctx_rh_S_temporal_inf"},12174:{color:[223,220,60],opacity:1,label:"ctx_rh_S_temporal_sup"},12175:{color:[221,60,60],opacity:1,label:"ctx_rh_S_temporal_transverse"},13100:{color:[0,0,0],opacity:1,label:"wm_lh_Unknown"},13101:{color:[23,220,60],opacity:1,label:"wm_lh_G_and_S_frontomargin"},13102:{color:[23,60,180],opacity:1,label:"wm_lh_G_and_S_occipital_inf"},13103:{color:[63,100,60],opacity:1,label:"wm_lh_G_and_S_paracentral"},13104:{color:[63,20,220],opacity:1,label:"wm_lh_G_and_S_subcentral"},13105:{color:[13,0,250],opacity:1,label:"wm_lh_G_and_S_transv_frontopol"},13106:{color:[26,60,0],opacity:1,label:"wm_lh_G_and_S_cingul-Ant"},13107:{color:[26,60,75],opacity:1,label:"wm_lh_G_and_S_cingul-Mid-Ant"},13108:{color:[26,60,150],opacity:1,label:"wm_lh_G_and_S_cingul-Mid-Post"},13109:{color:[25,60,250],opacity:1,label:"wm_lh_G_cingul-Post-dorsal"},13110:{color:[60,25,25],opacity:1,label:"wm_lh_G_cingul-Post-ventral"},13111:{color:[180,20,20],opacity:1,label:"wm_lh_G_cuneus"},13112:{color:[220,20,100],opacity:1,label:"wm_lh_G_front_inf-Opercular"},13113:{color:[140,60,60],opacity:1,label:"wm_lh_G_front_inf-Orbital"},13114:{color:[180,220,140],opacity:1,label:"wm_lh_G_front_inf-Triangul"},13115:{color:[140,100,180],opacity:1,label:"wm_lh_G_front_middle"},13116:{color:[180,20,140],opacity:1,label:"wm_lh_G_front_sup"},13117:{color:[23,10,10],opacity:1,label:"wm_lh_G_Ins_lg_and_S_cent_ins"},13118:{color:[225,140,140],opacity:1,label:"wm_lh_G_insular_short"},13119:{color:[180,60,180],opacity:1,label:"wm_lh_G_occipital_middle"},13120:{color:[20,220,60],opacity:1,label:"wm_lh_G_occipital_sup"},13121:{color:[60,20,140],opacity:1,label:"wm_lh_G_oc-temp_lat-fusifor"},13122:{color:[220,180,140],opacity:1,label:"wm_lh_G_oc-temp_med-Lingual"},13123:{color:[65,100,20],opacity:1,label:"wm_lh_G_oc-temp_med-Parahip"},13124:{color:[220,60,20],opacity:1,label:"wm_lh_G_orbital"},13125:{color:[20,60,220],opacity:1,label:"wm_lh_G_pariet_inf-Angular"},13126:{color:[100,100,60],opacity:1,label:"wm_lh_G_pariet_inf-Supramar"},13127:{color:[220,180,220],opacity:1,label:"wm_lh_G_parietal_sup"},13128:{color:[20,180,140],opacity:1,label:"wm_lh_G_postcentral"},13129:{color:[60,140,180],opacity:1,label:"wm_lh_G_precentral"},13130:{color:[25,20,140],opacity:1,label:"wm_lh_G_precuneus"},13131:{color:[20,60,100],opacity:1,label:"wm_lh_G_rectus"},13132:{color:[60,220,20],opacity:1,label:"wm_lh_G_subcallosal"},13133:{color:[60,60,220],opacity:1,label:"wm_lh_G_temp_sup-G_T_transv"},13134:{color:[220,60,220],opacity:1,label:"wm_lh_G_temp_sup-Lateral"},13135:{color:[65,220,60],opacity:1,label:"wm_lh_G_temp_sup-Plan_polar"},13136:{color:[25,140,20],opacity:1,label:"wm_lh_G_temp_sup-Plan_tempo"},13137:{color:[220,220,100],opacity:1,label:"wm_lh_G_temporal_inf"},13138:{color:[180,60,60],opacity:1,label:"wm_lh_G_temporal_middle"},13139:{color:[61,20,220],opacity:1,label:"wm_lh_Lat_Fis-ant-Horizont"},13140:{color:[61,20,60],opacity:1,label:"wm_lh_Lat_Fis-ant-Vertical"},13141:{color:[61,60,100],opacity:1,label:"wm_lh_Lat_Fis-post"},13142:{color:[25,25,25],opacity:1,label:"wm_lh_Medial_wall"},13143:{color:[140,20,60],opacity:1,label:"wm_lh_Pole_occipital"},13144:{color:[220,180,20],opacity:1,label:"wm_lh_Pole_temporal"},13145:{color:[63,180,180],opacity:1,label:"wm_lh_S_calcarine"},13146:{color:[221,20,10],opacity:1,label:"wm_lh_S_central"},13147:{color:[221,20,100],opacity:1,label:"wm_lh_S_cingul-Marginalis"},13148:{color:[221,60,140],opacity:1,label:"wm_lh_S_circular_insula_ant"},13149:{color:[221,20,220],opacity:1,label:"wm_lh_S_circular_insula_inf"},13150:{color:[61,220,220],opacity:1,label:"wm_lh_S_circular_insula_sup"},13151:{color:[100,200,200],opacity:1,label:"wm_lh_S_collat_transv_ant"},13152:{color:[10,200,200],opacity:1,label:"wm_lh_S_collat_transv_post"},13153:{color:[221,220,20],opacity:1,label:"wm_lh_S_front_inf"},13154:{color:[141,20,100],opacity:1,label:"wm_lh_S_front_middle"},13155:{color:[61,220,100],opacity:1,label:"wm_lh_S_front_sup"},13156:{color:[141,60,20],opacity:1,label:"wm_lh_S_interm_prim-Jensen"},13157:{color:[143,20,220],opacity:1,label:"wm_lh_S_intrapariet_and_P_trans"},13158:{color:[101,60,220],opacity:1,label:"wm_lh_S_oc_middle_and_Lunatus"},13159:{color:[21,20,140],opacity:1,label:"wm_lh_S_oc_sup_and_transversal"},13160:{color:[61,20,180],opacity:1,label:"wm_lh_S_occipital_ant"},13161:{color:[221,140,20],opacity:1,label:"wm_lh_S_oc-temp_lat"},13162:{color:[141,100,220],opacity:1,label:"wm_lh_S_oc-temp_med_and_Lingual"},13163:{color:[221,100,20],opacity:1,label:"wm_lh_S_orbital_lateral"},13164:{color:[181,200,20],opacity:1,label:"wm_lh_S_orbital_med-olfact"},13165:{color:[101,20,20],opacity:1,label:"wm_lh_S_orbital-H_Shaped"},13166:{color:[101,100,180],opacity:1,label:"wm_lh_S_parieto_occipital"},13167:{color:[181,220,20],opacity:1,label:"wm_lh_S_pericallosal"},13168:{color:[21,140,200],opacity:1,label:"wm_lh_S_postcentral"},13169:{color:[21,20,240],opacity:1,label:"wm_lh_S_precentral-inf-part"},13170:{color:[21,20,200],opacity:1,label:"wm_lh_S_precentral-sup-part"},13171:{color:[21,20,60],opacity:1,label:"wm_lh_S_suborbital"},13172:{color:[101,60,60],opacity:1,label:"wm_lh_S_subparietal"},13173:{color:[21,180,180],opacity:1,label:"wm_lh_S_temporal_inf"},13174:{color:[223,220,60],opacity:1,label:"wm_lh_S_temporal_sup"},13175:{color:[221,60,60],opacity:1,label:"wm_lh_S_temporal_transverse"},14100:{color:[0,0,0],opacity:1,label:"wm_rh_Unknown"},14101:{color:[23,220,60],opacity:1,label:"wm_rh_G_and_S_frontomargin"},14102:{color:[23,60,180],opacity:1,label:"wm_rh_G_and_S_occipital_inf"},14103:{color:[63,100,60],opacity:1,label:"wm_rh_G_and_S_paracentral"},14104:{color:[63,20,220],opacity:1,label:"wm_rh_G_and_S_subcentral"},14105:{color:[13,0,250],opacity:1,label:"wm_rh_G_and_S_transv_frontopol"},14106:{color:[26,60,0],opacity:1,label:"wm_rh_G_and_S_cingul-Ant"},14107:{color:[26,60,75],opacity:1,label:"wm_rh_G_and_S_cingul-Mid-Ant"},14108:{color:[26,60,150],opacity:1,label:"wm_rh_G_and_S_cingul-Mid-Post"},14109:{color:[25,60,250],opacity:1,label:"wm_rh_G_cingul-Post-dorsal"},14110:{color:[60,25,25],opacity:1,label:"wm_rh_G_cingul-Post-ventral"},14111:{color:[180,20,20],opacity:1,label:"wm_rh_G_cuneus"},14112:{color:[220,20,100],opacity:1,label:"wm_rh_G_front_inf-Opercular"},14113:{color:[140,60,60],opacity:1,label:"wm_rh_G_front_inf-Orbital"},14114:{color:[180,220,140],opacity:1,label:"wm_rh_G_front_inf-Triangul"},14115:{color:[140,100,180],opacity:1,label:"wm_rh_G_front_middle"},14116:{color:[180,20,140],opacity:1,label:"wm_rh_G_front_sup"},14117:{color:[23,10,10],opacity:1,label:"wm_rh_G_Ins_lg_and_S_cent_ins"},14118:{color:[225,140,140],opacity:1,label:"wm_rh_G_insular_short"},14119:{color:[180,60,180],opacity:1,label:"wm_rh_G_occipital_middle"},14120:{color:[20,220,60],opacity:1,label:"wm_rh_G_occipital_sup"},14121:{color:[60,20,140],opacity:1,label:"wm_rh_G_oc-temp_lat-fusifor"},14122:{color:[220,180,140],opacity:1,label:"wm_rh_G_oc-temp_med-Lingual"},14123:{color:[65,100,20],opacity:1,label:"wm_rh_G_oc-temp_med-Parahip"},14124:{color:[220,60,20],opacity:1,label:"wm_rh_G_orbital"},14125:{color:[20,60,220],opacity:1,label:"wm_rh_G_pariet_inf-Angular"},14126:{color:[100,100,60],opacity:1,label:"wm_rh_G_pariet_inf-Supramar"},14127:{color:[220,180,220],opacity:1,label:"wm_rh_G_parietal_sup"},14128:{color:[20,180,140],opacity:1,label:"wm_rh_G_postcentral"},14129:{color:[60,140,180],opacity:1,label:"wm_rh_G_precentral"},14130:{color:[25,20,140],opacity:1,label:"wm_rh_G_precuneus"},14131:{color:[20,60,100],opacity:1,label:"wm_rh_G_rectus"},14132:{color:[60,220,20],opacity:1,label:"wm_rh_G_subcallosal"},14133:{color:[60,60,220],opacity:1,label:"wm_rh_G_temp_sup-G_T_transv"},14134:{color:[220,60,220],opacity:1,label:"wm_rh_G_temp_sup-Lateral"},14135:{color:[65,220,60],opacity:1,label:"wm_rh_G_temp_sup-Plan_polar"},14136:{color:[25,140,20],opacity:1,label:"wm_rh_G_temp_sup-Plan_tempo"},14137:{color:[220,220,100],opacity:1,label:"wm_rh_G_temporal_inf"},14138:{color:[180,60,60],opacity:1,label:"wm_rh_G_temporal_middle"},14139:{color:[61,20,220],opacity:1,label:"wm_rh_Lat_Fis-ant-Horizont"},14140:{color:[61,20,60],opacity:1,label:"wm_rh_Lat_Fis-ant-Vertical"},14141:{color:[61,60,100],opacity:1,label:"wm_rh_Lat_Fis-post"},14142:{color:[25,25,25],opacity:1,label:"wm_rh_Medial_wall"},14143:{color:[140,20,60],opacity:1,label:"wm_rh_Pole_occipital"},14144:{color:[220,180,20],opacity:1,label:"wm_rh_Pole_temporal"},14145:{color:[63,180,180],opacity:1,label:"wm_rh_S_calcarine"},14146:{color:[221,20,10],opacity:1,label:"wm_rh_S_central"},14147:{color:[221,20,100],opacity:1,label:"wm_rh_S_cingul-Marginalis"},14148:{color:[221,60,140],opacity:1,label:"wm_rh_S_circular_insula_ant"},14149:{color:[221,20,220],opacity:1,label:"wm_rh_S_circular_insula_inf"},14150:{color:[61,220,220],opacity:1,label:"wm_rh_S_circular_insula_sup"},14151:{color:[100,200,200],opacity:1,label:"wm_rh_S_collat_transv_ant"},14152:{color:[10,200,200],opacity:1,label:"wm_rh_S_collat_transv_post"},14153:{color:[221,220,20],opacity:1,label:"wm_rh_S_front_inf"},14154:{color:[141,20,100],opacity:1,label:"wm_rh_S_front_middle"},14155:{color:[61,220,100],opacity:1,label:"wm_rh_S_front_sup"},14156:{color:[141,60,20],opacity:1,label:"wm_rh_S_interm_prim-Jensen"},14157:{color:[143,20,220],opacity:1,label:"wm_rh_S_intrapariet_and_P_trans"},14158:{color:[101,60,220],opacity:1,label:"wm_rh_S_oc_middle_and_Lunatus"},14159:{color:[21,20,140],opacity:1,label:"wm_rh_S_oc_sup_and_transversal"},14160:{color:[61,20,180],opacity:1,label:"wm_rh_S_occipital_ant"},14161:{color:[221,140,20],opacity:1,label:"wm_rh_S_oc-temp_lat"},14162:{color:[141,100,220],opacity:1,label:"wm_rh_S_oc-temp_med_and_Lingual"},14163:{color:[221,100,20],opacity:1,label:"wm_rh_S_orbital_lateral"},14164:{color:[181,200,20],opacity:1,label:"wm_rh_S_orbital_med-olfact"},14165:{color:[101,20,20],opacity:1,label:"wm_rh_S_orbital-H_Shaped"},14166:{color:[101,100,180],opacity:1,label:"wm_rh_S_parieto_occipital"},14167:{color:[181,220,20],opacity:1,label:"wm_rh_S_pericallosal"},14168:{color:[21,140,200],opacity:1,label:"wm_rh_S_postcentral"},14169:{color:[21,20,240],opacity:1,label:"wm_rh_S_precentral-inf-part"},14170:{color:[21,20,200],opacity:1,label:"wm_rh_S_precentral-sup-part"},14171:{color:[21,20,60],opacity:1,label:"wm_rh_S_suborbital"},14172:{color:[101,60,60],opacity:1,label:"wm_rh_S_subparietal"},14173:{color:[21,180,180],opacity:1,label:"wm_rh_S_temporal_inf"},14174:{color:[223,220,60],opacity:1,label:"wm_rh_S_temporal_sup"},14175:{color:[221,60,60],opacity:1,label:"wm_rh_S_temporal_transverse"}}},function(t,e,i){"use strict";i.d(e,"a",function(){return n});class n{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*i-o*n+t.x,this.y=r*n+o*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}n.prototype.isVector2=!0},function(t,e,i){t.exports=i(128)},function(t,e,i){"use strict";i.r(e);var n=i(56);i.d(e,"OrthographicCamera",function(){return n.a});var r=i(58);i.d(e,"TrackballControl",function(){return r.b}),i.d(e,"TrackballOrthoControl",function(){return r.c}),i.d(e,"OrbitControl",function(){return r.a});var o=i(62);i.d(e,"ColorsCore",function(){return o.a}),i.d(e,"IntersectionsCore",function(){return o.b}),i.d(e,"UtilsCore",function(){return o.c}),i.d(e,"ValidatorsCore",function(){return o.d});var a=i(63);i.d(e,"SliceGeometry",function(){return a.a}),i.d(e,"VoxelGeometry",function(){return a.b});var s=i(65);i.d(e,"BorderHelper",function(){return s.a}),i.d(e,"BoundingBoxHelper",function(){return s.b}),i.d(e,"ContourHelper",function(){return s.c}),i.d(e,"LocalizerHelper",function(){return s.d}),i.d(e,"LutHelper",function(){return s.e}),i.d(e,"SegmentationLutHelper",function(){return s.h}),i.d(e,"ProgressBarHelper",function(){return s.g}),i.d(e,"ProgressBarEventBasedHelper",function(){return s.f}),i.d(e,"SliceHelper",function(){return s.i}),i.d(e,"StackHelper",function(){return s.j}),i.d(e,"VolumeRenderingHelper",function(){return s.k});var l=i(73);i.d(e,"VolumeLoader",function(){return l.a});var c=i(89);i.d(e,"FrameModel",function(){return c.a}),i.d(e,"StackModel",function(){return c.c}),i.d(e,"SeriesModel",function(){return c.b}),i.d(e,"VoxelModel",function(){return c.d});var h=i(90);i.d(e,"DicomParser",function(){return h.a}),i.d(e,"MghParser",function(){return h.b}),i.d(e,"NiftiParser",function(){return h.c}),i.d(e,"NrrdParser",function(){return h.d});var u=i(91);i.d(e,"SegmentationPreset",function(){return u.a});var d=i(93);i.d(e,"ContourUniformShader",function(){return d.b}),i.d(e,"ContourFragmentShader",function(){return d.a}),i.d(e,"ContourVertexShader",function(){return d.c}),i.d(e,"DataUniformShader",function(){return d.e}),i.d(e,"DataFragmentShader",function(){return d.d}),i.d(e,"DataVertexShader",function(){return d.f}),i.d(e,"VRUniformShader",function(){return d.n}),i.d(e,"VRFragmentShader",function(){return d.m}),i.d(e,"VRVertexShader",function(){return d.o}),i.d(e,"LayerUniformShader",function(){return d.h}),i.d(e,"LayerFragmentShader",function(){return d.g}),i.d(e,"LayerVertexShader",function(){return d.i}),i.d(e,"LocalizerUniformShader",function(){return d.k}),i.d(e,"LocalizerFragmentShader",function(){return d.j}),i.d(e,"LocalizerVertexShader",function(){return d.l});var f=i(97);i.d(e,"WidgetsCss",function(){return f.o}),i.d(e,"AngleWidget",function(){return f.a}),i.d(e,"AnnotationWidget",function(){return f.b}),i.d(e,"BiRulerWidget",function(){return f.c}),i.d(e,"CrossRulerWidget",function(){return f.d}),i.d(e,"EllipseWidget",function(){return f.e}),i.d(e,"FreehandWidget",function(){return f.f}),i.d(e,"HandleWidget",function(){return f.g}),i.d(e,"PeakVelocityWidget",function(){return f.h}),i.d(e,"PressureHalfTimeWidget",function(){return f.j}),i.d(e,"PolygonWidget",function(){return f.i}),i.d(e,"RectangleWidget",function(){return f.k}),i.d(e,"RulerWidget",function(){return f.l}),i.d(e,"VelocityTimeIntegralWidget",function(){return f.m}),i.d(e,"VoxelProbeWidget",function(){return f.n});const p=i(164).version,m=i(165).version;console.log(`ami ${p} (three ${m})`)},function(t,e,i){"use strict";var n=i(130),r=i(12),o=i(77),a=i(48),s=i(78),l=Object.prototype.toString,c=0,h=-1,u=0,d=8;function f(t){if(!(this instanceof f))return new f(t);this.options=r.assign({level:h,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(a[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var p;if(p="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=n.deflateSetDictionary(this.strm,p))!==c)throw new Error(a[i]);this._dict_set=!0}}function p(t,e){var i=new f(e);if(i.push(t,!0),i.err)throw i.msg;return i.result}f.prototype.push=function(t,e){var i,a,s=this.strm,h=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(h),s.next_out=0,s.avail_out=h),1!==(i=n.deflate(s,a))&&i!==c)return this.onEnd(i),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==i);return 4===a?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==a||(this.onEnd(c),s.avail_out=0,!0)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=f,e.deflate=p,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,p(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,p(t,e)}},function(t,e,i){"use strict";var n,r=i(12),o=i(131),a=i(75),s=i(76),l=i(48),c=0,h=1,u=3,d=4,f=5,p=0,m=1,_=-2,g=-3,y=-5,b=-1,v=1,w=2,x=3,A=4,S=0,M=2,E=8,T=9,k=15,C=8,I=286,P=30,R=19,B=2*I+1,L=15,D=3,O=258,F=O+D+1,G=32,N=42,z=69,U=73,H=91,V=103,W=113,j=666,Z=1,Y=2,X=3,J=4,Q=3;function q(t,e){return t.msg=l[e],e}function K(t){return(t<<1)-(t>4?9:0)}function $(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function et(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function it(t,e){t.pending_buf[t.pending++]=e}function nt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e,i,n){var o=t.avail_in;return o>n&&(o=n),0===o?0:(t.avail_in-=o,r.arraySet(e,t.input,t.next_in,o,i),1===t.state.wrap?t.adler=a(t.adler,e,o,i):2===t.state.wrap&&(t.adler=s(t.adler,e,o,i)),t.next_in+=o,t.total_in+=o,o)}function ot(t,e){var i,n,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-F?t.strstart-(t.w_size-F):0,c=t.window,h=t.w_mask,u=t.prev,d=t.strstart+O,f=c[o+a-1],p=c[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(i=e)+a]===p&&c[i+a-1]===f&&c[i]===c[o]&&c[++i]===c[o+1]){o+=2,i++;do{}while(c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&o<d);if(n=O-(d-o),o=d-O,n>a){if(t.match_start=e,a=n,n>=s)break;f=c[o+a-1],p=c[o+a]}}}while((e=u[e&h])>l&&0!=--r);return a<=t.lookahead?a:t.lookahead}function at(t){var e,i,n,o,a,s=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-F)){r.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=s?n-s:0}while(--i);e=i=s;do{n=t.prev[--e],t.prev[e]=n>=s?n-s:0}while(--i);o+=s}if(0===t.strm.avail_in)break;if(i=rt(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=i,t.lookahead+t.insert>=D)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+D-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<D)););}while(t.lookahead<F&&0!==t.strm.avail_in)}function st(t,e){for(var i,n;;){if(t.lookahead<F){if(at(t),t.lookahead<F&&e===c)return Z;if(0===t.lookahead)break}if(i=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-F&&(t.match_length=ot(t,i)),t.match_length>=D)if(n=o._tr_tally(t,t.strstart-t.match_start,t.match_length-D),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=D){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=t.strstart<D-1?t.strstart:D-1,e===d?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:Y}function lt(t,e){for(var i,n,r;;){if(t.lookahead<F){if(at(t),t.lookahead<F&&e===c)return Z;if(0===t.lookahead)break}if(i=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=D-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-F&&(t.match_length=ot(t,i),t.match_length<=5&&(t.strategy===v||t.match_length===D&&t.strstart-t.match_start>4096)&&(t.match_length=D-1)),t.prev_length>=D&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-D,n=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-D),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=D-1,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return Z}else if(t.match_available){if((n=o._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Z}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<D-1?t.strstart:D-1,e===d?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:Y}function ct(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function ht(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=M,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?N:W,t.adler=2===e.wrap?0:1,e.last_flush=c,o._tr_init(e),p):q(t,_)}function ut(t){var e=ht(t);return e===p&&function(t){t.window_size=2*t.w_size,$(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=D-1,t.match_available=0,t.ins_h=0}(t.state),e}function dt(t,e,i,n,o,a){if(!t)return _;var s=1;if(e===b&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>T||i!==E||n<8||n>15||e<0||e>9||a<0||a>A)return q(t,_);8===n&&(n=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*B),this.dyn_dtree=new r.Buf16(2*(2*P+1)),this.bl_tree=new r.Buf16(2*(2*R+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(L+1),this.heap=new r.Buf16(2*I+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*I+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+D-1)/D),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=i,ut(t)}n=[new ct(0,0,0,0,function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===c)return Z;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,et(t,!1),0===t.strm.avail_out))return Z;if(t.strstart-t.block_start>=t.w_size-F&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?X:J):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),Z)}),new ct(4,4,8,4,st),new ct(4,5,16,8,st),new ct(4,6,32,32,st),new ct(4,4,16,16,lt),new ct(8,16,32,32,lt),new ct(8,16,128,128,lt),new ct(8,32,128,256,lt),new ct(32,128,258,1024,lt),new ct(32,258,258,4096,lt)],e.deflateInit=function(t,e){return dt(t,e,E,k,C,S)},e.deflateInit2=dt,e.deflateReset=ut,e.deflateResetKeep=ht,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?_:(t.state.gzhead=e,p):_},e.deflate=function(t,e){var i,r,a,l;if(!t||!t.state||e>f||e<0)return t?q(t,_):_;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===j&&e!==d)return q(t,0===t.avail_out?y:_);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===N)if(2===r.wrap)t.adler=0,it(r,31),it(r,139),it(r,8),r.gzhead?(it(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),it(r,255&r.gzhead.time),it(r,r.gzhead.time>>8&255),it(r,r.gzhead.time>>16&255),it(r,r.gzhead.time>>24&255),it(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),it(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(it(r,255&r.gzhead.extra.length),it(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=s(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=z):(it(r,0),it(r,0),it(r,0),it(r,0),it(r,0),it(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),it(r,Q),r.status=W);else{var g=E+(r.w_bits-8<<4)<<8;g|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(g|=G),g+=31-g%31,r.status=W,nt(r,g),0!==r.strstart&&(nt(r,t.adler>>>16),nt(r,65535&t.adler)),t.adler=1}if(r.status===z)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending!==r.pending_buf_size));)it(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=U)}else r.status=U;if(r.status===U)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,it(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=H)}else r.status=H;if(r.status===H)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,it(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=V)}else r.status=V;if(r.status===V&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&tt(t),r.pending+2<=r.pending_buf_size&&(it(r,255&t.adler),it(r,t.adler>>8&255),t.adler=0,r.status=W)):r.status=W),0!==r.pending){if(tt(t),0===t.avail_out)return r.last_flush=-1,p}else if(0===t.avail_in&&K(e)<=K(i)&&e!==d)return q(t,y);if(r.status===j&&0!==t.avail_in)return q(t,y);if(0!==t.avail_in||0!==r.lookahead||e!==c&&r.status!==j){var b=r.strategy===w?function(t,e){for(var i;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===c)return Z;break}if(t.match_length=0,i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:Y}(r,e):r.strategy===x?function(t,e){for(var i,n,r,a,s=t.window;;){if(t.lookahead<=O){if(at(t),t.lookahead<=O&&e===c)return Z;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=D&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){a=t.strstart+O;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<a);t.match_length=O-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=D?(i=o._tr_tally(t,1,t.match_length-D),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:Y}(r,e):n[r.level].func(r,e);if(b!==X&&b!==J||(r.status=j),b===Z||b===X)return 0===t.avail_out&&(r.last_flush=-1),p;if(b===Y&&(e===h?o._tr_align(r):e!==f&&(o._tr_stored_block(r,0,0,!1),e===u&&($(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),tt(t),0===t.avail_out))return r.last_flush=-1,p}return e!==d?p:r.wrap<=0?m:(2===r.wrap?(it(r,255&t.adler),it(r,t.adler>>8&255),it(r,t.adler>>16&255),it(r,t.adler>>24&255),it(r,255&t.total_in),it(r,t.total_in>>8&255),it(r,t.total_in>>16&255),it(r,t.total_in>>24&255)):(nt(r,t.adler>>>16),nt(r,65535&t.adler)),tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:m)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==N&&e!==z&&e!==U&&e!==H&&e!==V&&e!==W&&e!==j?q(t,_):(t.state=null,e===W?q(t,g):p):_},e.deflateSetDictionary=function(t,e){var i,n,o,s,l,c,h,u,d=e.length;if(!t||!t.state)return _;if(2===(s=(i=t.state).wrap)||1===s&&i.status!==N||i.lookahead)return _;for(1===s&&(t.adler=a(t.adler,e,d,0)),i.wrap=0,d>=i.w_size&&(0===s&&($(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new r.Buf8(i.w_size),r.arraySet(u,e,d-i.w_size,i.w_size,0),e=u,d=i.w_size),l=t.avail_in,c=t.next_in,h=t.input,t.avail_in=d,t.next_in=0,t.input=e,at(i);i.lookahead>=D;){n=i.strstart,o=i.lookahead-(D-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+D-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--o);i.strstart=n,i.lookahead=D-1,at(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=D-1,i.match_available=0,t.next_in=c,t.input=h,t.avail_in=l,i.wrap=s,p},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";var n=i(12),r=4,o=0,a=1,s=2;function l(t){for(var e=t.length;--e>=0;)t[e]=0}var c=0,h=1,u=2,d=29,f=256,p=f+1+d,m=30,_=19,g=2*p+1,y=15,b=16,v=7,w=256,x=16,A=17,S=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=new Array(2*(p+2));l(C);var I=new Array(2*m);l(I);var P=new Array(512);l(P);var R=new Array(256);l(R);var B=new Array(d);l(B);var L,D,O,F=new Array(m);function G(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function N(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function z(t){return t<256?P[t]:P[256+(t>>>7)]}function U(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function H(t,e,i){t.bi_valid>b-i?(t.bi_buf|=e<<t.bi_valid&65535,U(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=i-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function V(t,e,i){H(t,i[2*e],i[2*e+1])}function W(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function j(t,e,i){var n,r,o=new Array(y+1),a=0;for(n=1;n<=y;n++)o[n]=a=a+i[n-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=W(o[s]++,s))}}function Z(t){var e;for(e=0;e<p;e++)t.dyn_ltree[2*e]=0;for(e=0;e<m;e++)t.dyn_dtree[2*e]=0;for(e=0;e<_;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*w]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function Y(t){t.bi_valid>8?U(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function X(t,e,i,n){var r=2*e,o=2*i;return t[r]<t[o]||t[r]===t[o]&&n[e]<=n[i]}function J(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&X(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!X(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function Q(t,e,i){var n,r,o,a,s=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],r=t.pending_buf[t.l_buf+s],s++,0===n?V(t,r,e):(V(t,(o=R[r])+f+1,e),0!==(a=M[o])&&H(t,r-=B[o],a),V(t,o=z(--n),i),0!==(a=E[o])&&H(t,n-=F[o],a))}while(s<t.last_lit);V(t,w,e)}function q(t,e){var i,n,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=g,i=0;i<l;i++)0!==o[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):o[2*i+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=c,i=t.heap_len>>1;i>=1;i--)J(t,o,i);r=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],J(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,o[2*r]=o[2*i]+o[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,o[2*i+1]=o[2*n+1]=r,t.heap[1]=r++,J(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,o,a,s,l=e.dyn_tree,c=e.max_code,h=e.stat_desc.static_tree,u=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(o=0;o<=y;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<g;i++)(o=l[2*l[2*(n=t.heap[i])+1]+1]+1)>p&&(o=p,m++),l[2*n+1]=o,n>c||(t.bl_count[o]++,a=0,n>=f&&(a=d[n-f]),s=l[2*n],t.opt_len+=s*(o+a),u&&(t.static_len+=s*(h[2*n+1]+a)));if(0!==m){do{for(o=p-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(n=t.bl_count[o];0!==n;)(r=t.heap[--i])>c||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),n--)}}(t,e),j(o,c,t.bl_count)}function K(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=a,a=e[2*(n+1)+1],++s<l&&r===a||(s<c?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*x]++):s<=10?t.bl_tree[2*A]++:t.bl_tree[2*S]++,s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function $(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=i;n++)if(r=a,a=e[2*(n+1)+1],!(++s<l&&r===a)){if(s<c)do{V(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(V(t,r,t.bl_tree),s--),V(t,x,t.bl_tree),H(t,s-3,2)):s<=10?(V(t,A,t.bl_tree),H(t,s-3,3)):(V(t,S,t.bl_tree),H(t,s-11,7));s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}l(F);var tt=!1;function et(t,e,i,r){H(t,(c<<1)+(r?1:0),3),function(t,e,i,r){Y(t),r&&(U(t,i),U(t,~i)),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i,!0)}e._tr_init=function(t){tt||(function(){var t,e,i,n,r,o=new Array(y+1);for(i=0,n=0;n<d-1;n++)for(B[n]=i,t=0;t<1<<M[n];t++)R[i++]=n;for(R[i-1]=n,r=0,n=0;n<16;n++)for(F[n]=r,t=0;t<1<<E[n];t++)P[r++]=n;for(r>>=7;n<m;n++)for(F[n]=r<<7,t=0;t<1<<E[n]-7;t++)P[256+r++]=n;for(e=0;e<=y;e++)o[e]=0;for(t=0;t<=143;)C[2*t+1]=8,t++,o[8]++;for(;t<=255;)C[2*t+1]=9,t++,o[9]++;for(;t<=279;)C[2*t+1]=7,t++,o[7]++;for(;t<=287;)C[2*t+1]=8,t++,o[8]++;for(j(C,p+1,o),t=0;t<m;t++)I[2*t+1]=5,I[2*t]=W(t,5);L=new G(C,M,f+1,p,y),D=new G(I,E,0,m,y),O=new G(new Array(0),T,0,_,v)}(),tt=!0),t.l_desc=new N(t.dyn_ltree,L),t.d_desc=new N(t.dyn_dtree,D),t.bl_desc=new N(t.bl_tree,O),t.bi_buf=0,t.bi_valid=0,Z(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,i,n){var l,c,d=0;t.level>0?(t.strm.data_type===s&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return a;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return a;return o}(t)),q(t,t.l_desc),q(t,t.d_desc),d=function(t){var e;for(K(t,t.dyn_ltree,t.l_desc.max_code),K(t,t.dyn_dtree,t.d_desc.max_code),q(t,t.bl_desc),e=_-1;e>=3&&0===t.bl_tree[2*k[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),l=t.opt_len+3+7>>>3,(c=t.static_len+3+7>>>3)<=l&&(l=c)):l=c=i+5,i+4<=l&&-1!==e?et(t,e,i,n):t.strategy===r||c===l?(H(t,(h<<1)+(n?1:0),3),Q(t,C,I)):(H(t,(u<<1)+(n?1:0),3),function(t,e,i,n){var r;for(H(t,e-257,5),H(t,i-1,5),H(t,n-4,4),r=0;r<n;r++)H(t,t.bl_tree[2*k[r]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,d+1),Q(t,t.dyn_ltree,t.dyn_dtree)),Z(t),n&&Y(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(R[i]+f+1)]++,t.dyn_dtree[2*z(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){H(t,h<<1,3),V(t,w,C),function(t){16===t.bi_valid?(U(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){"use strict";var n=i(133),r=i(12),o=i(77),a=i(79),s=i(48),l=i(78),c=i(136),h=Object.prototype.toString;function u(t){if(!(this instanceof u))return new u(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==a.Z_OK)throw new Error(s[i]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function d(t,e){var i=new u(e);if(i.push(t,!0),i.err)throw i.msg;return i.result}u.prototype.push=function(t,e){var i,s,l,c,u,d,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,_=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?f.input=o.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(p),f.next_out=0,f.avail_out=p),(i=n.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(d="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===h.call(m)?new Uint8Array(m):m,i=n.inflateSetDictionary(this.strm,d)),i===a.Z_BUF_ERROR&&!0===_&&(i=a.Z_OK,_=!1),i!==a.Z_STREAM_END&&i!==a.Z_OK)return this.onEnd(i),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&i!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,u=o.buf2string(f.output,l),f.next_out=c,f.avail_out=p-c,c&&r.arraySet(f.output,f.output,l,c,0),this.onData(u)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(_=!0)}while((f.avail_in>0||0===f.avail_out)&&i!==a.Z_STREAM_END);return i===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),f.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=u,e.inflate=d,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.ungzip=d},function(t,e,i){"use strict";var n=i(12),r=i(75),o=i(76),a=i(134),s=i(135),l=0,c=1,h=2,u=4,d=5,f=6,p=0,m=1,_=2,g=-2,y=-3,b=-4,v=-5,w=8,x=1,A=2,S=3,M=4,E=5,T=6,k=7,C=8,I=9,P=10,R=11,B=12,L=13,D=14,O=15,F=16,G=17,N=18,z=19,U=20,H=21,V=22,W=23,j=24,Z=25,Y=26,X=27,J=28,Q=29,q=30,K=31,$=32,tt=852,et=592,it=15;function nt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=x,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(tt),e.distcode=e.distdyn=new n.Buf32(et),e.sane=1,e.back=-1,p):g}function ot(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,rt(t)):g}function at(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?g:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,ot(t))):g}function st(t,e){var i,r;return t?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},t.state=r,r.window=null,(i=at(t,e))!==p&&(t.state=null),i):g}var lt,ct,ht=!0;function ut(t){if(ht){var e;for(lt=new n.Buf32(512),ct=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(c,t.lens,0,288,lt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(h,t.lens,0,32,ct,0,t.work,{bits:5}),ht=!1}t.lencode=lt,t.lenbits=9,t.distcode=ct,t.distbits=5}function dt(t,e,i,r){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),r>=a.wsize?(n.arraySet(a.window,e,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),n.arraySet(a.window,e,i-r,o,a.wnext),(r-=o)?(n.arraySet(a.window,e,i-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=ot,e.inflateReset2=at,e.inflateResetKeep=rt,e.inflateInit=function(t){return st(t,it)},e.inflateInit2=st,e.inflate=function(t,e){var i,tt,et,it,rt,ot,at,st,lt,ct,ht,ft,pt,mt,_t,gt,yt,bt,vt,wt,xt,At,St,Mt,Et=0,Tt=new n.Buf8(4),kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return g;(i=t.state).mode===B&&(i.mode=L),rt=t.next_out,et=t.output,at=t.avail_out,it=t.next_in,tt=t.input,ot=t.avail_in,st=i.hold,lt=i.bits,ct=ot,ht=at,At=p;t:for(;;)switch(i.mode){case x:if(0===i.wrap){i.mode=L;break}for(;lt<16;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(2&i.wrap&&35615===st){i.check=0,Tt[0]=255&st,Tt[1]=st>>>8&255,i.check=o(i.check,Tt,2,0),st=0,lt=0,i.mode=A;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&st)<<8)+(st>>8))%31){t.msg="incorrect header check",i.mode=q;break}if((15&st)!==w){t.msg="unknown compression method",i.mode=q;break}if(lt-=4,xt=8+(15&(st>>>=4)),0===i.wbits)i.wbits=xt;else if(xt>i.wbits){t.msg="invalid window size",i.mode=q;break}i.dmax=1<<xt,t.adler=i.check=1,i.mode=512&st?P:B,st=0,lt=0;break;case A:for(;lt<16;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(i.flags=st,(255&i.flags)!==w){t.msg="unknown compression method",i.mode=q;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=q;break}i.head&&(i.head.text=st>>8&1),512&i.flags&&(Tt[0]=255&st,Tt[1]=st>>>8&255,i.check=o(i.check,Tt,2,0)),st=0,lt=0,i.mode=S;case S:for(;lt<32;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.head&&(i.head.time=st),512&i.flags&&(Tt[0]=255&st,Tt[1]=st>>>8&255,Tt[2]=st>>>16&255,Tt[3]=st>>>24&255,i.check=o(i.check,Tt,4,0)),st=0,lt=0,i.mode=M;case M:for(;lt<16;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.head&&(i.head.xflags=255&st,i.head.os=st>>8),512&i.flags&&(Tt[0]=255&st,Tt[1]=st>>>8&255,i.check=o(i.check,Tt,2,0)),st=0,lt=0,i.mode=E;case E:if(1024&i.flags){for(;lt<16;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.length=st,i.head&&(i.head.extra_len=st),512&i.flags&&(Tt[0]=255&st,Tt[1]=st>>>8&255,i.check=o(i.check,Tt,2,0)),st=0,lt=0}else i.head&&(i.head.extra=null);i.mode=T;case T:if(1024&i.flags&&((ft=i.length)>ot&&(ft=ot),ft&&(i.head&&(xt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,tt,it,ft,xt)),512&i.flags&&(i.check=o(i.check,tt,ft,it)),ot-=ft,it+=ft,i.length-=ft),i.length))break t;i.length=0,i.mode=k;case k:if(2048&i.flags){if(0===ot)break t;ft=0;do{xt=tt[it+ft++],i.head&&xt&&i.length<65536&&(i.head.name+=String.fromCharCode(xt))}while(xt&&ft<ot);if(512&i.flags&&(i.check=o(i.check,tt,ft,it)),ot-=ft,it+=ft,xt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=C;case C:if(4096&i.flags){if(0===ot)break t;ft=0;do{xt=tt[it+ft++],i.head&&xt&&i.length<65536&&(i.head.comment+=String.fromCharCode(xt))}while(xt&&ft<ot);if(512&i.flags&&(i.check=o(i.check,tt,ft,it)),ot-=ft,it+=ft,xt)break t}else i.head&&(i.head.comment=null);i.mode=I;case I:if(512&i.flags){for(;lt<16;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(st!==(65535&i.check)){t.msg="header crc mismatch",i.mode=q;break}st=0,lt=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=B;break;case P:for(;lt<32;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}t.adler=i.check=nt(st),st=0,lt=0,i.mode=R;case R:if(0===i.havedict)return t.next_out=rt,t.avail_out=at,t.next_in=it,t.avail_in=ot,i.hold=st,i.bits=lt,_;t.adler=i.check=1,i.mode=B;case B:if(e===d||e===f)break t;case L:if(i.last){st>>>=7&lt,lt-=7&lt,i.mode=X;break}for(;lt<3;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}switch(i.last=1&st,lt-=1,3&(st>>>=1)){case 0:i.mode=D;break;case 1:if(ut(i),i.mode=U,e===f){st>>>=2,lt-=2;break t}break;case 2:i.mode=G;break;case 3:t.msg="invalid block type",i.mode=q}st>>>=2,lt-=2;break;case D:for(st>>>=7&lt,lt-=7&lt;lt<32;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if((65535&st)!=(st>>>16^65535)){t.msg="invalid stored block lengths",i.mode=q;break}if(i.length=65535&st,st=0,lt=0,i.mode=O,e===f)break t;case O:i.mode=F;case F:if(ft=i.length){if(ft>ot&&(ft=ot),ft>at&&(ft=at),0===ft)break t;n.arraySet(et,tt,it,ft,rt),ot-=ft,it+=ft,at-=ft,rt+=ft,i.length-=ft;break}i.mode=B;break;case G:for(;lt<14;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(i.nlen=257+(31&st),st>>>=5,lt-=5,i.ndist=1+(31&st),st>>>=5,lt-=5,i.ncode=4+(15&st),st>>>=4,lt-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=q;break}i.have=0,i.mode=N;case N:for(;i.have<i.ncode;){for(;lt<3;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.lens[kt[i.have++]]=7&st,st>>>=3,lt-=3}for(;i.have<19;)i.lens[kt[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,St={bits:i.lenbits},At=s(l,i.lens,0,19,i.lencode,0,i.work,St),i.lenbits=St.bits,At){t.msg="invalid code lengths set",i.mode=q;break}i.have=0,i.mode=z;case z:for(;i.have<i.nlen+i.ndist;){for(;gt=(Et=i.lencode[st&(1<<i.lenbits)-1])>>>16&255,yt=65535&Et,!((_t=Et>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(yt<16)st>>>=_t,lt-=_t,i.lens[i.have++]=yt;else{if(16===yt){for(Mt=_t+2;lt<Mt;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(st>>>=_t,lt-=_t,0===i.have){t.msg="invalid bit length repeat",i.mode=q;break}xt=i.lens[i.have-1],ft=3+(3&st),st>>>=2,lt-=2}else if(17===yt){for(Mt=_t+3;lt<Mt;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}lt-=_t,xt=0,ft=3+(7&(st>>>=_t)),st>>>=3,lt-=3}else{for(Mt=_t+7;lt<Mt;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}lt-=_t,xt=0,ft=11+(127&(st>>>=_t)),st>>>=7,lt-=7}if(i.have+ft>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=q;break}for(;ft--;)i.lens[i.have++]=xt}}if(i.mode===q)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=q;break}if(i.lenbits=9,St={bits:i.lenbits},At=s(c,i.lens,0,i.nlen,i.lencode,0,i.work,St),i.lenbits=St.bits,At){t.msg="invalid literal/lengths set",i.mode=q;break}if(i.distbits=6,i.distcode=i.distdyn,St={bits:i.distbits},At=s(h,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,St),i.distbits=St.bits,At){t.msg="invalid distances set",i.mode=q;break}if(i.mode=U,e===f)break t;case U:i.mode=H;case H:if(ot>=6&&at>=258){t.next_out=rt,t.avail_out=at,t.next_in=it,t.avail_in=ot,i.hold=st,i.bits=lt,a(t,ht),rt=t.next_out,et=t.output,at=t.avail_out,it=t.next_in,tt=t.input,ot=t.avail_in,st=i.hold,lt=i.bits,i.mode===B&&(i.back=-1);break}for(i.back=0;gt=(Et=i.lencode[st&(1<<i.lenbits)-1])>>>16&255,yt=65535&Et,!((_t=Et>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(gt&&0==(240&gt)){for(bt=_t,vt=gt,wt=yt;gt=(Et=i.lencode[wt+((st&(1<<bt+vt)-1)>>bt)])>>>16&255,yt=65535&Et,!(bt+(_t=Et>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}st>>>=bt,lt-=bt,i.back+=bt}if(st>>>=_t,lt-=_t,i.back+=_t,i.length=yt,0===gt){i.mode=Y;break}if(32&gt){i.back=-1,i.mode=B;break}if(64&gt){t.msg="invalid literal/length code",i.mode=q;break}i.extra=15&gt,i.mode=V;case V:if(i.extra){for(Mt=i.extra;lt<Mt;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.length+=st&(1<<i.extra)-1,st>>>=i.extra,lt-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=W;case W:for(;gt=(Et=i.distcode[st&(1<<i.distbits)-1])>>>16&255,yt=65535&Et,!((_t=Et>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(0==(240&gt)){for(bt=_t,vt=gt,wt=yt;gt=(Et=i.distcode[wt+((st&(1<<bt+vt)-1)>>bt)])>>>16&255,yt=65535&Et,!(bt+(_t=Et>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}st>>>=bt,lt-=bt,i.back+=bt}if(st>>>=_t,lt-=_t,i.back+=_t,64&gt){t.msg="invalid distance code",i.mode=q;break}i.offset=yt,i.extra=15&gt,i.mode=j;case j:if(i.extra){for(Mt=i.extra;lt<Mt;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}i.offset+=st&(1<<i.extra)-1,st>>>=i.extra,lt-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=q;break}i.mode=Z;case Z:if(0===at)break t;if(ft=ht-at,i.offset>ft){if((ft=i.offset-ft)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=q;break}ft>i.wnext?(ft-=i.wnext,pt=i.wsize-ft):pt=i.wnext-ft,ft>i.length&&(ft=i.length),mt=i.window}else mt=et,pt=rt-i.offset,ft=i.length;ft>at&&(ft=at),at-=ft,i.length-=ft;do{et[rt++]=mt[pt++]}while(--ft);0===i.length&&(i.mode=H);break;case Y:if(0===at)break t;et[rt++]=i.length,at--,i.mode=H;break;case X:if(i.wrap){for(;lt<32;){if(0===ot)break t;ot--,st|=tt[it++]<<lt,lt+=8}if(ht-=at,t.total_out+=ht,i.total+=ht,ht&&(t.adler=i.check=i.flags?o(i.check,et,ht,rt-ht):r(i.check,et,ht,rt-ht)),ht=at,(i.flags?st:nt(st))!==i.check){t.msg="incorrect data check",i.mode=q;break}st=0,lt=0}i.mode=J;case J:if(i.wrap&&i.flags){for(;lt<32;){if(0===ot)break t;ot--,st+=tt[it++]<<lt,lt+=8}if(st!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=q;break}st=0,lt=0}i.mode=Q;case Q:At=m;break t;case q:At=y;break t;case K:return b;case $:default:return g}return t.next_out=rt,t.avail_out=at,t.next_in=it,t.avail_in=ot,i.hold=st,i.bits=lt,(i.wsize||ht!==t.avail_out&&i.mode<q&&(i.mode<X||e!==u))&&dt(t,t.output,t.next_out,ht-t.avail_out)?(i.mode=K,b):(ct-=t.avail_in,ht-=t.avail_out,t.total_in+=ct,t.total_out+=ht,i.total+=ht,i.wrap&&ht&&(t.adler=i.check=i.flags?o(i.check,et,ht,t.next_out-ht):r(i.check,et,ht,t.next_out-ht)),t.data_type=i.bits+(i.last?64:0)+(i.mode===B?128:0)+(i.mode===U||i.mode===O?256:0),(0===ct&&0===ht||e===u)&&At===p&&(At=v),At)},e.inflateEnd=function(t){if(!t||!t.state)return g;var e=t.state;return e.window&&(e.window=null),t.state=null,p},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?g:(i.head=e,e.done=!1,p):g},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&i.mode!==R?g:i.mode===R&&r(1,e,n,0)!==i.check?y:dt(t,e,n,n)?(i.mode=K,b):(i.havedict=1,p):g},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,r,o,a,s,l,c,h,u,d,f,p,m,_,g,y,b,v,w,x,A,S,M,E;i=t.state,n=t.next_in,M=t.input,r=n+(t.avail_in-5),o=t.next_out,E=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=i.dmax,c=i.wsize,h=i.whave,u=i.wnext,d=i.window,f=i.hold,p=i.bits,m=i.lencode,_=i.distcode,g=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;t:do{p<15&&(f+=M[n++]<<p,p+=8,f+=M[n++]<<p,p+=8),b=m[f&g];e:for(;;){if(f>>>=v=b>>>24,p-=v,0===(v=b>>>16&255))E[o++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=m[(65535&b)+(f&(1<<v)-1)];continue e}if(32&v){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&b,(v&=15)&&(p<v&&(f+=M[n++]<<p,p+=8),w+=f&(1<<v)-1,f>>>=v,p-=v),p<15&&(f+=M[n++]<<p,p+=8,f+=M[n++]<<p,p+=8),b=_[f&y];i:for(;;){if(f>>>=v=b>>>24,p-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=_[(65535&b)+(f&(1<<v)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(x=65535&b,p<(v&=15)&&(f+=M[n++]<<p,(p+=8)<v&&(f+=M[n++]<<p,p+=8)),(x+=f&(1<<v)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(f>>>=v,p-=v,x>(v=o-a)){if((v=x-v)>h&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(A=0,S=d,0===u){if(A+=c-v,v<w){w-=v;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}}else if(u<v){if(A+=c+u-v,(v-=u)<w){w-=v;do{E[o++]=d[A++]}while(--v);if(A=0,u<w){w-=v=u;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}}}else if(A+=u-v,v<w){w-=v;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}for(;w>2;)E[o++]=S[A++],E[o++]=S[A++],E[o++]=S[A++],w-=3;w&&(E[o++]=S[A++],w>1&&(E[o++]=S[A++]))}else{A=o-x;do{E[o++]=E[A++],E[o++]=E[A++],E[o++]=E[A++],w-=3}while(w>2);w&&(E[o++]=E[A++],w>1&&(E[o++]=E[A++]))}break}}break}}while(n<r&&o<s);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<s?s-o+257:257-(o-s),i.hold=f,i.bits=p}},function(t,e,i){"use strict";var n=i(12),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,c,h,u,d){var f,p,m,_,g,y,b,v,w,x=d.bits,A=0,S=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=null,L=0,D=new n.Buf16(16),O=new n.Buf16(16),F=null,G=0;for(A=0;A<=15;A++)D[A]=0;for(S=0;S<l;S++)D[e[i+S]]++;for(T=x,E=15;E>=1&&0===D[E];E--);if(T>E&&(T=E),0===E)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(M=1;M<E&&0===D[M];M++);for(T<M&&(T=M),I=1,A=1;A<=15;A++)if(I<<=1,(I-=D[A])<0)return-1;if(I>0&&(0===t||1!==E))return-1;for(O[1]=0,A=1;A<15;A++)O[A+1]=O[A]+D[A];for(S=0;S<l;S++)0!==e[i+S]&&(u[O[e[i+S]]++]=S);if(0===t?(B=F=u,y=19):1===t?(B=r,L-=257,F=o,G-=257,y=256):(B=a,F=s,y=-1),R=0,S=0,A=M,g=h,k=T,C=0,m=-1,_=(P=1<<T)-1,1===t&&P>852||2===t&&P>592)return 1;for(;;){0,b=A-C,u[S]<y?(v=0,w=u[S]):u[S]>y?(v=F[G+u[S]],w=B[L+u[S]]):(v=96,w=0),f=1<<A-C,M=p=1<<k;do{c[g+(R>>C)+(p-=f)]=b<<24|v<<16|w|0}while(0!==p);for(f=1<<A-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,S++,0==--D[A]){if(A===E)break;A=e[i+u[S]]}if(A>T&&(R&_)!==m){for(0===C&&(C=T),g+=M,I=1<<(k=A-C);k+C<E&&!((I-=D[k+C])<=0);)k++,I<<=1;if(P+=1<<k,1===t&&P>852||2===t&&P>592)return 1;c[m=R&_]=T<<24|k<<16|g-h|0}}return 0!==R&&(c[g+R]=A-C<<24|64<<16|0),d.bits=T,0}},function(t,e,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,i){"use strict";var n=i(138),r=i(139),o=i(140),a=i(80),s=i(141),l=i(144),c=i(51),h=i(145),u=i(146),d=127;t.exports=function(t){var e,i,f,p,m,_,g;if(i=t<0||1/t===r?"1":"0",t===n||t===r)return i+(p=c("1",8))+(f=c("0",23));if(t!=t)return i+(p=c("1",8))+(f="1"+c("0",22));if(0===t)return i+(p=c("0",8))+(f=c("0",23));if(_=(t=o(t))-(m=a(t)),m=h(m),_=u(_),m)p=m.length-1;else{for(g=0;g<_.length;g++)if("1"===_[g]){e=g+1;break}p=-e}return f=m+_,p<0?(p<=-d&&(e=d-1),f=f.substring(e)):f=f.substring(1),p=h(p+d),i+(p=l(p,8,"0"))+(f=s(f,23,"0").substring(0,23))}},function(t,e,i){"use strict";var n=new Float32Array(1);new Uint32Array(n.buffer)[0]=2139095040,t.exports=n[0]},function(t,e,i){"use strict";var n=new Float32Array(1);new Uint32Array(n.buffer)[0]=4286578688,t.exports=n[0]},function(t,e,i){"use strict";t.exports=function(t){return t<0?-t:0===t?0:t}},function(t,e,i){"use strict";var n=i(49),r=i(50),o=i(81),a=i(51),s=9007199254740991;t.exports=function(t,e,i){var l,c;if(!n(t))throw new TypeError("invalid input argument. First argument must be a string. Value: `"+t+"`.");if(!r(e))throw new TypeError("invalid input argument. Second argument must be a nonnegative integer. Value: `"+e+"`.");if(arguments.length>2){if(!n(c=i))throw new TypeError("invalid input argument. Third argument must be a string. Value: `"+c+"`.");if(0===c.length)throw new RangeError("invalid input argument. Pad string must not be an empty string.")}else c=" ";if(e>s)throw new RangeError("invalid input argument. Output string length exceeds maximum allowed string length.");return(l=(e-t.length)/c.length)<=0?t:(l=o(l),t+a(c,l))}},function(t,e,i){"use strict";var n=i(143);t.exports=function(t){return n(t)&&t%1==0}},function(t,e,i){"use strict";t.exports=function(t){return("number"==typeof t||"[object Number]"===Object.prototype.toString.call(t))&&t.valueOf()==t.valueOf()}},function(t,e,i){"use strict";var n=i(49),r=i(50),o=i(81),a=i(51),s=9007199254740991;t.exports=function(t,e,i){var l,c;if(!n(t))throw new TypeError("invalid input argument. First argument must be a string. Value: `"+t+"`.");if(!r(e))throw new TypeError("invalid input argument. Second argument must be a nonnegative integer. Value: `"+e+"`.");if(arguments.length>2){if(!n(c=i))throw new TypeError("invalid input argument. Third argument must be a string. Value: `"+c+"`.");if(0===c.length)throw new RangeError("invalid input argument. Pad string must not be an empty string.")}else c=" ";if(e>s)throw new RangeError("invalid input argument. Output string length exceeds maximum allowed string length.");return(l=(e-t.length)/c.length)<=0?t:(l=o(l),a(c,l)+t)}},function(t,e,i){"use strict";var n=i(80);t.exports=function(t){for(var e,i="";t>0;)i=(e=t/2)===(t=n(e))?"0"+i:"1"+i;return i}},function(t,e,i){"use strict";var n=149,r=24;t.exports=function(t){var e,i,o,a;if(e="",0===t)return e;for(a=n,o=0;o<n&&((i=2*t)>=1?(t=i-1,e+="1",a===n&&(a=o)):(t=i,e+="0"),!(1===i||o-a>r));o++);return e}},function(t,e,i){"use strict";var n=n||{};n.Utils=n.Utils||i(52),n.NIFTI1=n.NIFTI1||i(82),n.NIFTI2=n.NIFTI2||function(){this.littleEndian=!1,this.dim_info=0,this.dims=[],this.intent_p1=0,this.intent_p2=0,this.intent_p3=0,this.intent_code=0,this.datatypeCode=0,this.numBitsPerVoxel=0,this.slice_start=0,this.slice_end=0,this.slice_code=0,this.pixDims=[],this.vox_offset=0,this.scl_slope=1,this.scl_inter=0,this.xyzt_units=0,this.cal_max=0,this.cal_min=0,this.slice_duration=0,this.toffset=0,this.description="",this.aux_file="",this.intent_name="",this.qform_code=0,this.sform_code=0,this.quatern_b=0,this.quatern_c=0,this.quatern_d=0,this.qoffset_x=0,this.qoffset_y=0,this.qoffset_z=0,this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.magic=0,this.extensionFlag=[0,0,0,0]},n.NIFTI2.MAGIC_COOKIE=540,n.NIFTI2.MAGIC_NUMBER_LOCATION=4,n.NIFTI2.MAGIC_NUMBER=[110,43,50,0,13,10,26,10],n.NIFTI2.prototype.readHeader=function(t){var e,i,r,o,a=new DataView(t),s=n.Utils.getIntAt(a,0,this.littleEndian);if(s!==n.NIFTI2.MAGIC_COOKIE&&(this.littleEndian=!0,s=n.Utils.getIntAt(a,0,this.littleEndian)),s!==n.NIFTI2.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.datatypeCode=n.Utils.getShortAt(a,12,this.littleEndian),this.numBitsPerVoxel=n.Utils.getShortAt(a,14,this.littleEndian),e=0;e<8;e+=1)o=16+8*e,this.dims[e]=n.Utils.getLongAt(a,o,this.littleEndian);for(this.intent_p1=n.Utils.getDoubleAt(a,80,this.littleEndian),this.intent_p2=n.Utils.getDoubleAt(a,88,this.littleEndian),this.intent_p3=n.Utils.getDoubleAt(a,96,this.littleEndian),e=0;e<8;e+=1)o=104+8*e,this.pixDims[e]=n.Utils.getDoubleAt(a,o,this.littleEndian);for(this.vox_offset=n.Utils.getLongAt(a,168,this.littleEndian),this.scl_slope=n.Utils.getDoubleAt(a,176,this.littleEndian),this.scl_inter=n.Utils.getDoubleAt(a,184,this.littleEndian),this.cal_max=n.Utils.getDoubleAt(a,192,this.littleEndian),this.cal_min=n.Utils.getDoubleAt(a,200,this.littleEndian),this.slice_duration=n.Utils.getDoubleAt(a,208,this.littleEndian),this.toffset=n.Utils.getDoubleAt(a,216,this.littleEndian),this.slice_start=n.Utils.getLongAt(a,224,this.littleEndian),this.slice_end=n.Utils.getLongAt(a,232,this.littleEndian),this.description=n.Utils.getStringAt(a,240,320),this.aux_file=n.Utils.getStringAt(a,320,344),this.qform_code=n.Utils.getIntAt(a,344,this.littleEndian),this.sform_code=n.Utils.getIntAt(a,348,this.littleEndian),this.quatern_b=n.Utils.getDoubleAt(a,352,this.littleEndian),this.quatern_c=n.Utils.getDoubleAt(a,360,this.littleEndian),this.quatern_d=n.Utils.getDoubleAt(a,368,this.littleEndian),this.qoffset_x=n.Utils.getDoubleAt(a,376,this.littleEndian),this.qoffset_y=n.Utils.getDoubleAt(a,384,this.littleEndian),this.qoffset_z=n.Utils.getDoubleAt(a,392,this.littleEndian),i=0;i<3;i+=1)for(r=0;r<4;r+=1)o=400+8*(4*i+r),this.affine[i][r]=n.Utils.getDoubleAt(a,o,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=n.Utils.getIntAt(a,496,this.littleEndian),this.xyzt_units=n.Utils.getIntAt(a,500,this.littleEndian),this.intent_code=n.Utils.getIntAt(a,504,this.littleEndian),this.intent_name=n.Utils.getStringAt(a,508,524),this.dim_info=n.Utils.getByteAt(a,524),a.byteLength>n.NIFTI2.MAGIC_COOKIE&&(this.extensionFlag[0]=n.Utils.getByteAt(a,540),this.extensionFlag[1]=n.Utils.getByteAt(a,541),this.extensionFlag[2]=n.Utils.getByteAt(a,542),this.extensionFlag[3]=n.Utils.getByteAt(a,543),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))},n.NIFTI2.prototype.toFormattedString=function(){var t=n.Utils.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Slice End = "+this.slice_end+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(n.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(n.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Intent Code = "+this.intent_code+"\n",e+='Intent Name: "'+this.intent_name+'"\n',e+="Dim Info = "+this.dim_info+"\n"},n.NIFTI2.prototype.getExtensionLocation=function(){return n.NIFTI2.MAGIC_COOKIE+4},n.NIFTI2.prototype.getExtensionSize=n.NIFTI1.prototype.getExtensionSize,n.NIFTI2.prototype.getExtensionCode=n.NIFTI1.prototype.getExtensionCode,n.NIFTI2.prototype.getDatatypeCodeString=n.NIFTI1.prototype.getDatatypeCodeString,n.NIFTI2.prototype.getTransformCodeString=n.NIFTI1.prototype.getTransformCodeString,n.NIFTI2.prototype.getUnitsCodeString=n.NIFTI1.prototype.getUnitsCodeString,n.NIFTI2.prototype.getQformMat=n.NIFTI1.prototype.getQformMat,n.NIFTI2.prototype.convertNiftiQFormToNiftiSForm=n.NIFTI1.prototype.convertNiftiQFormToNiftiSForm,n.NIFTI2.prototype.convertNiftiSFormToNEMA=n.NIFTI1.prototype.convertNiftiSFormToNEMA,n.NIFTI2.prototype.nifti_mat33_mul=n.NIFTI1.prototype.nifti_mat33_mul,n.NIFTI2.prototype.nifti_mat33_determ=n.NIFTI1.prototype.nifti_mat33_determ,"undefined"!==typeof t&&t.exports&&(t.exports=n.NIFTI2)},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=i(149),r=i(150),o=i(151);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return c(this,t,e,i)}function c(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,i),r=(t=s(t,n)).write(e,i);r!==n&&(t=t.slice(0,r));return t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|f(e.length);return 0===(t=s(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?s(t,0):d(t,e);if("Buffer"===e.type&&o(e.data))return d(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(h(e),t=s(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function d(t,e){var i=e.length<0?0:0|f(e.length);t=s(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function f(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return U(t).length;default:if(n)return z(t).length;e=(""+e).toLowerCase(),n=!0}}function m(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function _(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:g(t,e,i,n,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):g(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function g(t,e,i,n,r){var o,a=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,i/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var h=-1;for(o=i;o<s;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(i+l>s&&(i=s-l),o=i;o>=0;o--){for(var u=!0,d=0;d<l;d++)if(c(t,o+d)!==c(e,d)){u=!1;break}if(u)return o}return-1}function y(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[i+a]=s}return a}function b(t,e,i,n){return H(z(e,t.length-i),t,i,n)}function v(t,e,i,n){return H(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function w(t,e,i,n){return v(t,e,i,n)}function x(t,e,i,n){return H(U(e),t,i,n)}function A(t,e,i,n){return H(function(t,e){for(var i,n,r,o=[],a=0;a<t.length&&!((e-=2)<0);++a)i=t.charCodeAt(a),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function S(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function M(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o,a,s,l,c=t[r],h=null,u=c>239?4:c>223?3:c>191?2:1;if(r+u<=i)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&c)<<6|63&o)>127&&(h=l);break;case 3:o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(h=l)}null===h?(h=65533,u=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),r+=u}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=E));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return c(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return h(e),e<=0?s(t,e):void 0!==i?"string"==typeof n?s(t,e).fill(i,n):s(t,e).fill(i):s(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return u(null,t)},l.allocUnsafeSlow=function(t){return u(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var a=t[i];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,r),r+=a.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?M(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,i);case"utf8":case"utf-8":return M(this,e,i);case"ascii":return T(this,e,i);case"latin1":case"binary":return k(this,e,i);case"base64":return S(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,r>>>=0,this===t)return 0;for(var o=r-n,a=i-e,s=Math.min(o,a),c=this.slice(n,r),h=t.slice(e,i),u=0;u<s;++u)if(c[u]!==h[u]){o=c[u],a=h[u];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return _(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return _(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return v(this,t,e,i);case"latin1":case"binary":return w(this,t,e,i);case"base64":return x(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function T(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function k(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function C(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=N(t[o]);return r}function I(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,i,n,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function B(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function L(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function D(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function O(t,e,i,n,o){return o||D(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function F(t,e,i,n,o){return o||D(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;i=new l(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUInt8=function(t,e){return e||P(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||P(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||P(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||R(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||R(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);R(this,t,e,i,r-1,-r)}var o=0,a=1,s=0;for(this[e]=255&t;++o<i&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);R(this,t,e,i,r-1,-r)}var o=i-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return O(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return O(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return F(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return F(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,o=n-i;if(this===t&&i<e&&e<n)for(r=o-1;r>=0;--r)t[r+e]=this[r+i];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var a=l.isBuffer(t)?t:z(new l(t,n).toString()),s=a.length;for(o=0;o<i-e;++o)this[o+e]=a[o%s]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var i;e=e||1/0;for(var n=t.length,r=null,o=[],a=0;a<n;++a){if((i=t.charCodeAt(a))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function U(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(54))},function(t,e,i){"use strict";e.byteLength=function(t){var e=c(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){for(var e,i=c(t),n=i[0],a=i[1],s=new o(function(t,e,i){return 3*(e+i)/4-i}(0,n,a)),l=0,h=a>0?n-4:n,u=0;u<h;u+=4)e=r[t.charCodeAt(u)]<<18|r[t.charCodeAt(u+1)]<<12|r[t.charCodeAt(u+2)]<<6|r[t.charCodeAt(u+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=255&e;2===a&&(e=r[t.charCodeAt(u)]<<2|r[t.charCodeAt(u+1)]>>4,s[l++]=255&e);1===a&&(e=r[t.charCodeAt(u)]<<10|r[t.charCodeAt(u+1)]<<4|r[t.charCodeAt(u+2)]>>2,s[l++]=e>>8&255,s[l++]=255&e);return s},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o=[],a=0,s=i-r;a<s;a+=16383)o.push(u(t,a,a+16383>s?s:a+16383));1===r?(e=t[i-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],r[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function h(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[63&t]}function u(t,e,i){for(var n,r=[],o=e;o<i;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),r.push(h(n));return r.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,n,r){var o,a,s=8*r-n-1,l=(1<<s)-1,c=l>>1,h=-7,u=i?r-1:0,d=i?-1:1,f=t[e+u];for(u+=d,o=f&(1<<-h)-1,f>>=-h,h+=s;h>0;o=256*o+t[e+u],u+=d,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+t[e+u],u+=d,h-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=c}return(f?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var a,s,l,c=8*o-r-1,h=(1<<c)-1,u=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=h?(s=0,a=h):a+u>=1?(s=(e*l-1)*Math.pow(2,r),a+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,r),a=0));r>=8;t[i+f]=255&s,f+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;t[i+f]=255&a,f+=p,a/=256,c-=8);t[i+f-p]|=128*m}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){},function(t,e,i){(function(t){function i(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return n.exec(t).slice(1)};function o(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}e.resolve=function(){for(var e="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var a=r>=0?arguments[r]:t.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,n="/"===a.charAt(0))}return e=i(o(e.split("/"),function(t){return!!t}),!n).join("/"),(n?"/":"")+e||"."},e.normalize=function(t){var n=e.isAbsolute(t),r="/"===a(t,-1);return(t=i(o(t.split("/"),function(t){return!!t}),!n).join("/"))||n||(t="."),t&&r&&(t+="/"),(n?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(o(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,i){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=e.resolve(t).substr(1),i=e.resolve(i).substr(1);for(var r=n(t.split("/")),o=n(i.split("/")),a=Math.min(r.length,o.length),s=a,l=0;l<a;l++)if(r[l]!==o[l]){s=l;break}var c=[];for(l=s;l<r.length;l++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=r(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},e.basename=function(t,e){var i=r(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},e.extname=function(t){return r(t)[3]};var a="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,i(53))},function(t,e,i){
/*! dicom-parser - 1.8.1 - 2018-05-16 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */
t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=79)}([function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=i(73),r=i(72),o=i(38);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return c(this,t,e,i)}function c(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e),t}(t,e,i,n):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,i),r=(t=s(t,n)).write(e,i);return r!==n&&(t=t.slice(0,r)),t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|f(e.length);return 0===(t=s(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(t,0):d(t,e);if("Buffer"===e.type&&o(e.data))return d(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(h(e),t=s(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function d(t,e){var i=e.length<0?0:0|f(e.length);t=s(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function f(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return U(t).length;default:if(n)return z(t).length;e=(""+e).toLowerCase(),n=!0}}function m(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function _(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:g(t,e,i,n,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):g(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function g(t,e,i,n,r){var o,a=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,i/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var h=-1;for(o=i;o<s;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(i+l>s&&(i=s-l),o=i;o>=0;o--){for(var u=!0,d=0;d<l;d++)if(c(t,o+d)!==c(e,d)){u=!1;break}if(u)return o}return-1}function y(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[i+a]=s}return a}function b(t,e,i,n){return H(z(e,t.length-i),t,i,n)}function v(t,e,i,n){return H(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function w(t,e,i,n){return v(t,e,i,n)}function x(t,e,i,n){return H(U(e),t,i,n)}function A(t,e,i,n){return H(function(t,e){for(var i,n,r,o=[],a=0;a<t.length&&!((e-=2)<0);++a)i=t.charCodeAt(a),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,t.length-i),t,i,n)}function S(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function M(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var o,a,s,l,c=t[r],h=null,u=c>239?4:c>223?3:c>191?2:1;if(r+u<=i)switch(u){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&c)<<6|63&o)>127&&(h=l);break;case 3:o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(h=l)}null===h?(h=65533,u=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),r+=u}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=E));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return c(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return h(e),e<=0?s(t,e):void 0!==i?"string"==typeof n?s(t,e).fill(i,n):s(t,e).fill(i):s(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return u(null,t)},l.allocUnsafeSlow=function(t){return u(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var a=t[i];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,r),r+=a.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?M(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,i);case"utf8":case"utf-8":return M(this,e,i);case"ascii":return T(this,e,i);case"latin1":case"binary":return k(this,e,i);case"base64":return S(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,r>>>=0,this===t)return 0;for(var o=r-n,a=i-e,s=Math.min(o,a),c=this.slice(n,r),h=t.slice(e,i),u=0;u<s;++u)if(c[u]!==h[u]){o=c[u],a=h[u];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return _(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return _(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return v(this,t,e,i);case"latin1":case"binary":return w(this,t,e,i);case"base64":return x(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function T(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function k(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function C(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=e;o<i;++o)r+=N(t[o]);return r}function I(t,e,i){for(var n=t.slice(e,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,i,n,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function B(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function L(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function D(t,e,i,n,r,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function O(t,e,i,n,o){return o||D(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function F(t,e,i,n,o){return o||D(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;i=new l(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUInt8=function(t,e){return e||P(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||P(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||P(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,o=0;++o<e&&(r*=256);)n+=this[t+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=e,r=1,o=this[t+--n];n>0&&(r*=256);)o+=this[t+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||R(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[e]=255&t;++o<i&&(r*=256);)this[e+o]=t/r&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||R(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):L(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);R(this,t,e,i,r-1,-r)}var o=0,a=1,s=0;for(this[e]=255&t;++o<i&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);R(this,t,e,i,r-1,-r)}var o=i-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):B(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):B(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):L(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):L(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return O(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return O(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return F(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return F(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,o=n-i;if(this===t&&i<e&&e<n)for(r=o-1;r>=0;--r)t[r+e]=this[r+i];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var a=l.isBuffer(t)?t:z(new l(t,n).toString()),s=a.length;for(o=0;o<i-e;++o)this[o+e]=a[o%s]}return this};var G=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var i;e=e||1/0;for(var n=t.length,r=null,o=[],a=0;a<n;++a){if((i=t.charCodeAt(a))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function U(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(0))},function(t,e,i){"use strict";var n=i(10),r=Object.keys||function(t){var e=[];for(var i in t)e.push(i);return e};t.exports=u;var o=i(6);o.inherits=i(5);var a=i(35),s=i(18);o.inherits(u,a);for(var l=r(s.prototype),c=0;c<l.length;c++){var h=l[c];u.prototype[h]||(u.prototype[h]=s.prototype[h])}function u(t){if(!(this instanceof u))return new u(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),u.prototype._destroy=function(t,e){this.push(null),this.end(),n.nextTick(e,t)}},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var l,c=[],h=!1,u=-1;function d(){h&&l&&(h=!1,l.length?c=l.concat(c):u=-1,c.length&&f())}function f(){if(!h){var t=s(d);h=!0;for(var e=c.length;e;){for(l=c,c=[];++u<e;)l&&l[u].run();u=-1,e=c.length}l=null,h=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new p(t,e)),1!==c.length||h||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(void 0===t)throw"dicomParser.readTag: missing required parameter 'byteStream'";var e=256*t.readUint16()*256,i=t.readUint16();return"x"+("00000000"+(e+i).toString(16)).substr(-8)}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){(function(t){function i(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===i(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===i(t)},e.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,i(1).Buffer)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(14);function o(t,e){return void 0!==t.parser?t.parser:e}var a=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.byteArrayParser=e,this.byteArray=i,this.elements=n}return n(t,[{key:"uint16",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readUint16(this.byteArray,i.dataOffset+2*e)}},{key:"int16",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readInt16(this.byteArray,i.dataOffset+2*e)}},{key:"uint32",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readUint32(this.byteArray,i.dataOffset+4*e)}},{key:"int32",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readInt32(this.byteArray,i.dataOffset+4*e)}},{key:"float",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readFloat(this.byteArray,i.dataOffset+4*e)}},{key:"double",value:function(t,e){var i=this.elements[t];if(e=void 0!==e?e:0,i&&0!==i.length)return o(i,this.byteArrayParser).readDouble(this.byteArray,i.dataOffset+8*e)}},{key:"numStringValues",value:function(t){var e=this.elements[t];if(e&&e.length>0){var i=(0,r.readFixedString)(this.byteArray,e.dataOffset,e.length).match(/\\/g);return null===i?1:i.length+1}}},{key:"string",value:function(t,e){var i=this.elements[t];if(i&&i.length>0){var n=(0,r.readFixedString)(this.byteArray,i.dataOffset,i.length);return e>=0?n.split("\\")[e].trim():n.trim()}}},{key:"text",value:function(t,e){var i=this.elements[t];if(i&&i.length>0){var n=(0,r.readFixedString)(this.byteArray,i.dataOffset,i.length);return e>=0?n.split("\\")[e].replace(/ +$/,""):n.replace(/ +$/,"")}}},{key:"floatString",value:function(t,e){var i=this.elements[t];if(i&&i.length>0){e=void 0!==e?e:0;var n=this.string(t,e);if(void 0!==n)return parseFloat(n)}}},{key:"intString",value:function(t,e){var i=this.elements[t];if(i&&i.length>0){e=void 0!==e?e:0;var n=this.string(t,e);if(void 0!==n)return parseInt(n)}}},{key:"attributeTag",value:function(t){var e=this.elements[t];if(e&&4===e.length){var i=o(e,this.byteArrayParser).readUint16,n=this.byteArray,r=e.dataOffset;return"x"+("00000000"+(256*i(n,r)*256+i(n,r+2)).toString(16)).substr(-8)}}}]),t}();e.default=a},function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){var e,i,n,r,o,a;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(a=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)o=t[e],a.set(o,r),r+=o.length;return a}},a={arraySet:function(t,e,i,n,r){for(var o=0;o<n;o++)t[r+o]=e[i+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(n)},function(t,e,i){var n=i(1),r=n.Buffer;function o(t,e){for(var i in t)e[i]=t[i]}function a(t,e,i){return r(t,e,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(o(n,e),e.Buffer=a),o(r,a),a.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,i)},a.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=r(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},function(t,e,i){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,i,n,r){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,i)});case 3:return e.nextTick(function(){t.call(null,i,n)});case 4:return e.nextTick(function(){t.call(null,i,n,r)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,i(3))},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,i,n){if(void 0!==t&&e instanceof t)return e.slice(i,i+n);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+i,n);throw"dicomParser.from: unknown type for byteArray"}}).call(this,i(1).Buffer)},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(11),a=(n=o)&&n.__esModule?n:{default:n},s=i(14),l=function(){function e(i,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===i)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===n)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(n instanceof Uint8Array==0&&n instanceof t==0)throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(r<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(r>=n.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=i,this.byteArray=n,this.position=r||0,this.warnings=[]}return r(e,[{key:"seek",value:function(t){if(this.position+t<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=t}},{key:"readByteStream",value:function(t){if(this.position+t>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var i=(0,a.default)(this.byteArray,this.position,t);return this.position+=t,new e(this.byteArrayParser,i)}},{key:"readUint16",value:function(){var t=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,t}},{key:"readUint32",value:function(){var t=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,t}},{key:"readFixedString",value:function(t){var e=(0,s.readFixedString)(this.byteArray,this.position,t);return this.position+=t,e}}]),e}();e.default=l}).call(this,i(1).Buffer)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(void 0===t)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var e={tag:(0,o.default)(t),length:t.readUint32(),dataOffset:t.position};if("xfffee000"!==e.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset "+t.position;return e};var n,r=i(4),o=(n=r)&&n.__esModule?n:{default:n}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.readFixedString=function(t,e,i){if(i<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(e+i>t.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var n,r="",o=0;o<i;o++){if(0===(n=t[e+o]))return e+=i,r;r+=String.fromCharCode(n)}return r}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var l={tag:(0,a.default)(t),vr:t.readFixedString(2)};return 2===c(l.vr)?(l.length=t.readUint16(),l.dataOffset=t.position):(t.seek(2),l.length=t.readUint32(),l.dataOffset=t.position),4294967295===l.length&&(l.hadUndefinedLength=!0),l.tag===i?l:"SQ"===l.vr?((0,s.default)(t,l,e),l):4294967295===l.length?"x7fe00010"===l.tag?((0,n.default)(t,l,e),l):"UN"===l.vr?((0,r.default)(t,l),l):((0,o.default)(t,l),l):(t.seek(l.length),l)};var n=l(i(42)),r=l(i(41)),o=l(i(24)),a=l(i(4)),s=l(i(40));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){return"OB"===t||"OW"===t||"SQ"===t||"OF"===t||"UT"===t||"UN"===t?4:2}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseDicomDataSetExplicit=function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(i=void 0===i?e.byteArray.length:i,void 0===e)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(i<e.position||i>e.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var o=t.elements;e.position<i;){var a=(0,n.default)(e,t.warnings,r.untilTag);if(o[a.tag]=a,a.tag===r.untilTag)return}if(e.position>i)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"},e.parseDicomDataSetImplicit=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(i=void 0===i?t.byteArray.length:i,void 0===e)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(i<e.position||i>e.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var o=t.elements;e.position<i;){var a=(0,r.default)(e,n.untilTag,n.vrCallback);if(o[a.tag]=a,a.tag===n.untilTag)return}};var n=o(i(15)),r=o(i(23));function o(t){return t&&t.__esModule?t:{default:t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i,s,c){if(s=s||1,c=c||e.fragments,void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===i)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===s)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==e.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==e.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==e.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(e.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(i<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(i>=e.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(s<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(i+s>e.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var h=new r.default(t.byteArrayParser,t.byteArray,e.dataOffset),u=(0,o.default)(h);if("xfffee000"!==u.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";h.seek(u.length);var d=h.position;if(1===s)return(0,a.default)(h.byteArray,d+c[i].offset+8,c[i].length);for(var f=l(c,i,s),p=(0,n.default)(h.byteArray,f),m=0,_=i;_<i+s;_++)for(var g=d+c[_].offset+8,y=0;y<c[_].length;y++)p[m++]=h.byteArray[g++];return p};var n=s(i(22)),r=s(i(12)),o=s(i(13)),a=s(i(11));function s(t){return t&&t.__esModule?t:{default:t}}var l=function(t,e,i){for(var n=0,r=e;r<e+i;r++)n+=t[r].length;return n}},function(t,e,i){"use strict";(function(e,n,r){var o=i(10);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,i){var n=t.entry;for(t.entry=null;n;){var r=n.callback;e.pendingcb--,r(void 0),n=n.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=y;var s,l=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?n:o.nextTick;y.WritableState=g;var c=i(6);c.inherits=i(5);var h,u={deprecate:i(61)},d=i(34),f=i(9).Buffer,p=r.Uint8Array||function(){},m=i(33);function _(){}function g(t,e){s=s||i(2),t=t||{};var n=e instanceof s;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,c=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(c||0===c)?c:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===t.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var i=t._writableState,n=i.sync,r=i.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(i),e)!function(t,e,i,n,r){--e.pendingcb,i?(o.nextTick(r,n),o.nextTick(S,t,e),t._writableState.errorEmitted=!0,t.emit("error",n)):(r(n),t._writableState.errorEmitted=!0,t.emit("error",n),S(t,e))}(t,i,n,e,r);else{var a=x(i);a||i.corked||i.bufferProcessing||!i.bufferedRequest||w(t,i),n?l(v,t,i,a,r):v(t,i,a,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function y(t){if(s=s||i(2),!(h.call(y,this)||this instanceof s))return new y(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function b(t,e,i,n,r,o,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,i?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function v(t,e,i,n){i||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,n(),S(t,e)}function w(t,e){e.bufferProcessing=!0;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var n=e.bufferedRequestCount,r=new Array(n),o=e.corkedRequestsFree;o.entry=i;for(var s=0,l=!0;i;)r[s]=i,i.isBuf||(l=!1),i=i.next,s+=1;r.allBuffers=l,b(t,e,!0,e.length,r,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;i;){var c=i.chunk,h=i.encoding,u=i.callback;if(b(t,e,!1,e.objectMode?1:c.length,c,h,u),i=i.next,e.bufferedRequestCount--,e.writing)break}null===i&&(e.lastBufferedRequest=null)}e.bufferedRequest=i,e.bufferProcessing=!1}function x(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function A(t,e){t._final(function(i){e.pendingcb--,i&&t.emit("error",i),e.prefinished=!0,t.emit("prefinish"),S(t,e)})}function S(t,e){var i=x(e);return i&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(A,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}c.inherits(y,d),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:u.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(t){return!!h.call(this,t)||this===y&&t&&t._writableState instanceof g}})):h=function(t){return t instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(t,e,i){var n,r=this._writableState,a=!1,s=!r.objectMode&&(n=t,f.isBuffer(n)||n instanceof p);return s&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(i=e,e=null),s?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof i&&(i=_),r.ended?function(t,e){var i=new Error("write after end");t.emit("error",i),o.nextTick(e,i)}(this,i):(s||function(t,e,i,n){var r=!0,a=!1;return null===i?a=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),o.nextTick(n,a),r=!1),r}(this,r,t,i))&&(r.pendingcb++,a=function(t,e,i,n,r,o){if(!i){var a=function(t,e,i){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,i)),e}(e,n,r);n!==a&&(i=!0,r="buffer",n=a)}var s=e.objectMode?1:n.length;e.length+=s;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,s,n,r,o);return l}(this,r,s,t,e,i)),a},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},y.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},y.prototype._write=function(t,e,i){i(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(t,e,i){var n=this._writableState;"function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!==t&&void 0!==t&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(t,e,i){e.ending=!0,S(t,e),i&&(e.finished?o.nextTick(i):t.once("finish",i)),e.ended=!0,t.writable=!1}(this,n,i)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,i(3),i(63).setImmediate,i(0))},function(t,e,i){(e=t.exports=i(35)).Stream=e,e.Readable=e,e.Writable=i(18),e.Duplex=i(2),e.Transform=i(31),e.PassThrough=i(60)},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,a,s,l,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(o(i=this._events[t]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(r(i))for(s=Array.prototype.slice.call(arguments,1),a=(c=i.slice()).length,l=0;l<a;l++)c[l].apply(this,s);return!0},i.prototype.addListener=function(t,e){var a;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var i=!1;function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},i.prototype.removeListener=function(t,e){var i,o,a,s;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(i=this._events[t]).length,o=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(i)){for(s=a;s-- >0;)if(i[s]===e||i[s].listener&&i[s].listener===e){o=s;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[t]))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={readUint16:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(e+2>t.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return t[e]+256*t[e+1]},readInt16:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(e+2>t.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";var i=t[e]+(t[e+1]<<8);return 32768&i&&(i=i-65535-1),i},readUint32:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(e+4>t.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return t[e]+256*t[e+1]+256*t[e+2]*256+256*t[e+3]*256*256},readInt32:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(e+4>t.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)},readFloat:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(e+4>t.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var i=new Uint8Array(4);return i[0]=t[e],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],new Float32Array(i.buffer)[0]},readDouble:function(t,e){if(e<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(e+8>t.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var i=new Uint8Array(8);return i[0]=t[e],i[1]=t[e+1],i[2]=t[e+2],i[3]=t[e+3],i[4]=t[e+4],i[5]=t[e+5],i[6]=t[e+6],i[7]=t[e+7],new Float64Array(i.buffer)[0]}}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,i){if(void 0!==t&&e instanceof t)return t.alloc(i);if(e instanceof Uint8Array)return new Uint8Array(i);throw"dicomParser.alloc: unknown type for byteArray"}}).call(this,i(1).Buffer)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var a={tag:(0,o.default)(t),length:t.readUint32(),dataOffset:t.position};return 4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===e?a:s(a,t,i)?((0,r.default)(t,a),a):a.hadUndefinedLength?((0,n.default)(t,a),a):(t.seek(a.length),a)};var n=a(i(24)),r=a(i(39)),o=a(i(4));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e,i){if(void 0!==i)return"SQ"===i(t.tag);if(e.position+4<=e.byteArray.length){var n=(0,o.default)(e);return e.seek(-4),"xfffee000"===n||"xfffee0dd"===n}return e.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(void 0===t)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var i=t.byteArray.length-8;t.position<=i;){var n=t.readUint16();if(65534===n){var r=t.readUint16();if(57357===r){var o=t.readUint32();return 0!==o&&t.warnings("encountered non zero length following item delimiter at position "+(t.position-4)+" while reading element of undefined length with tag "+e.tag),void(e.length=t.position-e.dataOffset)}}}e.length=t.byteArray.length-e.dataOffset,t.seek(t.byteArray.length-t.position)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0};e.isStringVr=function(t){return n[t]},e.isPrivateTag=function(t){return parseInt(t[4],10)%2==1},e.parsePN=function(t){if(void 0!==t){var e=t.split("^");return{familyName:e[0],givenName:e[1],middleName:e[2],prefix:e[3],suffix:e[4]}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i,n,r){if(n=n||e.basicOffsetTable,r=r||e.fragments,void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===n)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==e.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==e.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==e.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===e.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===n.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(i<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(i>=n.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var l=n[i],c=a(r,l);if(void 0===c)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";var h=s(i,n,r,c);return(0,o.default)(t,e,c,h,r)};var n,r=i(17),o=(n=r)&&n.__esModule?n:{default:n},a=function(t,e){for(var i=0;i<t.length;i++)if(t[i].offset===e)return i},s=function(t,e,i,n){if(t===e.length-1)return i.length-n;for(var r=e[t+1],o=n+1;o<i.length;o++)if(i[o].offset===r)return o-n;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"}},function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var o=n,a=r+i;t^=-1;for(var s=r;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},function(t,e,i){"use strict";t.exports=function(t,e,i,n){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{o=o+(r=r+e[n++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},function(t,e,i){(function(t,n){var r=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(s(arguments[i]));return e.join(" ")}i=1;for(var n=arguments,o=n.length,a=String(t).replace(r,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}}),l=n[i];i<o;l=n[++i])m(l)||!v(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(i,r){if(y(t.process))return function(){return e.deprecate(i,r).apply(this,arguments)};if(!0===n.noDeprecation)return i;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),o=!0}return i.apply(this,arguments)}};var o,a={};function s(t,i){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(i)?n.showHidden=i:i&&e._extend(n,i),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),h(n,t,n.depth)}function l(t,e){var i=s.styles[e];return i?"["+s.colors[i][0]+"m"+t+"["+s.colors[i][1]+"m":t}function c(t,e){return t}function h(t,i,n){if(t.customInspect&&i&&A(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,t);return g(r)||(r=h(t,r,n)),r}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(g(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return _(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}(t,i);if(o)return o;var a=Object.keys(i),s=function(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(i)),x(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(i);if(0===a.length){if(A(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(b(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return t.stylize(Date.prototype.toString.call(i),"date");if(x(i))return u(i)}var c,v="",S=!1,M=["{","}"];return f(i)&&(S=!0,M=["[","]"]),A(i)&&(v=" [Function"+(i.name?": "+i.name:"")+"]"),b(i)&&(v=" "+RegExp.prototype.toString.call(i)),w(i)&&(v=" "+Date.prototype.toUTCString.call(i)),x(i)&&(v=" "+u(i)),0!==a.length||S&&0!=i.length?n<0?b(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),c=S?function(t,e,i,n,r){for(var o=[],a=0,s=e.length;a<s;++a)T(e,String(a))?o.push(d(t,e,i,n,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(t,e,i,n,r,!0))}),o}(t,i,n,s,a):a.map(function(e){return d(t,i,n,s,e,S)}),t.seen.pop(),function(t,e,i){return t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}(c,v,M)):M[0]+v+M[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,i,n,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),T(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=m(i)?h(t,l.value,null):h(t,l.value,i-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function m(t){return null===t}function _(t){return"number"==typeof t}function g(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return v(t)&&"[object RegExp]"===S(t)}function v(t){return"object"==typeof t&&null!==t}function w(t){return v(t)&&"[object Date]"===S(t)}function x(t){return v(t)&&("[object Error]"===S(t)||t instanceof Error)}function A(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(o)&&(o=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var i=n.pid;a[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,i,n)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=_,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=v,e.isDate=w,e.isError=x,e.isFunction=A,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=i(54);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,i;console.log("%s - %s",(t=new Date,i=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":"),[t.getDate(),E[t.getMonth()],i].join(" ")),e.format.apply(e,arguments))},e.inherits=i(53),e._extend=function(t,e){if(!e||!v(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,i(0),i(3))},function(t,e,i){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function n(t,e){if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0}function r(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=i(29),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,l="foo"===function(){}.name;function c(t){return Object.prototype.toString.call(t)}function h(t){return!r(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var u=t.exports=g,d=/\s*function\s+([^\(\s]*)\s*/;function f(t){if(o.isFunction(t)){if(l)return t.name;var e=t.toString().match(d);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(l||!o.isFunction(t))return o.inspect(t);var e=f(t);return"[Function"+(e?": "+e:"")+"]"}function _(t,e,i,n,r){throw new u.AssertionError({message:i,actual:t,expected:e,operator:n,stackStartFunction:r})}function g(t,e){t||_(t,!0,e,"==",u.ok)}function y(t,e,i,a){if(t===e)return!0;if(r(t)&&r(e))return 0===n(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(h(t)&&h(e)&&c(t)===c(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(r(t)!==r(e))return!1;var l=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,i,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=b(t),a=b(e);if(r&&!a||!r&&a)return!1;if(r)return t=s.call(t),e=s.call(e),y(t,e,i);var l,c,h=x(t),u=x(e);if(h.length!==u.length)return!1;for(h.sort(),u.sort(),c=h.length-1;c>=0;c--)if(h[c]!==u[c])return!1;for(c=h.length-1;c>=0;c--)if(l=h[c],!y(t[l],e[l],i,n))return!1;return!0}(t,e,i,a))}return i?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function v(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,i,n){var r;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),t&&!r&&_(r,i,"Missing expected exception"+n);var a="string"==typeof n,s=!t&&o.isError(r),l=!t&&r&&!i;if((s&&a&&v(r,i)||l)&&_(r,i,"Got unwanted exception"+n),t&&r&&i&&!v(r,i)||!t&&r)throw r}u.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=p(m((e=this).actual),128)+" "+e.operator+" "+p(m(e.expected),128),this.generatedMessage=!0);var i=t.stackStartFunction||_;if(Error.captureStackTrace)Error.captureStackTrace(this,i);else{var n=new Error;if(n.stack){var r=n.stack,o=f(i),a=r.indexOf("\n"+o);if(a>=0){var s=r.indexOf("\n",a+1);r=r.substring(s+1)}this.stack=r}}},o.inherits(u.AssertionError,Error),u.fail=_,u.ok=g,u.equal=function(t,e,i){t!=e&&_(t,e,i,"==",u.equal)},u.notEqual=function(t,e,i){t==e&&_(t,e,i,"!=",u.notEqual)},u.deepEqual=function(t,e,i){y(t,e,!1)||_(t,e,i,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(t,e,i){y(t,e,!0)||_(t,e,i,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(t,e,i){y(t,e,!1)&&_(t,e,i,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function t(e,i,n){y(e,i,!0)&&_(e,i,n,"notDeepStrictEqual",t)},u.strictEqual=function(t,e,i){t!==e&&_(t,e,i,"===",u.strictEqual)},u.notStrictEqual=function(t,e,i){t===e&&_(t,e,i,"!==",u.notStrictEqual)},u.throws=function(t,e,i){w(!0,t,e,i)},u.doesNotThrow=function(t,e,i){w(!1,t,e,i)},u.ifError=function(t){if(t)throw t};var x=Object.keys||function(t){var e=[];for(var i in t)a.call(t,i)&&e.push(i);return e}}).call(this,i(0))},function(t,e,i){"use strict";t.exports=o;var n=i(2),r=i(6);function o(t){if(!(this instanceof o))return new o(t);n.call(this,t),this._transformState={afterTransform:function(t,e){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=e&&this.push(e),n(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush(function(e,i){s(t,e,i)}):s(this,null,null)}function s(t,e,i){if(e)return t.emit("error",e);if(null!=i&&t.push(i),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=i(5),r.inherits(o,n),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,n.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,i){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,i){var n=this._transformState;if(n.writecb=i,n.writechunk=t,n.writeencoding=e,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var i=this;n.prototype._destroy.call(this,t,function(t){e(t),i.emit("close")})}},function(t,e,i){"use strict";var n=i(9).Buffer,r=n.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(n.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=h,this.end=u,e=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:-1}function s(t){var e=this.lastTotal-this.lastNeed,i=function(t,e,i){if(128!=(192&e[0]))return t.lastNeed=0,"�".repeat(i);if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�".repeat(i+1);if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�".repeat(i+2)}}(this,t,e);return void 0!==i?i:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var i=t.toString("utf16le",e);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,i)}return e}function h(t,e){var i=(t.length-e)%3;return 0===i?t.toString("base64",e):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-i))}function u(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function f(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,i;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<t.length?e?e+this.text(t,i):this.text(t,i):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�".repeat(this.lastTotal-this.lastNeed):e},o.prototype.text=function(t,e){var i=function(t,e,i){var n=e.length-1;if(n<i)return 0;var r=a(e[n]);return r>=0?(r>0&&(t.lastNeed=r-1),r):--n<i?0:(r=a(e[n]))>=0?(r>0&&(t.lastNeed=r-2),r):--n<i?0:(r=a(e[n]))>=0?(r>0&&(2===r?r=0:t.lastNeed=r-3),r):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;var n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,i){"use strict";var n=i(10);function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||n.nextTick(r,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(n.nextTick(r,i,t),i._writableState&&(i._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,i){t.exports=i(20).EventEmitter},function(t,e,i){"use strict";(function(e,n){var r=i(10);t.exports=b;var o,a=i(38);b.ReadableState=y,i(20).EventEmitter;var s=function(t,e){return t.listeners(e).length},l=i(34),c=i(9).Buffer,h=e.Uint8Array||function(){},u=i(6);u.inherits=i(5);var d=i(66),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=i(65),_=i(33);u.inherits(b,l);var g=["error","close","destroy","pause","resume"];function y(t,e){o=o||i(2),t=t||{};var n=e instanceof o;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=i(32).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function b(t){if(o=o||i(2),!(this instanceof b))return new b(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function v(t,e,i,n,r){var o,a=t._readableState;return null===e?(a.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var i=e.decoder.end();i&&i.length&&(e.buffer.push(i),e.length+=e.objectMode?1:i.length)}e.ended=!0,S(t)}}(t,a)):(r||(o=function(t,e){var i,n;return n=e,c.isBuffer(n)||n instanceof h||"string"==typeof e||void 0===e||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=function(t){return c.from(t)}(e)),n?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!i?(e=a.decoder.write(e),a.objectMode||0!==e.length?w(t,a,e,!1):E(t,a)):w(t,a,e,!1))):n||(a.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function w(t,e,i,n){e.flowing&&0===e.length&&!e.sync?(t.emit("data",i),t.read(0)):(e.length+=e.objectMode?1:i.length,n?e.buffer.unshift(i):e.buffer.push(i),e.needReadable&&S(t)),E(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=_.destroy,b.prototype._undestroy=_.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof t&&((e=e||n.defaultEncoding)!==n.encoding&&(t=c.from(t,e),e=""),i=!0),v(this,t,e,!1,i)},b.prototype.unshift=function(t){return v(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return p||(p=i(32).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var x=8388608;function A(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=x?t=x:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(f("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(M,t):M(t))}function M(t){f("emit readable"),t.emit("readable"),I(t)}function E(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(T,t,e))}function T(t,e){for(var i=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(f("maybeReadMore read 0"),t.read(0),i!==e.length);)i=e.length;e.readingMore=!1}function k(t){f("readable nexttick read 0"),t.read(0)}function C(t,e){e.reading||(f("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),I(t),e.flowing&&!e.reading&&t.read(0)}function I(t){var e=t._readableState;for(f("flow",e.flowing);e.flowing&&null!==t.read(););}function P(t,e){return 0===e.length?null:(e.objectMode?i=e.buffer.shift():!t||t>=e.length?(i=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):i=function(t,e,i){var n;return t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):n=t===e.head.data.length?e.shift():i?function(t,e){var i=e.head,n=1,r=i.data;for(t-=r.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?r+=o:r+=o.slice(0,t),0==(t-=a)){a===o.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(a));break}++n}return e.length-=n,r}(t,e):function(t,e){var i=c.allocUnsafe(t),n=e.head,r=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),0==(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++r}return e.length-=r,i}(t,e),n}(t,e.buffer,e.decoder),i);var i}function R(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,r.nextTick(B,e,t))}function B(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function L(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}b.prototype.read=function(t){f("read",t),t=parseInt(t,10);var e=this._readableState,i=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return f("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?R(this):S(this),null;if(0===(t=A(t,e))&&e.ended)return 0===e.length&&R(this),null;var n,r=e.needReadable;return f("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&f("length less than watermark",r=!0),e.ended||e.reading?f("reading or ended",r=!1):r&&(f("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=A(i,e))),null===(n=t>0?P(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),i!==t&&e.ended&&R(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,e);var l=e&&!1===e.end||t===n.stdout||t===n.stderr?y:c;function c(){f("onend"),t.end()}o.endEmitted?r.nextTick(l):i.once("end",l),t.on("unpipe",function e(n,r){f("onunpipe"),n===i&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,f("cleanup"),t.removeListener("close",_),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",m),t.removeListener("unpipe",e),i.removeListener("end",c),i.removeListener("end",y),i.removeListener("data",p),u=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||h())});var h=function(t){return function(){var e=t._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,I(t))}}(i);t.on("drain",h);var u=!1,d=!1;function p(e){f("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==L(o.pipes,t))&&!u&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,d=!0),i.pause())}function m(e){f("onerror",e),y(),t.removeListener("error",m),0===s(t,"error")&&t.emit("error",e)}function _(){t.removeListener("finish",g),y()}function g(){f("onfinish"),t.removeListener("close",_),y()}function y(){f("unpipe"),i.unpipe(t)}return i.on("data",p),function(t,e,i){if("function"==typeof t.prependListener)return t.prependListener(e,i);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(i):t._events[e]=[i,t._events[e]]:t.on(e,i)}(t,"error",m),t.once("close",_),t.once("finish",g),t.emit("pipe",i),o.flowing||(f("pipe resume"),i.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,i={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,i),this);if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,i);return this}var a=L(e.pipes,t);return-1===a?this:(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,i),this)},b.prototype.on=function(t,e){var i=l.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&S(this):r.nextTick(k,this))}return i},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(f("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(C,t,e))}(this,t)),this},b.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,i=this._readableState,n=!1;for(var r in t.on("end",function(){if(f("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(r){f("wrapped data"),i.decoder&&(r=i.decoder.write(r)),(!i.objectMode||null!==r&&void 0!==r)&&(i.objectMode||r&&r.length)&&(e.push(r)||(n=!0,t.pause()))}),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var o=0;o<g.length;o++)t.on(g[o],this.emit.bind(this,g[o]));return this._read=function(e){f("wrapped _read",e),n&&(n=!1,t.resume())},this},b._fromList=P}).call(this,i(0),i(3))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(void 0===t)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var i=new n.default(o.default,t);return function(){!function(){if(i.seek(128),"DICM"!==i.readFixedString(4))throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file."}();for(var t=[],e={};i.position<i.byteArray.length;){var n=i.position,s=(0,a.default)(i,t);if(s.tag>"x0002ffff"){i.position=n;break}s.parser=o.default,e[s.tag]=s}var l=new r.default(i.byteArrayParser,i.byteArray,e);return l.warnings=i.warnings,l.position=i.position,l}()};var n=s(i(12)),r=s(i(7)),o=s(i(21)),a=s(i(15));function s(t){return t&&t.__esModule?t:{default:t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={readUint16:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(e+2>t.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(t[e]<<8)+t[e+1]},readInt16:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(e+2>t.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";var i=(t[e]<<8)+t[e+1];return 32768&i&&(i=i-65535-1),i},readUint32:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(e+4>t.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*t[e]+t[e+1])+t[e+2])+t[e+3]},readInt32:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(e+4>t.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]},readFloat:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(e+4>t.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var i=new Uint8Array(4);return i[3]=t[e],i[2]=t[e+1],i[1]=t[e+2],i[0]=t[e+3],new Float32Array(i.buffer)[0]},readDouble:function(t,e){if(e<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(e+8>t.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var i=new Uint8Array(8);return i[7]=t[e],i[6]=t[e+1],i[5]=t[e+2],i[4]=t[e+3],i[3]=t[e+4],i[2]=t[e+5],i[1]=t[e+6],i[0]=t[e+7],new Float64Array(i.buffer)[0]}}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";e.items=[],4294967295===e.length?function(t,e,i){for(;t.position+4<=t.byteArray.length;){var n=(0,a.default)(t);if(t.seek(-4),"xfffee0dd"===n)return e.length=t.position-e.dataOffset,t.seek(8),e;var r=c(t,i);e.items.push(r)}t.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),e.length=t.byteArray.length-e.dataOffset}(t,e,i):function(t,e,i){for(var n=e.dataOffset+e.length;t.position<n;){var r=c(t,i);e.items.push(r)}}(t,e,i)};var n=l(i(7)),r=l(i(23)),o=l(i(13)),a=l(i(4)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(16));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var i=(0,o.default)(t);return 4294967295===i.length?(i.hadUndefinedLength=!0,i.dataSet=function(t,e){for(var i={};t.position<t.byteArray.length;){var o=(0,r.default)(t,void 0,e);if(i[o.tag]=o,"xfffee00d"===o.tag)return new n.default(t.byteArrayParser,t.byteArray,i)}return t.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new n.default(t.byteArrayParser,t.byteArray,i)}(t,e),i.length=t.position-i.dataOffset):(i.dataSet=new n.default(t.byteArrayParser,t.byteArray,{}),s.parseDicomDataSetImplicit(i.dataSet,t,t.position+i.length,{vrCallback:e})),i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";e.items=[],4294967295===e.length?function(t,e,i){for(;t.position+4<=t.byteArray.length;){var n=(0,a.default)(t);if(t.seek(-4),"xfffee0dd"===n)return e.length=t.position-e.dataOffset,t.seek(8),e;var r=c(t,i);e.items.push(r)}i.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),e.length=t.position-e.dataOffset}(t,e,i):function(t,e,i){for(var n=e.dataOffset+e.length;t.position<n;){var r=c(t,i);e.items.push(r)}}(t,e,i)};var n=l(i(7)),r=l(i(15)),o=l(i(13)),a=l(i(4)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(16));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var i=(0,o.default)(t);return 4294967295===i.length?(i.hadUndefinedLength=!0,i.dataSet=function(t,e){for(var i={};t.position<t.byteArray.length;){var o=(0,r.default)(t,e);if(i[o.tag]=o,"xfffee00d"===o.tag)return new n.default(t.byteArrayParser,t.byteArray,i)}return e.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new n.default(t.byteArrayParser,t.byteArray,i)}(t,e),i.length=t.position-i.dataOffset):(i.dataSet=new n.default(t.byteArrayParser,t.byteArray,{}),s.parseDicomDataSetExplicit(i.dataSet,t,t.position+i.length)),i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(void 0===t)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var i=t.byteArray.length-8;t.position<=i;){var n=t.readUint16();if(65534===n){var r=t.readUint16();if(57565===r){var o=t.readUint32();return 0!==o&&t.warnings("encountered non zero length following item delimiter at position "+(t.position-4)+" while reading element of undefined length with tag "+e.tag),void(e.length=t.position-e.dataOffset)}}}e.length=t.byteArray.length-e.dataOffset,t.seek(t.byteArray.length-t.position)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(e.encapsulatedPixelData=!0,e.basicOffsetTable=[],e.fragments=[],"xfffee000"!==(0,o.default)(t))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var n=t.readUint32()/4,r=0;r<n;r++){var a=t.readUint32();e.basicOffsetTable.push(a)}for(var s=t.position;t.position<t.byteArray.length;){var l=(0,o.default)(t),c=t.readUint32();if("xfffee0dd"===l)return t.seek(c),void(e.length=t.position-e.dataOffset);if("xfffee000"!==l)return i&&i.push("unexpected tag "+l+" while searching for end of pixel data element with undefined length"),c>t.byteArray.length-t.position&&(c=t.byteArray.length-t.position),e.fragments.push({offset:t.position-s-8,position:t.position,length:c}),t.seek(c),void(e.length=t.position-e.dataOffset);e.fragments.push({offset:t.position-s-8,position:t.position,length:c}),t.seek(c)}i&&i.push("pixel data element "+e.tag+" missing sequence delimiter tag xfffee0dd")};var n,r=i(4),o=(n=r)&&n.__esModule?n:{default:n}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(void 0===t||void 0===e)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===e.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var i,r=e.vr,o=e.tag;function a(e,i){for(var n="",r=0;r<e;r++)0!==r&&(n+="/"),n+=i.call(t,o,r).toString();return n}if(!0===n.isStringVr(r))i=t.string(o);else{if("AT"===r){var s=t.uint32(o);if(void 0===s)return;return s<0&&(s=4294967295+s+1),"x"+s.toString(16).toUpperCase()}"US"===r?i=a(e.length/2,t.uint16):"SS"===r?i=a(e.length/2,t.int16):"UL"===r?i=a(e.length/4,t.uint32):"SL"===r?i=a(e.length/4,t.int32):"FD"===r?i=a(e.length/8,t.double):"FL"===r&&(i=a(e.length/4,t.float))}return i};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(25))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(a||(a=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===i)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==e.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==e.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==e.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(i<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==e.basicOffsetTable.length?(0,n.default)(t,e,i):(0,r.default)(t,e,0,e.fragments.length)};var n=o(i(26)),r=o(i(17));function o(t){return t&&t.__esModule?t:{default:t}}var a=!1},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){"use strict";var n=i(8),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,c,h,u,d){var f,p,m,_,g,y,b,v,w,x=d.bits,A=0,S=0,M=0,E=0,T=0,k=0,C=0,I=0,P=0,R=0,B=null,L=0,D=new n.Buf16(16),O=new n.Buf16(16),F=null,G=0;for(A=0;A<=15;A++)D[A]=0;for(S=0;S<l;S++)D[e[i+S]]++;for(T=x,E=15;E>=1&&0===D[E];E--);if(T>E&&(T=E),0===E)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(M=1;M<E&&0===D[M];M++);for(T<M&&(T=M),I=1,A=1;A<=15;A++)if(I<<=1,(I-=D[A])<0)return-1;if(I>0&&(0===t||1!==E))return-1;for(O[1]=0,A=1;A<15;A++)O[A+1]=O[A]+D[A];for(S=0;S<l;S++)0!==e[i+S]&&(u[O[e[i+S]]++]=S);if(0===t?(B=F=u,y=19):1===t?(B=r,L-=257,F=o,G-=257,y=256):(B=a,F=s,y=-1),R=0,S=0,A=M,g=h,k=T,C=0,m=-1,_=(P=1<<T)-1,1===t&&P>852||2===t&&P>592)return 1;for(;;){b=A-C,u[S]<y?(v=0,w=u[S]):u[S]>y?(v=F[G+u[S]],w=B[L+u[S]]):(v=96,w=0),f=1<<A-C,M=p=1<<k;do{c[g+(R>>C)+(p-=f)]=b<<24|v<<16|w|0}while(0!==p);for(f=1<<A-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,S++,0==--D[A]){if(A===E)break;A=e[i+u[S]]}if(A>T&&(R&_)!==m){for(0===C&&(C=T),g+=M,I=1<<(k=A-C);k+C<E&&!((I-=D[k+C])<=0);)k++,I<<=1;if(P+=1<<k,1===t&&P>852||2===t&&P>592)return 1;c[m=R&_]=T<<24|k<<16|g-h|0}}return 0!==R&&(c[g+R]=A-C<<24|64<<16|0),d.bits=T,0}},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,r,o,a,s,l,c,h,u,d,f,p,m,_,g,y,b,v,w,x,A,S,M,E;i=t.state,n=t.next_in,M=t.input,r=n+(t.avail_in-5),o=t.next_out,E=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=i.dmax,c=i.wsize,h=i.whave,u=i.wnext,d=i.window,f=i.hold,p=i.bits,m=i.lencode,_=i.distcode,g=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;t:do{p<15&&(f+=M[n++]<<p,p+=8,f+=M[n++]<<p,p+=8),b=m[f&g];e:for(;;){if(f>>>=v=b>>>24,p-=v,0==(v=b>>>16&255))E[o++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=m[(65535&b)+(f&(1<<v)-1)];continue e}if(32&v){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&b,(v&=15)&&(p<v&&(f+=M[n++]<<p,p+=8),w+=f&(1<<v)-1,f>>>=v,p-=v),p<15&&(f+=M[n++]<<p,p+=8,f+=M[n++]<<p,p+=8),b=_[f&y];i:for(;;){if(f>>>=v=b>>>24,p-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=_[(65535&b)+(f&(1<<v)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(x=65535&b,p<(v&=15)&&(f+=M[n++]<<p,(p+=8)<v&&(f+=M[n++]<<p,p+=8)),(x+=f&(1<<v)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(f>>>=v,p-=v,x>(v=o-a)){if((v=x-v)>h&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(A=0,S=d,0===u){if(A+=c-v,v<w){w-=v;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}}else if(u<v){if(A+=c+u-v,(v-=u)<w){w-=v;do{E[o++]=d[A++]}while(--v);if(A=0,u<w){w-=v=u;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}}}else if(A+=u-v,v<w){w-=v;do{E[o++]=d[A++]}while(--v);A=o-x,S=E}for(;w>2;)E[o++]=S[A++],E[o++]=S[A++],E[o++]=S[A++],w-=3;w&&(E[o++]=S[A++],w>1&&(E[o++]=S[A++]))}else{A=o-x;do{E[o++]=E[A++],E[o++]=E[A++],E[o++]=E[A++],w-=3}while(w>2);w&&(E[o++]=E[A++],w>1&&(E[o++]=E[A++]))}break}}break}}while(n<r&&o<s);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<s?s-o+257:257-(o-s),i.hold=f,i.bits=p}},function(t,e,i){"use strict";var n=i(8),r=i(28),o=i(27),a=i(47),s=i(46),l=1,c=2,h=0,u=-2,d=1,f=12,p=30,m=852,_=592;function g(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function y(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=d,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(m),e.distcode=e.distdyn=new n.Buf32(_),e.sane=1,e.back=-1,h):u}function b(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,y(t)):u}function v(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?u:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,b(t))):u}function w(t,e){var i,r;return t?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},t.state=r,r.window=null,(i=v(t,e))!==h&&(t.state=null),i):u}var x,A,S=!0;function M(t){if(S){var e;for(x=new n.Buf32(512),A=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(l,t.lens,0,288,x,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(c,t.lens,0,32,A,0,t.work,{bits:5}),S=!1}t.lencode=x,t.lenbits=9,t.distcode=A,t.distbits=5}function E(t,e,i,r){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),r>=a.wsize?(n.arraySet(a.window,e,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),n.arraySet(a.window,e,i-r,o,a.wnext),(r-=o)?(n.arraySet(a.window,e,i-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=b,e.inflateReset2=v,e.inflateResetKeep=y,e.inflateInit=function(t){return w(t,15)},e.inflateInit2=w,e.inflate=function(t,e){var i,m,_,y,b,v,w,x,A,S,T,k,C,I,P,R,B,L,D,O,F,G,N,z,U=0,H=new n.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return u;(i=t.state).mode===f&&(i.mode=13),b=t.next_out,_=t.output,w=t.avail_out,y=t.next_in,m=t.input,v=t.avail_in,x=i.hold,A=i.bits,S=v,T=w,G=h;t:for(;;)switch(i.mode){case d:if(0===i.wrap){i.mode=13;break}for(;A<16;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(2&i.wrap&&35615===x){i.check=0,H[0]=255&x,H[1]=x>>>8&255,i.check=o(i.check,H,2,0),x=0,A=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&x)<<8)+(x>>8))%31){t.msg="incorrect header check",i.mode=p;break}if(8!=(15&x)){t.msg="unknown compression method",i.mode=p;break}if(A-=4,F=8+(15&(x>>>=4)),0===i.wbits)i.wbits=F;else if(F>i.wbits){t.msg="invalid window size",i.mode=p;break}i.dmax=1<<F,t.adler=i.check=1,i.mode=512&x?10:f,x=0,A=0;break;case 2:for(;A<16;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(i.flags=x,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=p;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=p;break}i.head&&(i.head.text=x>>8&1),512&i.flags&&(H[0]=255&x,H[1]=x>>>8&255,i.check=o(i.check,H,2,0)),x=0,A=0,i.mode=3;case 3:for(;A<32;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.head&&(i.head.time=x),512&i.flags&&(H[0]=255&x,H[1]=x>>>8&255,H[2]=x>>>16&255,H[3]=x>>>24&255,i.check=o(i.check,H,4,0)),x=0,A=0,i.mode=4;case 4:for(;A<16;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.head&&(i.head.xflags=255&x,i.head.os=x>>8),512&i.flags&&(H[0]=255&x,H[1]=x>>>8&255,i.check=o(i.check,H,2,0)),x=0,A=0,i.mode=5;case 5:if(1024&i.flags){for(;A<16;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.length=x,i.head&&(i.head.extra_len=x),512&i.flags&&(H[0]=255&x,H[1]=x>>>8&255,i.check=o(i.check,H,2,0)),x=0,A=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((k=i.length)>v&&(k=v),k&&(i.head&&(F=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,m,y,k,F)),512&i.flags&&(i.check=o(i.check,m,k,y)),v-=k,y+=k,i.length-=k),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===v)break t;k=0;do{F=m[y+k++],i.head&&F&&i.length<65536&&(i.head.name+=String.fromCharCode(F))}while(F&&k<v);if(512&i.flags&&(i.check=o(i.check,m,k,y)),v-=k,y+=k,F)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===v)break t;k=0;do{F=m[y+k++],i.head&&F&&i.length<65536&&(i.head.comment+=String.fromCharCode(F))}while(F&&k<v);if(512&i.flags&&(i.check=o(i.check,m,k,y)),v-=k,y+=k,F)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;A<16;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(x!==(65535&i.check)){t.msg="header crc mismatch",i.mode=p;break}x=0,A=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=f;break;case 10:for(;A<32;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}t.adler=i.check=g(x),x=0,A=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=b,t.avail_out=w,t.next_in=y,t.avail_in=v,i.hold=x,i.bits=A,2;t.adler=i.check=1,i.mode=f;case f:if(5===e||6===e)break t;case 13:if(i.last){x>>>=7&A,A-=7&A,i.mode=27;break}for(;A<3;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}switch(i.last=1&x,A-=1,3&(x>>>=1)){case 0:i.mode=14;break;case 1:if(M(i),i.mode=20,6===e){x>>>=2,A-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=p}x>>>=2,A-=2;break;case 14:for(x>>>=7&A,A-=7&A;A<32;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if((65535&x)!=(x>>>16^65535)){t.msg="invalid stored block lengths",i.mode=p;break}if(i.length=65535&x,x=0,A=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(k=i.length){if(k>v&&(k=v),k>w&&(k=w),0===k)break t;n.arraySet(_,m,y,k,b),v-=k,y+=k,w-=k,b+=k,i.length-=k;break}i.mode=f;break;case 17:for(;A<14;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(i.nlen=257+(31&x),x>>>=5,A-=5,i.ndist=1+(31&x),x>>>=5,A-=5,i.ncode=4+(15&x),x>>>=4,A-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=p;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;A<3;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.lens[V[i.have++]]=7&x,x>>>=3,A-=3}for(;i.have<19;)i.lens[V[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,N={bits:i.lenbits},G=s(0,i.lens,0,19,i.lencode,0,i.work,N),i.lenbits=N.bits,G){t.msg="invalid code lengths set",i.mode=p;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;R=(U=i.lencode[x&(1<<i.lenbits)-1])>>>16&255,B=65535&U,!((P=U>>>24)<=A);){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(B<16)x>>>=P,A-=P,i.lens[i.have++]=B;else{if(16===B){for(z=P+2;A<z;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(x>>>=P,A-=P,0===i.have){t.msg="invalid bit length repeat",i.mode=p;break}F=i.lens[i.have-1],k=3+(3&x),x>>>=2,A-=2}else if(17===B){for(z=P+3;A<z;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}A-=P,F=0,k=3+(7&(x>>>=P)),x>>>=3,A-=3}else{for(z=P+7;A<z;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}A-=P,F=0,k=11+(127&(x>>>=P)),x>>>=7,A-=7}if(i.have+k>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=p;break}for(;k--;)i.lens[i.have++]=F}}if(i.mode===p)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=p;break}if(i.lenbits=9,N={bits:i.lenbits},G=s(l,i.lens,0,i.nlen,i.lencode,0,i.work,N),i.lenbits=N.bits,G){t.msg="invalid literal/lengths set",i.mode=p;break}if(i.distbits=6,i.distcode=i.distdyn,N={bits:i.distbits},G=s(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,N),i.distbits=N.bits,G){t.msg="invalid distances set",i.mode=p;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(v>=6&&w>=258){t.next_out=b,t.avail_out=w,t.next_in=y,t.avail_in=v,i.hold=x,i.bits=A,a(t,T),b=t.next_out,_=t.output,w=t.avail_out,y=t.next_in,m=t.input,v=t.avail_in,x=i.hold,A=i.bits,i.mode===f&&(i.back=-1);break}for(i.back=0;R=(U=i.lencode[x&(1<<i.lenbits)-1])>>>16&255,B=65535&U,!((P=U>>>24)<=A);){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(R&&0==(240&R)){for(L=P,D=R,O=B;R=(U=i.lencode[O+((x&(1<<L+D)-1)>>L)])>>>16&255,B=65535&U,!(L+(P=U>>>24)<=A);){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}x>>>=L,A-=L,i.back+=L}if(x>>>=P,A-=P,i.back+=P,i.length=B,0===R){i.mode=26;break}if(32&R){i.back=-1,i.mode=f;break}if(64&R){t.msg="invalid literal/length code",i.mode=p;break}i.extra=15&R,i.mode=22;case 22:if(i.extra){for(z=i.extra;A<z;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.length+=x&(1<<i.extra)-1,x>>>=i.extra,A-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;R=(U=i.distcode[x&(1<<i.distbits)-1])>>>16&255,B=65535&U,!((P=U>>>24)<=A);){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(0==(240&R)){for(L=P,D=R,O=B;R=(U=i.distcode[O+((x&(1<<L+D)-1)>>L)])>>>16&255,B=65535&U,!(L+(P=U>>>24)<=A);){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}x>>>=L,A-=L,i.back+=L}if(x>>>=P,A-=P,i.back+=P,64&R){t.msg="invalid distance code",i.mode=p;break}i.offset=B,i.extra=15&R,i.mode=24;case 24:if(i.extra){for(z=i.extra;A<z;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}i.offset+=x&(1<<i.extra)-1,x>>>=i.extra,A-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=p;break}i.mode=25;case 25:if(0===w)break t;if(k=T-w,i.offset>k){if((k=i.offset-k)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=p;break}k>i.wnext?(k-=i.wnext,C=i.wsize-k):C=i.wnext-k,k>i.length&&(k=i.length),I=i.window}else I=_,C=b-i.offset,k=i.length;k>w&&(k=w),w-=k,i.length-=k;do{_[b++]=I[C++]}while(--k);0===i.length&&(i.mode=21);break;case 26:if(0===w)break t;_[b++]=i.length,w--,i.mode=21;break;case 27:if(i.wrap){for(;A<32;){if(0===v)break t;v--,x|=m[y++]<<A,A+=8}if(T-=w,t.total_out+=T,i.total+=T,T&&(t.adler=i.check=i.flags?o(i.check,_,T,b-T):r(i.check,_,T,b-T)),T=w,(i.flags?x:g(x))!==i.check){t.msg="incorrect data check",i.mode=p;break}x=0,A=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;A<32;){if(0===v)break t;v--,x+=m[y++]<<A,A+=8}if(x!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=p;break}x=0,A=0}i.mode=29;case 29:G=1;break t;case p:G=-3;break t;case 31:return-4;case 32:default:return u}return t.next_out=b,t.avail_out=w,t.next_in=y,t.avail_in=v,i.hold=x,i.bits=A,(i.wsize||T!==t.avail_out&&i.mode<p&&(i.mode<27||4!==e))&&E(t,t.output,t.next_out,T-t.avail_out)?(i.mode=31,-4):(S-=t.avail_in,T-=t.avail_out,t.total_in+=S,t.total_out+=T,i.total+=T,i.wrap&&T&&(t.adler=i.check=i.flags?o(i.check,_,T,t.next_out-T):r(i.check,_,T,t.next_out-T)),t.data_type=i.bits+(i.last?64:0)+(i.mode===f?128:0)+(20===i.mode||15===i.mode?256:0),(0===S&&0===T||4===e)&&G===h&&(G=-5),G)},e.inflateEnd=function(t){if(!t||!t.state)return u;var e=t.state;return e.window&&(e.window=null),t.state=null,h},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?u:(i.head=e,e.done=!1,h):u},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?u:11===i.mode&&r(1,e,n,0)!==i.check?-3:E(t,e,n,n)?(i.mode=31,-4):(i.havedict=1,h):u},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";var n=i(8);function r(t){for(var e=t.length;--e>=0;)t[e]=0}var o=0,a=256,s=a+1+29,l=30,c=19,h=2*s+1,u=15,d=16,f=256,p=16,m=17,_=18,g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],v=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(2*(s+2));r(w);var x=new Array(2*l);r(x);var A=new Array(512);r(A);var S=new Array(256);r(S);var M=new Array(29);r(M);var E,T,k,C=new Array(l);function I(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function P(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function R(t){return t<256?A[t]:A[256+(t>>>7)]}function B(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function L(t,e,i){t.bi_valid>d-i?(t.bi_buf|=e<<t.bi_valid&65535,B(t,t.bi_buf),t.bi_buf=e>>d-t.bi_valid,t.bi_valid+=i-d):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function D(t,e,i){L(t,i[2*e],i[2*e+1])}function O(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function F(t,e,i){var n,r,o=new Array(u+1),a=0;for(n=1;n<=u;n++)o[n]=a=a+i[n-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=O(o[s]++,s))}}function G(t){var e;for(e=0;e<s;e++)t.dyn_ltree[2*e]=0;for(e=0;e<l;e++)t.dyn_dtree[2*e]=0;for(e=0;e<c;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*f]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function N(t){t.bi_valid>8?B(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function z(t,e,i,n){var r=2*e,o=2*i;return t[r]<t[o]||t[r]===t[o]&&n[e]<=n[i]}function U(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&z(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!z(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function H(t,e,i){var n,r,o,s,l=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],r=t.pending_buf[t.l_buf+l],l++,0===n?D(t,r,e):(D(t,(o=S[r])+a+1,e),0!==(s=g[o])&&L(t,r-=M[o],s),D(t,o=R(--n),i),0!==(s=y[o])&&L(t,n-=C[o],s))}while(l<t.last_lit);D(t,f,e)}function V(t,e){var i,n,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=h,i=0;i<l;i++)0!==o[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):o[2*i+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=c,i=t.heap_len>>1;i>=1;i--)U(t,o,i);r=l;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],U(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,o[2*r]=o[2*i]+o[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,o[2*i+1]=o[2*n+1]=r,t.heap[1]=r++,U(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,o,a,s,l=e.dyn_tree,c=e.max_code,d=e.stat_desc.static_tree,f=e.stat_desc.has_stree,p=e.stat_desc.extra_bits,m=e.stat_desc.extra_base,_=e.stat_desc.max_length,g=0;for(o=0;o<=u;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<h;i++)(o=l[2*l[2*(n=t.heap[i])+1]+1]+1)>_&&(o=_,g++),l[2*n+1]=o,n>c||(t.bl_count[o]++,a=0,n>=m&&(a=p[n-m]),s=l[2*n],t.opt_len+=s*(o+a),f&&(t.static_len+=s*(d[2*n+1]+a)));if(0!==g){do{for(o=_-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[_]--,g-=2}while(g>0);for(o=_;0!==o;o--)for(n=t.bl_count[o];0!==n;)(r=t.heap[--i])>c||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),n--)}}(t,e),F(o,c,t.bl_count)}function W(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=a,a=e[2*(n+1)+1],++s<l&&r===a||(s<c?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*p]++):s<=10?t.bl_tree[2*m]++:t.bl_tree[2*_]++,s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function j(t,e,i){var n,r,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=i;n++)if(r=a,a=e[2*(n+1)+1],!(++s<l&&r===a)){if(s<c)do{D(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(D(t,r,t.bl_tree),s--),D(t,p,t.bl_tree),L(t,s-3,2)):s<=10?(D(t,m,t.bl_tree),L(t,s-3,3)):(D(t,_,t.bl_tree),L(t,s-11,7));s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}r(C);var Z=!1;function Y(t,e,i,r){L(t,(o<<1)+(r?1:0),3),function(t,e,i,r){N(t),B(t,i),B(t,~i),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i)}e._tr_init=function(t){Z||(function(){var t,e,i,n,r,o=new Array(u+1);for(i=0,n=0;n<28;n++)for(M[n]=i,t=0;t<1<<g[n];t++)S[i++]=n;for(S[i-1]=n,r=0,n=0;n<16;n++)for(C[n]=r,t=0;t<1<<y[n];t++)A[r++]=n;for(r>>=7;n<l;n++)for(C[n]=r<<7,t=0;t<1<<y[n]-7;t++)A[256+r++]=n;for(e=0;e<=u;e++)o[e]=0;for(t=0;t<=143;)w[2*t+1]=8,t++,o[8]++;for(;t<=255;)w[2*t+1]=9,t++,o[9]++;for(;t<=279;)w[2*t+1]=7,t++,o[7]++;for(;t<=287;)w[2*t+1]=8,t++,o[8]++;for(F(w,s+1,o),t=0;t<l;t++)x[2*t+1]=5,x[2*t]=O(t,5);E=new I(w,g,a+1,s,u),T=new I(x,y,0,l,u),k=new I(new Array(0),b,0,c,7)}(),Z=!0),t.l_desc=new P(t.dyn_ltree,E),t.d_desc=new P(t.dyn_dtree,T),t.bl_desc=new P(t.bl_tree,k),t.bi_buf=0,t.bi_valid=0,G(t)},e._tr_stored_block=Y,e._tr_flush_block=function(t,e,i,n){var r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<a;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),V(t,t.l_desc),V(t,t.d_desc),s=function(t){var e;for(W(t,t.dyn_ltree,t.l_desc.max_code),W(t,t.dyn_dtree,t.d_desc.max_code),V(t,t.bl_desc),e=c-1;e>=3&&0===t.bl_tree[2*v[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=i+5,i+4<=r&&-1!==e?Y(t,e,i,n):4===t.strategy||o===r?(L(t,2+(n?1:0),3),H(t,w,x)):(L(t,4+(n?1:0),3),function(t,e,i,n){var r;for(L(t,e-257,5),L(t,i-1,5),L(t,n-4,4),r=0;r<n;r++)L(t,t.bl_tree[2*v[r]+1],3);j(t,t.dyn_ltree,e-1),j(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),H(t,t.dyn_ltree,t.dyn_dtree)),G(t),n&&N(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(S[i]+a+1)]++,t.dyn_dtree[2*R(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){L(t,2,3),D(t,f,w),function(t){16===t.bi_valid?(B(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){"use strict";var n,r=i(8),o=i(50),a=i(28),s=i(27),l=i(49),c=0,h=4,u=0,d=-2,f=-1,p=1,m=4,_=2,g=8,y=9,b=286,v=30,w=19,x=2*b+1,A=15,S=3,M=258,E=M+S+1,T=42,k=103,C=113,I=666,P=1,R=2,B=3,L=4;function D(t,e){return t.msg=l[e],e}function O(t){return(t<<1)-(t>4?9:0)}function F(t){for(var e=t.length;--e>=0;)t[e]=0}function G(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function N(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,G(t.strm)}function z(t,e){t.pending_buf[t.pending++]=e}function U(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function H(t,e){var i,n,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-E?t.strstart-(t.w_size-E):0,c=t.window,h=t.w_mask,u=t.prev,d=t.strstart+M,f=c[o+a-1],p=c[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(i=e)+a]===p&&c[i+a-1]===f&&c[i]===c[o]&&c[++i]===c[o+1]){o+=2,i++;do{}while(c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&o<d);if(n=M-(d-o),o=d-M,n>a){if(t.match_start=e,a=n,n>=s)break;f=c[o+a-1],p=c[o+a]}}}while((e=u[e&h])>l&&0!=--r);return a<=t.lookahead?a:t.lookahead}function V(t){var e,i,n,o,l,c,h,u,d,f,p=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-E)){r.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=p?n-p:0}while(--i);e=i=p;do{n=t.prev[--e],t.prev[e]=n>=p?n-p:0}while(--i);o+=p}if(0===t.strm.avail_in)break;if(c=t.strm,h=t.window,u=t.strstart+t.lookahead,d=o,f=void 0,(f=c.avail_in)>d&&(f=d),i=0===f?0:(c.avail_in-=f,r.arraySet(h,c.input,c.next_in,f,u),1===c.state.wrap?c.adler=a(c.adler,h,f,u):2===c.state.wrap&&(c.adler=s(c.adler,h,f,u)),c.next_in+=f,c.total_in+=f,f),t.lookahead+=i,t.lookahead+t.insert>=S)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+S-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<S)););}while(t.lookahead<E&&0!==t.strm.avail_in)}function W(t,e){for(var i,n;;){if(t.lookahead<E){if(V(t),t.lookahead<E&&e===c)return P;if(0===t.lookahead)break}if(i=0,t.lookahead>=S&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-E&&(t.match_length=H(t,i)),t.match_length>=S)if(n=o._tr_tally(t,t.strstart-t.match_start,t.match_length-S),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=S){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(N(t,!1),0===t.strm.avail_out))return P}return t.insert=t.strstart<S-1?t.strstart:S-1,e===h?(N(t,!0),0===t.strm.avail_out?B:L):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?P:R}function j(t,e){for(var i,n,r;;){if(t.lookahead<E){if(V(t),t.lookahead<E&&e===c)return P;if(0===t.lookahead)break}if(i=0,t.lookahead>=S&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=S-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-E&&(t.match_length=H(t,i),t.match_length<=5&&(t.strategy===p||t.match_length===S&&t.strstart-t.match_start>4096)&&(t.match_length=S-1)),t.prev_length>=S&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-S,n=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-S),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=S-1,t.strstart++,n&&(N(t,!1),0===t.strm.avail_out))return P}else if(t.match_available){if((n=o._tr_tally(t,0,t.window[t.strstart-1]))&&N(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return P}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<S-1?t.strstart:S-1,e===h?(N(t,!0),0===t.strm.avail_out?B:L):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?P:R}function Z(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function Y(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=_,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?T:C,t.adler=2===e.wrap?0:1,e.last_flush=c,o._tr_init(e),u):D(t,d)}function X(t){var e,i=Y(t);return i===u&&((e=t.state).window_size=2*e.w_size,F(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=S-1,e.match_available=0,e.ins_h=0),i}function J(t,e,i,n,o,a){if(!t)return d;var s=1;if(e===f&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>y||i!==g||n<8||n>15||e<0||e>9||a<0||a>m)return D(t,d);8===n&&(n=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*x),this.dyn_dtree=new r.Buf16(2*(2*v+1)),this.bl_tree=new r.Buf16(2*(2*w+1)),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(A+1),this.heap=new r.Buf16(2*b+1),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*b+1),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+S-1)/S),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=i,X(t)}n=[new Z(0,0,0,0,function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(V(t),0===t.lookahead&&e===c)return P;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,N(t,!1),0===t.strm.avail_out))return P;if(t.strstart-t.block_start>=t.w_size-E&&(N(t,!1),0===t.strm.avail_out))return P}return t.insert=0,e===h?(N(t,!0),0===t.strm.avail_out?B:L):(t.strstart>t.block_start&&(N(t,!1),t.strm.avail_out),P)}),new Z(4,4,8,4,W),new Z(4,5,16,8,W),new Z(4,6,32,32,W),new Z(4,4,16,16,j),new Z(8,16,32,32,j),new Z(8,16,128,128,j),new Z(8,32,128,256,j),new Z(32,128,258,1024,j),new Z(32,258,258,4096,j)],e.deflateInit=function(t,e){return J(t,e,g,15,8,0)},e.deflateInit2=J,e.deflateReset=X,e.deflateResetKeep=Y,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?d:(t.state.gzhead=e,u):d},e.deflate=function(t,e){var i,r,a,l;if(!t||!t.state||e>5||e<0)return t?D(t,d):d;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===I&&e!==h)return D(t,0===t.avail_out?-5:d);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===T)if(2===r.wrap)t.adler=0,z(r,31),z(r,139),z(r,8),r.gzhead?(z(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),z(r,255&r.gzhead.time),z(r,r.gzhead.time>>8&255),z(r,r.gzhead.time>>16&255),z(r,r.gzhead.time>>24&255),z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),z(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(z(r,255&r.gzhead.extra.length),z(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=s(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(z(r,0),z(r,0),z(r,0),z(r,0),z(r,0),z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),z(r,3),r.status=C);else{var f=g+(r.w_bits-8<<4)<<8;f|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(f|=32),f+=31-f%31,r.status=C,U(r,f),0!==r.strstart&&(U(r,t.adler>>>16),U(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),G(t),a=r.pending,r.pending!==r.pending_buf_size));)z(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),G(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,z(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),G(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,z(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=k)}else r.status=k;if(r.status===k&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&G(t),r.pending+2<=r.pending_buf_size&&(z(r,255&t.adler),z(r,t.adler>>8&255),t.adler=0,r.status=C)):r.status=C),0!==r.pending){if(G(t),0===t.avail_out)return r.last_flush=-1,u}else if(0===t.avail_in&&O(e)<=O(i)&&e!==h)return D(t,-5);if(r.status===I&&0!==t.avail_in)return D(t,-5);if(0!==t.avail_in||0!==r.lookahead||e!==c&&r.status!==I){var p=2===r.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(V(t),0===t.lookahead)){if(e===c)return P;break}if(t.match_length=0,i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(N(t,!1),0===t.strm.avail_out))return P}return t.insert=0,e===h?(N(t,!0),0===t.strm.avail_out?B:L):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?P:R}(r,e):3===r.strategy?function(t,e){for(var i,n,r,a,s=t.window;;){if(t.lookahead<=M){if(V(t),t.lookahead<=M&&e===c)return P;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=S&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){a=t.strstart+M;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<a);t.match_length=M-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=S?(i=o._tr_tally(t,1,t.match_length-S),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(N(t,!1),0===t.strm.avail_out))return P}return t.insert=0,e===h?(N(t,!0),0===t.strm.avail_out?B:L):t.last_lit&&(N(t,!1),0===t.strm.avail_out)?P:R}(r,e):n[r.level].func(r,e);if(p!==B&&p!==L||(r.status=I),p===P||p===B)return 0===t.avail_out&&(r.last_flush=-1),u;if(p===R&&(1===e?o._tr_align(r):5!==e&&(o._tr_stored_block(r,0,0,!1),3===e&&(F(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),G(t),0===t.avail_out))return r.last_flush=-1,u}return e!==h?u:r.wrap<=0?1:(2===r.wrap?(z(r,255&t.adler),z(r,t.adler>>8&255),z(r,t.adler>>16&255),z(r,t.adler>>24&255),z(r,255&t.total_in),z(r,t.total_in>>8&255),z(r,t.total_in>>16&255),z(r,t.total_in>>24&255)):(U(r,t.adler>>>16),U(r,65535&t.adler)),G(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?u:1)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==T&&69!==e&&73!==e&&91!==e&&e!==k&&e!==C&&e!==I?D(t,d):(t.state=null,e===C?D(t,-3):u):d},e.deflateSetDictionary=function(t,e){var i,n,o,s,l,c,h,f,p=e.length;if(!t||!t.state)return d;if(2===(s=(i=t.state).wrap)||1===s&&i.status!==T||i.lookahead)return d;for(1===s&&(t.adler=a(t.adler,e,p,0)),i.wrap=0,p>=i.w_size&&(0===s&&(F(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new r.Buf8(i.w_size),r.arraySet(f,e,p-i.w_size,i.w_size,0),e=f,p=i.w_size),l=t.avail_in,c=t.next_in,h=t.input,t.avail_in=p,t.next_in=0,t.input=e,V(i);i.lookahead>=S;){n=i.strstart,o=i.lookahead-(S-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+S-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--o);i.strstart=n,i.lookahead=S-1,V(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=S-1,i.match_available=0,t.next_in=c,t.input=h,t.avail_in=l,i.wrap=s,u},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,i){"use strict";(function(t,n){var r=i(30),o=i(52),a=i(51),s=i(48),l=i(45);for(var c in l)e[c]=l[c];function h(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7,h.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?a.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||s.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},h.prototype.write=function(t,e,i,n,r,o,a){return this._write(!0,t,e,i,n,r,o,a)},h.prototype.writeSync=function(t,e,i,n,r,o,a){return this._write(!1,t,e,i,n,r,o,a)},h.prototype._write=function(i,o,a,s,l,c,h,u){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==e.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==e.Z_NO_FLUSH&&o!==e.Z_PARTIAL_FLUSH&&o!==e.Z_SYNC_FLUSH&&o!==e.Z_FULL_FLUSH&&o!==e.Z_FINISH&&o!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==a&&(a=t.alloc(0),l=0,s=0),this.strm.avail_in=l,this.strm.input=a,this.strm.next_in=s,this.strm.avail_out=u,this.strm.output=c,this.strm.next_out=h,this.flush=o,!i)return this._process(),this._checkError()?this._afterSync():void 0;var d=this;return n.nextTick(function(){d._process(),d._after()}),this},h.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},h.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},h.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},h.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},h.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},h.prototype.init=function(t,i,n,o,a){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(t>=8&&t<=15,"invalid windowBits"),r(i>=-1&&i<=9,"invalid compression level"),r(n>=1&&n<=9,"invalid memlevel"),r(o===e.Z_FILTERED||o===e.Z_HUFFMAN_ONLY||o===e.Z_RLE||o===e.Z_FIXED||o===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(i,t,n,o,a),this._setDictionary()},h.prototype.params=function(){throw new Error("deflateParams Not supported")},h.prototype.reset=function(){this._reset(),this._setDictionary()},h.prototype._init=function(t,i,n,r,l){switch(this.level=t,this.windowBits=i,this.memLevel=n,this.strategy=r,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=l,this.write_in_progress=!1,this.init_done=!0},h.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},h.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=a.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=h}).call(this,i(1).Buffer,i(3))},function(t,e,i){t.exports=i(19).PassThrough},function(t,e,i){t.exports=i(19).Transform},function(t,e,i){t.exports=i(2)},function(t,e,i){t.exports=i(18)},function(t,e,i){"use strict";t.exports=o;var n=i(31),r=i(6);function o(t){if(!(this instanceof o))return new o(t);n.call(this,t)}r.inherits=i(5),r.inherits(o,n),o.prototype._transform=function(t,e,i){i(null,t)}},function(t,e,i){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(t){return!1}var i=e.localStorage[t];return null!=i&&"true"===String(i).toLowerCase()}t.exports=function(t,e){if(i("noDeprecation"))return t;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(e);i("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}}).call(this,i(0))},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,r,o,a,s,l=1,c={},h=!1,u=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),n=function(e){t.postMessage(a+e,"*")}):t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},n=function(t){o.port2.postMessage(t)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,n=function(t){var e=u.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):n=function(t){setTimeout(p,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return c[l]=r,n(l),l++},d.clearImmediate=f}function f(t){delete c[t]}function p(t){if(h)setTimeout(p,0,t);else{var e=c[t];if(e){h=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n)}}(e)}finally{f(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(0),i(3))},function(t,e,i){(function(t){var n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(n.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(n.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(62),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(0))},function(t,e){},function(t,e,i){"use strict";var n=i(9).Buffer,r=i(64);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var e,i,r,o=n.allocUnsafe(t>>>0),a=this.head,s=0;a;)e=a.data,i=o,r=s,e.copy(i,r),s+=a.data.length,a=a.next;return o},t}(),r&&r.inspect&&r.inspect.custom&&(t.exports.prototype[r.inspect.custom]=function(){var t=r.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,i){t.exports=r;var n=i(20).EventEmitter;function r(){n.call(this)}i(5)(r,n),r.Readable=i(19),r.Writable=i(59),r.Duplex=i(58),r.Transform=i(57),r.PassThrough=i(56),r.Stream=r,r.prototype.pipe=function(t,e){var i=this;function r(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function o(){i.readable&&i.resume&&i.resume()}i.on("data",r),t.on("drain",o),t._isStdio||e&&!1===e.end||(i.on("end",s),i.on("close",l));var a=!1;function s(){a||(a=!0,t.end())}function l(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(h(),0===n.listenerCount(this,"error"))throw t}function h(){i.removeListener("data",r),t.removeListener("drain",o),i.removeListener("end",s),i.removeListener("close",l),i.removeListener("error",c),t.removeListener("error",c),i.removeListener("end",h),i.removeListener("close",h),t.removeListener("close",h)}return i.on("error",c),t.on("error",c),i.on("end",h),i.on("close",h),t.on("close",h),t.emit("pipe",i),t}},function(t,e,i){"use strict";(function(t){var n=i(1).Buffer,r=i(67).Transform,o=i(55),a=i(29),s=i(30).ok,l=i(1).kMaxLength,c="Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var h=Object.keys(o),u=0;u<h.length;u++){var d=h[u];d.match(/^Z/)&&Object.defineProperty(e,d,{enumerable:!0,value:o[d],writable:!1})}for(var f={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},p=Object.keys(f),m=0;m<p.length;m++){var _=p[m];f[f[_]]=_}function g(t,e,i){var r=[],o=0;function a(){for(var e;null!==(e=t.read());)r.push(e),o+=e.length;t.once("readable",a)}function s(){var e,a=null;o>=l?a=new RangeError(c):e=n.concat(r,o),r=[],t.close(),i(a,e)}t.on("error",function(e){t.removeListener("end",s),t.removeListener("readable",a),i(e)}),t.on("end",s),t.end(e),a()}function y(t,e){if("string"==typeof e&&(e=n.from(e)),!n.isBuffer(e))throw new TypeError("Not a string or buffer");var i=t._finishFlushFlag;return t._processChunk(e,i)}function b(t){if(!(this instanceof b))return new b(t);T.call(this,t,o.DEFLATE)}function v(t){if(!(this instanceof v))return new v(t);T.call(this,t,o.INFLATE)}function w(t){if(!(this instanceof w))return new w(t);T.call(this,t,o.GZIP)}function x(t){if(!(this instanceof x))return new x(t);T.call(this,t,o.GUNZIP)}function A(t){if(!(this instanceof A))return new A(t);T.call(this,t,o.DEFLATERAW)}function S(t){if(!(this instanceof S))return new S(t);T.call(this,t,o.INFLATERAW)}function M(t){if(!(this instanceof M))return new M(t);T.call(this,t,o.UNZIP)}function E(t){return t===o.Z_NO_FLUSH||t===o.Z_PARTIAL_FLUSH||t===o.Z_SYNC_FLUSH||t===o.Z_FULL_FLUSH||t===o.Z_FINISH||t===o.Z_BLOCK}function T(t,i){var a=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,r.call(this,t),t.flush&&!E(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!E(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:o.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!n.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(i);var s=this;this._hadError=!1,this._handle.onerror=function(t,i){k(s),s._hadError=!0;var n=new Error(t);n.errno=i,n.code=e.codes[i],s.emit("error",n)};var l=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(l=t.level);var c=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(c=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,l,t.memLevel||e.Z_DEFAULT_MEMLEVEL,c,t.dictionary),this._buffer=n.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=c,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!a._handle},configurable:!0,enumerable:!0})}function k(e,i){i&&t.nextTick(i),e._handle&&(e._handle.close(),e._handle=null)}function C(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(f),writable:!1}),e.Deflate=b,e.Inflate=v,e.Gzip=w,e.Gunzip=x,e.DeflateRaw=A,e.InflateRaw=S,e.Unzip=M,e.createDeflate=function(t){return new b(t)},e.createInflate=function(t){return new v(t)},e.createDeflateRaw=function(t){return new A(t)},e.createInflateRaw=function(t){return new S(t)},e.createGzip=function(t){return new w(t)},e.createGunzip=function(t){return new x(t)},e.createUnzip=function(t){return new M(t)},e.deflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new b(e),t,i)},e.deflateSync=function(t,e){return y(new b(e),t)},e.gzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new w(e),t,i)},e.gzipSync=function(t,e){return y(new w(e),t)},e.deflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new A(e),t,i)},e.deflateRawSync=function(t,e){return y(new A(e),t)},e.unzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new M(e),t,i)},e.unzipSync=function(t,e){return y(new M(e),t)},e.inflate=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new v(e),t,i)},e.inflateSync=function(t,e){return y(new v(e),t)},e.gunzip=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new x(e),t,i)},e.gunzipSync=function(t,e){return y(new x(e),t)},e.inflateRaw=function(t,e,i){return"function"==typeof e&&(i=e,e={}),g(new S(e),t,i)},e.inflateRawSync=function(t,e){return y(new S(e),t)},a.inherits(T,r),T.prototype.params=function(i,n,r){if(i<e.Z_MIN_LEVEL||i>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+i);if(n!=e.Z_FILTERED&&n!=e.Z_HUFFMAN_ONLY&&n!=e.Z_RLE&&n!=e.Z_FIXED&&n!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==i||this._strategy!==n){var a=this;this.flush(o.Z_SYNC_FLUSH,function(){s(a._handle,"zlib binding closed"),a._handle.params(i,n),a._hadError||(a._level=i,a._strategy=n,r&&r())})}else t.nextTick(r)},T.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},T.prototype._flush=function(t){this._transform(n.alloc(0),"",t)},T.prototype.flush=function(e,i){var r=this,a=this._writableState;("function"==typeof e||void 0===e&&!i)&&(i=e,e=o.Z_FULL_FLUSH),a.ended?i&&t.nextTick(i):a.ending?i&&this.once("end",i):a.needDrain?i&&this.once("drain",function(){return r.flush(e,i)}):(this._flushFlag=e,this.write(n.alloc(0),"",i))},T.prototype.close=function(e){k(this,e),t.nextTick(C,this)},T.prototype._transform=function(t,e,i){var r,a=this._writableState,s=(a.ending||a.ended)&&(!t||a.length===t.length);return null===t||n.isBuffer(t)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,t.length>=a.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(t,r,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},T.prototype._processChunk=function(t,e,i){var r=t&&t.length,o=this._chunkSize-this._offset,a=0,h=this,u="function"==typeof i;if(!u){var d,f=[],p=0;this.on("error",function(t){d=t}),s(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(e,t,a,r,this._buffer,this._offset,o)}while(!this._hadError&&y(m[0],m[1]));if(this._hadError)throw d;if(p>=l)throw k(this),new RangeError(c);var _=n.concat(f,p);return k(this),_}s(this._handle,"zlib binding closed");var g=this._handle.write(e,t,a,r,this._buffer,this._offset,o);function y(l,c){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var d=o-c;if(s(d>=0,"have should not go down"),d>0){var m=h._buffer.slice(h._offset,h._offset+d);h._offset+=d,u?h.push(m):(f.push(m),p+=m.length)}if((0===c||h._offset>=h._chunkSize)&&(o=h._chunkSize,h._offset=0,h._buffer=n.allocUnsafe(h._chunkSize)),0===c){if(a+=r-l,r=l,!u)return!0;var _=h._handle.write(e,t,a,r,h._buffer,h._offset,h._chunkSize);return _.callback=y,void(_.buffer=t)}if(!u)return!1;i()}}g.buffer=t,g.callback=y},a.inherits(b,T),a.inherits(v,T),a.inherits(w,T),a.inherits(x,T),a.inherits(A,T),a.inherits(S,T),a.inherits(M,T)}).call(this,i(3))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,d){if(void 0===e)throw"dicomParser.parseDicom: missing required parameter 'byteArray'";return f=(0,l.default)(e,d),p=function(l){var f=function(t){if(void 0===t.elements.x00020010)throw"dicomParser.parseDicom: missing required meta header attribute 0002,0010";var i=t.elements.x00020010;return h.readFixedString(e,i.dataOffset,i.length)}(l),p=function(t){return"1.2.840.10008.1.2"!==t}(f),m=function(a,l){if("1.2.840.10008.1.2.1.99"===a){if(d&&d.inflater){var h=d.inflater(e,l);return new o.default(s.default,h,0)}if(void 0!==t&&this.module!==t){var u=i(68),f=(0,c.default)(e,l,e.length-l),p=u.inflateRawSync(f),m=(0,n.default)(e,p.length+l);return e.copy(m,0,0,l),p.copy(m,l),new o.default(s.default,m,0)}if("undefined"!=typeof pako){var _=e.slice(l),g=pako.inflateRaw(_),y=(0,n.default)(e,g.length+l);return y.set(e.slice(0,l),0),y.set(g,l),new o.default(s.default,y,0)}throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax"}return"1.2.840.10008.1.2.2"===a?new o.default(r.default,e,l):new o.default(s.default,e,l)}(f,l.position),_=new a.default(m.byteArrayParser,m.byteArray,{});_.warnings=m.warnings;try{p?u.parseDicomDataSetExplicit(_,m,m.byteArray.length,d):u.parseDicomDataSetImplicit(_,m,m.byteArray.length,d)}catch(t){var g={exception:t,dataSet:_};throw g}return _}(f),function(t,e){for(var i in t.elements)t.elements.hasOwnProperty(i)&&(e.elements[i]=t.elements[i]);return void 0!==t.warnings&&(e.warnings=t.warnings.concat(e.warnings)),e}(f,p);var f,p};var n=f(i(22)),r=f(i(37)),o=f(i(12)),a=f(i(7)),s=f(i(21)),l=f(i(36)),c=f(i(11)),h=d(i(14)),u=d(i(16));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function f(t){return t&&t.__esModule?t:{default:t}}}).call(this,i(69)(t))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="1.8.1"},function(t,e){e.read=function(t,e,i,n,r){var o,a,s=8*r-n-1,l=(1<<s)-1,c=l>>1,h=-7,u=i?r-1:0,d=i?-1:1,f=t[e+u];for(u+=d,o=f&(1<<-h)-1,f>>=-h,h+=s;h>0;o=256*o+t[e+u],u+=d,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=n;h>0;a=256*a+t[e+u],u+=d,h-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=c}return(f?-1:1)*a*Math.pow(2,o-n)},e.write=function(t,e,i,n,r,o){var a,s,l,c=8*o-r-1,h=(1<<c)-1,u=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=h?(s=0,a=h):a+u>=1?(s=(e*l-1)*Math.pow(2,r),a+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,r),a=0));r>=8;t[i+f]=255&s,f+=p,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;t[i+f]=255&a,f+=p,a/=256,c-=8);t[i+f-p]|=128*m}},function(t,e,i){"use strict";e.byteLength=function(t){return 3*t.length/4-c(t)},e.toByteArray=function(t){var e,i,n,a,s,l=t.length;a=c(t),s=new o(3*l/4-a),i=a>0?l-4:l;var h=0;for(e=0;e<i;e+=4)n=r[t.charCodeAt(e)]<<18|r[t.charCodeAt(e+1)]<<12|r[t.charCodeAt(e+2)]<<6|r[t.charCodeAt(e+3)],s[h++]=n>>16&255,s[h++]=n>>8&255,s[h++]=255&n;return 2===a?(n=r[t.charCodeAt(e)]<<2|r[t.charCodeAt(e+1)]>>4,s[h++]=255&n):1===a&&(n=r[t.charCodeAt(e)]<<10|r[t.charCodeAt(e+1)]<<4|r[t.charCodeAt(e+2)]>>2,s[h++]=n>>8&255,s[h++]=255&n),s},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o="",a=[],s=0,l=i-r;s<l;s+=16383)a.push(h(t,s,s+16383>l?l:s+16383));return 1===r?(e=t[i-1],o+=n[e>>2],o+=n[e<<4&63],o+="=="):2===r&&(e=(t[i-2]<<8)+t[i-1],o+=n[e>>10],o+=n[e>>4&63],o+=n[e<<2&63],o+="="),a.push(o),a.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],r[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function h(t,e,i){for(var r,o,a=[],s=e;s<i;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e,i){"use strict";function n(t,e){return 255===t.byteArray[e]&&217===t.byteArray[e+1]}function r(t,e,i){var r=e.fragments[i];return!(!n(t,r.position+r.length-2)&&!n(t,r.position+r.length-3))}function o(t,e,i){for(var n=i;n<e.fragments.length;n++)if(r(t,e,n))return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==e.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==e.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==e.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===e.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(e.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(i&&i.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";i=i||e.fragments;for(var n=[],r=0;;){n.push(e.fragments[r].offset);var a=o(t,e,r);if(void 0===a||a===e.fragments.length-1)return n;r=a+1}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e,i){if(void 0===e)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";i=i||{omitPrivateAttibutes:!0,maxElementLength:128};var n={};for(var r in e.elements){var s=e.elements[r];if(!0!==i.omitPrivateAttibutes||!a.isPrivateTag(r))if(s.items){for(var l=[],c=0;c<s.items.length;c++)l.push(t(s.items[c].dataSet,i));n[r]=l}else{var h;h=void 0,s.length<i.maxElementLength&&(h=(0,o.default)(e,s)),n[r]=void 0!==h?h:{dataOffset:s.dataOffset,length:s.length}}}return n};var n,r=i(43),o=(n=r)&&n.__esModule?n:{default:n},a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(25))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(t&&8===t.length){var i=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,6),10),r=parseInt(t.substring(6,8),10);if(e&&!0!==function(t,e,i){return!isNaN(i)&&e>0&&e<=12&&t>0&&t<=function(t,e){switch(t){case 2:return e%4==0&&e%100||e%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(e,i)}(r,n,i))throw"invalid DA '"+t+"'";return{year:i,month:n,day:r}}if(e)throw"invalid DA '"+t+"'"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(t.length>=2){var i=parseInt(t.substring(0,2),10),n=t.length>=4?parseInt(t.substring(2,4),10):void 0,r=t.length>=6?parseInt(t.substring(4,6),10):void 0,o=t.length>=8?parseInt(t.substring(7,13),10):void 0;if(e&&(isNaN(i)||void 0!==n&&isNaN(n)||void 0!==r&&isNaN(r)||void 0!==o&&isNaN(o)||i<0||i>23||n&&(n<0||n>59)||r&&(r<0||r>59)||o&&(o<0||o>999999)))throw"invalid TM '"+t+"'";return{hours:i,minutes:n,seconds:r,fractionalSeconds:o}}if(e)throw"invalid TM '"+t+"'"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(25);Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})});var r=i(77);Object.defineProperty(e,"parseTM",{enumerable:!0,get:function(){return c(r).default}});var o=i(76);Object.defineProperty(e,"parseDA",{enumerable:!0,get:function(){return c(o).default}});var a=i(43);Object.defineProperty(e,"explicitElementToString",{enumerable:!0,get:function(){return c(a).default}});var s=i(75);Object.defineProperty(e,"explicitDataSetToJS",{enumerable:!0,get:function(){return c(s).default}});var l=i(74);function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"createJPEGBasicOffsetTable",{enumerable:!0,get:function(){return c(l).default}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(78);Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})});var r=i(16);Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})});var o=i(14);Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}})});var a=i(22);Object.defineProperty(e,"alloc",{enumerable:!0,get:function(){return T(a).default}});var s=i(71);Object.defineProperty(e,"version",{enumerable:!0,get:function(){return T(s).default}});var l=i(37);Object.defineProperty(e,"bigEndianByteArrayParser",{enumerable:!0,get:function(){return T(l).default}});var c=i(12);Object.defineProperty(e,"ByteStream",{enumerable:!0,get:function(){return T(c).default}});var h=i(11);Object.defineProperty(e,"sharedCopy",{enumerable:!0,get:function(){return T(h).default}});var u=i(7);Object.defineProperty(e,"DataSet",{enumerable:!0,get:function(){return T(u).default}});var d=i(41);Object.defineProperty(e,"findAndSetUNElementLength",{enumerable:!0,get:function(){return T(d).default}});var f=i(42);Object.defineProperty(e,"findEndOfEncapsulatedElement",{enumerable:!0,get:function(){return T(f).default}});var p=i(24);Object.defineProperty(e,"findItemDelimitationItemAndSetElementLength",{enumerable:!0,get:function(){return T(p).default}});var m=i(21);Object.defineProperty(e,"littleEndianByteArrayParser",{enumerable:!0,get:function(){return T(m).default}});var _=i(70);Object.defineProperty(e,"parseDicom",{enumerable:!0,get:function(){return T(_).default}});var g=i(15);Object.defineProperty(e,"readDicomElementExplicit",{enumerable:!0,get:function(){return T(g).default}});var y=i(23);Object.defineProperty(e,"readDicomElementImplicit",{enumerable:!0,get:function(){return T(y).default}});var b=i(26);Object.defineProperty(e,"readEncapsulatedImageFrame",{enumerable:!0,get:function(){return T(b).default}});var v=i(44);Object.defineProperty(e,"readEncapsulatedPixelData",{enumerable:!0,get:function(){return T(v).default}});var w=i(17);Object.defineProperty(e,"readEncapsulatedPixelDataFromFragments",{enumerable:!0,get:function(){return T(w).default}});var x=i(36);Object.defineProperty(e,"readPart10Header",{enumerable:!0,get:function(){return T(x).default}});var A=i(40);Object.defineProperty(e,"readSequenceItemsExplicit",{enumerable:!0,get:function(){return T(A).default}});var S=i(39);Object.defineProperty(e,"readSequenceItemsImplicit",{enumerable:!0,get:function(){return T(S).default}});var M=i(13);Object.defineProperty(e,"readSequenceItem",{enumerable:!0,get:function(){return T(M).default}});var E=i(4);function T(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"readTag",{enumerable:!0,get:function(){return T(E).default}})}])},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.ComponentSpec=n.lossless.ComponentSpec||i(83),n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.Decoder=n.lossless.Decoder||i(156),n.lossless.FrameHeader=n.lossless.FrameHeader||i(88),n.lossless.HuffmanTable=n.lossless.HuffmanTable||i(84),n.lossless.QuantizationTable=n.lossless.QuantizationTable||i(85),n.lossless.ScanComponent=n.lossless.ScanComponent||i(87),n.lossless.ScanHeader=n.lossless.ScanHeader||i(86),n.lossless.Utils=n.lossless.Utils||i(22),"undefined"!==typeof t&&t.exports&&(t.exports=n)},function(t,e,i){"use strict";var n=n||{};n.lossless=n.lossless||{},n.lossless.DataStream=n.lossless.DataStream||i(13),n.lossless.HuffmanTable=n.lossless.HuffmanTable||i(84),n.lossless.QuantizationTable=n.lossless.QuantizationTable||i(85),n.lossless.ScanHeader=n.lossless.ScanHeader||i(86),n.lossless.FrameHeader=n.lossless.FrameHeader||i(88),n.lossless.Utils=n.lossless.Utils||i(22),n.lossless.Decoder=n.lossless.Decoder||function(t,e){this.buffer=t,this.frame=new n.lossless.FrameHeader,this.huffTable=new n.lossless.HuffmanTable,this.quantTable=new n.lossless.QuantizationTable,this.scan=new n.lossless.ScanHeader,this.DU=n.lossless.Utils.createArray(10,4,64),this.HuffTab=n.lossless.Utils.createArray(4,2,12800),this.IDCT_Source=[],this.nBlock=[],this.acTab=n.lossless.Utils.createArray(10,1),this.dcTab=n.lossless.Utils.createArray(10,1),this.qTab=n.lossless.Utils.createArray(10,1),this.marker=0,this.markerIndex=0,this.numComp=0,this.restartInterval=0,this.selection=0,this.xDim=0,this.yDim=0,this.xLoc=0,this.yLoc=0,this.numBytes=0,this.outputData=null,this.restarting=!1,this.mask=0,void 0!==e&&(this.numBytes=e)},n.lossless.Decoder.IDCT_P=[0,5,40,16,45,2,7,42,21,56,8,61,18,47,1,4,41,23,58,13,32,24,37,10,63,17,44,3,6,43,20,57,15,34,29,48,53,26,39,9,60,19,46,22,59,12,33,31,50,55,25,36,11,62,14,35,28,49,52,27,38,30,51,54],n.lossless.Decoder.TABLE=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],n.lossless.Decoder.MAX_HUFFMAN_SUBTREE=50,n.lossless.Decoder.MSB=2147483648,n.lossless.Decoder.RESTART_MARKER_BEGIN=65488,n.lossless.Decoder.RESTART_MARKER_END=65495,n.lossless.Decoder.prototype.decompress=function(t,e,i){return this.decode(t,e,i).buffer},n.lossless.Decoder.prototype.decode=function(t,e,i,r){var o,a,s,l,c=0,h=[],u=[],d=[];if(void 0!==t&&(this.buffer=t),void 0!==r&&(this.numBytes=r),this.stream=new n.lossless.DataStream(this.buffer,e,i),this.buffer=null,this.xLoc=0,this.yLoc=0,65496!==(o=this.stream.get16()))throw new Error("Not a JPEG file");for(o=this.stream.get16();o>>4!=4092||65476===o;){switch(o){case 65476:this.huffTable.read(this.stream,this.HuffTab);break;case 65484:throw new Error("Program doesn't support arithmetic coding. (format throw new IOException)");case 65499:this.quantTable.read(this.stream,n.lossless.Decoder.TABLE);break;case 65501:this.restartInterval=this.readNumber();break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:this.readApp();break;case 65534:this.readComment();break;default:if(o>>8!=255)throw new Error("ERROR: format throw new IOException! (decode)")}o=this.stream.get16()}if(o<65472||o>65479)throw new Error("ERROR: could not handle arithmetic code!");this.frame.read(this.stream),o=this.stream.get16();do{for(;65498!==o;){switch(o){case 65476:this.huffTable.read(this.stream,this.HuffTab);break;case 65484:throw new Error("Program doesn't support arithmetic coding. (format throw new IOException)");case 65499:this.quantTable.read(this.stream,n.lossless.Decoder.TABLE);break;case 65501:this.restartInterval=this.readNumber();break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:this.readApp();break;case 65534:this.readComment();break;default:if(o>>8!=255)throw new Error("ERROR: format throw new IOException! (Parser.decode)")}o=this.stream.get16()}switch(this.precision=this.frame.precision,this.components=this.frame.components,this.numBytes||(this.numBytes=parseInt(Math.ceil(this.precision/8))),1==this.numBytes?this.mask=255:this.mask=65535,this.scan.read(this.stream),this.numComp=this.scan.numComp,this.selection=this.scan.selection,1===this.numBytes?3===this.numComp?(this.getter=this.getValueRGB,this.setter=this.setValueRGB,this.output=this.outputRGB):(this.getter=this.getValue8,this.setter=this.setValue8,this.output=this.outputSingle):(this.getter=this.getValue16,this.setter=this.setValue16,this.output=this.outputSingle),this.selection){case 2:this.selector=this.select2;break;case 3:this.selector=this.select3;break;case 4:this.selector=this.select4;break;case 5:this.selector=this.select5;break;case 6:this.selector=this.select6;break;case 7:this.selector=this.select7;break;default:this.selector=this.select1}for(this.scanComps=this.scan.components,this.quantTables=this.quantTable.quantTables,a=0;a<this.numComp;a+=1)s=this.scanComps[a].scanCompSel,this.qTab[a]=this.quantTables[this.components[s].quantTableSel],this.nBlock[a]=this.components[s].vSamp*this.components[s].hSamp,this.dcTab[a]=this.HuffTab[this.scanComps[a].dcTabSel][0],this.acTab[a]=this.HuffTab[this.scanComps[a].acTabSel][1];for(this.xDim=this.frame.dimX,this.yDim=this.frame.dimY,this.outputData=new DataView(new ArrayBuffer(this.xDim*this.yDim*this.numBytes*this.numComp)),c+=1;;){for(u[0]=0,d[0]=0,a=0;a<10;a+=1)h[a]=1<<this.precision-1;if(0===this.restartInterval){for(o=this.decodeUnit(h,u,d);0===o&&this.xLoc<this.xDim&&this.yLoc<this.yDim;)this.output(h),o=this.decodeUnit(h,u,d);break}for(l=0;l<this.restartInterval&&(this.restarting=0==l,o=this.decodeUnit(h,u,d),this.output(h),0===o);l+=1);if(0===o&&(0!==this.markerIndex?(o=65280|this.marker,this.markerIndex=0):o=this.stream.get16()),!(o>=n.lossless.Decoder.RESTART_MARKER_BEGIN&&o<=n.lossless.Decoder.RESTART_MARKER_END))break}65500===o&&1===c&&(this.readNumber(),o=this.stream.get16())}while(65497!==o&&this.xLoc<this.xDim&&this.yLoc<this.yDim&&0===c);return this.outputData},n.lossless.Decoder.prototype.decodeUnit=function(t,e,i){return 1==this.numComp?this.decodeSingle(t,e,i):3==this.numComp?this.decodeRGB(t,e,i):-1},n.lossless.Decoder.prototype.select1=function(t){return this.getPreviousX(t)},n.lossless.Decoder.prototype.select2=function(t){return this.getPreviousY(t)},n.lossless.Decoder.prototype.select3=function(t){return this.getPreviousXY(t)},n.lossless.Decoder.prototype.select4=function(t){return this.getPreviousX(t)+this.getPreviousY(t)-this.getPreviousXY(t)},n.lossless.Decoder.prototype.select5=function(t){return this.getPreviousX(t)+(this.getPreviousY(t)-this.getPreviousXY(t)>>1)},n.lossless.Decoder.prototype.select6=function(t){return this.getPreviousY(t)+(this.getPreviousX(t)-this.getPreviousXY(t)>>1)},n.lossless.Decoder.prototype.select7=function(t){return(this.getPreviousX(t)+this.getPreviousY(t))/2},n.lossless.Decoder.prototype.decodeRGB=function(t,e,i){var r,o,a,s,l,c,h,u;for(t[0]=this.selector(0),t[1]=this.selector(1),t[2]=this.selector(2),l=0;l<this.numComp;l+=1)for(s=this.qTab[l],o=this.acTab[l],a=this.dcTab[l],c=0;c<this.nBlock[l];c+=1){for(h=0;h<this.IDCT_Source.length;h+=1)this.IDCT_Source[h]=0;if((r=this.getHuffmanValue(a,e,i))>=65280)return r;for(t[l]=this.IDCT_Source[0]=t[l]+this.getn(i,r,e,i),this.IDCT_Source[0]*=s[0],u=1;u<64;u+=1){if((r=this.getHuffmanValue(o,e,i))>=65280)return r;if(u+=r>>4,0==(15&r)){if(r>>4==0)break}else this.IDCT_Source[n.lossless.Decoder.IDCT_P[u]]=this.getn(i,15&r,e,i)*s[u]}}return 0},n.lossless.Decoder.prototype.decodeSingle=function(t,e,i){var r,o,a,s;for(this.restarting?(this.restarting=!1,t[0]=1<<this.frame.precision-1):t[0]=this.selector(),o=0;o<this.nBlock[0];o+=1){if((r=this.getHuffmanValue(this.dcTab[0],e,i))>=65280)return r;if((s=(a=this.getn(t,r,e,i))>>8)>=n.lossless.Decoder.RESTART_MARKER_BEGIN&&s<=n.lossless.Decoder.RESTART_MARKER_END)return s;t[0]+=a}return 0},n.lossless.Decoder.prototype.getHuffmanValue=function(t,e,i){var r,o;if(65535,i[0]<8?(e[0]<<=8,255===(o=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),e[0]|=o):i[0]-=8,0!=((r=t[e[0]>>i[0]])&n.lossless.Decoder.MSB)){if(0!==this.markerIndex)return this.markerIndex=0,65280|this.marker;e[0]&=65535>>16-i[0],e[0]<<=8,255===(o=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),e[0]|=o,r=t[256*(255&r)+(e[0]>>i[0])],i[0]+=8}if(i[0]+=8-(r>>8),i[0]<0)throw new Error("index="+i[0]+" temp="+e[0]+" code="+r+" in HuffmanValue()");return i[0]<this.markerIndex?(this.markerIndex=0,65280|this.marker):(e[0]&=65535>>16-i[0],255&r)},n.lossless.Decoder.prototype.getn=function(t,e,i,n){var r,o;if(1,-1,65535,0===e)return 0;if(16===e)return t[0]>=0?-32768:32768;if(n[0]-=e,n[0]>=0){if(n[0]<this.markerIndex&&!this.isLastPixel())return this.markerIndex=0,(65280|this.marker)<<8;r=i[0]>>n[0],i[0]&=65535>>16-n[0]}else{if(i[0]<<=8,255===(o=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),i[0]|=o,n[0]+=8,n[0]<0){if(0!==this.markerIndex)return this.markerIndex=0,(65280|this.marker)<<8;i[0]<<=8,255===(o=this.stream.get8())&&(this.marker=this.stream.get8(),0!==this.marker&&(this.markerIndex=9)),i[0]|=o,n[0]+=8}if(n[0]<0)throw new Error("index="+n[0]+" in getn()");if(n[0]<this.markerIndex)return this.markerIndex=0,(65280|this.marker)<<8;r=i[0]>>n[0],i[0]&=65535>>16-n[0]}return r<1<<e-1&&(r+=1+(-1<<e)),r},n.lossless.Decoder.prototype.getPreviousX=function(t){return this.xLoc>0?this.getter(this.yLoc*this.xDim+this.xLoc-1,t):this.yLoc>0?this.getPreviousY(t):1<<this.frame.precision-1},n.lossless.Decoder.prototype.getPreviousXY=function(t){return this.xLoc>0&&this.yLoc>0?this.getter((this.yLoc-1)*this.xDim+this.xLoc-1,t):this.getPreviousY(t)},n.lossless.Decoder.prototype.getPreviousY=function(t){return this.yLoc>0?this.getter((this.yLoc-1)*this.xDim+this.xLoc,t):this.getPreviousX(t)},n.lossless.Decoder.prototype.isLastPixel=function(){return this.xLoc===this.xDim-1&&this.yLoc===this.yDim-1},n.lossless.Decoder.prototype.outputSingle=function(t){this.xLoc<this.xDim&&this.yLoc<this.yDim&&(this.setter(this.yLoc*this.xDim+this.xLoc,this.mask&t[0]),this.xLoc+=1,this.xLoc>=this.xDim&&(this.yLoc+=1,this.xLoc=0))},n.lossless.Decoder.prototype.outputRGB=function(t){var e=this.yLoc*this.xDim+this.xLoc;this.xLoc<this.xDim&&this.yLoc<this.yDim&&(this.setter(e,t[0],0),this.setter(e,t[1],1),this.setter(e,t[2],2),this.xLoc+=1,this.xLoc>=this.xDim&&(this.yLoc+=1,this.xLoc=0))},n.lossless.Decoder.prototype.setValue16=function(t,e){this.outputData.setInt16(2*t,e,!0)},n.lossless.Decoder.prototype.getValue16=function(t){return this.outputData.getInt16(2*t,!0)},n.lossless.Decoder.prototype.setValue8=function(t,e){this.outputData.setInt8(t,e)},n.lossless.Decoder.prototype.getValue8=function(t){return this.outputData.getInt8(t)},n.lossless.Decoder.prototype.setValueRGB=function(t,e,i){this.outputData.setUint8(3*t+i,e)},n.lossless.Decoder.prototype.getValueRGB=function(t,e){return this.outputData.getUint8(3*t+e)},n.lossless.Decoder.prototype.readApp=function(){var t=0,e=this.stream.get16();for(t+=2;t<e;)this.stream.get8(),t+=1;return e},n.lossless.Decoder.prototype.readComment=function(){var t,e="",i=0;for(t=this.stream.get16(),i+=2;i<t;)e+=this.stream.get8(),i+=1;return e},n.lossless.Decoder.prototype.readNumber=function(){if(4!==this.stream.get16())throw new Error("ERROR: Define number format throw new IOException [Ld!=4]");return this.stream.get16()},"undefined"!==typeof t&&t.exports&&(t.exports=n.lossless.Decoder)},function(t,e){var i={Unkown:0,Grayscale:1,AdobeRGB:2,RGB:3,CYMK:4},n=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,n=799,r=3406,o=2276,a=1567,s=3784,l=5793,c=2896;function h(){}function u(t,e){for(var i,n,r=0,o=[],a=16;a>0&&!t[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(i=0;i<a;i++){for(n=0;n<t[i];n++){for((l=o.pop()).children[l.index]=e[r];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=i;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;r++}i+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function d(t,e,i){return 64*((t.blocksPerLine+1)*e+i)}function f(e,i,n,r,o,a,s,l,c){n.precision,n.samplesPerLine,n.scanLines;var h=n.mcusPerLine,u=n.progressive,f=(n.maxH,n.maxV,i),p=0,m=0;function _(){if(m>0)return p>>--m&1;if(255==(p=e[i++])){var t=e[i++];if(t)throw"unexpected marker: "+(p<<8|t).toString(16)}return m=7,p>>>7}function g(t){for(var e,i=t;null!==(e=_());){if("number"==typeof(i=i[e]))return i;if("object"!=typeof i)throw"invalid huffman sequence"}return null}function y(t){for(var e=0;t>0;){var i=_();if(null===i)return;e=e<<1|i,t--}return e}function b(t){var e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}var v=0;var w,x=0;function A(t,e,i,n,r){var o=i%h;e(t,d(t,(i/h|0)*t.v+n,o*t.h+r))}function S(t,e,i){e(t,d(t,i/t.blocksPerLine|0,i%t.blocksPerLine))}var M,E,T,k,C,I,P=r.length;I=u?0===a?0===l?function(t,e){var i=g(t.huffmanTableDC),n=0===i?0:b(i)<<c;t.blockData[e]=t.pred+=n}:function(t,e){t.blockData[e]|=_()<<c}:0===l?function(e,i){if(v>0)v--;else for(var n=a,r=s;n<=r;){var o=g(e.huffmanTableAC),l=15&o,h=o>>4;if(0!==l){var u=t[n+=h];e.blockData[i+u]=b(l)*(1<<c),n++}else{if(h<15){v=y(h)+(1<<h)-1;break}n+=16}}}:function(e,i){for(var n=a,r=s,o=0;n<=r;){var l=t[n];switch(x){case 0:var h=g(e.huffmanTableAC),u=15&h;if(o=h>>4,0===u)o<15?(v=y(o)+(1<<o),x=4):(o=16,x=1);else{if(1!==u)throw"invalid ACn encoding";w=b(u),x=o?2:3}continue;case 1:case 2:e.blockData[i+l]?e.blockData[i+l]+=_()<<c:0==--o&&(x=2==x?3:0);break;case 3:e.blockData[i+l]?e.blockData[i+l]+=_()<<c:(e.blockData[i+l]=w<<c,x=0);break;case 4:e.blockData[i+l]&&(e.blockData[i+l]+=_()<<c)}n++}4===x&&0==--v&&(x=0)}:function(e,i){var n=g(e.huffmanTableDC),r=0===n?0:b(n);e.blockData[i]=e.pred+=r;for(var o=1;o<64;){var a=g(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){var c=t[o+=l];e.blockData[i+c]=b(s),o++}else{if(l<15)break;o+=16}}};var R,B,L,D,O=0;for(B=1==P?r[0].blocksPerLine*r[0].blocksPerColumn:h*n.mcusPerColumn,o||(o=B);O<B;){for(E=0;E<P;E++)r[E].pred=0;if(v=0,1==P)for(M=r[0],C=0;C<o;C++)S(M,I,O),O++;else for(C=0;C<o;C++){for(E=0;E<P;E++)for(L=(M=r[E]).h,D=M.v,T=0;T<D;T++)for(k=0;k<L;k++)A(M,I,O,T,k);O++}if(m=0,(R=e[i]<<8|e[i+1])<=65280)throw"marker was not found";if(!(R>=65488&&R<=65495))break;i+=2}return i-f}function p(t,i,h){var u,d,f,p,m,_,g,y,b,v,w=t.quantizationTable;for(v=0;v<64;v++)h[v]=t.blockData[i+v]*w[v];for(v=0;v<8;++v){var x=8*v;0!==h[1+x]||0!==h[2+x]||0!==h[3+x]||0!==h[4+x]||0!==h[5+x]||0!==h[6+x]||0!==h[7+x]?(u=l*h[0+x]+128>>8,d=l*h[4+x]+128>>8,f=h[2+x],p=h[6+x],m=c*(h[1+x]-h[7+x])+128>>8,y=c*(h[1+x]+h[7+x])+128>>8,_=h[3+x]<<4,g=h[5+x]<<4,b=u-d+1>>1,u=u+d+1>>1,d=b,b=f*s+p*a+128>>8,f=f*a-p*s+128>>8,p=b,b=m-g+1>>1,m=m+g+1>>1,g=b,b=y+_+1>>1,_=y-_+1>>1,y=b,b=u-p+1>>1,u=u+p+1>>1,p=b,b=d-f+1>>1,d=d+f+1>>1,f=b,b=m*o+y*r+2048>>12,m=m*r-y*o+2048>>12,y=b,b=_*n+g*e+2048>>12,_=_*e-g*n+2048>>12,g=b,h[0+x]=u+y,h[7+x]=u-y,h[1+x]=d+g,h[6+x]=d-g,h[2+x]=f+_,h[5+x]=f-_,h[3+x]=p+m,h[4+x]=p-m):(b=l*h[0+x]+512>>10,h[0+x]=b,h[1+x]=b,h[2+x]=b,h[3+x]=b,h[4+x]=b,h[5+x]=b,h[6+x]=b,h[7+x]=b)}for(v=0;v<8;++v){var A=v;0!==h[8+A]||0!==h[16+A]||0!==h[24+A]||0!==h[32+A]||0!==h[40+A]||0!==h[48+A]||0!==h[56+A]?(u=l*h[0+A]+2048>>12,d=l*h[32+A]+2048>>12,f=h[16+A],p=h[48+A],m=c*(h[8+A]-h[56+A])+2048>>12,y=c*(h[8+A]+h[56+A])+2048>>12,_=h[24+A],g=h[40+A],b=u-d+1>>1,u=u+d+1>>1,d=b,b=f*s+p*a+2048>>12,f=f*a-p*s+2048>>12,p=b,b=m-g+1>>1,m=m+g+1>>1,g=b,b=y+_+1>>1,_=y-_+1>>1,y=b,b=u-p+1>>1,u=u+p+1>>1,p=b,b=d-f+1>>1,d=d+f+1>>1,f=b,b=m*o+y*r+2048>>12,m=m*r-y*o+2048>>12,y=b,b=_*n+g*e+2048>>12,_=_*e-g*n+2048>>12,g=b,h[0+A]=u+y,h[56+A]=u-y,h[8+A]=d+g,h[48+A]=d-g,h[16+A]=f+_,h[40+A]=f-_,h[24+A]=p+m,h[32+A]=p-m):(b=l*h[v+0]+8192>>14,h[0+A]=b,h[8+A]=b,h[16+A]=b,h[24+A]=b,h[32+A]=b,h[40+A]=b,h[48+A]=b,h[56+A]=b)}for(v=0;v<64;++v){var S=i+v,M=h[v];M=M<=-2056/t.bitConversion?0:M>=2024/t.bitConversion?255/t.bitConversion:M+2056/t.bitConversion>>4,t.blockData[S]=M}}function m(t,e){for(var i=e.blocksPerLine,n=e.blocksPerColumn,r=new Int32Array(64),o=0;o<n;o++)for(var a=0;a<i;a++){p(e,d(e,o,a),r)}return e.blockData}function _(t){return t<=0?0:t>=255?255:0|t}return h.prototype={load:function(t){var e=function(t){this.parse(t),this.onload&&this.onload()}.bind(this);if(t.indexOf("data:")>-1){for(var i=t.indexOf("base64,")+7,n=atob(t.substring(i)),r=new Uint8Array(n.length),o=n.length-1;o>=0;o--)r[o]=n.charCodeAt(o);e(n)}else{var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){var t=new Uint8Array(a.response);e(t)}.bind(this),a.send(null)}},parse:function(e){function n(){var t=e[l]<<8|e[l+1];return l+=2,t}function r(){var t=n(),i=e.subarray(l,l+t-2);return l+=i.length,i}function o(t){for(var e=Math.ceil(t.samplesPerLine/8/t.maxH),i=Math.ceil(t.scanLines/8/t.maxV),n=0;n<t.components.length;n++){j=t.components[n];var r=Math.ceil(Math.ceil(t.samplesPerLine/8)*j.h/t.maxH),o=Math.ceil(Math.ceil(t.scanLines/8)*j.v/t.maxV),a=e*j.h,s=64*(i*j.v)*(a+1);j.blockData=new Int16Array(s),j.blocksPerLine=r,j.blocksPerColumn=o}t.mcusPerLine=e,t.mcusPerColumn=i}var a,s,l=0,c=(e.length,null),h=null,d=[],p=[],_=[],g=n();if(65496!=g)throw"SOI not found";for(g=n();65497!=g;){var y,b;switch(g){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=r();65504===g&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(c={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===g&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(h={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var w=n()+l-2;l<w;){var x=e[l++],A=new Int32Array(64);if(x>>4==0)for(y=0;y<64;y++){A[t[y]]=e[l++]}else{if(x>>4!=1)throw"DQT: invalid table spec";for(y=0;y<64;y++){A[t[y]]=n()}}d[15&x]=A}break;case 65472:case 65473:case 65474:if(a)throw"Only single frame JPEGs supported";n(),(a={}).extended=65473===g,a.progressive=65474===g,a.precision=e[l++],a.scanLines=n(),a.samplesPerLine=n(),a.components=[],a.componentIds={};var S,M=e[l++],E=0,T=0;for(W=0;W<M;W++){S=e[l];var k=e[l+1]>>4,C=15&e[l+1];E<k&&(E=k),T<C&&(T=C);var I=e[l+2];b=a.components.push({h:k,v:C,quantizationTable:d[I],quantizationTableId:I,bitConversion:255/((1<<a.precision)-1)}),a.componentIds[S]=b-1,l+=3}a.maxH=E,a.maxV=T,o(a);break;case 65476:var P=n();for(W=2;W<P;){var R=e[l++],B=new Uint8Array(16),L=0;for(y=0;y<16;y++,l++)L+=B[y]=e[l];var D=new Uint8Array(L);for(y=0;y<L;y++,l++)D[y]=e[l];W+=17+L,(R>>4==0?_:p)[15&R]=u(B,D)}break;case 65501:n(),s=n();break;case 65498:n();var O=e[l++],F=[];for(W=0;W<O;W++){var G=a.componentIds[e[l++]];j=a.components[G];var N=e[l++];j.huffmanTableDC=_[N>>4],j.huffmanTableAC=p[15&N],F.push(j)}var z=e[l++],U=e[l++],H=e[l++],V=f(e,l,a,F,s,z,U,H>>4,15&H);l+=V;break;default:if(255==e[l-3]&&e[l-2]>=192&&e[l-2]<=254){l-=3;break}throw"unknown JPEG marker "+g.toString(16)}g=n()}switch(this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=c,this.adobe=h,this.components=[],a.components.length){case 1:this.colorspace=i.Grayscale;break;case 3:this.adobe?this.colorspace=i.AdobeRGB:this.colorspace=i.RGB;break;case 4:this.colorspace=i.CYMK;break;default:this.colorspace=i.Unknown}for(var W=0;W<a.components.length;W++){var j;(j=a.components[W]).quantizationTable||null===j.quantizationTableId||(j.quantizationTable=d[j.quantizationTableId]),this.components.push({output:m(0,j),scaleX:j.h/a.maxH,scaleY:j.v/a.maxV,blocksPerLine:j.blocksPerLine,blocksPerColumn:j.blocksPerColumn,bitConversion:j.bitConversion})}},getData16:function(t,e){if(1!==this.components.length)throw"Unsupported color mode";var i,n,r,o,a,s,l=this.width/t,c=this.height/e,h=0,u=this.components.length,f=new Uint16Array(t*e*u),p=new Uint16Array((this.components[0].blocksPerLine<<3)*this.components[0].blocksPerColumn*8);for(s=0;s<u;s++){for(var m,_,g,y=(i=this.components[s]).blocksPerLine,b=i.blocksPerColumn,v=y<<3,w=0,x=0;x<b;x++)for(var A=x<<3,S=0;S<y;S++){var M=d(i,x,S),E=(h=0,S<<3);for(m=0;m<8;m++){w=(A+m)*v;for(_=0;_<8;_++)p[w+E+_]=i.output[M+h++]}}for(n=i.scaleX*l,r=i.scaleY*c,h=s,a=0;a<e;a++)for(o=0;o<t;o++)g=(0|a*r)*v+(0|o*n),f[h]=p[g],h+=u}return f},getData:function(t,e){var i,n,r,o,a,s,l,c,h,u,f,p,m,g,y,b=this.width/t,v=this.height/e,w=0,x=this.components.length,A=t*e*x,S=new Uint8Array(A),M=new Uint8Array((this.components[0].blocksPerLine<<3)*this.components[0].blocksPerColumn*8);for(s=0;s<x;s++){for(var E,T,k,C=(i=this.components[s]).blocksPerLine,I=i.blocksPerColumn,P=C<<3,R=0,B=0;B<I;B++)for(var L=B<<3,D=0;D<C;D++){var O=d(i,B,D),F=(w=0,D<<3);for(E=0;E<8;E++){R=(L+E)*P;for(T=0;T<8;T++)M[R+F+T]=i.output[O+w++]*i.bitConversion}}for(n=i.scaleX*b,r=i.scaleY*v,w=s,a=0;a<e;a++)for(o=0;o<t;o++)k=(0|a*r)*P+(0|o*n),S[w]=M[k],w+=x}switch(x){case 1:case 2:break;case 3:if(y=!0,this.adobe&&this.adobe.transformCode?y=!0:void 0!==this.colorTransform&&(y=!!this.colorTransform),y)for(s=0;s<A;s+=x)l=S[s],c=S[s+1],p=_(l-179.456+1.402*(h=S[s+2])),m=_(l+135.459-.344*c-.714*h),g=_(l-226.816+1.772*c),S[s]=p,S[s+1]=m,S[s+2]=g;break;case 4:if(!this.adobe)throw"Unsupported color mode (4 components)";if(y=!1,this.adobe&&this.adobe.transformCode?y=!0:void 0!==this.colorTransform&&(y=!!this.colorTransform),y)for(s=0;s<A;s+=x)l=S[s],c=S[s+1],u=_(434.456-l-1.402*(h=S[s+2])),f=_(119.541-l+.344*c+.714*h),l=_(481.816-l-1.772*c),S[s]=u,S[s+1]=f,S[s+2]=l;break;default:throw"Unsupported color mode"}return S}},h}();"undefined"!==typeof t&&t.exports&&(t.exports=n)},function(t,e,i){"use strict";
/*! image-JPEG2000 - v0.3.1 - 2015-08-26 | https://github.com/OHIF/image-JPEG2000 */var n=function(){var t={LL:0,LH:1,HL:1,HH:2};function e(){this.failOnCorruptedImage=!1}function i(t,e){t.x0=Math.ceil(e.XOsiz/t.XRsiz),t.x1=Math.ceil(e.Xsiz/t.XRsiz),t.y0=Math.ceil(e.YOsiz/t.YRsiz),t.y1=Math.ceil(e.Ysiz/t.YRsiz),t.width=t.x1-t.x0,t.height=t.y1-t.y0}function n(t,e){for(var i,n=t.SIZ,r=[],o=Math.ceil((n.Xsiz-n.XTOsiz)/n.XTsiz),a=Math.ceil((n.Ysiz-n.YTOsiz)/n.YTsiz),s=0;s<a;s++)for(var l=0;l<o;l++)(i={}).tx0=Math.max(n.XTOsiz+l*n.XTsiz,n.XOsiz),i.ty0=Math.max(n.YTOsiz+s*n.YTsiz,n.YOsiz),i.tx1=Math.min(n.XTOsiz+(l+1)*n.XTsiz,n.Xsiz),i.ty1=Math.min(n.YTOsiz+(s+1)*n.YTsiz,n.Ysiz),i.width=i.tx1-i.tx0,i.height=i.ty1-i.ty0,i.components=[],r.push(i);t.tiles=r;for(var c=0,h=n.Csiz;c<h;c++)for(var u=e[c],d=0,f=r.length;d<f;d++){var p={};i=r[d],p.tcx0=Math.ceil(i.tx0/u.XRsiz),p.tcy0=Math.ceil(i.ty0/u.YRsiz),p.tcx1=Math.ceil(i.tx1/u.XRsiz),p.tcy1=Math.ceil(i.ty1/u.YRsiz),p.width=p.tcx1-p.tcx0,p.height=p.tcy1-p.tcy0,i.components[c]=p}}function o(t,e,i){var n=e.codingStyleParameters,r={};return n.entropyCoderWithCustomPrecincts?(r.PPx=n.precinctsSizes[i].PPx,r.PPy=n.precinctsSizes[i].PPy):(r.PPx=15,r.PPy=15),r.xcb_=i>0?Math.min(n.xcb,r.PPx-1):Math.min(n.xcb,r.PPx),r.ycb_=i>0?Math.min(n.ycb,r.PPy-1):Math.min(n.ycb,r.PPy),r}function l(t,e,i){var n=1<<i.PPx,r=1<<i.PPy,o=0===e.resLevel,a=1<<i.PPx+(o?0:-1),s=1<<i.PPy+(o?0:-1),l=e.trx1>e.trx0?Math.ceil(e.trx1/n)-Math.floor(e.trx0/n):0,c=e.try1>e.try0?Math.ceil(e.try1/r)-Math.floor(e.try0/r):0,h=l*c;e.precinctParameters={precinctWidth:n,precinctHeight:r,numprecinctswide:l,numprecinctshigh:c,numprecincts:h,precinctWidthInSubband:a,precinctHeightInSubband:s}}function c(t,e,i){var n,r,o,a,s=i.xcb_,l=i.ycb_,c=1<<s,h=1<<l,u=e.tbx0>>s,d=e.tby0>>l,f=e.tbx1+c-1>>s,p=e.tby1+h-1>>l,m=e.resolution.precinctParameters,_=[],g=[];for(r=d;r<p;r++)for(n=u;n<f;n++){if((o={cbx:n,cby:r,tbx0:c*n,tby0:h*r,tbx1:c*(n+1),tby1:h*(r+1)}).tbx0_=Math.max(e.tbx0,o.tbx0),o.tby0_=Math.max(e.tby0,o.tby0),o.tbx1_=Math.min(e.tbx1,o.tbx1),o.tby1_=Math.min(e.tby1,o.tby1),a=Math.floor((o.tbx0_-e.tbx0)/m.precinctWidthInSubband)+Math.floor((o.tby0_-e.tby0)/m.precinctHeightInSubband)*m.numprecinctswide,o.precinctNumber=a,o.subbandType=e.type,o.Lblock=3,!(o.tbx1_<=o.tbx0_||o.tby1_<=o.tby0_)){_.push(o);var y=g[a];void 0!==y?(n<y.cbxMin?y.cbxMin=n:n>y.cbxMax&&(y.cbxMax=n),r<y.cbyMin?y.cbxMin=r:r>y.cbyMax&&(y.cbyMax=r)):g[a]=y={cbxMin:n,cbyMin:r,cbxMax:n,cbyMax:r},o.precinct=y}}e.codeblockParameters={codeblockWidth:s,codeblockHeight:l,numcodeblockwide:f-u+1,numcodeblockhigh:p-d+1},e.codeblocks=_,e.precincts=g}function h(t,e,i){for(var n=[],r=t.subbands,o=0,a=r.length;o<a;o++)for(var s=r[o].codeblocks,l=0,c=s.length;l<c;l++){var h=s[l];h.precinctNumber===e&&n.push(h)}return{layerNumber:i,codeblocks:n}}function u(t,e,i,n,r){var o=t*n.minWidth,a=e*n.minHeight;if(o%i.width!=0||a%i.height!=0)return null;var s=a/i.width*r.precinctParameters.numprecinctswide;return o/i.height+s}function d(t){for(var e=t.components.length,i=Number.MAX_VALUE,n=Number.MAX_VALUE,r=0,o=0,a=new Array(e),s=0;s<e;s++){for(var l=t.components[s],c=l.codingStyleParameters.decompositionLevelsCount,h=new Array(c+1),u=Number.MAX_VALUE,d=Number.MAX_VALUE,f=0,p=0,m=1,_=c;_>=0;--_){var g=l.resolutions[_],y=m*g.precinctParameters.precinctWidth,b=m*g.precinctParameters.precinctHeight;u=Math.min(u,y),d=Math.min(d,b),f=Math.max(f,g.precinctParameters.numprecinctswide),p=Math.max(p,g.precinctParameters.numprecinctshigh),h[_]={width:y,height:b},m<<=1}i=Math.min(i,u),n=Math.min(n,d),r=Math.max(r,f),o=Math.max(o,p),a[s]={resolutions:h,minWidth:u,minHeight:d,maxNumWide:f,maxNumHigh:p}}return{components:a,minWidth:i,minHeight:n,maxNumWide:r,maxNumHigh:o}}function f(t){for(var e=t.SIZ,i=t.currentTile.index,n=t.tiles[i],r=e.Csiz,a=0;a<r;a++){for(var s=n.components[a],f=s.codingStyleParameters.decompositionLevelsCount,p=[],m=[],_=0;_<=f;_++){var g,y=o(0,s,_),b={},v=1<<f-_;if(b.trx0=Math.ceil(s.tcx0/v),b.try0=Math.ceil(s.tcy0/v),b.trx1=Math.ceil(s.tcx1/v),b.try1=Math.ceil(s.tcy1/v),b.resLevel=_,l(0,b,y),p.push(b),0===_)(g={}).type="LL",g.tbx0=Math.ceil(s.tcx0/v),g.tby0=Math.ceil(s.tcy0/v),g.tbx1=Math.ceil(s.tcx1/v),g.tby1=Math.ceil(s.tcy1/v),g.resolution=b,c(0,g,y),m.push(g),b.subbands=[g];else{var w=1<<f-_+1,x=[];(g={}).type="HL",g.tbx0=Math.ceil(s.tcx0/w-.5),g.tby0=Math.ceil(s.tcy0/w),g.tbx1=Math.ceil(s.tcx1/w-.5),g.tby1=Math.ceil(s.tcy1/w),g.resolution=b,c(0,g,y),m.push(g),x.push(g),(g={}).type="LH",g.tbx0=Math.ceil(s.tcx0/w),g.tby0=Math.ceil(s.tcy0/w-.5),g.tbx1=Math.ceil(s.tcx1/w),g.tby1=Math.ceil(s.tcy1/w-.5),g.resolution=b,c(0,g,y),m.push(g),x.push(g),(g={}).type="HH",g.tbx0=Math.ceil(s.tcx0/w-.5),g.tby0=Math.ceil(s.tcy0/w-.5),g.tbx1=Math.ceil(s.tcx1/w-.5),g.tby1=Math.ceil(s.tcy1/w-.5),g.resolution=b,c(0,g,y),m.push(g),x.push(g),b.subbands=x}}s.resolutions=p,s.subbands=m}var A=n.codingStyleDefaultParameters.progressionOrder;switch(A){case 0:n.packetsIterator=new function(t){for(var e=t.SIZ,i=t.currentTile.index,n=t.tiles[i],r=n.codingStyleDefaultParameters.layersCount,o=e.Csiz,a=0,s=0;s<o;s++)a=Math.max(a,n.components[s].codingStyleParameters.decompositionLevelsCount);var l=0,c=0,u=0,d=0;this.nextPacket=function(){for(;l<r;l++){for(;c<=a;c++){for(;u<o;u++){var t=n.components[u];if(!(c>t.codingStyleParameters.decompositionLevelsCount)){for(var e=t.resolutions[c],i=e.precinctParameters.numprecincts;d<i;){var s=h(e,d,l);return d++,s}d=0}}u=0}c=0}}}(t);break;case 1:n.packetsIterator=new function(t){for(var e=t.SIZ,i=t.currentTile.index,n=t.tiles[i],r=n.codingStyleDefaultParameters.layersCount,o=e.Csiz,a=0,s=0;s<o;s++)a=Math.max(a,n.components[s].codingStyleParameters.decompositionLevelsCount);var l=0,c=0,u=0,d=0;this.nextPacket=function(){for(;l<=a;l++){for(;c<r;c++){for(;u<o;u++){var t=n.components[u];if(!(l>t.codingStyleParameters.decompositionLevelsCount)){for(var e=t.resolutions[l],i=e.precinctParameters.numprecincts;d<i;){var s=h(e,d,c);return d++,s}d=0}}u=0}c=0}}}(t);break;case 2:n.packetsIterator=new function(t){var e,i,n,r,o=t.SIZ,a=t.currentTile.index,s=t.tiles[a],l=s.codingStyleDefaultParameters.layersCount,c=o.Csiz,u=0;for(n=0;n<c;n++){var d=s.components[n];u=Math.max(u,d.codingStyleParameters.decompositionLevelsCount)}var f=new Int32Array(u+1);for(i=0;i<=u;++i){var p=0;for(n=0;n<c;++n){var m=s.components[n].resolutions;i<m.length&&(p=Math.max(p,m[i].precinctParameters.numprecincts))}f[i]=p}e=0,i=0,n=0,r=0,this.nextPacket=function(){for(;i<=u;i++){for(;r<f[i];r++){for(;n<c;n++){var t=s.components[n];if(!(i>t.codingStyleParameters.decompositionLevelsCount)){var o=t.resolutions[i],a=o.precinctParameters.numprecincts;if(!(r>=a)){for(;e<l;){var d=h(o,r,e);return e++,d}e=0}}}n=0}r=0}}}(t);break;case 3:n.packetsIterator=new function(t){var e=t.SIZ,i=t.currentTile.index,n=t.tiles[i],r=n.codingStyleDefaultParameters.layersCount,o=e.Csiz,a=d(n),s=a,l=0,c=0,f=0,p=0,m=0;this.nextPacket=function(){for(;m<s.maxNumHigh;m++){for(;p<s.maxNumWide;p++){for(;f<o;f++){for(var t=n.components[f],e=t.codingStyleParameters.decompositionLevelsCount;c<=e;c++){var i=t.resolutions[c],d=a.components[f].resolutions[c],_=u(p,m,d,s,i);if(null!==_){for(;l<r;){var g=h(i,_,l);return l++,g}l=0}}c=0}f=0}p=0}}}(t);break;case 4:n.packetsIterator=new function(t){var e=t.SIZ,i=t.currentTile.index,n=t.tiles[i],r=n.codingStyleDefaultParameters.layersCount,o=e.Csiz,a=d(n),s=0,l=0,c=0,f=0,p=0;this.nextPacket=function(){for(;c<o;++c){for(var t=n.components[c],e=a.components[c],i=t.codingStyleParameters.decompositionLevelsCount;p<e.maxNumHigh;p++){for(;f<e.maxNumWide;f++){for(;l<=i;l++){var d=t.resolutions[l],m=e.resolutions[l],_=u(f,p,m,e,d);if(null!==_){for(;s<r;){var g=h(d,_,s);return s++,g}s=0}}l=0}f=0}p=0}}}(t);break;default:throw new Error("JPX Error: Unsupported progression order "+A)}}function g(t,e,i,n){var r,o=0,a=0,s=!1;function l(t){for(;a<t;){if(i+o>=e.length)throw new Error("Unexpected EOF");var n=e[i+o];o++,s?(r=r<<7|n,a+=7,s=!1):(r=r<<8|n,a+=8),255===n&&(s=!0)}return r>>>(a-=t)&(1<<t)-1}function c(t){return 255===e[i+o-1]&&e[i+o]===t?(h(1),!0):255===e[i+o]&&e[i+o+1]===t&&(h(2),!0)}function h(t){o+=t}function u(){a=0,s&&(o++,s=!1)}function d(){if(0===l(1))return 1;if(0===l(1))return 2;var t=l(2);return t<3?t+3:(t=l(5))<31?t+6:(t=l(7))+37}for(var f=t.currentTile.index,m=t.tiles[f],_=t.COD.sopMarkerUsed,g=t.COD.ephMarkerUsed,y=m.packetsIterator;o<n;)try{u(),_&&c(145)&&h(4);var b=y.nextPacket();if(void 0===b)return;if(!l(1))continue;for(var v,A=b.layerNumber,S=[],M=0,E=b.codeblocks.length;M<E;M++){var T=(v=b.codeblocks[M]).precinct,k=v.cbx-T.cbxMin,C=v.cby-T.cbyMin,I=!1,P=!1;if(void 0!==v.included)I=!!l(1);else{var R,B;if(void 0!==(T=v.precinct).inclusionTree)R=T.inclusionTree;else{var L=T.cbxMax-T.cbxMin+1,D=T.cbyMax-T.cbyMin+1;R=new x(L,D),B=new w(L,D),T.inclusionTree=R,T.zeroBitPlanesTree=B}for(R.reset(k,C,A);;){if(o>=e.length)return;if(R.isAboveThreshold())break;if(R.isKnown())R.nextLevel();else if(l(1)){if(R.setKnown(),R.isLeaf()){v.included=!0,I=P=!0;break}R.nextLevel()}else R.incrementValue()}}if(I){if(P){for((B=T.zeroBitPlanesTree).reset(k,C);;){if(o>=e.length)return;if(l(1)){if(!B.nextLevel())break}else B.incrementValue()}v.zeroBitPlanes=B.value}for(var O=d();l(1);)v.Lblock++;var F=p(O),G=l((O<1<<F?F-1:F)+v.Lblock);S.push({codeblock:v,codingpasses:O,dataLength:G})}}for(u(),g&&c(146);S.length>0;){var N=S.shift();void 0===(v=N.codeblock).data&&(v.data=[]),v.data.push({data:e,start:i+o,end:i+o+N.dataLength,codingpasses:N.codingpasses}),o+=N.dataLength}}catch(t){return}return o}function y(t,e,i,n,o,a,s,l){for(var c=n.tbx0,h=n.tby0,u=n.tbx1-n.tbx0,d=n.codeblocks,f="H"===n.type.charAt(0)?1:0,p="H"===n.type.charAt(1)?e:0,m=0,_=d.length;m<_;++m){var g=d[m],y=g.tbx1_-g.tbx0_,b=g.tby1_-g.tby0_;if(0!==y&&0!==b&&void 0!==g.data){var v,w;v=new A(y,b,g.subbandType,g.zeroBitPlanes,a),w=2;var x,S,M,E=g.data,T=0,k=0;for(x=0,S=E.length;x<S;x++)T+=(M=E[x]).end-M.start,k+=M.codingpasses;var C=new Int16Array(T),I=0;for(x=0,S=E.length;x<S;x++){var P=(M=E[x]).data.subarray(M.start,M.end);C.set(P,I),I+=P.length}var R=new r(C,0,T);for(v.setDecoder(R),x=0;x<k;x++){switch(w){case 0:v.runSignificancePropogationPass();break;case 1:v.runMagnitudeRefinementPass();break;case 2:v.runCleanupPass(),l&&v.checkSegmentationSymbol()}w=(w+1)%3}var B,L,D,O=g.tbx0_-c+(g.tby0_-h)*u,F=v.coefficentsSign,G=v.coefficentsMagnitude,N=v.bitsDecoded,z=s?0:.5;I=0;var U="LL"!==n.type;for(x=0;x<b;x++){var H=2*(O/u|0)*(e-u)+f+p;for(B=0;B<y;B++){if(0!==(L=G[I])){L=(L+z)*o,0!==F[I]&&(L=-L),D=N[I];var V=U?H+(O<<1):O;t[V]=s&&D>=a?L:L*(1<<a-D)}O++,I++}O+=u-y}}}}function b(e,i,n){for(var r=i.components[n],o=r.codingStyleParameters,a=r.quantizationParameters,s=o.decompositionLevelsCount,l=a.SPqcds,c=a.scalarExpounded,h=a.guardBits,u=o.segmentationSymbolUsed,d=e.components[n].precision,f=o.reversibleTransformation,p=f?new E:new M,m=[],_=0,g=0;g<=s;g++){for(var b=r.resolutions[g],v=b.trx1-b.trx0,w=b.try1-b.try0,x=new Float32Array(v*w),A=0,S=b.subbands.length;A<S;A++){var T,k;c?(T=l[_].mu,k=l[_].epsilon,_++):(T=l[0].mu,k=l[0].epsilon+(g>0?1-g:0));var C=b.subbands[A],I=t[C.type];y(x,v,0,C,f?1:Math.pow(2,d+I-k)*(1+T/2048),h+k-1,f,u)}m.push({width:v,height:w,items:x})}var P=p.calculate(m,r.tcx0,r.tcy0);return{left:r.tcx0,top:r.tcy0,width:P.width,height:P.height,items:P.items}}function v(t,e){for(var i=t.SIZ.Csiz,n=t.tiles[e],r=0;r<i;r++){var o=n.components[r],a=void 0!==t.currentTile.QCC[r]?t.currentTile.QCC[r]:t.currentTile.QCD;o.quantizationParameters=a;var s=void 0!==t.currentTile.COC[r]?t.currentTile.COC[r]:t.currentTile.COD;o.codingStyleParameters=s}n.codingStyleDefaultParameters=t.currentTile.COD}e.prototype={parse:function(t){if(65359!==m(t,0))for(var e=0,i=t.length;e<i;){var n=8,r=_(t,e),o=_(t,e+4);if(e+=n,1===r&&(r=4294967296*_(t,e)+_(t,e+4),e+=8,n+=8),0===r&&(r=i-e+n),r<n)throw new Error("JPX Error: Invalid box field size");var l=r-n,c=!0;switch(o){case 1785737832:c=!1;break;case 1668246642:var h=t[e];t[e+1],t[e+2];if(1===h){var u=_(t,e+3);switch(u){case 16:case 17:case 18:break;default:s("Unknown colorspace "+u)}}else 2===h&&a("ICC profile not supported");break;case 1785737827:this.parseCodestream(t,e,e+l);break;case 1783636e3:218793738!==_(t,e)&&s("Invalid JP2 signature");break;case 1783634458:case 1718909296:case 1920099697:case 1919251232:case 1768449138:break;default:s("Unsupported header type "+o+" ("+String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o)+")")}c&&(e+=l)}else this.parseCodestream(t,0,t.length)},parseImageProperties:function(t){for(var e=t.getByte();e>=0;){if(65361===(e<<8|(e=t.getByte()))){t.skip(4);var i=t.getInt32()>>>0,n=t.getInt32()>>>0,r=t.getInt32()>>>0,o=t.getInt32()>>>0;t.skip(16);var a=t.getUint16();return this.width=i-r,this.height=n-o,this.componentsCount=a,void(this.bitsPerComponent=8)}}throw new Error("JPX Error: No size marker found in JPX stream")},parseCodestream:function(t,e,r){var o={};try{for(var a=!1,l=e;l+1<r;){var c=m(t,l);l+=2;var h,u,d,p,y,w,x=0;switch(c){case 65359:o.mainHeader=!0;break;case 65497:break;case 65361:x=m(t,l);var A={};A.Xsiz=_(t,l+4),A.Ysiz=_(t,l+8),A.XOsiz=_(t,l+12),A.YOsiz=_(t,l+16),A.XTsiz=_(t,l+20),A.YTsiz=_(t,l+24),A.XTOsiz=_(t,l+28),A.YTOsiz=_(t,l+32);var S=m(t,l+36);A.Csiz=S;var M=[];h=l+38;for(var E=0;E<S;E++){var T={precision:1+(127&t[h]),isSigned:!!(128&t[h]),XRsiz:t[h+1],YRsiz:t[h+1]};i(T,A),M.push(T)}o.SIZ=A,o.components=M,n(o,M),o.QCC=[],o.COC=[];break;case 65372:x=m(t,l);var k={};switch(h=l+2,31&(u=t[h++])){case 0:p=8,y=!0;break;case 1:p=16,y=!1;break;case 2:p=16,y=!0;break;default:throw new Error("JPX Error: Invalid SQcd value "+u)}for(k.noQuantization=8===p,k.scalarExpounded=y,k.guardBits=u>>5,d=[];h<x+l;){var C={};8===p?(C.epsilon=t[h++]>>3,C.mu=0):(C.epsilon=t[h]>>3,C.mu=(7&t[h])<<8|t[h+1],h+=2),d.push(C)}k.SPqcds=d,o.mainHeader?o.QCD=k:(o.currentTile.QCD=k,o.currentTile.QCC=[]);break;case 65373:x=m(t,l);var I,P={};switch(h=l+2,o.SIZ.Csiz<257?I=t[h++]:(I=m(t,h),h+=2),31&(u=t[h++])){case 0:p=8,y=!0;break;case 1:p=16,y=!1;break;case 2:p=16,y=!0;break;default:throw new Error("JPX Error: Invalid SQcd value "+u)}for(P.noQuantization=8===p,P.scalarExpounded=y,P.guardBits=u>>5,d=[];h<x+l;)C={},8===p?(C.epsilon=t[h++]>>3,C.mu=0):(C.epsilon=t[h]>>3,C.mu=(7&t[h])<<8|t[h+1],h+=2),d.push(C);P.SPqcds=d,o.mainHeader?o.QCC[I]=P:o.currentTile.QCC[I]=P;break;case 65362:x=m(t,l);var R={};h=l+2;var B=t[h++];R.entropyCoderWithCustomPrecincts=!!(1&B),R.sopMarkerUsed=!!(2&B),R.ephMarkerUsed=!!(4&B),R.progressionOrder=t[h++],R.layersCount=m(t,h),h+=2,R.multipleComponentTransform=t[h++],R.decompositionLevelsCount=t[h++],R.xcb=2+(15&t[h++]),R.ycb=2+(15&t[h++]);var L=t[h++];if(R.selectiveArithmeticCodingBypass=!!(1&L),R.resetContextProbabilities=!!(2&L),R.terminationOnEachCodingPass=!!(4&L),R.verticalyStripe=!!(8&L),R.predictableTermination=!!(16&L),R.segmentationSymbolUsed=!!(32&L),R.reversibleTransformation=t[h++],R.entropyCoderWithCustomPrecincts){for(var D=[];h<x+l;){var O=t[h++];D.push({PPx:15&O,PPy:O>>4})}R.precinctsSizes=D}var F=[];if(R.selectiveArithmeticCodingBypass&&F.push("selectiveArithmeticCodingBypass"),R.resetContextProbabilities&&F.push("resetContextProbabilities"),R.terminationOnEachCodingPass&&F.push("terminationOnEachCodingPass"),R.verticalyStripe&&F.push("verticalyStripe"),R.predictableTermination&&F.push("predictableTermination"),F.length>0)throw a=!0,new Error("JPX Error: Unsupported COD options ("+F.join(", ")+")");o.mainHeader?o.COD=R:(o.currentTile.COD=R,o.currentTile.COC=[]);break;case 65424:x=m(t,l),(w={}).index=m(t,l+2),w.length=_(t,l+4),w.dataEnd=w.length+l-2,w.partIndex=t[l+8],w.partsCount=t[l+9],o.mainHeader=!1,0===w.partIndex&&(w.COD=o.COD,w.COC=o.COC.slice(0),w.QCD=o.QCD,w.QCC=o.QCC.slice(0)),o.currentTile=w;break;case 65427:0===(w=o.currentTile).partIndex&&(v(o,w.index),f(o)),g(o,t,l,x=w.dataEnd-l);break;case 65365:case 65367:case 65368:case 65380:x=m(t,l);break;case 65363:throw new Error("JPX Error: Codestream code 0xFF53 (COC) is not implemented");default:throw new Error("JPX Error: Unknown codestream code: "+c.toString(16))}l+=x}}catch(t){if(a||this.failOnCorruptedImage)throw t;s("Trying to recover from "+t.message)}this.tiles=function(t){for(var e=t.SIZ,i=t.components,n=e.Csiz,r=[],o=0,a=t.tiles.length;o<a;o++){var s,l=t.tiles[o],c=[];for(s=0;s<n;s++)c[s]=b(t,l,s);var h=c[0],u=i[0].isSigned;if(u)var d=new Int16Array(h.items.length*n);else var d=new Uint16Array(h.items.length*n);var f,p,m,_,g,y,v,w,x,A,S,M,E,T,k,C={left:h.left,top:h.top,width:h.width,height:h.height,items:d},I=0;if(l.codingStyleDefaultParameters.multipleComponentTransform){var P=4===n,R=c[0].items,B=c[1].items,L=c[2].items,D=P?c[3].items:null;f=i[0].precision-8,p=.5+(128<<f),_=-(g=.5*(m=255*(1<<f)));var O=l.components[0],F=n-3;if(v=R.length,O.codingStyleParameters.reversibleTransformation)for(y=0;y<v;y++,I+=F)w=R[y]+p,x=B[y],A=L[y],S=(M=w-(A+x>>2))+A,E=M+x,d[I++]=S<=0?0:S>=m?255:S>>f,d[I++]=M<=0?0:M>=m?255:M>>f,d[I++]=E<=0?0:E>=m?255:E>>f;else for(y=0;y<v;y++,I+=F)w=R[y]+p,x=B[y],A=L[y],S=w+1.402*A,M=w-.34413*x-.71414*A,E=w+1.772*x,d[I++]=S<=0?0:S>=m?255:S>>f,d[I++]=M<=0?0:M>=m?255:M>>f,d[I++]=E<=0?0:E>=m?255:E>>f;if(P)for(y=0,I=3;y<v;y++,I+=4)T=D[y],d[I]=T<=_?0:T>=g?255:T+p>>f}else for(s=0;s<n;s++)if(8===i[s].precision){var G=c[s].items;for(f=i[s].precision-8,p=.5+(128<<f),_=-(m=127.5*(1<<f)),I=s,y=0,v=G.length;y<v;y++)k=G[y],d[I]=k<=_?0:k>=m?255:k+p>>f,I+=n}else{var u=i[s].isSigned,G=c[s].items;if(u)for(I=s,y=0,v=G.length;y<v;y++)d[I]=G[y],I+=n;else{f=i[s].precision-8,p=.5+(128<<f);var N=Math.pow(2,i[s].precision)-1;for(I=s,y=0,v=G.length;y<v;y++)k=G[y],d[I]=Math.max(Math.min(k+p,N),0),I+=n}}r.push(C)}return r}(o),this.width=o.SIZ.Xsiz-o.SIZ.XOsiz,this.height=o.SIZ.Ysiz-o.SIZ.YOsiz,this.componentsCount=o.SIZ.Csiz}};var w=function(){function t(t,e){var i=p(Math.max(t,e))+1;this.levels=[];for(var n=0;n<i;n++){var r={width:t,height:e,items:[]};this.levels.push(r),t=Math.ceil(t/2),e=Math.ceil(e/2)}}return t.prototype={reset:function(t,e){for(var i,n=0,r=0;n<this.levels.length;){var o=t+e*(i=this.levels[n]).width;if(void 0!==i.items[o]){r=i.items[o];break}i.index=o,t>>=1,e>>=1,n++}n--,(i=this.levels[n]).items[i.index]=r,this.currentLevel=n,delete this.value},incrementValue:function(){var t=this.levels[this.currentLevel];t.items[t.index]++},nextLevel:function(){var t=this.currentLevel,e=this.levels[t],i=e.items[e.index];return--t<0?(this.value=i,!1):(this.currentLevel=t,(e=this.levels[t]).items[e.index]=i,!0)}},t}(),x=function(){function t(t,e){var i=p(Math.max(t,e))+1;this.levels=[];for(var n=0;n<i;n++){for(var r=new Uint8Array(t*e),o=new Uint8Array(t*e),a=0,s=r.length;a<s;a++)r[a]=0,o[a]=0;var l={width:t,height:e,items:r,status:o};this.levels.push(l),t=Math.ceil(t/2),e=Math.ceil(e/2)}}return t.prototype={reset:function(t,e,i){this.currentStopValue=i;for(var n=0;n<this.levels.length;){var r=this.levels[n],o=t+e*r.width;r.index=o,t>>=1,e>>=1,n++}this.currentLevel=this.levels.length-1,this.minValue=this.levels[this.currentLevel].items[0]},incrementValue:function(){var t=this.levels[this.currentLevel];t.items[t.index]=t.items[t.index]+1,t.items[t.index]>this.minValue&&(this.minValue=t.items[t.index])},nextLevel:function(){var t=this.currentLevel;if(--t<0)return!1;this.currentLevel=t;var e=this.levels[t];return e.items[e.index]<this.minValue?e.items[e.index]=this.minValue:e.items[e.index]>this.minValue&&(this.minValue=e.items[e.index]),!0},isLeaf:function(){return 0===this.currentLevel},isAboveThreshold:function(){var t=this.currentLevel,e=this.levels[t];return e.items[e.index]>this.currentStopValue},isKnown:function(){var t=this.currentLevel,e=this.levels[t];return e.status[e.index]>0},setKnown:function(){var t=this.currentLevel,e=this.levels[t];e.status[e.index]=1}},t}(),A=function(){var t=new Uint8Array([0,5,8,0,3,7,8,0,4,7,8,0,0,0,0,0,1,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8]),e=new Uint8Array([0,3,4,0,5,7,7,0,8,8,8,0,0,0,0,0,1,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8]),i=new Uint8Array([0,1,2,0,1,2,2,0,2,2,2,0,0,0,0,0,3,4,5,0,4,5,5,0,5,5,5,0,0,0,0,0,6,7,7,0,7,7,7,0,7,7,7,0,0,0,0,0,8,8,8,0,8,8,8,0,8,8,8,0,0,0,0,0,8,8,8,0,8,8,8,0,8,8,8]);function n(n,r,o,a,s){this.width=n,this.height=r,this.contextLabelTable="HH"===o?i:"HL"===o?e:t;var l=n*r;this.neighborsSignificance=new Uint8Array(l),this.coefficentsSign=new Uint8Array(l),this.coefficentsMagnitude=s>14?new Uint32Array(l):s>6?new Uint16Array(l):new Uint8Array(l),this.processingFlags=new Uint8Array(l);var c=new Uint8Array(l);if(0!==a)for(var h=0;h<l;h++)c[h]=a;this.bitsDecoded=c,this.reset()}return n.prototype={setDecoder:function(t){this.decoder=t},reset:function(){this.contexts=new Int8Array(19),this.contexts[0]=8,this.contexts[17]=92,this.contexts[18]=6},setNeighborsSignificance:function(t,e,i){var n,r=this.neighborsSignificance,o=this.width,a=this.height,s=e>0,l=e+1<o;t>0&&(n=i-o,s&&(r[n-1]+=16),l&&(r[n+1]+=16),r[n]+=4),t+1<a&&(n=i+o,s&&(r[n-1]+=16),l&&(r[n+1]+=16),r[n]+=4),s&&(r[i-1]+=1),l&&(r[i+1]+=1),r[i]|=128},runSignificancePropogationPass:function(){for(var t=this.decoder,e=this.width,i=this.height,n=this.coefficentsMagnitude,r=this.coefficentsSign,o=this.neighborsSignificance,a=this.processingFlags,s=this.contexts,l=this.contextLabelTable,c=this.bitsDecoded,h=0;h<i;h+=4)for(var u=0;u<e;u++)for(var d=h*e+u,f=0;f<4;f++,d+=e){var p=h+f;if(p>=i)break;if(a[d]&=-2,!n[d]&&o[d]){var m=l[o[d]];if(t.readBit(s,m)){var _=this.decodeSignBit(p,u,d);r[d]=_,n[d]=1,this.setNeighborsSignificance(p,u,d),a[d]|=2}c[d]++,a[d]|=1}}},decodeSignBit:function(t,e,i){var n,r,o,a,s,l,c=this.width,h=this.height,u=this.coefficentsMagnitude,d=this.coefficentsSign;a=e>0&&0!==u[i-1],e+1<c&&0!==u[i+1]?(o=d[i+1],n=a?1-o-(r=d[i-1]):1-o-o):n=a?1-(r=d[i-1])-r:0;var f=3*n;return a=t>0&&0!==u[i-c],t+1<h&&0!==u[i+c]?(o=d[i+c],n=a?1-o-(r=d[i-c])+f:1-o-o+f):n=a?1-(r=d[i-c])-r+f:f,n>=0?(s=9+n,l=this.decoder.readBit(this.contexts,s)):(s=9-n,l=1^this.decoder.readBit(this.contexts,s)),l},runMagnitudeRefinementPass:function(){for(var t,e=this.decoder,i=this.width,n=this.height,r=this.coefficentsMagnitude,o=this.neighborsSignificance,a=this.contexts,s=this.bitsDecoded,l=this.processingFlags,c=i*n,h=4*i,u=0;u<c;u=t){t=Math.min(c,u+h);for(var d=0;d<i;d++)for(var f=u+d;f<t;f+=i)if(r[f]&&0==(1&l[f])){var p=16;if(0!=(2&l[f]))l[f]^=2,p=0===(127&o[f])?15:14;var m=e.readBit(a,p);r[f]=r[f]<<1|m,s[f]++,l[f]|=1}}},runCleanupPass:function(){for(var t,e=this.decoder,i=this.width,n=this.height,r=this.neighborsSignificance,o=this.coefficentsMagnitude,a=this.coefficentsSign,s=this.contexts,l=this.contextLabelTable,c=this.bitsDecoded,h=this.processingFlags,u=i,d=2*i,f=3*i,p=0;p<n;p=t){t=Math.min(p+4,n);for(var m=p*i,_=p+3<n,g=0;g<i;g++){var y,b=m+g,v=0,w=b,x=p;if(_&&0===h[b]&&0===h[b+u]&&0===h[b+d]&&0===h[b+f]&&0===r[b]&&0===r[b+u]&&0===r[b+d]&&0===r[b+f]){if(!e.readBit(s,18)){c[b]++,c[b+u]++,c[b+d]++,c[b+f]++;continue}0!==(v=e.readBit(s,17)<<1|e.readBit(s,17))&&(x=p+v,w+=v*i),y=this.decodeSignBit(x,g,w),a[w]=y,o[w]=1,this.setNeighborsSignificance(x,g,w),h[w]|=2,w=b;for(var A=p;A<=x;A++,w+=i)c[w]++;v++}for(x=p+v;x<t;x++,w+=i)if(!o[w]&&0==(1&h[w])){var S=l[r[w]];1===e.readBit(s,S)&&(y=this.decodeSignBit(x,g,w),a[w]=y,o[w]=1,this.setNeighborsSignificance(x,g,w),h[w]|=2),c[w]++}}}},checkSegmentationSymbol:function(){var t=this.decoder,e=this.contexts;if(10!==(t.readBit(e,17)<<3|t.readBit(e,17)<<2|t.readBit(e,17)<<1|t.readBit(e,17)))throw new Error("JPX Error: Invalid segmentation symbol")}},n}(),S=function(){function t(){}return t.prototype.calculate=function(t,e,i){for(var n=t[0],r=1,o=t.length;r<o;r++)n=this.iterate(n,t[r],e,i);return n},t.prototype.extend=function(t,e,i){var n=e-1,r=e+1,o=e+i-2,a=e+i;t[n--]=t[r++],t[a++]=t[o--],t[n--]=t[r++],t[a++]=t[o--],t[n--]=t[r++],t[a++]=t[o--],t[n]=t[r],t[a]=t[o]},t.prototype.iterate=function(t,e,i,n){var r,o,a,s,l,c,h=t.width,u=t.height,d=t.items,f=e.width,p=e.height,m=e.items;for(a=0,r=0;r<u;r++)for(s=2*r*f,o=0;o<h;o++,a++,s+=2)m[s]=d[a];d=t.items=null;var _=new Float32Array(f+8);if(1===f){if(0!=(1&i))for(c=0,a=0;c<p;c++,a+=f)m[a]*=.5}else for(c=0,a=0;c<p;c++,a+=f)_.set(m.subarray(a,a+f),4),this.extend(_,4,f),this.filter(_,4,f),m.set(_.subarray(4,4+f),a);var g=16,y=[];for(r=0;r<g;r++)y.push(new Float32Array(p+8));var b,v=0;if(t=4+p,1===p){if(0!=(1&n))for(l=0;l<f;l++)m[l]*=.5}else for(l=0;l<f;l++){if(0===v){for(g=Math.min(f-l,g),a=l,s=4;s<t;a+=f,s++)for(b=0;b<g;b++)y[b][s]=m[a+b];v=g}var w=y[--v];if(this.extend(w,4,p),this.filter(w,4,p),0===v)for(a=l-g+1,s=4;s<t;a+=f,s++)for(b=0;b<g;b++)m[a+b]=y[b][s]}return{width:f,height:p,items:m}},t}(),M=function(){function t(){S.call(this)}return t.prototype=Object.create(S.prototype),t.prototype.filter=function(t,e,i){var n,r,o,a,s=i>>1,l=-1.586134342059924,c=-.052980118572961,h=.882911075530934,u=.443506852043971,d=1.230174104914001;for(n=(e|=0)-3,r=s+4;r--;n+=2)t[n]*=.8128930661159609;for(o=u*t[(n=e-2)-1],r=s+3;r--&&(a=u*t[n+1],t[n]=d*t[n]-o-a,r--);n+=2)o=u*t[(n+=2)+1],t[n]=d*t[n]-o-a;for(o=h*t[(n=e-1)-1],r=s+2;r--&&(a=h*t[n+1],t[n]-=o+a,r--);n+=2)o=h*t[(n+=2)+1],t[n]-=o+a;for(o=c*t[(n=e)-1],r=s+1;r--&&(a=c*t[n+1],t[n]-=o+a,r--);n+=2)o=c*t[(n+=2)+1],t[n]-=o+a;if(0!==s)for(o=l*t[(n=e+1)-1],r=s;r--&&(a=l*t[n+1],t[n]-=o+a,r--);n+=2)o=l*t[(n+=2)+1],t[n]-=o+a},t}(),E=function(){function t(){S.call(this)}return t.prototype=Object.create(S.prototype),t.prototype.filter=function(t,e,i){var n,r,o=i>>1;for(n=e|=0,r=o+1;r--;n+=2)t[n]-=t[n-1]+t[n+1]+2>>2;for(n=e+1,r=o;r--;n+=2)t[n]+=t[n-1]+t[n+1]>>1},t}();return e}(),r=function(){var t=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];function e(t,e,i){this.data=t,this.bp=e,this.dataEnd=i,this.chigh=t[e],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}return e.prototype={byteIn:function(){var t=this.data,e=this.bp;255===t[e]?t[e+1]>143?(this.clow+=65280,this.ct=8):(e++,this.clow+=t[e]<<9,this.ct=7,this.bp=e):(e++,this.clow+=e<this.dataEnd?t[e]<<8:65280,this.ct=8,this.bp=e);this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)},readBit:function(e,i){var n,r=e[i]>>1,o=1&e[i],a=t[r],s=a.qe,l=this.a-s;if(this.chigh<s)l<s?(l=s,n=o,r=a.nmps):(l=s,n=1^o,1===a.switchFlag&&(o=n),r=a.nlps);else{if(this.chigh-=s,0!=(32768&l))return this.a=l,o;l<s?(n=1^o,1===a.switchFlag&&(o=n),r=a.nlps):(n=o,r=a.nmps)}do{0===this.ct&&this.byteIn(),l<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--}while(0==(32768&l));return this.a=l,e[i]=r<<1|o,n}},e}(),o="undefined"==typeof window?this:window;o.PDFJS||(o.PDFJS={}),o.PDFJS.pdfBug=!1,PDFJS.VERBOSITY_LEVELS={errors:0,warnings:1,infos:5};PDFJS.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};function a(t){PDFJS.verbosity>=PDFJS.VERBOSITY_LEVELS.infos&&console.log("Info: "+t)}function s(t){PDFJS.verbosity>=PDFJS.VERBOSITY_LEVELS.warnings&&console.log("Warning: "+t)}PDFJS.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},PDFJS.UnsupportedManager=function(){var t=[];return{listen:function(e){t.push(e)},notify:function(e){s('Unsupported feature "'+e+'"');for(var i=0,n=t.length;i<n;i++)t[i](e)}}}();function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!1}),i}PDFJS.isValidUrl=function(t,e){if(!t)return!1;var i=/^[a-z][a-z0-9+\-.]*(?=:)/i.exec(t);if(!i)return e;switch(i=i[0].toLowerCase()){case"http":case"https":case"ftp":case"mailto":case"tel":return!0;default:return!1}},PDFJS.shadow=l;PDFJS.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var c=function(){function t(t,e){this.name="PasswordException",this.message=t,this.code=e}return t.prototype=new Error,t.constructor=t,t}();PDFJS.PasswordException=c;var h=function(){function t(t,e){this.name="UnknownErrorException",this.message=t,this.details=e}return t.prototype=new Error,t.constructor=t,t}();PDFJS.UnknownErrorException=h;var u=function(){function t(t){this.name="InvalidPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}();PDFJS.InvalidPDFException=u;var d=function(){function t(t){this.name="MissingPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}();PDFJS.MissingPDFException=d;var f=function(){function t(t,e){this.name="UnexpectedResponseException",this.message=t,this.status=e}return t.prototype=new Error,t.constructor=t,t}();PDFJS.UnexpectedResponseException=f;(function(){function t(t){this.message=t}t.prototype=new Error,t.prototype.name="NotImplementedException",t.constructor=t})(),function(){function t(t,e){this.begin=t,this.end=e,this.message="Missing data ["+t+", "+e+")"}t.prototype=new Error,t.prototype.name="MissingDataException",t.constructor=t}(),function(){function t(t){this.message=t}t.prototype=new Error,t.prototype.name="XRefParseException",t.constructor=t}();function p(t){for(var e=1,i=0;t>e;)e<<=1,i++;return i}function m(t,e){return t[e]<<8|t[e+1]}function _(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}Object.defineProperty(PDFJS,"isLittleEndian",{configurable:!0,get:function(){return l(PDFJS,"isLittleEndian",function(){var t=new Uint8Array(2);return t[0]=1,1===new Uint16Array(t.buffer)[0]}())}}),Object.defineProperty(PDFJS,"hasCanvasTypedArrays",{configurable:!0,get:function(){return l(PDFJS,"hasCanvasTypedArrays",function(){var t=document.createElement("canvas");return t.width=t.height=1,void 0!==t.getContext("2d").createImageData(1,1).data.buffer}())}});!function(){function t(n,r){this.buffer=n,this.byteLength=n.length,this.length=void 0===r?this.byteLength>>2:r,function(n){for(;e<n;)Object.defineProperty(t.prototype,e,i(e)),e++}(this.length)}t.prototype=Object.create(null);var e=0;function i(t){return{get:function(){var e=this.buffer,i=t<<2;return(e[i]|e[i+1]<<8|e[i+2]<<16|e[i+3]<<24)>>>0},set:function(e){var i=this.buffer,n=t<<2;i[n]=255&e,i[n+1]=e>>8&255,i[n+2]=e>>16&255,i[n+3]=e>>>24&255}}}}();var g=PDFJS.Util=function(){function t(){}var e=["rgb(",0,",",0,",",0,")"];return t.makeCssRgb=function(t,i,n){return e[1]=t,e[3]=i,e[5]=n,e.join("")},t.transform=function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},t.applyTransform=function(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]},t.applyInverseTransform=function(t,e){var i=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i]},t.getAxialAlignedBoundingBox=function(e,i){var n=t.applyTransform(e,i),r=t.applyTransform(e.slice(2,4),i),o=t.applyTransform([e[0],e[3]],i),a=t.applyTransform([e[2],e[1]],i);return[Math.min(n[0],r[0],o[0],a[0]),Math.min(n[1],r[1],o[1],a[1]),Math.max(n[0],r[0],o[0],a[0]),Math.max(n[1],r[1],o[1],a[1])]},t.inverseTransform=function(t){var e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]},t.apply3dTransform=function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]},t.singularValueDecompose2dScale=function(t){var e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],a=(i+o)/2,s=Math.sqrt((i+o)*(i+o)-4*(i*o-r*n))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]},t.normalizeRect=function(t){var e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e},t.intersect=function(e,i){function n(t,e){return t-e}var r=[e[0],e[2],i[0],i[2]].sort(n),o=[e[1],e[3],i[1],i[3]].sort(n),a=[];return e=t.normalizeRect(e),i=t.normalizeRect(i),(r[0]===e[0]&&r[1]===i[0]||r[0]===i[0]&&r[1]===e[0])&&(a[0]=r[1],a[2]=r[2],(o[0]===e[1]&&o[1]===i[1]||o[0]===i[1]&&o[1]===e[1])&&(a[1]=o[1],a[3]=o[2],a))},t.sign=function(t){return t<0?-1:1},t.appendToArray=function(t,e){Array.prototype.push.apply(t,e)},t.prependToArray=function(t,e){Array.prototype.unshift.apply(t,e)},t.extendObj=function(t,e){for(var i in e)t[i]=e[i]},t.getInheritableProperty=function(t,e){for(;t&&!t.has(e);)t=t.get("Parent");return t?t.get(e):null},t.inherit=function(t,e,i){for(var n in t.prototype=Object.create(e.prototype),t.prototype.constructor=t,i)t.prototype[n]=i[n]},t.loadScript=function(t,e){var i=document.createElement("script"),n=!1;i.setAttribute("src",t),e&&(i.onload=function(){n||e(),n=!0}),document.getElementsByTagName("head")[0].appendChild(i)},t}();PDFJS.PageViewport=function(){function t(t,e,i,n,r,o){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=n,this.offsetY=r;var a,s,l,c,h,u,d,f,p=(t[2]+t[0])/2,m=(t[3]+t[1])/2;switch(i=(i%=360)<0?i+360:i){case 180:a=-1,s=0,l=0,c=1;break;case 90:a=0,s=1,l=1,c=0;break;case 270:a=0,s=-1,l=-1,c=0;break;default:a=1,s=0,l=0,c=-1}o&&(l=-l,c=-c),0===a?(h=Math.abs(m-t[1])*e+n,u=Math.abs(p-t[0])*e+r,d=Math.abs(t[3]-t[1])*e,f=Math.abs(t[2]-t[0])*e):(h=Math.abs(p-t[0])*e+n,u=Math.abs(m-t[1])*e+r,d=Math.abs(t[2]-t[0])*e,f=Math.abs(t[3]-t[1])*e),this.transform=[a*e,s*e,l*e,c*e,h-a*e*p-l*e*m,u-s*e*p-c*e*m],this.width=d,this.height=f,this.fontScale=e}return t.prototype={clone:function(e){var i="scale"in(e=e||{})?e.scale:this.scale,n="rotation"in e?e.rotation:this.rotation;return new t(this.viewBox.slice(),i,n,this.offsetX,this.offsetY,e.dontFlip)},convertToViewportPoint:function(t,e){return g.applyTransform([t,e],this.transform)},convertToViewportRectangle:function(t){var e=g.applyTransform([t[0],t[1]],this.transform),i=g.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]},convertToPdfPoint:function(t,e){return g.applyInverseTransform([t,e],this.transform)}},t}();function y(){var t={};return t.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),t}PDFJS.createPromiseCapability=y,function(){if(o.Promise)return"function"!=typeof o.Promise.all&&(o.Promise.all=function(t){var e,i,n=0,r=[],a=new o.Promise(function(t,n){e=t,i=n});return t.forEach(function(t,o){n++,t.then(function(t){r[o]=t,0===--n&&e(r)},i)}),0===n&&e(r),a}),"function"!=typeof o.Promise.resolve&&(o.Promise.resolve=function(t){return new o.Promise(function(e){e(t)})}),"function"!=typeof o.Promise.reject&&(o.Promise.reject=function(t){return new o.Promise(function(e,i){i(t)})}),void("function"!=typeof o.Promise.prototype.catch&&(o.Promise.prototype.catch=function(t){return o.Promise.prototype.then(void 0,t)}));var t=0,e=2,i={handlers:[],running:!1,unhandledRejections:[],pendingRejectionCheck:!1,scheduleHandlers:function(e){e._status!==t&&(this.handlers=this.handlers.concat(e._handlers),e._handlers=[],this.running||(this.running=!0,setTimeout(this.runHandlers.bind(this),0)))},runHandlers:function(){for(var t=Date.now()+1;this.handlers.length>0;){var i=this.handlers.shift(),n=i.thisPromise._status,r=i.thisPromise._value;try{1===n?"function"==typeof i.onResolve&&(r=i.onResolve(r)):"function"==typeof i.onReject&&(r=i.onReject(r),n=1,i.thisPromise._unhandledRejection&&this.removeUnhandeledRejection(i.thisPromise))}catch(t){n=e,r=t}if(i.nextPromise._updateStatus(n,r),Date.now()>=t)break}this.handlers.length>0?setTimeout(this.runHandlers.bind(this),0):this.running=!1},addUnhandledRejection:function(t){this.unhandledRejections.push({promise:t,time:Date.now()}),this.scheduleRejectionCheck()},removeUnhandeledRejection:function(t){t._unhandledRejection=!1;for(var e=0;e<this.unhandledRejections.length;e++)this.unhandledRejections[e].promise===t&&(this.unhandledRejections.splice(e),e--)},scheduleRejectionCheck:function(){this.pendingRejectionCheck||(this.pendingRejectionCheck=!0,setTimeout(function(){this.pendingRejectionCheck=!1;for(var t=Date.now(),e=0;e<this.unhandledRejections.length;e++)if(t-this.unhandledRejections[e].time>500){var i=this.unhandledRejections[e].promise._value,n="Unhandled rejection: "+i;i.stack&&(n+="\n"+i.stack),s(n),this.unhandledRejections.splice(e),e--}this.unhandledRejections.length&&this.scheduleRejectionCheck()}.bind(this),500))}};function n(e){this._status=t,this._handlers=[];try{e.call(this,this._resolve.bind(this),this._reject.bind(this))}catch(t){this._reject(t)}}n.all=function(t){var i,r,o=new n(function(t,e){i=t,r=e}),a=t.length,s=[];if(0===a)return i(s),o;function l(t){o._status!==e&&(s=[],r(t))}for(var c=0,h=t.length;c<h;++c){var u=t[c],d=function(t){return function(n){o._status!==e&&(s[t]=n,0===--a&&i(s))}}(c);n.isPromise(u)?u.then(d,l):d(u)}return o},n.isPromise=function(t){return t&&"function"==typeof t.then},n.resolve=function(t){return new n(function(e){e(t)})},n.reject=function(t){return new n(function(e,i){i(t)})},n.prototype={_status:null,_value:null,_handlers:null,_unhandledRejection:null,_updateStatus:function(t,r){1!==this._status&&this._status!==e&&(1===t&&n.isPromise(r)?r.then(this._updateStatus.bind(this,1),this._updateStatus.bind(this,e)):(this._status=t,this._value=r,t===e&&0===this._handlers.length&&(this._unhandledRejection=!0,i.addUnhandledRejection(this)),i.scheduleHandlers(this)))},_resolve:function(t){this._updateStatus(1,t)},_reject:function(t){this._updateStatus(e,t)},then:function(t,e){var r=new n(function(t,e){this.resolve=t,this.reject=e});return this._handlers.push({thisPromise:this,onResolve:t,onReject:e,nextPromise:r}),i.scheduleHandlers(this),r},catch:function(t){return this.then(void 0,t)}},o.Promise=n}();!function(){function t(t,e,i){for(;t.length<i;)t+=e;return t}function e(){this.started={},this.times=[],this.enabled=!0}e.prototype={time:function(t){this.enabled&&(t in this.started&&s("Timer is already running for "+t),this.started[t]=Date.now())},timeEnd:function(t){this.enabled&&(t in this.started||s("Timer has not been started for "+t),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t])},toString:function(){var e,i,n=this.times,r="",o=0;for(e=0,i=n.length;e<i;++e){var a=n[e].name;a.length>o&&(o=a.length)}for(e=0,i=n.length;e<i;++e){var s=n[e],l=s.end-s.start;r+=t(s.name," ",o)+" "+l+"ms\n"}return r}}}();PDFJS.createBlob=function(t,e){if("undefined"!=typeof Blob)return new Blob([t],{type:e});var i=new MozBlobBuilder;return i.append(t),i.getBlob(e)},PDFJS.createObjectURL=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(e,i){if(!PDFJS.disableCreateObjectURL&&"undefined"!=typeof URL&&URL.createObjectURL){var n=PDFJS.createBlob(e,i);return URL.createObjectURL(n)}for(var r="data:"+i+";base64,",o=0,a=e.length;o<a;o+=3){var s=255&e[o],l=255&e[o+1],c=255&e[o+2];r+=t[s>>2]+t[(3&s)<<4|l>>4]+t[o+1<a?(15&l)<<2|c>>6:64]+t[o+2<a?63&c:64]}return r}}(),"undefined"!==typeof t&&t.exports&&(t.exports=n)},function(t,e,i){"use strict";var n=i(160),r=/[ \f\t\v]*\r?\n/,o=/^NRRD\d{4}$/,a=/^([^:]*)(:[ =])(.*)$/,s=/^LIST(?: (\d+))?$/;function l(t){return t.replace("\\","\\\\").replace("\n","\\n")}function c(t){return t.split("\\\\").map(function(t){return t.replace("\\n","\n")}).join("\\")}function h(t,e,i,r){var o,a=function(t){return t in f?f[t]:t}(t);switch(t){case"data":case"buffer":case"keys":case"version":break;case"content":case"number":case"sampleUnits":case"space":o=a+": "+e;break;case"blockSize":case"lineSkip":case"byteSkip":case"dimension":case"spaceDimension":n("number"==typeof e||e instanceof Number,"Field "+t+" should at least contain a number!"),o=a+": "+e;break;case"min":case"max":case"oldMin":case"oldMax":n("number"==typeof e||e instanceof Number,"Field "+t+" should contain a number!"),o=a+": "+e;break;case"spaceOrigin":n(e.length===r,"Field "+t+" should be a list with length equal to the space dimension!"),e.forEach(function(e){n("number"==typeof e||e instanceof Number,"Field "+t+" should be a list of numbers!")}),o=a+": ("+e.join(",")+")";break;case"labels":case"units":case"spaceUnits":n(void 0!==e.length&&e.length==i,"Field "+t+" should be a list with length equal to the dimension!"),e.forEach(function(e){n("string"==typeof e||e instanceof String,"Field "+t+" should be a list of numbers!")}),o=a+": "+e.map(b).join(" ");break;case"sizes":n(void 0!==e.length&&e.length==i,"Field "+t+" should be a list with length equal to the dimension!"),e.forEach(function(e){n("number"==typeof e||e instanceof Number,"Field "+t+" should be a list of numbers!")}),o=a+": "+e.join(" ");break;case"spacings":case"thicknesses":case"axisMins":case"axisMaxs":n(void 0!==e.length&&e.length==i,"Field "+t+" should be a list with length equal to the dimension!"),e.forEach(function(e){n("number"==typeof e||e instanceof Number,"Field "+t+" should be a list of numbers!")}),o=a+": "+e.join(" ");break;case"spaceDirections":n(void 0!==e.length&&e.length===i,"Field "+t+" should be a list with length equal to the dimension!"),e.forEach(function(e){n(null===e||void 0!==e.length&&e.length===r,"The elements of field "+t+" should be lists with length equal to the space dimension!"),null!==e&&e.forEach(function(e){n("number"==typeof e||e instanceof Number,"The elements of field "+t+" should be lists of numbers!")})}),o=a+": "+e.map(function(t){return null===t?"none":"("+t.join(",")+")"}).join(" ");break;case"measurementFrame":n(void 0!==e.length&&e.length===r,"Field "+t+" should be a list with length equal to the space dimension!"),e.forEach(function(e){n(null===e||void 0!==e.length&&e.length===r,"The elements of field "+t+" should be lists with length equal to the space dimension!"),null!==e&&e.forEach(function(e){n("number"==typeof e||e instanceof Number,"The elements of field "+t+" should be lists of numbers!")})}),o=a+": "+e.map(function(t){return null===t?"none":"("+t.join(",")+")"}).join(" ");break;case"type":case"encoding":case"endian":n("string"==typeof e||e instanceof String,"Field "+t+" should contain a string!"),o=a+": "+e;break;case"dataFile":e.length||e.files&&"subdim"in e||(o=a+": "+function(t){if("string"==typeof t||t instanceof String)return t;if("format"in t&&"min"in t&&"max"in t&&"step"in t)return"subdim"in t?t.format+" "+t.min+" "+t.max+" "+t.step+" "+t.subdim:t.format+" "+t.min+" "+t.max+" "+t.step;throw new Error("Unrecognized data file format!")}(e));break;case"centers":case"kinds":n(void 0!==e.length&&e.length==i,"Field "+t+" should be a list with length equal to the dimension!"),o=a+": "+e.map(C).join(" ");break;default:console.warn("Unrecognized NRRD field: "+t+", skipping.")}return o}function u(t,e){switch(t){case"content":case"number":case"sampleUnits":break;case"dimension":case"blockSize":case"lineSkip":case"byteSkip":case"spaceDimension":e=m(e);break;case"min":case"max":case"oldMin":case"oldMax":e=_(e);break;case"spaceOrigin":e=g(e);break;case"labels":case"units":case"spaceUnits":e=w(e,y);break;case"sizes":e=w(e,m);break;case"spacings":case"thicknesses":case"axisMins":case"axisMaxs":e=w(e,_);break;case"spaceDirections":case"measurementFrame":e=w(e,g);break;case"type":e=x(e);break;case"encoding":e=A(e);break;case"endian":e=S(e);break;case"dataFile":e=function(t){var e=M.exec(t);return e?5==e.length&&e[4]?{format:t.substring(0,e.index),min:m(e[1]),max:m(e[2]),step:m(e[3]),subdim:m(e[4])}:{format:t.substring(0,e.index),min:m(e[1]),max:m(e[2]),step:m(e[3])}:t}(e);break;case"centers":e=w(e,E);break;case"kinds":e=w(e,k);break;case"space":e=function(t){switch(t.toLowerCase()){case"right-anterior-superior":case"ras":return"right-anterior-superior";case"left-anterior-superior":case"las":return"left-anterior-superior";case"left-posterior-superior":case"lps":return"left-posterior-superior";case"right-anterior-superior-time":case"rast":return"right-anterior-superior-time";case"left-anterior-superior-time":case"last":return"left-anterior-superior-time";case"left-posterior-superior-time":case"lpst":return"left-posterior-superior-time";case"scanner-xyz":return"scanner-xyz";case"scanner-xyz-time":return"scanner-xyz-time";case"3d-right-handed":return"3D-right-handed";case"3d-left-handed":return"3D-left-handed";case"3d-right-handed-time":return"3D-right-handed-time";case"3d-left-handed-time":return"3D-left-handed-time";default:return console.warn("Unrecognized space: "+t),t}}(e);break;default:console.warn("Unrecognized NRRD field: "+t)}return e}t.exports.serialize=function(t){var e,i,n,r,o,a,s,c,u,d,f=1,p={},m=[];for(r in t)p[r]=t[r];if(void 0===p.sizes)throw new Error("Sizes missing from NRRD file!");if(void 0===p.dimension&&(p.dimension=p.sizes.length),p.data instanceof Int8Array?o="int8":p.data instanceof Uint8Array?o="uint8":p.data instanceof Int16Array?o="int16":p.data instanceof Uint16Array?o="uint16":p.data instanceof Int32Array?o="int32":p.data instanceof Uint32Array?o="uint32":p.data instanceof Float32Array?o="float":p.data instanceof Float64Array&&(o="double"),void 0===p.type&&void 0!==o)p.type=o;else{if(void 0===p.type)throw new Error("Type of data is not given and cannot be inferred!");("string"==typeof p.type||p.type instanceof String)&&(p.type=x(p.type))}void 0===p.encoding?p.encoding="raw":("string"==typeof p.encoding||p.encoding instanceof String)&&(p.encoding=A(p.encoding)),p.data&&"block"!=p.type&&"int8"!=p.type&&"uint8"!=p.type&&"ascii"!=p.encoding?p.endian=I:"block"==p.type||"int8"==p.type||"uint8"==p.type||"ascii"==p.encoding?p.endian=void 0:("string"==typeof p.endian||p.endian instanceof String)&&(p.endian=S(p.endian));var _=void 0;if(void 0!==p.spaceDimension)_=p.spaceDimension;else if(void 0!==p.space)switch(p.space){case"right-anterior-superior":case"RAS":_=3;break;case"left-anterior-superior":case"LAS":_=3;break;case"left-posterior-superior":case"LPS":_=3;break;case"right-anterior-superior-time":case"RAST":_=4;break;case"left-anterior-superior-time":case"LAST":_=4;break;case"left-posterior-superior-time":case"LPST":_=4;break;case"scanner-xyz":_=3;break;case"scanner-xyz-time":_=4;break;case"3D-right-handed":case"3D-left-handed":_=3;break;case"3D-right-handed-time":case"3D-left-handed-time":_=4;break;default:console.warn("Unrecognized space: "+p.space)}for(B(p),e=0;e<p.sizes.length;e++){if(p.sizes[e]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");f*=p.sizes[e]}if(p.data){if(p.data.length<f)throw new Error("Missing data to serialize!")}else if(p.buffer){if("raw"==p.encoding&&(a="block"==p.type&&void 0!==p.blockSize?p.blockSize:R(p.type),p.buffer.byteLength<f*a))throw new Error("Missing data to serialize!")}else if(!p.dataFile)throw new Error("Will not serialize an empty NRRD file!");if(p.data)switch(p.encoding){case"raw":s=p.type==o&&p.endian==I?p.data.buffer.slice(p.data.byteOffset,p.data.byteOffset+p.data.byteLength):p.endian==I?(s=L(p.data,p.type)).buffer.slice(s.byteOffset,s.byteOffset+s.byteLength):function(t,e,i){var n,r,o,a=R(e),s=new ArrayBuffer(t.length*a);switch(i){case"big":r=!1;break;case"little":r=!0;break;default:return void console.warn("Unsupported endianness in NRRD file: "+i)}switch(o=new DataView(s),e){case"int8":for(n=0;n<t.length;n++)o.setInt8(n,t[n],r);return s;case"uint8":for(n=0;n<t.length;n++)o.setUint8(n,t[n],r);return s;case"int16":for(n=0;n<t.length;n++)o.setInt16(2*n,t[n],r);return s;case"uint16":for(n=0;n<t.length;n++)o.setUint16(2*n,t[n],r);return s;case"int32":for(n=0;n<t.length;n++)o.setInt32(4*n,t[n],r);return s;case"uint32":for(n=0;n<t.length;n++)o.setUint32(4*n,t[n],r);return s;case"float":for(n=0;n<t.length;n++)o.setFloat32(4*n,t[n],r);return s;case"double":for(n=0;n<t.length;n++)o.setFloat64(8*n,t[n],r);return s;default:return void console.warn("Cannot serialize NRRD type: "+e+".")}}(p.data,p.type,p.endian);break;case"ascii":s=p.type==o?D(p.data):D(L(p.data,p.type));break;default:throw new Error("Unsupported NRRD encoding: "+p.encoding)}else p.buffer&&(s=p.buffer);m.push("NRRD0005"),m.push("# Generated by nrrd-js");var g=["dimension","spaceDimension","space"];for(e=0;e<g.length;e++)void 0!==p[r=g[e]]&&void 0!==(u=h(r,p[r],p.dimension,_))&&m.push(u);for(r in p)void 0!==p[r]&&(g.indexOf(r)>=0||void 0!==(u=h(r,p[r],p.dimension,_))&&m.push(u));if(p.keys)for(r in p.keys){if(r.indexOf(":=")>=0)throw new Error("The combination ':=' is not allowed in an NRRD key!");m.push(r+":="+l(p[r]))}if(p.dataFile&&p.dataFile.length?(m.push("data file: LIST"),Array.prototype.push.apply(m,p.dataFile)):p.dataFile&&p.dataFile.files&&"subdim"in p.dataFile&&(m.push("data file: LIST "+p.dataFile.subdim),Array.prototype.push.apply(m,p.dataFile.files)),!s||"dataFile"in p)for(m.push(""),d=m.join("\n"),i=new ArrayBuffer(d.length),n=new Uint8Array(i),e=0;e<d.length;e++)n[e]=d.charCodeAt(e);else{for(m.push(""),m.push(""),d=m.join("\n"),i=new ArrayBuffer(d.length+s.byteLength),n=new Uint8Array(i),e=0;e<d.length;e++)n[e]=d.charCodeAt(e);c=new Uint8Array(s),n.set(c,d.length)}return i},t.exports.parse=function(t){var e,i,n,l,h,d,f={data:void 0,buffer:void 0,keys:{},version:void 0},g=new Uint8Array(t);for(g.buffer!==t&&(t=g.buffer),e=2;e<g.length;)if(10==g[e]){if(10==g[e-1]||13==g[e-1]&&10==g[e-2]){n=e+1;break}e++}else 13==g[e]?e++:e+=2;if(void 0===n?i=String.fromCharCode.apply(null,g):(i=String.fromCharCode.apply(null,g.subarray(0,n)),f.buffer=t.slice(n)),l=(l=i.split(r)).filter(function(t){return t.length>0&&"#"!=t[0]}),!o.test(l[0]))throw new Error("File is not an NRRD file!");for(f.version=parseInt(l[0].substring(4,8),10),f.version>5&&console.warn("Reading an unsupported version of the NRRD format; things may go haywire."),e=1;e<l.length;e++)if(h=a.exec(l[e]))if(": "==h[2])h[1]=p(h[1]),"dataFile"==h[1]&&(d=s.exec(h[3]))?(2==d.length&&d[1]?f[h[1]]={files:l.slice(e+1),subdim:m(d[1])}:f[h[1]]=l.slice(e+1),l.length=e):f[h[1]]=u(h[1],h[3]);else{if(":="!=h[2])throw new Error("Logic error in NRRD parser.");f.keys[h[1]]=c(h[3])}else console.warn("Unrecognized line in NRRD header: "+l[e]);if(B(f),"dataFile"in f)console.warn("No support for external data yet!");else switch(f.encoding){case"raw":f.data=function(t,e,i,n){var r,o,a,s=1;for(r=0;r<i.length;r++){if(i[r]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");s*=i[r]}if("block"==e)return t.slice(0,s*n.blockSize);if("int8"==e||"uint8"==e||n.endian==I)switch(e){case"int8":return l(1),new Int8Array(t.slice(0,s));case"uint8":return l(1),new Uint8Array(t.slice(0,s));case"int16":return l(2),new Int16Array(t.slice(0,2*s));case"uint16":return l(2),new Uint16Array(t.slice(0,2*s));case"int32":return l(4),new Int32Array(t.slice(0,4*s));case"uint32":return l(4),new Uint32Array(t.slice(0,4*s));case"float":return l(4),new Float32Array(t.slice(0,4*s));case"double":return l(8),new Float64Array(t.slice(0,8*s));default:return void console.warn("Unsupported NRRD type: "+e+", returning raw buffer.")}else{switch(n.endian){case"big":!1;break;case"little":!0;break;default:return void console.warn("Unsupported endianness in NRRD file: "+n.endian)}switch(a=new DataView(t),e){case"int8":for(o=new Int8Array(s),r=0;r<s;r++)o[r]=a.getInt8(r);return o;case"uint8":for(o=new Uint8Array(s),r=0;r<s;r++)o[r]=a.getUint8(r);return o;case"int16":for(o=new Int16Array(s),r=0;r<s;r++)o[r]=a.getInt16(2*r);return o;case"uint16":for(o=new Uint16Array(s),r=0;r<s;r++)o[r]=a.getUint16(2*r);return o;case"int32":for(o=new Int32Array(s),r=0;r<s;r++)o[r]=a.getInt32(4*r);return o;case"uint32":for(o=new Uint32Array(s),r=0;r<s;r++)o[r]=a.getUint32(4*r);return o;case"float":for(o=new Float32Array(s),r=0;r<s;r++)o[r]=a.getFloat32(4*r);return o;case"double":for(o=new Float64Array(s),r=0;r<s;r++)o[r]=a.getFloat64(8*r);return o;default:return void console.warn("Unsupported NRRD type: "+e+", returning raw buffer.")}}function l(e){if(t.byteLength<s*e)throw new Error("NRRD file does not contain enough data!")}}(f.buffer,f.type,f.sizes,{endian:f.endian,blockSize:f.blockSize});break;case"ascii":f.data=function(t,e,i){var n,r,o,a,s=1;for(n=0;n<i.length;n++){if(i[n]<=0)throw new Error("Sizes should be a list of positive (>0) integers!");s*=i[n]}if(r=new Uint8Array(t),o=String.fromCharCode.apply(null,r),(a=o.split(P)).length<s)throw new Error("Not enough data in NRRD file!");a.length>s&&(""===a[0]&&(a=a.slice(1)),a=a.slice(0,s));switch(e){case"int8":return new Int8Array(a.map(m));case"uint8":return new Uint8Array(a.map(m));case"int16":return new Int16Array(a.map(m));case"uint16":return new Uint16Array(a.map(m));case"int32":return new Int32Array(a.map(m));case"uint32":return new Uint32Array(a.map(m));case"float":return new Float32Array(a.map(_));case"double":return new Float64Array(a.map(_));default:return void console.warn("Unsupported NRRD type: "+e+".")}}(f.buffer,f.type,f.sizes);break;default:console.warn("Unsupported NRRD encoding: "+f.encoding)}return f};var d={"block size":"blockSize",blocksize:"blockSize","old min":"oldMin",oldmin:"oldMin","old max":"oldMax",oldmax:"oldMax","data file":"dataFile",datafile:"dataFile","line skip":"lineSkip",lineskip:"lineSkip","byte skip":"byteSkip",byteskip:"byteSkip","sample units":"sampleUnits",sampleunits:"sampleUnits","axis mins":"axisMins","axis maxs":"axisMaxs",centers:"centers",centerings:"centers","space dimension":"spaceDimension","space units":"spaceUnits","space origin":"spaceOrigin","space directions":"spaceDirections","measurement frame":"measurementFrame"},f=function(){var t,e={};for(t in d)e[d[t]]=t;return e}();function p(t){return(t=t.toLowerCase())in d?d[t]:t}function m(t){var e=parseInt(t,10);if(Number.isNaN(e))throw new Error("Malformed NRRD integer: "+t);return e}function _(t){if((t=t.toLowerCase()).indexOf("nan")>=0)return NaN;if(t.indexOf("-inf")>=0)return-1/0;if(t.indexOf("inf")>=0)return 1/0;var e=parseFloat(t);if(Number.isNaN(e))throw new Error("Malformed NRRD float: "+t);return e}function g(t){if("none"==t)return null;if(t.length<2||"("!==t[0]||")"!==t[t.length-1])throw new Error("Malformed NRRD vector: "+t);return t.slice(1,-1).split(",").map(_)}function y(t){if(length<2||'"'!=t[0]||'"'!=t[t.length-1])throw new Error("Invalid NRRD quoted string: "+t);return t.slice(1,-1).replace('\\"','"')}function b(t){return'"'+t.replace('"','\\"')+'"'}var v=/[ \t]+/;function w(t,e){return t.split(v).map(e)}function x(t){switch(t.toLowerCase()){case"signed char":case"int8":case"int8_t":return"int8";case"uchar":case"unsigned char":case"uint8":case"uint8_t":return"uint8";case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":return"int16";case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":return"uint16";case"int":case"signed int":case"int32":case"int32_t":return"int32";case"uint":case"unsigned int":case"uint32":case"uint32_t":return"uint32";case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":return"int64";case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":return"uint64";case"float":return"float";case"double":return"double";case"block":return"block";default:return console.warn("Unrecognized NRRD type: "+t),t}}function A(t){switch(t.toLowerCase()){case"raw":return"raw";case"txt":case"text":case"ascii":return"ascii";case"hex":return"hex";case"gz":case"gzip":return"gzip";case"bz2":case"bzip2":return"bzip2";default:return console.warn("Unrecognized NRRD encoding: "+t),t}}function S(t){switch(t.toLowerCase()){case"little":return"little";case"big":return"big";default:return console.warn("Unrecognized NRRD endianness: "+t),t}}var M=/ (-?\d+) (-?\d+) (-?\d+)(?: (\d+))?$/;function E(t){switch(t.toLowerCase()){case"cell":return"cell";case"node":return"node";case"???":case"none":return null;default:return console.warn("Unrecognized NRRD center: "+t),t}}var T={domain:"domain",space:"space",time:"time",list:"list",point:"point",vector:"vector","covariant-vector":"covariant-vector",normal:"normal",stub:"stub",scalar:"scalar",complex:"complex","2-vector":"2-vector","3-color":"3-color","rgb-color":"RGB-color","hsv-color":"HSV-color","xyz-color":"XYZ-color","4-color":"4-color","rgba-color":"RGBA-color","3-vector":"3-vector","3-gradient":"3-gradient","3-normal":"3-normal","4-vector":"4-vector",quaternion:"quaternion","2d-symmetric-matrix":"2D-symmetric-matrix","2d-masked-symmetric-matrix":"2D-masked-symmetric-matrix","2d-matrix":"2D-matrix","2d-masked-matrix":"2D-masked-matrix","3d-symmetric-matrix":"3D-symmetric-matrix","3d-masked-symmetric-matrix":"3D-masked-symmetric-matrix","3d-matrix":"3D-matrix","3d-masked-matrix":"3D-masked-matrix","???":null,none:null};function k(t){var e=t.toLowerCase();return e in T?T[e]:(console.warn("Unrecognized NRRD kind: "+t),t)}function C(t){return null===t?"???":t}var I=function(){var t=new ArrayBuffer(4),e=new Uint32Array(t),i=new Uint8Array(t);return e[0]=16909060,1==i[0]&&2==i[1]&&3==i[2]&&4==i[3]?"big":4==i[0]&&3==i[1]&&2==i[2]&&1==i[3]?"little":void console.warn("Unrecognized system endianness!")}();var P=/[ \t\n\r\v\f]+/;function R(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":return 4;case"int64":case"uint64":return 8;case"float":return 4;case"double":return 8;default:throw new Error("Do not know the size of NRRD type: "+t)}}function B(t){if(void 0===t.dimension)throw new Error("Dimension missing from NRRD file!");if(void 0===t.type)throw new Error("Type missing from NRRD file!");if(void 0===t.encoding)throw new Error("Encoding missing from NRRD file!");if(void 0===t.sizes)throw new Error("Sizes missing from NRRD file!");if("block"!=t.type&&"int8"!=t.type&&"uint8"!=t.type&&"ascii"!=t.encoding&&void 0===t.endian)throw new Error("Endianness missing from NRRD file!");if("block"==t.type&&void 0===t.blockSize)throw new Error("Missing block size in NRRD file!");if(0===t.dimension)throw new Error("Zero-dimensional NRRD file?");if(t.dimension!=t.sizes.length)throw new Error("Length of 'sizes' is different from 'dimension' in an NRRD file!");if(t.spacings&&t.dimension!=t.spacings.length)throw new Error("Length of 'spacings' is different from 'dimension' in an NRRD file!");if(t.thicknesses&&t.dimension!=t.thicknesses.length)throw new Error("Length of 'thicknesses' is different from 'dimension' in an NRRD file!");if(t.axisMins&&t.dimension!=t.axisMins.length)throw new Error("Length of 'axis mins' is different from 'dimension' in an NRRD file!");if(t.axisMaxs&&t.dimension!=t.axisMaxs.length)throw new Error("Length of 'axis maxs' is different from 'dimension' in an NRRD file!");if(t.centers&&t.dimension!=t.centers.length)throw new Error("Length of 'centers' is different from 'dimension' in an NRRD file!");if(t.labels&&t.dimension!=t.labels.length)throw new Error("Length of 'labels' is different from 'dimension' in an NRRD file!");if(t.units&&t.dimension!=t.units.length)throw new Error("Length of 'units' is different from 'dimension' in an NRRD file!");if(t.kinds&&t.dimension!=t.kinds.length)throw new Error("Length of 'kinds' is different from 'dimension' in an NRRD file!");if(!(void 0!==t.data&&0!==t.data.length||void 0!==t.buffer&&0!==t.buffer.byteLength||void 0!==t.dataFile))throw new Error("NRRD file has neither inline or external data!")}function L(t,e){switch(e){case"int8":return new Int8Array(t);case"uint8":return new Uint8Array(t);case"int16":return new Int16Array(t);case"uint16":return new Uint16Array(t);case"int32":return new Int32Array(t);case"uint32":return new Uint32Array(t);case"float":return new Float32Array(t);case"double":return new Float64Array(t);default:throw new Error("Cannot cast to NRRD type: "+e)}}function D(t){var e,i,n,r,o=new Array(t.length);for(e=0;e<t.length;e++)o[e]=""+t[e];for(i=o.join(" "),n=new ArrayBuffer(i.length),r=new Uint8Array(n),e=0;e<r.length;e++)r[e]=i.charCodeAt(e);return n}},function(t,e,i){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function n(t,e){if(t===e)return 0;for(var i=t.length,n=e.length,r=0,o=Math.min(i,n);r<o;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0}function r(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=i(161),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,l="foo"===function(){}.name;function c(t){return Object.prototype.toString.call(t)}function h(t){return!r(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var u=t.exports=g,d=/\s*function\s+([^\(\s]*)\s*/;function f(t){if(o.isFunction(t)){if(l)return t.name;var e=t.toString().match(d);return e&&e[1]}}function p(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(l||!o.isFunction(t))return o.inspect(t);var e=f(t);return"[Function"+(e?": "+e:"")+"]"}function _(t,e,i,n,r){throw new u.AssertionError({message:i,actual:t,expected:e,operator:n,stackStartFunction:r})}function g(t,e){t||_(t,!0,e,"==",u.ok)}function y(t,e,i,a){if(t===e)return!0;if(r(t)&&r(e))return 0===n(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(h(t)&&h(e)&&c(t)===c(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===n(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(r(t)!==r(e))return!1;var l=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,i,n){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=b(t),a=b(e);if(r&&!a||!r&&a)return!1;if(r)return t=s.call(t),e=s.call(e),y(t,e,i);var l,c,h=x(t),u=x(e);if(h.length!==u.length)return!1;for(h.sort(),u.sort(),c=h.length-1;c>=0;c--)if(h[c]!==u[c])return!1;for(c=h.length-1;c>=0;c--)if(l=h[c],!y(t[l],e[l],i,n))return!1;return!0}(t,e,i,a))}return i?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function v(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,i,n){var r;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),t&&!r&&_(r,i,"Missing expected exception"+n);var a="string"==typeof n,s=!t&&o.isError(r),l=!t&&r&&!i;if((s&&a&&v(r,i)||l)&&_(r,i,"Got unwanted exception"+n),t&&r&&i&&!v(r,i)||!t&&r)throw r}u.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return p(m(t.actual),128)+" "+t.operator+" "+p(m(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||_;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var i=new Error;if(i.stack){var n=i.stack,r=f(e),o=n.indexOf("\n"+r);if(o>=0){var a=n.indexOf("\n",o+1);n=n.substring(a+1)}this.stack=n}}},o.inherits(u.AssertionError,Error),u.fail=_,u.ok=g,u.equal=function(t,e,i){t!=e&&_(t,e,i,"==",u.equal)},u.notEqual=function(t,e,i){t==e&&_(t,e,i,"!=",u.notEqual)},u.deepEqual=function(t,e,i){y(t,e,!1)||_(t,e,i,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(t,e,i){y(t,e,!0)||_(t,e,i,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(t,e,i){y(t,e,!1)&&_(t,e,i,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function t(e,i,n){y(e,i,!0)&&_(e,i,n,"notDeepStrictEqual",t)},u.strictEqual=function(t,e,i){t!==e&&_(t,e,i,"===",u.strictEqual)},u.notStrictEqual=function(t,e,i){t===e&&_(t,e,i,"!==",u.notStrictEqual)},u.throws=function(t,e,i){w(!0,t,e,i)},u.doesNotThrow=function(t,e,i){w(!1,t,e,i)},u.ifError=function(t){if(t)throw t};var x=Object.keys||function(t){var e=[];for(var i in t)a.call(t,i)&&e.push(i);return e}}).call(this,i(54))},function(t,e,i){(function(t,n){var r=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(s(arguments[i]));return e.join(" ")}i=1;for(var n=arguments,o=n.length,a=String(t).replace(r,function(t){if("%%"===t)return"%";if(i>=o)return t;switch(t){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(t){return"[Circular]"}default:return t}}),l=n[i];i<o;l=n[++i])m(l)||!v(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(i,r){if(y(t.process))return function(){return e.deprecate(i,r).apply(this,arguments)};if(!0===n.noDeprecation)return i;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),o=!0}return i.apply(this,arguments)}};var o,a={};function s(t,i){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(i)?n.showHidden=i:i&&e._extend(n,i),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),h(n,t,n.depth)}function l(t,e){var i=s.styles[e];return i?"["+s.colors[i][0]+"m"+t+"["+s.colors[i][1]+"m":t}function c(t,e){return t}function h(t,i,n){if(t.customInspect&&i&&A(i.inspect)&&i.inspect!==e.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,t);return g(r)||(r=h(t,r,n)),r}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(g(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}if(_(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,i);if(o)return o;var a=Object.keys(i),s=function(t){var e={};return t.forEach(function(t,i){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(i)),x(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(i);if(0===a.length){if(A(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(b(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return t.stylize(Date.prototype.toString.call(i),"date");if(x(i))return u(i)}var c,v="",S=!1,M=["{","}"];(f(i)&&(S=!0,M=["[","]"]),A(i))&&(v=" [Function"+(i.name?": "+i.name:"")+"]");return b(i)&&(v=" "+RegExp.prototype.toString.call(i)),w(i)&&(v=" "+Date.prototype.toUTCString.call(i)),x(i)&&(v=" "+u(i)),0!==a.length||S&&0!=i.length?n<0?b(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),c=S?function(t,e,i,n,r){for(var o=[],a=0,s=e.length;a<s;++a)T(e,String(a))?o.push(d(t,e,i,n,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(t,e,i,n,r,!0))}),o}(t,i,n,s,a):a.map(function(e){return d(t,i,n,s,e,S)}),t.seen.pop(),function(t,e,i){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1];return i[0]+e+" "+t.join(", ")+" "+i[1]}(c,v,M)):M[0]+v+M[1]}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,i,n,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),T(n,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=m(i)?h(t,l.value,null):h(t,l.value,i-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function f(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function m(t){return null===t}function _(t){return"number"==typeof t}function g(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return v(t)&&"[object RegExp]"===S(t)}function v(t){return"object"==typeof t&&null!==t}function w(t){return v(t)&&"[object Date]"===S(t)}function x(t){return v(t)&&("[object Error]"===S(t)||t instanceof Error)}function A(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(o)&&(o=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var i=n.pid;a[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,i,n)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=_,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=v,e.isDate=w,e.isError=x,e.isFunction=A,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=i(162);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),E[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=i(163),e._extend=function(t,e){if(!e||!v(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,i(54),i(53))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t){t.exports={name:"ami.js",private:!0,version:"0.32.1",main:"build/ami.js",keywords:["ami","ami.js","three.js","webgl","dicom","nifti","awesome","medical","imaging","xtk","nrrd","vtk","stl","trk"],author:{name:"Nicolas Rannou",email:"nicolas@eunate.ch",url:"https://eunate.ch"},license:"Apache-2.0",repository:{type:"git",url:"https://fnndsc.github.io/ami"},config:{gaKey:"UA-39303022-3",babel:"--module-bind js=babel-loader --colors --display-error-details"},"lint-staged":{"{{src/**,examples/**, lessons/**}/,}.{js,jsx,json,css,ts,tsx}":["prettier --write","git add"]},prettier:{printWidth:100,singleQuote:!0,trailingComma:"es5",overrides:[{files:"*.css",options:{useTabs:!1,tabWidth:2}}]},sideEffects:!1,scripts:{precommit:"lint-staged","tslint-check":"tslint-config-prettier-check ./tslint.json","check-codestyle":"prettier-check 'src/**/*.{js,jsx,json,css,ts,tsx}'","fix-all-code-style":"prettier --write '{{src/**,examples/**, lessons/**}/,}*.{js,jsx,json,css,ts,tsx}'","build:ami":"webpack --config webpack.config.build.js --display-error-details","build:ami:prod":"cross-env NODE_ENV=production yarn build:ami","build:clean":"rimraf -rf build/*","build:clean:hot":"rimraf -rf build/*.hot-update.*","dev:ami":"webpack --config webpack.config.build.js --hot --watch --colors","dist:ami":"yarn build:clean && yarn build:ami && yarn build:ami:prod && yarn doc","dist:examples":"node ./scripts/buildDist.js && node ./scripts/router.js examples deploy","dist:clean":"rimraf -rf dist/*","analyze:ami":"cross-env NODE_WEBPACK_ANALYZE=true yarn build:ami","analyze:ami:prod":"cross-env NODE_WEBPACK_ANALYZE=true yarn build:ami:prod",clean:"yarn build:clean && yarn dist:clean",example:"node ./scripts/router.js examples","gen:index:examples":"node ./scripts/genIndexFiles.js examples","gen:index:examples:ga":"cross-env NODE_GA=true node ./scripts/genIndexFiles.js examples",test:"karma start",testExamples:"yarn dist:clean && yarn dist:examples",doc:"jsdoc -p -r -R README.md -c jsdoc.json -d dist/doc src",ami:"yarn dist:ami && yarn test",deploy:"yarn dist:clean && yarn build:clean && yarn dist:ami && yarn dist:examples && gh-pages -d dist"},dependencies:{"OpenJPEG.js":"joedrago/openjpeg#master","dicom-parser":"1.8.1","image-JPEG2000":"ReflexionMed/image-JPEG2000#master","jpeg-lossless-decoder-js":"1.2.3","math-float32-to-binary-string":"^1.0.0","nifti-reader-js":"v0.5.3","nrrd-js":"^0.2.1",pako:"1.0.1",three:"0.140.2"},devDependencies:{"@types/jasmine":"^3.3.2","@types/node":"^10.11.3","@types/three":"0.140.0","babel-cli":"latest","babel-core":"^6.26.0","babel-loader":"^7.1.2","babel-preset-env":"^1.6.0","babel-runtime":"^6.26.0","compression-webpack-plugin":"^1.0.1","cross-env":"^3.2.3","gh-pages":"^1.2.0",husky:"^1.1.3","jasmine-core":"^2.99.1",jsdoc:"jsdoc3/jsdoc#master",karma:"^2.0.5","karma-chrome-launcher":"^2.2.0","karma-jasmine":"^1.1.2","karma-sinon":"^1.0.5","karma-spec-reporter":"^0.0.32","karma-webpack":"3.0.0","lint-staged":"^8.0.4","live-server":"^1.1.0","node-pre-gyp":"^0.10.0",prettier:"^1.15.1","prettier-check":"^2.0.0",puppeteer:"^1.6.1",rimraf:"^2.6.1","rollup-plugin-node-builtins":"^2.1.2",shelljs:"^0.8.2",sinon:"^2.0.0","ts-loader":"^5.2.1",tslint:"^5.11.0","tslint-config-prettier":"^1.15.0","tslint-loader":"^3.6.0",typescript:"^3.1.1","uglifyjs-webpack-plugin":"^1.2.7",webpack:"^4.16.3","webpack-bundle-analyzer":"^2.9.0","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.5","webpack-watch-livereload-plugin":"^0.0.1"},engines:{node:">=6.9.0"}}},function(t){t.exports={name:"three",version:"0.140.2",description:"JavaScript 3D library",type:"module",main:"./build/three.js",module:"./build/three.module.js",exports:{".":{import:"./build/three.module.js",require:"./build/three.cjs"},"./examples/fonts/*":"./examples/fonts/*","./examples/jsm/*":"./examples/jsm/*","./src/*":"./src/*"},repository:{type:"git",url:"https://github.com/mrdoob/three.js"},sideEffects:!1,files:["build/three.js","build/three.cjs","build/three.min.js","build/three.module.js","examples/js","examples/jsm","examples/fonts","LICENSE","package.json","README.md","src"],directories:{doc:"docs",example:"examples",test:"test"},eslintConfig:{root:!0,extends:["mdcs","plugin:compat/recommended"],parser:"@babel/eslint-parser",parserOptions:{babelOptions:{configFile:"./utils/build/.babelrc.json"}},plugins:["html","import"],settings:{polyfills:["WebGL2RenderingContext"]},globals:{__THREE_DEVTOOLS__:"readonly",WebGL2ComputeRenderingContext:"readonly",potpack:"readonly",fflate:"readonly",bodymovin:"readonly",OIMO:"readonly",Stats:"readonly",XRWebGLBinding:"readonly",XRWebGLLayer:"readonly",GPUShaderStage:"readonly",GPUBufferUsage:"readonly",GPUTextureUsage:"readonly",QUnit:"readonly"},rules:{"no-throw-literal":["error"],"import/extensions":["error","always"],quotes:["error","single"],"prefer-const":["error",{destructuring:"any",ignoreReadBeforeAssign:!1}]}},browserslist:["> 1%, not dead, not ie 11, not op_mini all"],scripts:{start:"npm run dev",test:"npm run lint && npm run test-unit",build:"rollup -c utils/build/rollup.config.js","build-module":"ONLY_MODULE=true rollup -c utils/build/rollup.config.js","build-examples":"rollup -c utils/build/rollup.examples.config.js && echo '\nFormatting...' && eslint examples/js --ext js --ignore-pattern libs --ignore-pattern ifc --fix",dev:'concurrently --names "ROLLUP,HTTP" -c "bgBlue.bold,bgGreen.bold" "rollup -c utils/build/rollup.config.js -w -m inline" "servez -p 8080"',lint:"eslint src --ext js","lint-examples":"eslint examples/js examples/jsm --ext js --ignore-pattern libs --ignore-pattern ifc","lint-fix":"npm run lint -- --fix && npm run lint-examples -- --fix","lint-docs":"eslint docs --ext html","test-unit":"npm run unit --prefix test","test-e2e":"node test/e2e/puppeteer.js","test-e2e-cov":"node test/e2e/check-coverage.js","test-treeshake":"rollup -c test/rollup.treeshake.config.js","make-screenshot":"node test/e2e/puppeteer.js --make"},keywords:["three","three.js","javascript","3d","virtual-reality","augmented-reality","webgl","webgl2","webaudio","webgpu","webxr","canvas","svg","html5"],author:"mrdoob",license:"MIT",bugs:{url:"https://github.com/mrdoob/three.js/issues"},homepage:"https://threejs.org/",devDependencies:{"@babel/core":"^7.17.9","@babel/eslint-parser":"^7.17.0","@babel/plugin-proposal-class-properties":"^7.16.7","@babel/preset-env":"^7.16.11","@rollup/plugin-babel":"^5.3.1","@rollup/plugin-node-resolve":"^13.2.0",chalk:"^5.0.1",concurrently:"^7.1.0",eslint:"^8.13.0","eslint-config-mdcs":"^5.0.0","eslint-plugin-compat":"^4.0.2","eslint-plugin-html":"^6.2.0","eslint-plugin-import":"^2.26.0",rollup:"^2.70.2","rollup-plugin-filesize":"^9.1.2","rollup-plugin-terser":"^7.0.2","rollup-plugin-visualizer":"^5.6.0",servez:"^1.14.1"},jspm:{files:["package.json","LICENSE","README.md","build/three.js","build/three.min.js","build/three.module.js"],directories:{}}}}])});